2025-08-21 07:53:27 [info     ] Loaded environment variables from ../.env
2025-08-21 07:53:31 [info     ] Loading config from 'config/roleplay_miscon_test_kt_nocontext/qwen3:0.6b~T_0.0~SO_teacher_kt~SP_teacher_marshmellow_level_nocontext~EFI_quotes~ES_miscon_studentid_random0.yaml'
2025-08-21 07:53:31 [info     ] Loading config from 'config/roleplay_miscon_test_kt_nocontext/qwen3:1.7b~T_0.0~SO_student_kt~SP_student_chocolate_level_nocontext~EFI_quotes~ES_miscon_studentid_random0.yaml'
2025-08-21 07:53:31 [info     ] Loading config from 'config/roleplay_miscon_test_kt_nocontext/llama3.2:1b~T_0.0~SO_student_kt~SP_student_chocolate_level_nocontext~EFI_quotes~ES_miscon_studentid_random0.yaml'
2025-08-21 07:53:31 [info     ] Loading config from 'config/roleplay_miscon_test_kt_nocontext/llama3.2:3b~T_0.0~SO_teacher_kt~SP_teacher_marshmellow_level_nocontext~EFI_quotes~ES_miscon_studentid_random0.yaml'
2025-08-21 07:53:31 [info     ] Loading config from 'config/roleplay_miscon_test_kt_nocontext/qwen3:14b~T_0.0~SO_student_kt~SP_student_chocolate_level_nocontext~EFI_quotes~ES_miscon_studentid_random0.yaml'
2025-08-21 07:53:31 [info     ] Loading config from 'config/roleplay_miscon_test_kt_nocontext/llama3.1:8b~T_0.0~SO_student_kt~SP_student_chocolate_level_nocontext~EFI_quotes~ES_miscon_studentid_random0.yaml'
2025-08-21 07:53:31 [info     ] Loading config from 'config/roleplay_miscon_test_kt_nocontext/qwen3:4b~T_0.0~SO_teacher_kt~SP_teacher_marshmellow_level_nocontext~EFI_quotes~ES_miscon_studentid_random0.yaml'
2025-08-21 07:53:31 [info     ] Loading config from 'config/roleplay_miscon_test_kt_nocontext/qwen3:8b~T_0.0~SO_student_kt~SP_student_chocolate_level_nocontext~EFI_quotes~ES_miscon_studentid_random0.yaml'

 ========== Config: qwen3:0.6b~T_0.0~SO_teacher_kt~L_5~SP_teacher_marshmellow_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_miscon_studentlevel_random0 ==========
Config 1/8

 ********** Run: 1/3 **********
2025-08-21 07:53:31 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 07:53:31 [info     ] Reading train split questions  num_questions=92
2025-08-21 07:53:31 [info     ] Reading validation split questions num_questions=23
2025-08-21 07:53:31 [info     ] Reading test split questions   num_questions=39
2025-08-21 07:53:32 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 07:53:32 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 07:53:37 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 07:53:37 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 07:53:37 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 07:53:37 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 07:53:40 [info     ] Setting seed                   value=43
2025-08-21 07:53:40 [info     ] Building structured outputter  name=teacher_kt
2025-08-21 07:53:40 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_marshmellow_level_nocontext
2025-08-21 07:53:40 [info     ] Building model                 name=qwen3:0.6b provider=ollama rate_limit=None temp=0.0
2025-08-21 07:53:40 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:02<08:08,  2.52s/it]  1%|          | 2/195 [00:02<03:33,  1.11s/it]  2%|▏         | 3/195 [00:03<02:52,  1.11it/s]  2%|▏         | 4/195 [00:03<01:58,  1.62it/s]  3%|▎         | 5/195 [00:03<01:40,  1.89it/s]  3%|▎         | 6/195 [00:04<01:28,  2.13it/s]  4%|▎         | 7/195 [00:04<01:09,  2.69it/s]  4%|▍         | 8/195 [00:04<01:05,  2.85it/s]  5%|▍         | 9/195 [00:04<00:55,  3.33it/s]  5%|▌         | 10/195 [00:05<00:54,  3.37it/s]  6%|▌         | 11/195 [00:05<00:46,  3.94it/s]  6%|▌         | 12/195 [00:05<00:48,  3.81it/s]  7%|▋         | 13/195 [00:05<00:40,  4.46it/s]  7%|▋         | 14/195 [00:05<00:41,  4.37it/s]  8%|▊         | 15/195 [00:06<00:35,  5.02it/s]  8%|▊         | 16/195 [00:06<00:38,  4.66it/s]  9%|▊         | 17/195 [00:06<00:34,  5.23it/s]  9%|▉         | 18/195 [00:06<00:40,  4.36it/s] 10%|▉         | 19/195 [00:06<00:36,  4.87it/s] 10%|█         | 20/195 [00:07<00:40,  4.37it/s] 11%|█         | 21/195 [00:07<00:35,  4.85it/s] 11%|█▏        | 22/195 [00:07<00:40,  4.23it/s] 12%|█▏        | 23/195 [00:07<00:36,  4.73it/s] 12%|█▏        | 24/195 [00:08<00:40,  4.27it/s] 13%|█▎        | 25/195 [00:08<00:35,  4.77it/s] 13%|█▎        | 26/195 [00:08<00:39,  4.26it/s] 14%|█▍        | 27/195 [00:08<00:36,  4.67it/s] 14%|█▍        | 28/195 [00:09<00:39,  4.22it/s] 15%|█▍        | 29/195 [00:09<00:35,  4.63it/s] 15%|█▌        | 30/195 [00:09<00:39,  4.21it/s] 16%|█▌        | 31/195 [00:09<00:39,  4.13it/s] 16%|█▋        | 32/195 [00:10<00:40,  4.07it/s] 17%|█▋        | 33/195 [00:10<00:34,  4.64it/s] 17%|█▋        | 34/195 [00:10<00:36,  4.40it/s] 18%|█▊        | 35/195 [00:10<00:32,  4.91it/s] 18%|█▊        | 36/195 [00:10<00:37,  4.29it/s] 19%|█▉        | 37/195 [00:10<00:32,  4.84it/s] 19%|█▉        | 38/195 [00:11<00:34,  4.54it/s] 20%|██        | 39/195 [00:11<00:30,  5.07it/s] 21%|██        | 40/195 [00:11<00:36,  4.23it/s] 21%|██        | 41/195 [00:11<00:32,  4.72it/s] 22%|██▏       | 42/195 [00:12<00:35,  4.30it/s] 22%|██▏       | 43/195 [00:12<00:31,  4.78it/s] 23%|██▎       | 44/195 [00:12<00:35,  4.29it/s] 23%|██▎       | 45/195 [00:12<00:33,  4.53it/s] 24%|██▎       | 46/195 [00:13<00:35,  4.15it/s] 24%|██▍       | 47/195 [00:13<00:32,  4.60it/s] 25%|██▍       | 48/195 [00:13<00:35,  4.11it/s] 25%|██▌       | 49/195 [00:13<00:31,  4.60it/s] 26%|██▌       | 50/195 [00:14<00:35,  4.09it/s] 26%|██▌       | 51/195 [00:14<00:31,  4.51it/s] 27%|██▋       | 52/195 [00:14<00:35,  4.07it/s] 27%|██▋       | 53/195 [00:14<00:31,  4.46it/s] 28%|██▊       | 54/195 [00:14<00:34,  4.04it/s] 28%|██▊       | 55/195 [00:15<00:30,  4.53it/s] 29%|██▊       | 56/195 [00:15<00:33,  4.20it/s] 29%|██▉       | 57/195 [00:15<00:29,  4.64it/s] 30%|██▉       | 58/195 [00:15<00:32,  4.24it/s] 30%|███       | 59/195 [00:16<00:29,  4.56it/s] 31%|███       | 60/195 [00:16<00:31,  4.28it/s] 31%|███▏      | 61/195 [00:16<00:27,  4.84it/s] 32%|███▏      | 62/195 [00:16<00:29,  4.46it/s] 32%|███▏      | 63/195 [00:16<00:26,  4.99it/s] 33%|███▎      | 64/195 [00:17<00:29,  4.42it/s] 33%|███▎      | 65/195 [00:17<00:25,  5.04it/s] 34%|███▍      | 66/195 [00:17<00:27,  4.62it/s] 34%|███▍      | 67/195 [00:17<00:24,  5.12it/s] 35%|███▍      | 68/195 [00:17<00:28,  4.40it/s] 35%|███▌      | 69/195 [00:18<00:25,  4.94it/s] 36%|███▌      | 70/195 [00:18<00:29,  4.22it/s] 36%|███▋      | 71/195 [00:18<00:25,  4.91it/s] 37%|███▋      | 72/195 [00:18<00:27,  4.41it/s] 37%|███▋      | 73/195 [00:18<00:24,  4.90it/s] 38%|███▊      | 74/195 [00:19<00:27,  4.34it/s] 38%|███▊      | 75/195 [00:19<00:23,  5.12it/s] 39%|███▉      | 76/195 [00:19<00:26,  4.48it/s] 39%|███▉      | 77/195 [00:19<00:23,  5.04it/s] 40%|████      | 78/195 [00:20<00:26,  4.39it/s] 41%|████      | 79/195 [00:20<00:25,  4.51it/s] 41%|████      | 80/195 [00:20<00:29,  3.88it/s] 42%|████▏     | 81/195 [00:20<00:25,  4.55it/s] 42%|████▏     | 82/195 [00:21<00:27,  4.15it/s] 43%|████▎     | 83/195 [00:21<00:25,  4.47it/s] 43%|████▎     | 84/195 [00:21<00:31,  3.55it/s] 44%|████▎     | 85/195 [00:21<00:26,  4.09it/s] 44%|████▍     | 86/195 [00:22<00:28,  3.89it/s] 45%|████▍     | 87/195 [00:22<00:25,  4.20it/s] 45%|████▌     | 88/195 [00:22<00:29,  3.63it/s] 46%|████▌     | 89/195 [00:22<00:25,  4.16it/s] 46%|████▌     | 90/195 [00:23<00:27,  3.77it/s] 47%|████▋     | 91/195 [00:23<00:24,  4.25it/s] 47%|████▋     | 92/195 [00:23<00:26,  3.95it/s] 48%|████▊     | 93/195 [00:23<00:25,  3.93it/s] 48%|████▊     | 94/195 [00:24<00:27,  3.70it/s] 49%|████▊     | 95/195 [00:24<00:23,  4.22it/s] 49%|████▉     | 96/195 [00:24<00:25,  3.94it/s] 50%|████▉     | 97/195 [00:24<00:22,  4.39it/s] 50%|█████     | 98/195 [00:25<00:25,  3.86it/s] 51%|█████     | 99/195 [00:25<00:24,  3.98it/s] 51%|█████▏    | 100/195 [00:25<00:26,  3.61it/s] 52%|█████▏    | 101/195 [00:25<00:25,  3.70it/s] 52%|█████▏    | 102/195 [00:26<00:26,  3.45it/s] 53%|█████▎    | 103/195 [00:26<00:24,  3.76it/s] 53%|█████▎    | 104/195 [00:26<00:25,  3.64it/s] 54%|█████▍    | 105/195 [00:27<00:22,  3.97it/s] 54%|█████▍    | 106/195 [00:27<00:23,  3.77it/s] 55%|█████▍    | 107/195 [00:27<00:20,  4.22it/s] 55%|█████▌    | 108/195 [00:27<00:21,  4.07it/s] 56%|█████▌    | 109/195 [00:27<00:18,  4.58it/s] 56%|█████▋    | 110/195 [00:28<00:20,  4.22it/s] 57%|█████▋    | 111/195 [00:28<00:18,  4.66it/s] 57%|█████▋    | 112/195 [00:28<00:19,  4.30it/s] 58%|█████▊    | 113/195 [00:28<00:17,  4.79it/s] 58%|█████▊    | 114/195 [00:29<00:18,  4.44it/s] 59%|█████▉    | 115/195 [00:29<00:16,  4.87it/s] 59%|█████▉    | 116/195 [00:29<00:17,  4.58it/s] 60%|██████    | 117/195 [00:29<00:15,  4.93it/s] 61%|██████    | 118/195 [00:29<00:16,  4.62it/s] 61%|██████    | 119/195 [00:30<00:15,  5.04it/s] 62%|██████▏   | 120/195 [00:30<00:17,  4.40it/s] 62%|██████▏   | 121/195 [00:30<00:14,  4.95it/s] 63%|██████▎   | 122/195 [00:30<00:15,  4.61it/s] 63%|██████▎   | 123/195 [00:30<00:14,  5.08it/s] 64%|██████▎   | 124/195 [00:31<00:15,  4.63it/s] 64%|██████▍   | 125/195 [00:31<00:13,  5.17it/s] 65%|██████▍   | 126/195 [00:31<00:15,  4.35it/s] 65%|██████▌   | 127/195 [00:31<00:13,  5.05it/s] 66%|██████▌   | 128/195 [00:32<00:16,  4.04it/s] 66%|██████▌   | 129/195 [00:32<00:14,  4.52it/s] 67%|██████▋   | 130/195 [00:32<00:16,  3.83it/s] 67%|██████▋   | 131/195 [00:32<00:14,  4.46it/s] 68%|██████▊   | 132/195 [00:33<00:16,  3.80it/s] 68%|██████▊   | 133/195 [00:33<00:13,  4.46it/s] 69%|██████▊   | 134/195 [00:33<00:15,  3.85it/s] 69%|██████▉   | 135/195 [00:33<00:13,  4.50it/s] 70%|██████▉   | 136/195 [00:33<00:14,  4.11it/s] 70%|███████   | 137/195 [00:34<00:12,  4.56it/s] 71%|███████   | 138/195 [00:34<00:14,  3.88it/s] 71%|███████▏  | 139/195 [00:34<00:12,  4.35it/s] 72%|███████▏  | 140/195 [00:34<00:13,  4.06it/s] 72%|███████▏  | 141/195 [00:35<00:12,  4.46it/s] 73%|███████▎  | 142/195 [00:35<00:12,  4.12it/s] 73%|███████▎  | 143/195 [00:35<00:11,  4.63it/s] 74%|███████▍  | 144/195 [00:35<00:12,  3.97it/s] 74%|███████▍  | 145/195 [00:36<00:11,  4.45it/s] 75%|███████▍  | 146/195 [00:36<00:11,  4.11it/s] 75%|███████▌  | 147/195 [00:36<00:10,  4.40it/s] 76%|███████▌  | 148/195 [00:36<00:12,  3.78it/s] 76%|███████▋  | 149/195 [00:37<00:10,  4.24it/s] 77%|███████▋  | 150/195 [00:37<00:12,  3.49it/s] 77%|███████▋  | 151/195 [00:37<00:10,  4.13it/s] 78%|███████▊  | 152/195 [00:37<00:11,  3.86it/s] 78%|███████▊  | 153/195 [00:38<00:09,  4.32it/s] 79%|███████▉  | 154/195 [00:38<00:10,  3.97it/s] 79%|███████▉  | 155/195 [00:38<00:08,  4.51it/s] 80%|████████  | 156/195 [00:38<00:09,  4.17it/s] 81%|████████  | 157/195 [00:38<00:08,  4.50it/s] 81%|████████  | 158/195 [00:39<00:09,  3.98it/s] 82%|████████▏ | 159/195 [00:39<00:08,  4.45it/s] 82%|████████▏ | 160/195 [00:39<00:08,  4.13it/s] 83%|████████▎ | 161/195 [00:39<00:07,  4.66it/s] 83%|████████▎ | 162/195 [00:40<00:07,  4.21it/s] 84%|████████▎ | 163/195 [00:40<00:06,  4.97it/s] 84%|████████▍ | 164/195 [00:40<00:06,  4.62it/s] 85%|████████▍ | 165/195 [00:40<00:05,  5.17it/s] 85%|████████▌ | 166/195 [00:40<00:06,  4.26it/s] 86%|████████▌ | 167/195 [00:41<00:05,  4.71it/s] 86%|████████▌ | 168/195 [00:41<00:06,  4.23it/s] 87%|████████▋ | 169/195 [00:41<00:05,  4.85it/s] 87%|████████▋ | 170/195 [00:41<00:05,  4.35it/s] 88%|████████▊ | 171/195 [00:41<00:04,  5.09it/s] 88%|████████▊ | 172/195 [00:42<00:04,  4.63it/s] 89%|████████▊ | 173/195 [00:42<00:04,  5.00it/s] 89%|████████▉ | 174/195 [00:42<00:04,  4.65it/s] 90%|████████▉ | 175/195 [00:42<00:03,  5.14it/s] 90%|█████████ | 176/195 [00:43<00:04,  4.62it/s] 91%|█████████ | 177/195 [00:43<00:03,  5.11it/s] 91%|█████████▏| 178/195 [00:43<00:03,  4.61it/s] 92%|█████████▏| 179/195 [00:43<00:03,  4.92it/s] 92%|█████████▏| 180/195 [00:43<00:03,  4.58it/s] 93%|█████████▎| 181/195 [00:44<00:02,  5.14it/s] 93%|█████████▎| 182/195 [00:44<00:02,  4.38it/s] 94%|█████████▍| 183/195 [00:44<00:02,  4.85it/s] 94%|█████████▍| 184/195 [00:44<00:02,  4.33it/s] 95%|█████████▍| 185/195 [00:44<00:02,  4.74it/s] 95%|█████████▌| 186/195 [00:45<00:02,  4.20it/s] 96%|█████████▌| 187/195 [00:45<00:01,  4.41it/s] 96%|█████████▋| 188/195 [00:45<00:01,  3.90it/s] 97%|█████████▋| 189/195 [00:45<00:01,  4.41it/s] 97%|█████████▋| 190/195 [00:46<00:01,  3.95it/s] 98%|█████████▊| 191/195 [00:46<00:00,  4.46it/s] 98%|█████████▊| 192/195 [00:46<00:00,  4.11it/s] 99%|█████████▉| 193/195 [00:46<00:00,  4.35it/s] 99%|█████████▉| 194/195 [00:47<00:00,  4.04it/s]100%|██████████| 195/195 [00:47<00:00,  4.78it/s]100%|██████████| 195/195 [00:49<00:00,  3.95it/s]
2025-08-21 07:54:30 [info     ] Validating outputs
2025-08-21 07:54:30 [info     ] Predict - end                  time=0:0:49
2025-08-21 07:54:30 [info     ] Evaluate - start               split=test
2025-08-21 07:54:30 [info     ] Evaluate - end                 correctness_llm=0.36 monotonicity=-1.15
2025-08-21 07:54:30 [info     ] Evaluate question difficulty - start split=test
2025-08-21 07:54:30 [info     ] Augmenting questions for IRT estimation num_questions=30
2025-08-21 07:54:30 INFO: start loading data
start loading data
2025-08-21 07:54:30 INFO: data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1157.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3569.93it/s]
  0%|          | 0/39 [00:00<?, ?it/s] 54%|█████▍    | 21/39 [00:00<00:00, 209.50it/s]100%|██████████| 39/39 [00:00<00:00, 328.47it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 9635.75it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 987.76it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3384.95it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 440.09it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8594.89it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1098.93it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3788.89it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 598.44it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 9003.41it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1093.98it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3590.46it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 607.69it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8110.53it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1110.07it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3682.11it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 603.47it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7971.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1109.23it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3640.40it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 724.65it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8099.35it/s]
2025-08-21 07:54:34 INFO: EM converged at iteration 6.
EM converged at iteration 6.
2025-08-21 07:54:34 INFO: parameter estimated
parameter estimated
2025-08-21 07:54:34 INFO: parameter retrieved
parameter retrieved
2025-08-21 07:54:34 [info     ] Evaluate question difficulty - end rmse=2.631734994305152 split=test
2025-08-21 07:54:34 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 1 finished: 0:1:3

 ********** Run: 2/3 **********
2025-08-21 07:54:56 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 07:54:56 [info     ] Reading train split questions  num_questions=92
2025-08-21 07:54:56 [info     ] Reading validation split questions num_questions=23
2025-08-21 07:54:56 [info     ] Reading test split questions   num_questions=39
2025-08-21 07:54:58 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 07:54:58 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 07:55:02 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 07:55:02 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 07:55:02 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 07:55:03 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 07:55:06 [info     ] Setting seed                   value=44
2025-08-21 07:55:06 [info     ] Building structured outputter  name=teacher_kt
2025-08-21 07:55:06 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_marshmellow_level_nocontext
2025-08-21 07:55:06 [info     ] Building model                 name=qwen3:0.6b provider=ollama rate_limit=None temp=0.0
2025-08-21 07:55:06 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:00<03:09,  1.02it/s]  2%|▏         | 3/195 [00:01<01:16,  2.50it/s]  2%|▏         | 4/195 [00:01<00:59,  3.22it/s]  3%|▎         | 5/195 [00:01<01:01,  3.10it/s]  3%|▎         | 6/195 [00:02<01:00,  3.12it/s]  4%|▎         | 7/195 [00:02<00:52,  3.59it/s]  4%|▍         | 8/195 [00:02<00:54,  3.43it/s]  5%|▍         | 9/195 [00:02<00:45,  4.06it/s]  5%|▌         | 10/195 [00:03<00:51,  3.59it/s]  6%|▌         | 11/195 [00:03<00:48,  3.83it/s]  6%|▌         | 12/195 [00:03<00:46,  3.90it/s]  7%|▋         | 13/195 [00:03<00:43,  4.22it/s]  7%|▋         | 14/195 [00:04<00:46,  3.93it/s]  8%|▊         | 15/195 [00:04<00:40,  4.49it/s]  8%|▊         | 16/195 [00:04<00:46,  3.82it/s]  9%|▊         | 17/195 [00:04<00:42,  4.15it/s]  9%|▉         | 18/195 [00:05<00:40,  4.40it/s] 10%|▉         | 19/195 [00:05<00:37,  4.67it/s] 10%|█         | 20/195 [00:05<00:41,  4.20it/s] 11%|█         | 21/195 [00:05<00:38,  4.56it/s] 11%|█▏        | 22/195 [00:05<00:43,  4.00it/s] 12%|█▏        | 23/195 [00:06<00:36,  4.69it/s] 12%|█▏        | 24/195 [00:06<00:40,  4.27it/s] 13%|█▎        | 25/195 [00:06<00:37,  4.58it/s] 13%|█▎        | 26/195 [00:06<00:39,  4.23it/s] 14%|█▍        | 27/195 [00:07<00:35,  4.75it/s] 14%|█▍        | 28/195 [00:07<00:38,  4.36it/s] 15%|█▍        | 29/195 [00:07<00:33,  4.89it/s] 15%|█▌        | 30/195 [00:07<00:39,  4.23it/s] 16%|█▌        | 31/195 [00:07<00:34,  4.70it/s] 16%|█▋        | 32/195 [00:08<00:37,  4.31it/s] 17%|█▋        | 33/195 [00:08<00:33,  4.88it/s] 17%|█▋        | 34/195 [00:08<00:35,  4.58it/s] 18%|█▊        | 35/195 [00:08<00:33,  4.80it/s] 18%|█▊        | 36/195 [00:09<00:36,  4.33it/s] 19%|█▉        | 37/195 [00:09<00:32,  4.83it/s] 19%|█▉        | 38/195 [00:09<00:35,  4.39it/s] 20%|██        | 39/195 [00:09<00:31,  4.88it/s] 21%|██        | 40/195 [00:09<00:35,  4.41it/s] 21%|██        | 41/195 [00:10<00:31,  4.90it/s] 22%|██▏       | 42/195 [00:10<00:35,  4.35it/s] 22%|██▏       | 43/195 [00:10<00:31,  4.80it/s] 23%|██▎       | 44/195 [00:10<00:38,  3.96it/s] 23%|██▎       | 45/195 [00:11<00:33,  4.48it/s] 24%|██▎       | 46/195 [00:11<00:38,  3.90it/s] 24%|██▍       | 47/195 [00:11<00:33,  4.42it/s] 25%|██▍       | 48/195 [00:11<00:37,  3.94it/s] 25%|██▌       | 49/195 [00:11<00:33,  4.35it/s] 26%|██▌       | 50/195 [00:12<00:38,  3.76it/s] 26%|██▌       | 51/195 [00:12<00:34,  4.19it/s] 27%|██▋       | 52/195 [00:12<00:39,  3.67it/s] 27%|██▋       | 53/195 [00:13<00:34,  4.15it/s] 28%|██▊       | 54/195 [00:13<00:36,  3.90it/s] 28%|██▊       | 55/195 [00:13<00:32,  4.36it/s] 29%|██▊       | 56/195 [00:13<00:34,  4.03it/s] 29%|██▉       | 57/195 [00:13<00:30,  4.47it/s] 30%|██▉       | 58/195 [00:14<00:35,  3.81it/s] 30%|███       | 59/195 [00:14<00:31,  4.26it/s] 31%|███       | 60/195 [00:14<00:34,  3.93it/s] 31%|███▏      | 61/195 [00:14<00:30,  4.45it/s] 32%|███▏      | 62/195 [00:15<00:32,  4.14it/s] 32%|███▏      | 63/195 [00:15<00:31,  4.24it/s] 33%|███▎      | 64/195 [00:15<00:35,  3.64it/s] 33%|███▎      | 65/195 [00:15<00:31,  4.17it/s] 34%|███▍      | 66/195 [00:16<00:32,  3.92it/s] 34%|███▍      | 67/195 [00:16<00:28,  4.47it/s] 35%|███▍      | 68/195 [00:16<00:32,  3.91it/s] 35%|███▌      | 69/195 [00:16<00:28,  4.44it/s] 36%|███▌      | 70/195 [00:17<00:32,  3.90it/s] 36%|███▋      | 71/195 [00:17<00:27,  4.58it/s] 37%|███▋      | 72/195 [00:17<00:28,  4.37it/s] 37%|███▋      | 73/195 [00:17<00:24,  4.96it/s] 38%|███▊      | 74/195 [00:17<00:26,  4.60it/s] 38%|███▊      | 75/195 [00:18<00:23,  5.19it/s] 39%|███▉      | 76/195 [00:18<00:26,  4.46it/s] 39%|███▉      | 77/195 [00:18<00:23,  5.05it/s] 40%|████      | 78/195 [00:18<00:26,  4.44it/s] 41%|████      | 79/195 [00:19<00:25,  4.59it/s] 41%|████      | 80/195 [00:19<00:29,  3.85it/s] 42%|████▏     | 81/195 [00:19<00:25,  4.53it/s] 42%|████▏     | 82/195 [00:19<00:28,  3.97it/s] 43%|████▎     | 83/195 [00:20<00:24,  4.54it/s] 43%|████▎     | 84/195 [00:20<00:27,  3.99it/s] 44%|████▎     | 85/195 [00:20<00:24,  4.54it/s] 44%|████▍     | 86/195 [00:20<00:26,  4.10it/s] 45%|████▍     | 87/195 [00:20<00:24,  4.43it/s] 45%|████▌     | 88/195 [00:21<00:27,  3.93it/s] 46%|████▌     | 89/195 [00:21<00:23,  4.45it/s] 46%|████▌     | 90/195 [00:21<00:25,  4.14it/s] 47%|████▋     | 91/195 [00:21<00:24,  4.26it/s] 47%|████▋     | 92/195 [00:22<00:27,  3.80it/s] 48%|████▊     | 93/195 [00:22<00:25,  4.00it/s] 48%|████▊     | 94/195 [00:22<00:28,  3.58it/s] 49%|████▊     | 95/195 [00:22<00:23,  4.18it/s] 49%|████▉     | 96/195 [00:23<00:24,  4.02it/s] 50%|████▉     | 97/195 [00:23<00:21,  4.59it/s] 50%|█████     | 98/195 [00:23<00:23,  4.04it/s] 51%|█████     | 99/195 [00:23<00:20,  4.59it/s] 51%|█████▏    | 100/195 [00:24<00:22,  4.16it/s] 52%|█████▏    | 101/195 [00:24<00:21,  4.32it/s] 52%|█████▏    | 102/195 [00:24<00:24,  3.79it/s] 53%|█████▎    | 103/195 [00:24<00:22,  4.04it/s] 53%|█████▎    | 104/195 [00:25<00:23,  3.82it/s] 54%|█████▍    | 105/195 [00:25<00:22,  3.98it/s] 54%|█████▍    | 106/195 [00:25<00:25,  3.50it/s] 55%|█████▍    | 107/195 [00:26<00:22,  3.86it/s] 55%|█████▌    | 108/195 [00:26<00:25,  3.46it/s] 56%|█████▌    | 109/195 [00:26<00:21,  3.94it/s] 56%|█████▋    | 110/195 [00:26<00:22,  3.76it/s] 57%|█████▋    | 111/195 [00:27<00:20,  4.18it/s] 57%|█████▋    | 112/195 [00:27<00:21,  3.84it/s] 58%|█████▊    | 113/195 [00:27<00:19,  4.14it/s] 58%|█████▊    | 114/195 [00:27<00:20,  3.89it/s] 59%|█████▉    | 115/195 [00:27<00:18,  4.22it/s] 59%|█████▉    | 116/195 [00:28<00:20,  3.93it/s] 60%|██████    | 117/195 [00:28<00:17,  4.51it/s] 61%|██████    | 118/195 [00:28<00:18,  4.11it/s] 61%|██████    | 119/195 [00:28<00:16,  4.52it/s] 62%|██████▏   | 120/195 [00:29<00:17,  4.31it/s] 62%|██████▏   | 121/195 [00:29<00:15,  4.77it/s] 63%|██████▎   | 122/195 [00:29<00:16,  4.32it/s] 63%|██████▎   | 123/195 [00:29<00:14,  4.80it/s] 64%|██████▎   | 124/195 [00:30<00:16,  4.40it/s] 64%|██████▍   | 125/195 [00:30<00:13,  5.02it/s] 65%|██████▍   | 126/195 [00:30<00:14,  4.68it/s] 65%|██████▌   | 127/195 [00:30<00:14,  4.82it/s] 66%|██████▌   | 128/195 [00:30<00:15,  4.36it/s] 66%|██████▌   | 129/195 [00:31<00:13,  4.93it/s] 67%|██████▋   | 130/195 [00:31<00:15,  4.21it/s] 67%|██████▋   | 131/195 [00:31<00:13,  4.72it/s] 68%|██████▊   | 132/195 [00:31<00:14,  4.30it/s] 68%|██████▊   | 133/195 [00:31<00:12,  4.79it/s] 69%|██████▊   | 134/195 [00:32<00:15,  3.82it/s] 69%|██████▉   | 135/195 [00:32<00:13,  4.32it/s] 70%|██████▉   | 136/195 [00:32<00:15,  3.86it/s] 70%|███████   | 137/195 [00:32<00:13,  4.38it/s] 71%|███████   | 138/195 [00:33<00:15,  3.77it/s] 71%|███████▏  | 139/195 [00:33<00:12,  4.35it/s] 72%|███████▏  | 140/195 [00:33<00:14,  3.92it/s] 72%|███████▏  | 141/195 [00:33<00:12,  4.42it/s] 73%|███████▎  | 142/195 [00:34<00:13,  4.01it/s] 73%|███████▎  | 143/195 [00:34<00:11,  4.48it/s] 74%|███████▍  | 144/195 [00:34<00:13,  3.83it/s] 74%|███████▍  | 145/195 [00:34<00:11,  4.31it/s] 75%|███████▍  | 146/195 [00:35<00:12,  3.96it/s] 75%|███████▌  | 147/195 [00:35<00:10,  4.42it/s] 76%|███████▌  | 148/195 [00:35<00:11,  4.10it/s] 76%|███████▋  | 149/195 [00:35<00:09,  4.75it/s] 77%|███████▋  | 150/195 [00:36<00:10,  4.48it/s] 77%|███████▋  | 151/195 [00:36<00:08,  4.99it/s] 78%|███████▊  | 152/195 [00:36<00:10,  4.24it/s] 78%|███████▊  | 153/195 [00:36<00:08,  4.72it/s] 79%|███████▉  | 154/195 [00:36<00:09,  4.42it/s] 79%|███████▉  | 155/195 [00:37<00:08,  4.96it/s] 80%|████████  | 156/195 [00:37<00:08,  4.50it/s] 81%|████████  | 157/195 [00:37<00:07,  4.98it/s] 81%|████████  | 158/195 [00:37<00:09,  4.06it/s] 82%|████████▏ | 159/195 [00:38<00:08,  4.45it/s] 82%|████████▏ | 160/195 [00:38<00:08,  4.17it/s] 83%|████████▎ | 161/195 [00:38<00:07,  4.53it/s] 83%|████████▎ | 162/195 [00:38<00:08,  3.98it/s] 84%|████████▎ | 163/195 [00:38<00:06,  4.62it/s] 84%|████████▍ | 164/195 [00:39<00:07,  4.04it/s] 85%|████████▍ | 165/195 [00:39<00:06,  4.45it/s] 85%|████████▌ | 166/195 [00:39<00:07,  3.91it/s] 86%|████████▌ | 167/195 [00:39<00:06,  4.44it/s] 86%|████████▌ | 168/195 [00:40<00:06,  3.97it/s] 87%|████████▋ | 169/195 [00:40<00:05,  4.47it/s] 87%|████████▋ | 170/195 [00:40<00:06,  3.99it/s] 88%|████████▊ | 171/195 [00:40<00:05,  4.66it/s] 88%|████████▊ | 172/195 [00:41<00:05,  4.23it/s] 89%|████████▊ | 173/195 [00:41<00:04,  4.71it/s] 89%|████████▉ | 174/195 [00:41<00:04,  4.41it/s] 90%|████████▉ | 175/195 [00:41<00:03,  5.04it/s] 90%|█████████ | 176/195 [00:41<00:04,  4.64it/s] 91%|█████████ | 177/195 [00:42<00:03,  5.18it/s] 91%|█████████▏| 178/195 [00:42<00:03,  4.80it/s] 92%|█████████▏| 179/195 [00:42<00:03,  5.06it/s] 92%|█████████▏| 180/195 [00:42<00:03,  4.76it/s] 93%|█████████▎| 181/195 [00:42<00:02,  5.32it/s] 93%|█████████▎| 182/195 [00:43<00:02,  4.84it/s] 94%|█████████▍| 183/195 [00:43<00:02,  5.39it/s] 94%|█████████▍| 184/195 [00:43<00:02,  4.89it/s] 95%|█████████▍| 185/195 [00:43<00:01,  5.43it/s] 95%|█████████▌| 186/195 [00:43<00:01,  4.90it/s] 96%|█████████▌| 187/195 [00:43<00:01,  5.42it/s] 96%|█████████▋| 188/195 [00:44<00:01,  4.82it/s] 97%|█████████▋| 189/195 [00:44<00:01,  5.32it/s] 97%|█████████▋| 190/195 [00:44<00:01,  4.89it/s] 98%|█████████▊| 191/195 [00:44<00:00,  4.85it/s] 98%|█████████▊| 192/195 [00:45<00:00,  4.30it/s] 99%|█████████▉| 193/195 [00:45<00:00,  4.92it/s] 99%|█████████▉| 194/195 [00:45<00:00,  4.62it/s]100%|██████████| 195/195 [00:45<00:00,  5.50it/s]100%|██████████| 195/195 [00:47<00:00,  4.09it/s]
2025-08-21 07:55:54 [info     ] Validating outputs
2025-08-21 07:55:54 [info     ] Predict - end                  time=0:0:47
2025-08-21 07:55:54 [info     ] Evaluate - start               split=test
2025-08-21 07:55:54 [info     ] Evaluate - end                 correctness_llm=0.35 monotonicity=-1.02
2025-08-21 07:55:54 [info     ] Evaluate question difficulty - start split=test
2025-08-21 07:55:54 [info     ] Augmenting questions for IRT estimation num_questions=29
2025-08-21 07:55:54 INFO: start loading data
start loading data
start loading data
2025-08-21 07:55:54 INFO: data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 999.15it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3603.91it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 531.85it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5979.66it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 913.85it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3627.81it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 541.76it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5839.33it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1031.56it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3698.26it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 578.07it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6031.25it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1021.83it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3584.64it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 591.45it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5575.41it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 961.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3442.44it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 590.15it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5777.28it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 940.22it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3697.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 563.20it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5682.24it/s]
2025-08-21 07:55:58 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-08-21 07:55:58 INFO: parameter estimated
parameter estimated
parameter estimated
2025-08-21 07:55:58 INFO: parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 07:55:58 [info     ] Evaluate question difficulty - end rmse=2.6232552661076434 split=test
2025-08-21 07:55:58 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 2 finished: 0:1:2

 ********** Run: 3/3 **********
2025-08-21 07:56:20 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 07:56:20 [info     ] Reading train split questions  num_questions=92
2025-08-21 07:56:20 [info     ] Reading validation split questions num_questions=23
2025-08-21 07:56:20 [info     ] Reading test split questions   num_questions=39
2025-08-21 07:56:22 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 07:56:22 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 07:56:26 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 07:56:26 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 07:56:26 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 07:56:27 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 07:56:30 [info     ] Setting seed                   value=45
2025-08-21 07:56:30 [info     ] Building structured outputter  name=teacher_kt
2025-08-21 07:56:30 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_marshmellow_level_nocontext
2025-08-21 07:56:30 [info     ] Building model                 name=qwen3:0.6b provider=ollama rate_limit=None temp=0.0
2025-08-21 07:56:30 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<03:19,  1.03s/it]  2%|▏         | 3/195 [00:01<01:24,  2.26it/s]  2%|▏         | 4/195 [00:01<01:09,  2.74it/s]  3%|▎         | 5/195 [00:02<01:10,  2.71it/s]  4%|▎         | 7/195 [00:02<00:51,  3.68it/s]  4%|▍         | 8/195 [00:02<00:45,  4.11it/s]  5%|▍         | 9/195 [00:02<00:42,  4.41it/s]  5%|▌         | 10/195 [00:02<00:41,  4.48it/s]  6%|▌         | 11/195 [00:03<00:37,  4.88it/s]  6%|▌         | 12/195 [00:03<00:42,  4.29it/s]  7%|▋         | 13/195 [00:03<00:38,  4.73it/s]  7%|▋         | 14/195 [00:04<00:48,  3.72it/s]  8%|▊         | 15/195 [00:04<00:44,  4.01it/s]  8%|▊         | 16/195 [00:04<00:49,  3.60it/s]  9%|▊         | 17/195 [00:04<00:48,  3.66it/s]  9%|▉         | 18/195 [00:05<00:43,  4.03it/s] 10%|▉         | 19/195 [00:05<00:42,  4.13it/s] 10%|█         | 20/195 [00:05<00:41,  4.18it/s] 11%|█         | 21/195 [00:05<00:37,  4.61it/s] 11%|█▏        | 22/195 [00:05<00:43,  3.98it/s] 12%|█▏        | 23/195 [00:06<00:36,  4.69it/s] 12%|█▏        | 24/195 [00:06<00:41,  4.08it/s] 13%|█▎        | 25/195 [00:06<00:38,  4.45it/s] 13%|█▎        | 26/195 [00:06<00:40,  4.20it/s] 14%|█▍        | 27/195 [00:07<00:34,  4.80it/s] 14%|█▍        | 28/195 [00:07<00:37,  4.46it/s] 15%|█▍        | 29/195 [00:07<00:32,  5.06it/s] 15%|█▌        | 30/195 [00:07<00:35,  4.69it/s] 16%|█▌        | 31/195 [00:07<00:31,  5.26it/s] 16%|█▋        | 32/195 [00:08<00:34,  4.72it/s] 17%|█▋        | 33/195 [00:08<00:31,  5.12it/s] 17%|█▋        | 34/195 [00:08<00:36,  4.41it/s] 18%|█▊        | 35/195 [00:08<00:31,  5.02it/s] 18%|█▊        | 36/195 [00:08<00:34,  4.58it/s] 19%|█▉        | 37/195 [00:09<00:31,  5.08it/s] 19%|█▉        | 38/195 [00:09<00:33,  4.70it/s] 20%|██        | 39/195 [00:09<00:29,  5.26it/s] 21%|██        | 40/195 [00:09<00:32,  4.78it/s] 21%|██        | 41/195 [00:09<00:29,  5.28it/s] 22%|██▏       | 42/195 [00:10<00:32,  4.77it/s] 22%|██▏       | 43/195 [00:10<00:28,  5.31it/s] 23%|██▎       | 44/195 [00:10<00:30,  4.88it/s] 23%|██▎       | 45/195 [00:10<00:27,  5.48it/s] 24%|██▎       | 46/195 [00:10<00:30,  4.94it/s] 24%|██▍       | 47/195 [00:10<00:26,  5.49it/s] 25%|██▍       | 48/195 [00:11<00:29,  4.98it/s] 25%|██▌       | 49/195 [00:11<00:26,  5.49it/s] 26%|██▌       | 50/195 [00:11<00:30,  4.75it/s] 26%|██▌       | 51/195 [00:11<00:27,  5.20it/s] 27%|██▋       | 52/195 [00:12<00:30,  4.76it/s] 27%|██▋       | 53/195 [00:12<00:27,  5.18it/s] 28%|██▊       | 54/195 [00:12<00:32,  4.28it/s] 28%|██▊       | 55/195 [00:12<00:29,  4.71it/s] 29%|██▊       | 56/195 [00:12<00:31,  4.36it/s] 29%|██▉       | 57/195 [00:13<00:28,  4.89it/s] 30%|██▉       | 58/195 [00:13<00:31,  4.29it/s] 30%|███       | 59/195 [00:13<00:30,  4.48it/s] 31%|███       | 60/195 [00:13<00:34,  3.95it/s] 31%|███▏      | 61/195 [00:14<00:30,  4.45it/s] 32%|███▏      | 62/195 [00:14<00:32,  4.05it/s] 32%|███▏      | 63/195 [00:14<00:29,  4.54it/s] 33%|███▎      | 64/195 [00:14<00:32,  4.08it/s] 33%|███▎      | 65/195 [00:15<00:28,  4.57it/s] 34%|███▍      | 66/195 [00:15<00:31,  4.12it/s] 34%|███▍      | 67/195 [00:15<00:27,  4.61it/s] 35%|███▍      | 68/195 [00:15<00:30,  4.17it/s] 35%|███▌      | 69/195 [00:15<00:26,  4.84it/s] 36%|███▌      | 70/195 [00:16<00:31,  3.98it/s] 36%|███▋      | 71/195 [00:16<00:26,  4.70it/s] 37%|███▋      | 72/195 [00:16<00:31,  3.86it/s] 37%|███▋      | 73/195 [00:16<00:29,  4.20it/s] 38%|███▊      | 74/195 [00:17<00:30,  3.92it/s] 38%|███▊      | 75/195 [00:17<00:26,  4.45it/s] 39%|███▉      | 76/195 [00:17<00:30,  3.94it/s] 39%|███▉      | 77/195 [00:17<00:26,  4.47it/s] 40%|████      | 78/195 [00:18<00:29,  3.93it/s] 41%|████      | 79/195 [00:18<00:27,  4.25it/s] 41%|████      | 80/195 [00:18<00:30,  3.78it/s] 42%|████▏     | 81/195 [00:18<00:25,  4.50it/s] 42%|████▏     | 82/195 [00:19<00:27,  4.06it/s] 43%|████▎     | 83/195 [00:19<00:23,  4.76it/s] 43%|████▎     | 84/195 [00:19<00:25,  4.31it/s] 44%|████▎     | 85/195 [00:19<00:22,  4.85it/s] 44%|████▍     | 86/195 [00:20<00:26,  4.10it/s] 45%|████▍     | 87/195 [00:20<00:23,  4.65it/s] 45%|████▌     | 88/195 [00:20<00:24,  4.28it/s] 46%|████▌     | 89/195 [00:20<00:22,  4.77it/s] 46%|████▌     | 90/195 [00:20<00:24,  4.34it/s] 47%|████▋     | 91/195 [00:21<00:21,  4.81it/s] 47%|████▋     | 92/195 [00:21<00:23,  4.37it/s] 48%|████▊     | 93/195 [00:21<00:21,  4.71it/s] 48%|████▊     | 94/195 [00:21<00:23,  4.37it/s] 49%|████▊     | 95/195 [00:21<00:19,  5.02it/s] 49%|████▉     | 96/195 [00:22<00:20,  4.77it/s] 50%|████▉     | 97/195 [00:22<00:20,  4.77it/s] 50%|█████     | 98/195 [00:22<00:21,  4.57it/s] 51%|█████     | 99/195 [00:22<00:18,  5.09it/s] 51%|█████▏    | 100/195 [00:22<00:20,  4.69it/s] 52%|█████▏    | 101/195 [00:23<00:19,  4.91it/s] 52%|█████▏    | 102/195 [00:23<00:22,  4.22it/s] 53%|█████▎    | 103/195 [00:23<00:20,  4.42it/s] 53%|█████▎    | 104/195 [00:23<00:22,  4.05it/s] 54%|█████▍    | 105/195 [00:24<00:22,  4.03it/s] 54%|█████▍    | 106/195 [00:24<00:23,  3.81it/s] 55%|█████▍    | 107/195 [00:24<00:21,  4.12it/s] 55%|█████▌    | 108/195 [00:25<00:23,  3.66it/s] 56%|█████▌    | 109/195 [00:25<00:20,  4.14it/s] 56%|█████▋    | 110/195 [00:25<00:22,  3.80it/s] 57%|█████▋    | 111/195 [00:25<00:20,  4.06it/s] 57%|█████▋    | 112/195 [00:26<00:21,  3.83it/s] 58%|█████▊    | 113/195 [00:26<00:19,  4.29it/s] 58%|█████▊    | 114/195 [00:26<00:20,  3.94it/s] 59%|█████▉    | 115/195 [00:26<00:18,  4.38it/s] 59%|█████▉    | 116/195 [00:26<00:19,  4.00it/s] 60%|██████    | 117/195 [00:27<00:17,  4.53it/s] 61%|██████    | 118/195 [00:27<00:19,  3.96it/s] 61%|██████    | 119/195 [00:27<00:17,  4.33it/s] 62%|██████▏   | 120/195 [00:27<00:18,  3.95it/s] 62%|██████▏   | 121/195 [00:28<00:16,  4.45it/s] 63%|██████▎   | 122/195 [00:28<00:19,  3.79it/s] 63%|██████▎   | 123/195 [00:28<00:17,  4.23it/s] 64%|██████▎   | 124/195 [00:28<00:18,  3.86it/s] 64%|██████▍   | 125/195 [00:29<00:15,  4.43it/s] 65%|██████▍   | 126/195 [00:29<00:16,  4.15it/s] 65%|██████▌   | 127/195 [00:29<00:15,  4.50it/s] 66%|██████▌   | 128/195 [00:29<00:16,  3.96it/s] 66%|██████▌   | 129/195 [00:29<00:14,  4.48it/s] 67%|██████▋   | 130/195 [00:30<00:15,  4.16it/s] 67%|██████▋   | 131/195 [00:30<00:14,  4.40it/s] 68%|██████▊   | 132/195 [00:30<00:15,  4.07it/s] 68%|██████▊   | 133/195 [00:30<00:13,  4.55it/s] 69%|██████▊   | 134/195 [00:31<00:15,  3.96it/s] 69%|██████▉   | 135/195 [00:31<00:13,  4.56it/s] 70%|██████▉   | 136/195 [00:31<00:13,  4.41it/s] 70%|███████   | 137/195 [00:31<00:11,  5.01it/s] 71%|███████   | 138/195 [00:32<00:12,  4.73it/s] 71%|███████▏  | 139/195 [00:32<00:11,  4.95it/s] 72%|███████▏  | 140/195 [00:32<00:12,  4.50it/s] 72%|███████▏  | 141/195 [00:32<00:10,  4.99it/s] 73%|███████▎  | 142/195 [00:32<00:11,  4.48it/s] 73%|███████▎  | 143/195 [00:33<00:10,  4.88it/s] 74%|███████▍  | 144/195 [00:33<00:12,  4.17it/s] 74%|███████▍  | 145/195 [00:33<00:10,  4.67it/s] 75%|███████▍  | 146/195 [00:33<00:11,  4.24it/s] 75%|███████▌  | 147/195 [00:33<00:10,  4.56it/s] 76%|███████▌  | 148/195 [00:34<00:11,  3.95it/s] 76%|███████▋  | 149/195 [00:34<00:10,  4.48it/s] 77%|███████▋  | 150/195 [00:34<00:10,  4.13it/s] 77%|███████▋  | 151/195 [00:34<00:09,  4.88it/s] 78%|███████▊  | 152/195 [00:35<00:10,  4.18it/s] 78%|███████▊  | 153/195 [00:35<00:09,  4.43it/s] 79%|███████▉  | 154/195 [00:35<00:09,  4.13it/s] 79%|███████▉  | 155/195 [00:35<00:08,  4.71it/s] 80%|████████  | 156/195 [00:36<00:08,  4.33it/s] 81%|████████  | 157/195 [00:36<00:07,  4.83it/s] 81%|████████  | 158/195 [00:36<00:08,  4.40it/s] 82%|████████▏ | 159/195 [00:36<00:07,  5.00it/s] 82%|████████▏ | 160/195 [00:36<00:07,  4.72it/s] 83%|████████▎ | 161/195 [00:37<00:06,  5.33it/s] 83%|████████▎ | 162/195 [00:37<00:07,  4.33it/s] 84%|████████▎ | 163/195 [00:37<00:06,  4.81it/s] 84%|████████▍ | 164/195 [00:37<00:07,  4.15it/s] 85%|████████▍ | 165/195 [00:37<00:06,  4.66it/s] 85%|████████▌ | 166/195 [00:38<00:06,  4.29it/s] 86%|████████▌ | 167/195 [00:38<00:06,  4.46it/s] 86%|████████▌ | 168/195 [00:38<00:06,  4.31it/s] 87%|████████▋ | 169/195 [00:38<00:05,  4.61it/s] 87%|████████▋ | 170/195 [00:39<00:05,  4.26it/s] 88%|████████▊ | 171/195 [00:39<00:05,  4.77it/s] 88%|████████▊ | 172/195 [00:39<00:05,  4.07it/s] 89%|████████▊ | 173/195 [00:39<00:04,  4.62it/s] 89%|████████▉ | 174/195 [00:40<00:04,  4.25it/s] 90%|████████▉ | 175/195 [00:40<00:04,  4.62it/s] 90%|█████████ | 176/195 [00:40<00:04,  4.16it/s] 91%|█████████ | 177/195 [00:40<00:03,  4.70it/s] 91%|█████████▏| 178/195 [00:40<00:03,  4.31it/s] 92%|█████████▏| 179/195 [00:41<00:03,  4.70it/s] 92%|█████████▏| 180/195 [00:41<00:03,  4.05it/s] 93%|█████████▎| 181/195 [00:41<00:03,  4.53it/s] 93%|█████████▎| 182/195 [00:41<00:03,  4.00it/s] 94%|█████████▍| 183/195 [00:42<00:02,  4.56it/s] 94%|█████████▍| 184/195 [00:42<00:02,  4.21it/s] 95%|█████████▍| 185/195 [00:42<00:02,  4.45it/s] 95%|█████████▌| 186/195 [00:42<00:02,  4.10it/s] 96%|█████████▌| 187/195 [00:43<00:01,  4.60it/s] 96%|█████████▋| 188/195 [00:43<00:01,  4.27it/s] 97%|█████████▋| 189/195 [00:43<00:01,  4.76it/s] 97%|█████████▋| 190/195 [00:43<00:01,  4.22it/s] 98%|█████████▊| 191/195 [00:43<00:00,  4.66it/s] 98%|█████████▊| 192/195 [00:44<00:00,  4.15it/s] 99%|█████████▉| 193/195 [00:44<00:00,  4.61it/s] 99%|█████████▉| 194/195 [00:44<00:00,  3.95it/s]100%|██████████| 195/195 [00:46<00:00,  4.16it/s]
2025-08-21 07:57:17 [info     ] Validating outputs
2025-08-21 07:57:17 [info     ] Predict - end                  time=0:0:46
2025-08-21 07:57:17 [info     ] Evaluate - start               split=test
2025-08-21 07:57:17 [info     ] Evaluate - end                 correctness_llm=0.34 monotonicity=-1.19
2025-08-21 07:57:17 [info     ] Evaluate question difficulty - start split=test
2025-08-21 07:57:17 [info     ] Augmenting questions for IRT estimation num_questions=29
2025-08-21 07:57:17 INFO: start loading data
start loading data
start loading data
start loading data
2025-08-21 07:57:17 INFO: data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1094.26it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3655.53it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 493.38it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5235.40it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 989.09it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3629.90it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 486.98it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6348.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 959.14it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3684.10it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 580.06it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6085.00it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 935.57it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3482.08it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 607.64it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5946.96it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 888.46it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3787.84it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 607.30it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5820.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 927.12it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3519.70it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 619.44it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5713.20it/s]
2025-08-21 07:57:21 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-08-21 07:57:21 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 07:57:21 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 07:57:21 [info     ] Evaluate question difficulty - end rmse=2.4065626936708724 split=test
2025-08-21 07:57:21 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 3 finished: 0:1:1

 ========== Config: qwen3:1.7b~T_0.0~SO_student_kt~L_5~SP_student_chocolate_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_miscon_studentlevel_random0 ==========
Config 2/8

 ********** Run: 1/3 **********
2025-08-21 07:57:42 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 07:57:42 [info     ] Reading train split questions  num_questions=92
2025-08-21 07:57:42 [info     ] Reading validation split questions num_questions=23
2025-08-21 07:57:42 [info     ] Reading test split questions   num_questions=39
2025-08-21 07:57:44 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 07:57:44 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 07:57:49 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 07:57:49 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 07:57:49 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 07:57:50 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 07:57:53 [info     ] Setting seed                   value=43
2025-08-21 07:57:53 [info     ] Building structured outputter  name=student_kt
2025-08-21 07:57:53 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_chocolate_level_nocontext
2025-08-21 07:57:53 [info     ] Building model                 name=qwen3:1.7b provider=ollama rate_limit=None temp=0.0
2025-08-21 07:57:53 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:02<08:16,  2.56s/it]  1%|          | 2/195 [00:02<03:59,  1.24s/it]  2%|▏         | 4/195 [00:03<01:52,  1.69it/s]  3%|▎         | 6/195 [00:03<01:22,  2.30it/s]  4%|▎         | 7/195 [00:04<01:14,  2.52it/s]  4%|▍         | 8/195 [00:04<01:01,  3.04it/s]  5%|▍         | 9/195 [00:04<01:00,  3.07it/s]  6%|▌         | 11/195 [00:05<01:00,  3.04it/s]  7%|▋         | 13/195 [00:05<00:51,  3.50it/s]  8%|▊         | 15/195 [00:06<00:49,  3.60it/s]  9%|▊         | 17/195 [00:06<00:49,  3.62it/s]  9%|▉         | 18/195 [00:06<00:48,  3.64it/s] 10%|▉         | 19/195 [00:07<00:43,  4.01it/s] 10%|█         | 20/195 [00:07<00:46,  3.75it/s] 11%|█▏        | 22/195 [00:08<00:47,  3.63it/s] 12%|█▏        | 23/195 [00:08<00:46,  3.70it/s] 12%|█▏        | 24/195 [00:08<00:43,  3.91it/s] 13%|█▎        | 25/195 [00:08<00:42,  4.02it/s] 14%|█▍        | 27/195 [00:09<00:36,  4.55it/s] 15%|█▍        | 29/195 [00:09<00:37,  4.44it/s] 15%|█▌        | 30/195 [00:09<00:32,  5.01it/s] 16%|█▌        | 31/195 [00:10<00:41,  3.93it/s] 16%|█▋        | 32/195 [00:10<00:37,  4.32it/s] 17%|█▋        | 33/195 [00:10<00:41,  3.87it/s] 18%|█▊        | 35/195 [00:11<00:39,  4.02it/s] 19%|█▉        | 37/195 [00:11<00:38,  4.12it/s] 20%|██        | 39/195 [00:11<00:36,  4.26it/s] 21%|██        | 40/195 [00:12<00:33,  4.61it/s] 21%|██        | 41/195 [00:12<00:35,  4.33it/s] 22%|██▏       | 42/195 [00:12<00:30,  4.96it/s] 22%|██▏       | 43/195 [00:12<00:31,  4.85it/s] 23%|██▎       | 45/195 [00:13<00:31,  4.82it/s] 24%|██▍       | 47/195 [00:13<00:30,  4.85it/s] 25%|██▌       | 49/195 [00:13<00:30,  4.83it/s] 26%|██▌       | 50/195 [00:14<00:27,  5.26it/s] 26%|██▌       | 51/195 [00:14<00:30,  4.67it/s] 27%|██▋       | 53/195 [00:14<00:29,  4.88it/s] 28%|██▊       | 55/195 [00:15<00:30,  4.65it/s] 29%|██▉       | 57/195 [00:15<00:27,  5.04it/s] 30%|███       | 59/195 [00:15<00:26,  5.23it/s] 31%|███       | 60/195 [00:16<00:25,  5.31it/s] 32%|███▏      | 62/195 [00:16<00:23,  5.57it/s] 33%|███▎      | 64/195 [00:16<00:22,  5.88it/s] 34%|███▍      | 66/195 [00:17<00:22,  5.72it/s] 35%|███▍      | 68/195 [00:17<00:24,  5.22it/s] 36%|███▌      | 70/195 [00:17<00:23,  5.27it/s] 37%|███▋      | 72/195 [00:18<00:22,  5.52it/s] 38%|███▊      | 74/195 [00:18<00:20,  5.77it/s] 39%|███▉      | 76/195 [00:18<00:20,  5.92it/s] 40%|████      | 78/195 [00:19<00:19,  6.01it/s] 41%|████      | 80/195 [00:19<00:19,  6.00it/s] 42%|████▏     | 81/195 [00:19<00:19,  5.93it/s] 42%|████▏     | 82/195 [00:19<00:20,  5.65it/s] 43%|████▎     | 83/195 [00:20<00:20,  5.37it/s] 44%|████▎     | 85/195 [00:20<00:22,  4.84it/s] 45%|████▍     | 87/195 [00:20<00:20,  5.34it/s] 46%|████▌     | 89/195 [00:21<00:21,  4.92it/s] 47%|████▋     | 91/195 [00:21<00:21,  4.87it/s] 48%|████▊     | 93/195 [00:22<00:22,  4.62it/s] 49%|████▊     | 95/195 [00:22<00:21,  4.66it/s] 50%|████▉     | 97/195 [00:23<00:19,  5.14it/s] 51%|█████     | 99/195 [00:23<00:20,  4.64it/s] 52%|█████▏    | 101/195 [00:24<00:22,  4.27it/s] 52%|█████▏    | 102/195 [00:24<00:20,  4.46it/s] 53%|█████▎    | 103/195 [00:24<00:23,  3.94it/s] 53%|█████▎    | 104/195 [00:24<00:21,  4.14it/s] 54%|█████▍    | 105/195 [00:25<00:24,  3.61it/s] 54%|█████▍    | 106/195 [00:25<00:23,  3.83it/s] 55%|█████▍    | 107/195 [00:25<00:23,  3.69it/s] 55%|█████▌    | 108/195 [00:26<00:23,  3.74it/s] 56%|█████▌    | 109/195 [00:26<00:21,  3.93it/s] 56%|█████▋    | 110/195 [00:26<00:22,  3.75it/s] 57%|█████▋    | 111/195 [00:26<00:21,  3.96it/s] 57%|█████▋    | 112/195 [00:27<00:24,  3.39it/s] 58%|█████▊    | 114/195 [00:27<00:23,  3.46it/s] 59%|█████▉    | 115/195 [00:27<00:21,  3.80it/s] 59%|█████▉    | 116/195 [00:28<00:19,  4.06it/s] 60%|██████    | 117/195 [00:28<00:20,  3.77it/s] 61%|██████    | 119/195 [00:28<00:16,  4.47it/s] 62%|██████▏   | 120/195 [00:29<00:17,  4.28it/s] 62%|██████▏   | 121/195 [00:29<00:17,  4.32it/s] 63%|██████▎   | 122/195 [00:29<00:18,  3.99it/s] 64%|██████▎   | 124/195 [00:29<00:15,  4.65it/s] 64%|██████▍   | 125/195 [00:30<00:15,  4.65it/s] 65%|██████▍   | 126/195 [00:30<00:13,  5.11it/s] 65%|██████▌   | 127/195 [00:30<00:14,  4.70it/s] 66%|██████▌   | 129/195 [00:30<00:13,  4.99it/s] 67%|██████▋   | 130/195 [00:31<00:13,  4.69it/s] 67%|██████▋   | 131/195 [00:31<00:13,  4.69it/s] 68%|██████▊   | 132/195 [00:31<00:14,  4.30it/s] 69%|██████▊   | 134/195 [00:31<00:12,  4.88it/s] 69%|██████▉   | 135/195 [00:32<00:12,  4.75it/s] 70%|███████   | 137/195 [00:32<00:11,  4.96it/s] 71%|███████▏  | 139/195 [00:32<00:11,  5.09it/s] 72%|███████▏  | 140/195 [00:33<00:11,  4.84it/s] 73%|███████▎  | 142/195 [00:33<00:10,  5.13it/s] 74%|███████▍  | 144/195 [00:33<00:09,  5.28it/s] 74%|███████▍  | 145/195 [00:34<00:10,  4.91it/s] 75%|███████▌  | 147/195 [00:34<00:09,  5.21it/s] 76%|███████▋  | 149/195 [00:34<00:08,  5.40it/s] 77%|███████▋  | 151/195 [00:35<00:08,  5.34it/s] 78%|███████▊  | 153/195 [00:35<00:07,  5.26it/s] 79%|███████▉  | 154/195 [00:35<00:08,  5.03it/s] 79%|███████▉  | 155/195 [00:36<00:08,  4.79it/s] 80%|████████  | 156/195 [00:36<00:08,  4.58it/s] 81%|████████  | 157/195 [00:36<00:07,  4.97it/s] 81%|████████  | 158/195 [00:36<00:08,  4.30it/s] 82%|████████▏ | 160/195 [00:37<00:08,  4.27it/s] 83%|████████▎ | 162/195 [00:37<00:06,  4.83it/s] 84%|████████▍ | 164/195 [00:37<00:05,  5.19it/s] 85%|████████▍ | 165/195 [00:38<00:06,  5.00it/s] 86%|████████▌ | 167/195 [00:38<00:05,  5.47it/s] 87%|████████▋ | 169/195 [00:38<00:04,  5.60it/s] 87%|████████▋ | 170/195 [00:38<00:04,  5.58it/s] 88%|████████▊ | 172/195 [00:39<00:03,  5.87it/s] 89%|████████▉ | 174/195 [00:39<00:03,  6.00it/s] 90%|████████▉ | 175/195 [00:39<00:03,  5.62it/s] 91%|█████████ | 177/195 [00:40<00:03,  5.74it/s] 92%|█████████▏| 179/195 [00:40<00:02,  5.41it/s] 93%|█████████▎| 181/195 [00:40<00:02,  5.40it/s] 94%|█████████▍| 183/195 [00:41<00:02,  5.42it/s] 95%|█████████▍| 185/195 [00:41<00:01,  5.19it/s] 96%|█████████▌| 187/195 [00:42<00:01,  5.58it/s] 96%|█████████▋| 188/195 [00:42<00:01,  5.60it/s] 97%|█████████▋| 189/195 [00:42<00:01,  5.99it/s] 97%|█████████▋| 190/195 [00:42<00:00,  5.36it/s] 98%|█████████▊| 192/195 [00:42<00:00,  5.91it/s] 99%|█████████▉| 194/195 [00:43<00:00,  6.10it/s]100%|██████████| 195/195 [00:45<00:00,  4.29it/s]
2025-08-21 07:58:38 [info     ] Validating outputs
2025-08-21 07:58:38 [info     ] Predict - end                  time=0:0:45
2025-08-21 07:58:38 [info     ] Evaluate - start               split=test
2025-08-21 07:58:38 [error    ] Error computing monotonicity score error='Cannot calculate a linear regression if all x values are identical' llm_group_correctness=array([0., 0., 0., 0., 0.]) student_group_correctness=array([0.56861655, 0.69013588, 0.78119935, 0.84989873, 0.90918367])
2025-08-21 07:58:38 [info     ] Evaluate - end                 correctness_llm=0.0 monotonicity=nan
2025-08-21 07:58:38 [info     ] Evaluate question difficulty - start split=test
2025-08-21 07:58:38 [info     ] Augmenting questions for IRT estimation num_questions=39
2025-08-21 07:58:38 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 07:58:38 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1066.52it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3702.03it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 557.58it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7408.56it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1038.45it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3558.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 567.10it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7873.46it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 959.76it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3577.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 621.40it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7712.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 968.09it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3999.17it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 621.85it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8507.72it/s]
2025-08-21 07:58:41 INFO: EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
2025-08-21 07:58:41 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 07:58:41 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 07:58:41 [info     ] Evaluate question difficulty - end rmse=2.1790369211218823 split=test
2025-08-21 07:58:41 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 1 finished: 0:0:58

 ********** Run: 2/3 **********
2025-08-21 07:59:05 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 07:59:05 [info     ] Reading train split questions  num_questions=92
2025-08-21 07:59:05 [info     ] Reading validation split questions num_questions=23
2025-08-21 07:59:05 [info     ] Reading test split questions   num_questions=39
2025-08-21 07:59:07 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 07:59:07 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 07:59:11 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 07:59:11 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 07:59:11 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 07:59:12 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 07:59:15 [info     ] Setting seed                   value=44
2025-08-21 07:59:15 [info     ] Building structured outputter  name=student_kt
2025-08-21 07:59:15 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_chocolate_level_nocontext
2025-08-21 07:59:15 [info     ] Building model                 name=qwen3:1.7b provider=ollama rate_limit=None temp=0.0
2025-08-21 07:59:15 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<03:45,  1.16s/it]  2%|▏         | 3/195 [00:02<01:59,  1.60it/s]  2%|▏         | 4/195 [00:02<01:33,  2.04it/s]  3%|▎         | 5/195 [00:02<01:29,  2.13it/s]  4%|▎         | 7/195 [00:03<01:07,  2.79it/s]  5%|▍         | 9/195 [00:03<00:55,  3.34it/s]  6%|▌         | 11/195 [00:03<00:43,  4.28it/s]  7%|▋         | 13/195 [00:04<00:39,  4.62it/s]  8%|▊         | 15/195 [00:04<00:38,  4.67it/s]  9%|▊         | 17/195 [00:05<00:39,  4.52it/s]  9%|▉         | 18/195 [00:05<00:35,  5.02it/s] 10%|▉         | 19/195 [00:05<00:33,  5.19it/s] 10%|█         | 20/195 [00:05<00:34,  5.09it/s] 11%|█         | 21/195 [00:05<00:32,  5.35it/s] 11%|█▏        | 22/195 [00:06<00:36,  4.77it/s] 12%|█▏        | 24/195 [00:06<00:35,  4.84it/s] 13%|█▎        | 26/195 [00:06<00:29,  5.71it/s] 14%|█▍        | 28/195 [00:07<00:30,  5.50it/s] 15%|█▌        | 30/195 [00:07<00:32,  5.16it/s] 16%|█▋        | 32/195 [00:07<00:32,  4.95it/s] 17%|█▋        | 33/195 [00:08<00:31,  5.17it/s] 17%|█▋        | 34/195 [00:08<00:33,  4.75it/s] 18%|█▊        | 35/195 [00:08<00:35,  4.53it/s] 18%|█▊        | 36/195 [00:08<00:33,  4.68it/s] 19%|█▉        | 37/195 [00:09<00:37,  4.24it/s] 19%|█▉        | 38/195 [00:09<00:32,  4.77it/s] 20%|██        | 39/195 [00:09<00:37,  4.16it/s] 21%|██        | 41/195 [00:09<00:33,  4.53it/s] 22%|██▏       | 43/195 [00:10<00:30,  4.98it/s] 23%|██▎       | 45/195 [00:10<00:28,  5.34it/s] 24%|██▍       | 47/195 [00:11<00:28,  5.11it/s] 25%|██▌       | 49/195 [00:11<00:29,  5.00it/s] 26%|██▌       | 51/195 [00:11<00:28,  5.00it/s] 27%|██▋       | 53/195 [00:12<00:27,  5.10it/s] 28%|██▊       | 55/195 [00:12<00:28,  4.84it/s] 29%|██▉       | 57/195 [00:13<00:27,  5.05it/s] 30%|███       | 59/195 [00:13<00:26,  5.19it/s] 31%|███       | 60/195 [00:13<00:25,  5.20it/s] 32%|███▏      | 62/195 [00:13<00:24,  5.48it/s] 33%|███▎      | 64/195 [00:14<00:22,  5.77it/s] 34%|███▍      | 66/195 [00:14<00:21,  5.86it/s] 35%|███▍      | 68/195 [00:14<00:21,  6.03it/s] 36%|███▌      | 70/195 [00:15<00:20,  6.15it/s] 37%|███▋      | 72/195 [00:15<00:19,  6.37it/s] 38%|███▊      | 74/195 [00:15<00:18,  6.55it/s] 39%|███▉      | 76/195 [00:16<00:17,  6.83it/s] 40%|████      | 78/195 [00:16<00:17,  6.86it/s] 41%|████      | 80/195 [00:16<00:18,  6.29it/s] 42%|████▏     | 81/195 [00:16<00:17,  6.38it/s] 42%|████▏     | 82/195 [00:17<00:19,  5.85it/s] 43%|████▎     | 83/195 [00:17<00:20,  5.58it/s] 44%|████▎     | 85/195 [00:17<00:21,  5.06it/s] 45%|████▍     | 87/195 [00:18<00:19,  5.44it/s] 46%|████▌     | 89/195 [00:18<00:20,  5.12it/s] 47%|████▋     | 91/195 [00:18<00:21,  4.86it/s] 48%|████▊     | 93/195 [00:19<00:22,  4.56it/s] 49%|████▊     | 95/195 [00:19<00:22,  4.51it/s] 50%|████▉     | 97/195 [00:20<00:19,  5.06it/s] 51%|█████     | 99/195 [00:20<00:19,  4.94it/s] 52%|█████▏    | 101/195 [00:21<00:20,  4.58it/s] 52%|█████▏    | 102/195 [00:21<00:19,  4.82it/s] 53%|█████▎    | 103/195 [00:21<00:21,  4.37it/s] 53%|█████▎    | 104/195 [00:21<00:19,  4.62it/s] 54%|█████▍    | 105/195 [00:22<00:21,  4.22it/s] 54%|█████▍    | 106/195 [00:22<00:21,  4.16it/s] 55%|█████▍    | 107/195 [00:22<00:22,  3.96it/s] 55%|█████▌    | 108/195 [00:22<00:21,  4.03it/s] 56%|█████▌    | 109/195 [00:23<00:20,  4.13it/s] 56%|█████▋    | 110/195 [00:23<00:22,  3.80it/s] 57%|█████▋    | 111/195 [00:23<00:20,  4.03it/s] 57%|█████▋    | 112/195 [00:23<00:23,  3.57it/s] 58%|█████▊    | 113/195 [00:24<00:19,  4.11it/s] 58%|█████▊    | 114/195 [00:24<00:22,  3.58it/s] 59%|█████▉    | 116/195 [00:25<00:21,  3.60it/s] 61%|██████    | 118/195 [00:25<00:18,  4.12it/s] 62%|██████▏   | 120/195 [00:25<00:17,  4.25it/s] 63%|██████▎   | 122/195 [00:26<00:15,  4.59it/s] 64%|██████▎   | 124/195 [00:26<00:15,  4.64it/s] 64%|██████▍   | 125/195 [00:26<00:13,  5.09it/s] 65%|██████▍   | 126/195 [00:27<00:14,  4.61it/s] 66%|██████▌   | 128/195 [00:27<00:13,  4.84it/s] 67%|██████▋   | 130/195 [00:27<00:13,  4.65it/s] 68%|██████▊   | 132/195 [00:28<00:14,  4.44it/s] 69%|██████▊   | 134/195 [00:28<00:13,  4.69it/s] 69%|██████▉   | 135/195 [00:28<00:12,  4.71it/s] 70%|███████   | 137/195 [00:29<00:11,  4.94it/s] 71%|███████▏  | 139/195 [00:29<00:10,  5.11it/s] 72%|███████▏  | 140/195 [00:29<00:11,  4.87it/s] 73%|███████▎  | 142/195 [00:30<00:10,  5.27it/s] 74%|███████▍  | 144/195 [00:30<00:09,  5.37it/s] 74%|███████▍  | 145/195 [00:30<00:09,  5.15it/s] 75%|███████▍  | 146/195 [00:30<00:08,  5.55it/s] 75%|███████▌  | 147/195 [00:31<00:09,  5.08it/s] 76%|███████▋  | 149/195 [00:31<00:08,  5.35it/s] 77%|███████▋  | 150/195 [00:31<00:07,  5.91it/s] 77%|███████▋  | 151/195 [00:31<00:08,  4.97it/s] 78%|███████▊  | 153/195 [00:32<00:08,  5.22it/s] 79%|███████▉  | 154/195 [00:32<00:08,  4.96it/s] 79%|███████▉  | 155/195 [00:32<00:08,  4.93it/s] 80%|████████  | 156/195 [00:33<00:08,  4.70it/s] 81%|████████  | 157/195 [00:33<00:07,  5.11it/s] 81%|████████  | 158/195 [00:33<00:07,  4.64it/s] 82%|████████▏ | 160/195 [00:33<00:07,  4.56it/s] 83%|████████▎ | 162/195 [00:34<00:06,  5.07it/s] 84%|████████▍ | 164/195 [00:34<00:05,  5.24it/s] 85%|████████▍ | 165/195 [00:34<00:05,  5.19it/s] 85%|████████▌ | 166/195 [00:34<00:05,  5.60it/s] 86%|████████▌ | 167/195 [00:35<00:04,  5.64it/s] 87%|████████▋ | 169/195 [00:35<00:04,  6.13it/s] 87%|████████▋ | 170/195 [00:35<00:04,  6.19it/s] 88%|████████▊ | 172/195 [00:35<00:03,  6.43it/s] 89%|████████▉ | 174/195 [00:36<00:03,  6.08it/s] 90%|████████▉ | 175/195 [00:36<00:03,  5.66it/s] 91%|█████████ | 177/195 [00:36<00:03,  5.77it/s] 92%|█████████▏| 179/195 [00:37<00:03,  5.18it/s] 93%|█████████▎| 181/195 [00:37<00:02,  5.02it/s] 94%|█████████▍| 183/195 [00:38<00:02,  4.97it/s] 95%|█████████▍| 185/195 [00:38<00:02,  4.89it/s] 96%|█████████▌| 187/195 [00:38<00:01,  5.33it/s] 96%|█████████▋| 188/195 [00:38<00:01,  5.40it/s] 97%|█████████▋| 189/195 [00:39<00:01,  5.79it/s] 97%|█████████▋| 190/195 [00:39<00:00,  5.15it/s] 98%|█████████▊| 192/195 [00:39<00:00,  5.94it/s] 99%|█████████▉| 194/195 [00:39<00:00,  5.69it/s]100%|██████████| 195/195 [00:42<00:00,  4.62it/s]
2025-08-21 07:59:57 [info     ] Validating outputs
2025-08-21 07:59:57 [info     ] Predict - end                  time=0:0:42
2025-08-21 07:59:57 [info     ] Evaluate - start               split=test
2025-08-21 07:59:57 [error    ] Error computing monotonicity score error='Cannot calculate a linear regression if all x values are identical' llm_group_correctness=array([0., 0., 0., 0., 0.]) student_group_correctness=array([0.56861655, 0.69013588, 0.78119935, 0.84989873, 0.90918367])
2025-08-21 07:59:57 [info     ] Evaluate - end                 correctness_llm=0.0 monotonicity=nan
2025-08-21 07:59:57 [info     ] Evaluate question difficulty - start split=test
2025-08-21 07:59:57 [info     ] Augmenting questions for IRT estimation num_questions=39
2025-08-21 07:59:57 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 07:59:57 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 894.55it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3649.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 498.22it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6190.20it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 646.29it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3971.88it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 562.72it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6173.28it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 908.73it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3733.38it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 637.08it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6348.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 991.96it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3387.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 619.69it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5888.51it/s]
2025-08-21 08:00:00 INFO: EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
2025-08-21 08:00:00 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:00:00 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:00:00 [info     ] Evaluate question difficulty - end rmse=2.1790369211218823 split=test
2025-08-21 08:00:00 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 2 finished: 0:0:55

 ********** Run: 3/3 **********
2025-08-21 08:00:22 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:00:22 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:00:22 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:00:22 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:00:24 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:00:24 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:00:29 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:00:29 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:00:29 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:00:30 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:00:33 [info     ] Setting seed                   value=45
2025-08-21 08:00:33 [info     ] Building structured outputter  name=student_kt
2025-08-21 08:00:33 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_chocolate_level_nocontext
2025-08-21 08:00:33 [info     ] Building model                 name=qwen3:1.7b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:00:33 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<03:44,  1.16s/it]  2%|▏         | 3/195 [00:02<01:59,  1.61it/s]  3%|▎         | 5/195 [00:02<01:30,  2.11it/s]  4%|▎         | 7/195 [00:03<01:11,  2.64it/s]  5%|▍         | 9/195 [00:03<01:03,  2.94it/s]  6%|▌         | 11/195 [00:04<00:51,  3.60it/s]  7%|▋         | 13/195 [00:04<00:45,  3.98it/s]  8%|▊         | 15/195 [00:04<00:39,  4.56it/s]  8%|▊         | 16/195 [00:04<00:38,  4.66it/s]  9%|▊         | 17/195 [00:05<00:40,  4.36it/s]  9%|▉         | 18/195 [00:05<00:40,  4.40it/s] 10%|▉         | 19/195 [00:05<00:38,  4.56it/s] 10%|█         | 20/195 [00:05<00:42,  4.15it/s] 11%|█▏        | 22/195 [00:06<00:40,  4.29it/s] 12%|█▏        | 24/195 [00:06<00:40,  4.24it/s] 13%|█▎        | 26/195 [00:07<00:35,  4.75it/s] 14%|█▍        | 28/195 [00:07<00:32,  5.13it/s] 15%|█▌        | 30/195 [00:07<00:33,  4.92it/s] 16%|█▋        | 32/195 [00:08<00:34,  4.78it/s] 17%|█▋        | 33/195 [00:08<00:32,  5.00it/s] 17%|█▋        | 34/195 [00:08<00:34,  4.67it/s] 18%|█▊        | 35/195 [00:09<00:35,  4.48it/s] 18%|█▊        | 36/195 [00:09<00:33,  4.75it/s] 19%|█▉        | 37/195 [00:09<00:35,  4.49it/s] 19%|█▉        | 38/195 [00:09<00:30,  5.10it/s] 20%|██        | 39/195 [00:09<00:35,  4.44it/s] 21%|██        | 41/195 [00:10<00:31,  4.89it/s] 22%|██▏       | 43/195 [00:10<00:31,  4.78it/s] 23%|██▎       | 45/195 [00:11<00:29,  5.01it/s] 24%|██▍       | 47/195 [00:11<00:29,  5.10it/s] 25%|██▌       | 49/195 [00:11<00:28,  5.13it/s] 26%|██▌       | 51/195 [00:12<00:27,  5.21it/s] 27%|██▋       | 53/195 [00:12<00:27,  5.24it/s] 28%|██▊       | 55/195 [00:13<00:27,  5.09it/s] 29%|██▉       | 57/195 [00:13<00:25,  5.34it/s] 30%|██▉       | 58/195 [00:13<00:23,  5.75it/s] 30%|███       | 59/195 [00:13<00:27,  4.94it/s] 31%|███       | 60/195 [00:14<00:27,  4.94it/s] 32%|███▏      | 62/195 [00:14<00:24,  5.32it/s] 33%|███▎      | 64/195 [00:14<00:22,  5.74it/s] 34%|███▍      | 66/195 [00:15<00:23,  5.46it/s] 35%|███▍      | 68/195 [00:15<00:22,  5.72it/s] 36%|███▌      | 70/195 [00:15<00:22,  5.57it/s] 37%|███▋      | 72/195 [00:16<00:22,  5.56it/s] 38%|███▊      | 74/195 [00:16<00:20,  5.77it/s] 39%|███▉      | 76/195 [00:16<00:20,  5.74it/s] 40%|████      | 78/195 [00:17<00:19,  5.91it/s] 41%|████      | 80/195 [00:17<00:19,  5.92it/s] 42%|████▏     | 81/195 [00:17<00:19,  5.87it/s] 42%|████▏     | 82/195 [00:17<00:20,  5.61it/s] 43%|████▎     | 83/195 [00:18<00:21,  5.30it/s] 43%|████▎     | 84/195 [00:18<00:18,  5.85it/s] 44%|████▎     | 85/195 [00:18<00:23,  4.65it/s] 45%|████▍     | 87/195 [00:18<00:21,  4.96it/s] 46%|████▌     | 89/195 [00:19<00:22,  4.81it/s] 47%|████▋     | 91/195 [00:19<00:22,  4.69it/s] 48%|████▊     | 93/195 [00:20<00:22,  4.44it/s] 49%|████▊     | 95/195 [00:20<00:21,  4.55it/s] 50%|████▉     | 97/195 [00:20<00:19,  5.02it/s] 51%|█████     | 99/195 [00:21<00:19,  4.91it/s] 52%|█████▏    | 101/195 [00:21<00:20,  4.67it/s] 52%|█████▏    | 102/195 [00:22<00:20,  4.44it/s] 53%|█████▎    | 103/195 [00:22<00:21,  4.29it/s] 53%|█████▎    | 104/195 [00:22<00:22,  4.10it/s] 54%|█████▍    | 105/195 [00:22<00:21,  4.13it/s] 54%|█████▍    | 106/195 [00:23<00:22,  3.89it/s] 55%|█████▍    | 107/195 [00:23<00:21,  4.07it/s] 55%|█████▌    | 108/195 [00:23<00:23,  3.74it/s] 56%|█████▋    | 110/195 [00:24<00:21,  4.00it/s] 57%|█████▋    | 111/195 [00:24<00:19,  4.39it/s] 57%|█████▋    | 112/195 [00:24<00:20,  4.04it/s] 58%|█████▊    | 113/195 [00:24<00:18,  4.36it/s] 58%|█████▊    | 114/195 [00:25<00:19,  4.17it/s] 59%|█████▉    | 115/195 [00:25<00:19,  4.15it/s] 59%|█████▉    | 116/195 [00:25<00:18,  4.27it/s] 60%|██████    | 117/195 [00:25<00:18,  4.24it/s] 61%|██████    | 119/195 [00:26<00:16,  4.71it/s] 62%|██████▏   | 120/195 [00:26<00:15,  4.85it/s] 63%|██████▎   | 122/195 [00:26<00:14,  4.90it/s] 64%|██████▎   | 124/195 [00:27<00:14,  4.87it/s] 65%|██████▍   | 126/195 [00:27<00:13,  4.97it/s] 66%|██████▌   | 128/195 [00:27<00:13,  5.03it/s] 67%|██████▋   | 130/195 [00:28<00:13,  4.82it/s] 68%|██████▊   | 132/195 [00:28<00:13,  4.54it/s] 69%|██████▊   | 134/195 [00:29<00:12,  4.78it/s] 69%|██████▉   | 135/195 [00:29<00:12,  4.64it/s] 70%|███████   | 137/195 [00:29<00:11,  4.88it/s] 71%|███████▏  | 139/195 [00:30<00:11,  5.08it/s] 72%|███████▏  | 140/195 [00:30<00:11,  4.90it/s] 73%|███████▎  | 142/195 [00:30<00:10,  5.18it/s] 74%|███████▍  | 144/195 [00:31<00:09,  5.31it/s] 74%|███████▍  | 145/195 [00:31<00:10,  4.94it/s] 75%|███████▌  | 147/195 [00:31<00:09,  5.11it/s] 76%|███████▋  | 149/195 [00:32<00:08,  5.27it/s] 77%|███████▋  | 150/195 [00:32<00:09,  4.92it/s] 78%|███████▊  | 152/195 [00:32<00:08,  5.16it/s] 79%|███████▉  | 154/195 [00:33<00:07,  5.14it/s] 79%|███████▉  | 155/195 [00:33<00:07,  5.00it/s] 81%|████████  | 157/195 [00:33<00:07,  4.86it/s] 82%|████████▏ | 159/195 [00:34<00:07,  4.83it/s] 82%|████████▏ | 160/195 [00:34<00:06,  5.11it/s] 83%|████████▎ | 161/195 [00:34<00:06,  5.20it/s] 83%|████████▎ | 162/195 [00:34<00:06,  5.41it/s] 84%|████████▎ | 163/195 [00:34<00:05,  5.94it/s] 84%|████████▍ | 164/195 [00:35<00:05,  5.58it/s] 85%|████████▍ | 165/195 [00:35<00:05,  5.73it/s] 85%|████████▌ | 166/195 [00:35<00:04,  5.90it/s] 86%|████████▌ | 167/195 [00:35<00:04,  5.94it/s] 86%|████████▌ | 168/195 [00:35<00:04,  5.66it/s] 87%|████████▋ | 170/195 [00:36<00:04,  5.75it/s] 88%|████████▊ | 171/195 [00:36<00:04,  5.51it/s] 89%|████████▊ | 173/195 [00:36<00:04,  5.35it/s] 90%|████████▉ | 175/195 [00:37<00:03,  5.03it/s] 91%|█████████ | 177/195 [00:37<00:03,  5.50it/s] 92%|█████████▏| 179/195 [00:37<00:03,  4.91it/s] 93%|█████████▎| 181/195 [00:38<00:02,  4.79it/s] 94%|█████████▍| 183/195 [00:38<00:02,  4.79it/s] 95%|█████████▍| 185/195 [00:39<00:02,  4.56it/s] 96%|█████████▌| 187/195 [00:39<00:01,  4.82it/s] 96%|█████████▋| 188/195 [00:39<00:01,  4.90it/s] 97%|█████████▋| 189/195 [00:39<00:01,  5.24it/s] 97%|█████████▋| 190/195 [00:40<00:01,  4.61it/s] 98%|█████████▊| 192/195 [00:40<00:00,  5.43it/s] 99%|█████████▉| 194/195 [00:40<00:00,  5.69it/s]100%|██████████| 195/195 [00:43<00:00,  4.52it/s]
2025-08-21 08:01:16 [info     ] Validating outputs
2025-08-21 08:01:16 [info     ] Predict - end                  time=0:0:43
2025-08-21 08:01:16 [info     ] Evaluate - start               split=test
2025-08-21 08:01:16 [error    ] Error computing monotonicity score error='Cannot calculate a linear regression if all x values are identical' llm_group_correctness=array([0., 0., 0., 0., 0.]) student_group_correctness=array([0.56861655, 0.69013588, 0.78119935, 0.84989873, 0.90918367])
2025-08-21 08:01:16 [info     ] Evaluate - end                 correctness_llm=0.0 monotonicity=nan
2025-08-21 08:01:16 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:01:16 [info     ] Augmenting questions for IRT estimation num_questions=39
2025-08-21 08:01:16 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:01:16 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1067.10it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3626.76it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 515.47it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 2132.96it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 852.10it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3430.89it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 559.66it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7431.06it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 934.29it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3376.78it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 627.97it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5948.16it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 895.15it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3625.88it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 706.85it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6025.06it/s]
2025-08-21 08:01:19 INFO: EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
2025-08-21 08:01:19 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:01:19 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:01:19 [info     ] Evaluate question difficulty - end rmse=2.1790369211218823 split=test
2025-08-21 08:01:19 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 3 finished: 0:0:56

 ========== Config: llama3.2:1b~T_0.0~SO_student_kt~L_5~SP_student_chocolate_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_miscon_studentlevel_random0 ==========
Config 3/8

 ********** Run: 1/3 **********
2025-08-21 08:01:42 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:01:42 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:01:42 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:01:42 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:01:44 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:01:44 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:01:49 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:01:49 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:01:49 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:01:49 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:01:53 [info     ] Setting seed                   value=43
2025-08-21 08:01:53 [info     ] Building structured outputter  name=student_kt
2025-08-21 08:01:53 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_chocolate_level_nocontext
2025-08-21 08:01:53 [info     ] Building model                 name=llama3.2:1b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:01:53 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:03<10:39,  3.30s/it]  2%|▏         | 3/195 [00:04<04:12,  1.31s/it]  2%|▏         | 4/195 [00:04<02:51,  1.12it/s]  3%|▎         | 5/195 [00:05<02:51,  1.11it/s]  4%|▎         | 7/195 [00:05<01:45,  1.79it/s]  4%|▍         | 8/195 [00:06<01:44,  1.78it/s]  5%|▍         | 9/195 [00:06<01:25,  2.16it/s]  5%|▌         | 10/195 [00:07<01:28,  2.10it/s]  6%|▌         | 11/195 [00:07<01:14,  2.46it/s]  6%|▌         | 12/195 [00:07<01:00,  3.03it/s]  7%|▋         | 13/195 [00:08<01:03,  2.84it/s]  7%|▋         | 14/195 [00:08<00:50,  3.56it/s]  8%|▊         | 15/195 [00:08<00:53,  3.36it/s]  8%|▊         | 16/195 [00:09<01:15,  2.38it/s]  9%|▊         | 17/195 [00:09<00:59,  3.00it/s]  9%|▉         | 18/195 [00:10<01:20,  2.19it/s] 10%|█         | 20/195 [00:10<00:58,  3.02it/s] 11%|█         | 21/195 [00:10<00:52,  3.34it/s] 11%|█▏        | 22/195 [00:10<00:51,  3.33it/s] 12%|█▏        | 24/195 [00:11<00:53,  3.17it/s] 13%|█▎        | 25/195 [00:11<00:48,  3.52it/s] 13%|█▎        | 26/195 [00:12<00:54,  3.09it/s] 14%|█▍        | 27/195 [00:12<00:45,  3.73it/s] 14%|█▍        | 28/195 [00:12<00:50,  3.29it/s] 15%|█▍        | 29/195 [00:12<00:43,  3.81it/s] 15%|█▌        | 30/195 [00:13<00:46,  3.58it/s] 16%|█▌        | 31/195 [00:13<00:49,  3.29it/s] 16%|█▋        | 32/195 [00:14<01:09,  2.35it/s] 17%|█▋        | 33/195 [00:14<00:58,  2.75it/s] 17%|█▋        | 34/195 [00:14<00:55,  2.90it/s] 18%|█▊        | 35/195 [00:15<00:53,  3.02it/s] 18%|█▊        | 36/195 [00:15<00:48,  3.27it/s] 19%|█▉        | 37/195 [00:15<00:48,  3.25it/s] 20%|██        | 39/195 [00:16<00:41,  3.73it/s] 21%|██        | 41/195 [00:16<00:37,  4.09it/s] 22%|██▏       | 43/195 [00:17<00:37,  4.02it/s] 23%|██▎       | 44/195 [00:17<00:34,  4.35it/s] 23%|██▎       | 45/195 [00:17<00:47,  3.18it/s] 24%|██▎       | 46/195 [00:17<00:43,  3.45it/s] 24%|██▍       | 47/195 [00:18<00:43,  3.41it/s] 25%|██▍       | 48/195 [00:18<00:39,  3.75it/s] 25%|██▌       | 49/195 [00:18<00:44,  3.30it/s] 26%|██▌       | 50/195 [00:19<00:36,  3.99it/s] 26%|██▌       | 51/195 [00:19<01:01,  2.34it/s] 27%|██▋       | 53/195 [00:20<01:02,  2.26it/s] 28%|██▊       | 55/195 [00:21<01:01,  2.29it/s] 29%|██▉       | 57/195 [00:22<01:04,  2.15it/s] 30%|███       | 59/195 [00:23<01:05,  2.07it/s] 31%|███▏      | 61/195 [00:24<00:53,  2.51it/s] 32%|███▏      | 62/195 [00:24<00:46,  2.83it/s] 32%|███▏      | 63/195 [00:24<00:45,  2.90it/s] 33%|███▎      | 64/195 [00:24<00:40,  3.22it/s] 33%|███▎      | 65/195 [00:25<00:38,  3.39it/s] 34%|███▍      | 66/195 [00:25<00:48,  2.64it/s] 34%|███▍      | 67/195 [00:25<00:39,  3.20it/s] 35%|███▍      | 68/195 [00:26<00:44,  2.83it/s] 35%|███▌      | 69/195 [00:26<00:45,  2.78it/s] 36%|███▋      | 71/195 [00:27<00:50,  2.45it/s] 37%|███▋      | 73/195 [00:28<00:42,  2.85it/s] 38%|███▊      | 74/195 [00:28<00:37,  3.24it/s] 38%|███▊      | 75/195 [00:28<00:43,  2.78it/s] 39%|███▉      | 76/195 [00:29<00:42,  2.80it/s] 39%|███▉      | 77/195 [00:29<00:36,  3.27it/s] 40%|████      | 78/195 [00:30<00:53,  2.20it/s] 41%|████      | 80/195 [00:30<00:41,  2.76it/s] 42%|████▏     | 81/195 [00:31<00:46,  2.47it/s] 42%|████▏     | 82/195 [00:31<00:38,  2.91it/s] 43%|████▎     | 83/195 [00:32<00:47,  2.35it/s] 43%|████▎     | 84/195 [00:32<00:39,  2.84it/s] 44%|████▎     | 85/195 [00:32<00:37,  2.92it/s] 44%|████▍     | 86/195 [00:33<00:49,  2.18it/s] 45%|████▌     | 88/195 [00:34<00:50,  2.14it/s] 46%|████▌     | 89/195 [00:34<00:41,  2.57it/s] 46%|████▌     | 90/195 [00:34<00:45,  2.33it/s] 47%|████▋     | 91/195 [00:35<00:39,  2.62it/s] 47%|████▋     | 92/195 [00:35<00:32,  3.14it/s] 48%|████▊     | 93/195 [00:35<00:33,  3.05it/s] 48%|████▊     | 94/195 [00:35<00:30,  3.35it/s] 49%|████▊     | 95/195 [00:36<00:28,  3.45it/s] 49%|████▉     | 96/195 [00:36<00:39,  2.54it/s] 50%|████▉     | 97/195 [00:37<00:40,  2.40it/s] 50%|█████     | 98/195 [00:37<00:32,  2.98it/s] 51%|█████     | 99/195 [00:37<00:31,  3.02it/s] 51%|█████▏    | 100/195 [00:37<00:29,  3.27it/s] 52%|█████▏    | 101/195 [00:38<00:39,  2.35it/s] 52%|█████▏    | 102/195 [00:38<00:31,  2.98it/s] 53%|█████▎    | 103/195 [00:39<00:41,  2.19it/s] 53%|█████▎    | 104/195 [00:39<00:32,  2.80it/s] 54%|█████▍    | 105/195 [00:40<00:42,  2.13it/s] 54%|█████▍    | 106/195 [00:40<00:32,  2.72it/s] 55%|█████▍    | 107/195 [00:41<00:44,  1.96it/s] 55%|█████▌    | 108/195 [00:41<00:36,  2.40it/s] 56%|█████▌    | 109/195 [00:42<00:45,  1.90it/s] 56%|█████▋    | 110/195 [00:42<00:36,  2.34it/s] 57%|█████▋    | 111/195 [00:43<00:43,  1.92it/s] 57%|█████▋    | 112/195 [00:43<00:34,  2.40it/s] 58%|█████▊    | 113/195 [00:43<00:31,  2.64it/s] 58%|█████▊    | 114/195 [00:44<00:37,  2.15it/s] 59%|█████▉    | 115/195 [00:44<00:29,  2.69it/s] 59%|█████▉    | 116/195 [00:45<00:38,  2.07it/s] 60%|██████    | 117/195 [00:45<00:29,  2.64it/s] 61%|██████    | 118/195 [00:46<00:41,  1.86it/s] 61%|██████    | 119/195 [00:46<00:31,  2.41it/s] 62%|██████▏   | 120/195 [00:46<00:33,  2.25it/s] 62%|██████▏   | 121/195 [00:47<00:29,  2.47it/s] 63%|██████▎   | 122/195 [00:47<00:23,  3.16it/s] 63%|██████▎   | 123/195 [00:47<00:23,  3.03it/s] 64%|██████▎   | 124/195 [00:47<00:19,  3.66it/s] 64%|██████▍   | 125/195 [00:48<00:19,  3.66it/s] 65%|██████▍   | 126/195 [00:48<00:17,  3.93it/s] 65%|██████▌   | 127/195 [00:48<00:16,  4.04it/s] 66%|██████▌   | 128/195 [00:48<00:15,  4.26it/s] 66%|██████▌   | 129/195 [00:49<00:14,  4.52it/s] 67%|██████▋   | 130/195 [00:49<00:24,  2.63it/s] 67%|██████▋   | 131/195 [00:49<00:19,  3.25it/s] 68%|██████▊   | 132/195 [00:50<00:16,  3.72it/s] 68%|██████▊   | 133/195 [00:50<00:24,  2.55it/s] 69%|██████▊   | 134/195 [00:50<00:19,  3.18it/s] 69%|██████▉   | 135/195 [00:51<00:29,  2.06it/s] 70%|██████▉   | 136/195 [00:52<00:28,  2.07it/s] 71%|███████   | 138/195 [00:52<00:20,  2.79it/s] 71%|███████▏  | 139/195 [00:52<00:16,  3.40it/s] 72%|███████▏  | 140/195 [00:53<00:20,  2.68it/s] 73%|███████▎  | 142/195 [00:53<00:16,  3.27it/s] 74%|███████▍  | 144/195 [00:54<00:14,  3.53it/s] 74%|███████▍  | 145/195 [00:54<00:12,  3.89it/s] 75%|███████▍  | 146/195 [00:54<00:12,  3.83it/s] 75%|███████▌  | 147/195 [00:54<00:11,  4.32it/s] 76%|███████▌  | 148/195 [00:55<00:11,  4.11it/s] 76%|███████▋  | 149/195 [00:55<00:09,  4.61it/s] 77%|███████▋  | 150/195 [00:55<00:10,  4.18it/s] 77%|███████▋  | 151/195 [00:56<00:14,  3.08it/s] 78%|███████▊  | 152/195 [00:56<00:13,  3.10it/s] 79%|███████▉  | 154/195 [00:57<00:12,  3.26it/s] 79%|███████▉  | 155/195 [00:57<00:15,  2.63it/s] 81%|████████  | 157/195 [00:57<00:09,  4.04it/s] 81%|████████  | 158/195 [00:58<00:09,  3.97it/s] 82%|████████▏ | 159/195 [00:58<00:07,  4.56it/s] 82%|████████▏ | 160/195 [00:58<00:08,  4.16it/s] 83%|████████▎ | 162/195 [00:58<00:07,  4.58it/s] 84%|████████▍ | 164/195 [00:59<00:06,  5.01it/s] 85%|████████▌ | 166/195 [00:59<00:06,  4.76it/s] 86%|████████▌ | 168/195 [01:00<00:06,  4.40it/s] 87%|████████▋ | 170/195 [01:00<00:06,  3.99it/s] 88%|████████▊ | 171/195 [01:00<00:05,  4.48it/s] 88%|████████▊ | 172/195 [01:01<00:05,  4.15it/s] 89%|████████▊ | 173/195 [01:01<00:05,  4.39it/s] 89%|████████▉ | 174/195 [01:01<00:04,  4.22it/s] 90%|████████▉ | 175/195 [01:01<00:04,  4.39it/s] 90%|█████████ | 176/195 [01:02<00:05,  3.44it/s] 91%|█████████ | 177/195 [01:02<00:05,  3.20it/s] 92%|█████████▏| 179/195 [01:03<00:04,  3.70it/s] 93%|█████████▎| 181/195 [01:03<00:04,  2.98it/s] 94%|█████████▍| 183/195 [01:04<00:04,  2.66it/s] 95%|█████████▍| 185/195 [01:05<00:03,  2.53it/s] 95%|█████████▌| 186/195 [01:05<00:03,  2.95it/s] 96%|█████████▌| 187/195 [01:06<00:03,  2.30it/s] 97%|█████████▋| 189/195 [01:07<00:02,  2.86it/s] 97%|█████████▋| 190/195 [01:07<00:02,  2.47it/s] 98%|█████████▊| 191/195 [01:07<00:01,  2.95it/s] 98%|█████████▊| 192/195 [01:08<00:01,  2.91it/s] 99%|█████████▉| 193/195 [01:08<00:00,  3.05it/s] 99%|█████████▉| 194/195 [01:08<00:00,  3.09it/s]100%|██████████| 195/195 [01:08<00:00,  3.50it/s]100%|██████████| 195/195 [01:10<00:00,  2.75it/s]
2025-08-21 08:03:04 [info     ] Validating outputs
2025-08-21 08:03:04 [info     ] Predict - end                  time=0:1:11
2025-08-21 08:03:04 [info     ] Evaluate - start               split=test
2025-08-21 08:03:04 [info     ] Evaluate - end                 correctness_llm=0.25 monotonicity=-0.3
2025-08-21 08:03:04 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:03:04 [info     ] Augmenting questions for IRT estimation num_questions=22
2025-08-21 08:03:04 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:03:04 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 948.14it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3656.84it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 512.70it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6114.15it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1074.99it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3404.82it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 582.67it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6192.81it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 921.39it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3583.78it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 606.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6686.43it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 912.54it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 2943.42it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 612.82it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6072.42it/s]
2025-08-21 08:03:07 INFO: Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
2025-08-21 08:03:07 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:03:07 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:03:07 [info     ] Evaluate question difficulty - end rmse=3.1535240813065384 split=test
2025-08-21 08:03:07 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 1 finished: 0:1:24

 ********** Run: 2/3 **********
2025-08-21 08:03:28 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:03:28 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:03:28 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:03:28 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:03:30 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:03:30 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:03:34 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:03:34 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:03:34 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:03:35 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:03:38 [info     ] Setting seed                   value=44
2025-08-21 08:03:38 [info     ] Building structured outputter  name=student_kt
2025-08-21 08:03:38 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_chocolate_level_nocontext
2025-08-21 08:03:38 [info     ] Building model                 name=llama3.2:1b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:03:38 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<04:43,  1.46s/it]  1%|          | 2/195 [00:02<02:59,  1.07it/s]  2%|▏         | 3/195 [00:02<02:17,  1.40it/s]  2%|▏         | 4/195 [00:02<01:34,  2.02it/s]  3%|▎         | 5/195 [00:02<01:20,  2.35it/s]  3%|▎         | 6/195 [00:03<01:11,  2.63it/s]  4%|▎         | 7/195 [00:03<01:03,  2.96it/s]  4%|▍         | 8/195 [00:03<01:04,  2.89it/s]  5%|▍         | 9/195 [00:04<01:03,  2.95it/s]  5%|▌         | 10/195 [00:04<01:14,  2.47it/s]  6%|▌         | 11/195 [00:04<01:05,  2.80it/s]  7%|▋         | 13/195 [00:05<00:53,  3.41it/s]  7%|▋         | 14/195 [00:05<00:45,  3.96it/s]  8%|▊         | 15/195 [00:05<00:50,  3.59it/s]  8%|▊         | 16/195 [00:06<01:12,  2.47it/s]  9%|▊         | 17/195 [00:06<01:00,  2.96it/s]  9%|▉         | 18/195 [00:07<01:04,  2.73it/s] 10%|▉         | 19/195 [00:07<00:53,  3.29it/s] 10%|█         | 20/195 [00:07<00:44,  3.93it/s] 11%|█         | 21/195 [00:07<00:45,  3.79it/s] 11%|█▏        | 22/195 [00:07<00:38,  4.49it/s] 12%|█▏        | 23/195 [00:08<00:46,  3.71it/s] 12%|█▏        | 24/195 [00:08<00:58,  2.92it/s] 13%|█▎        | 26/195 [00:09<00:49,  3.41it/s] 14%|█▍        | 27/195 [00:09<00:41,  4.02it/s] 14%|█▍        | 28/195 [00:09<00:48,  3.47it/s] 15%|█▍        | 29/195 [00:09<00:41,  3.97it/s] 15%|█▌        | 30/195 [00:10<00:49,  3.36it/s] 16%|█▌        | 31/195 [00:10<00:49,  3.35it/s] 16%|█▋        | 32/195 [00:11<01:08,  2.39it/s] 17%|█▋        | 33/195 [00:11<00:56,  2.86it/s] 17%|█▋        | 34/195 [00:11<00:53,  2.99it/s] 18%|█▊        | 35/195 [00:12<00:53,  2.98it/s] 18%|█▊        | 36/195 [00:12<00:47,  3.36it/s] 19%|█▉        | 37/195 [00:12<00:47,  3.30it/s] 19%|█▉        | 38/195 [00:12<00:44,  3.52it/s] 20%|██        | 39/195 [00:13<00:46,  3.35it/s] 21%|██        | 40/195 [00:13<00:38,  3.98it/s] 21%|██        | 41/195 [00:13<00:44,  3.47it/s] 22%|██▏       | 43/195 [00:14<00:41,  3.65it/s] 23%|██▎       | 45/195 [00:14<00:38,  3.85it/s] 24%|██▎       | 46/195 [00:15<00:36,  4.11it/s] 24%|██▍       | 47/195 [00:15<00:43,  3.43it/s] 25%|██▍       | 48/195 [00:15<00:39,  3.72it/s] 25%|██▌       | 49/195 [00:16<00:43,  3.39it/s] 26%|██▌       | 50/195 [00:16<00:38,  3.81it/s] 26%|██▌       | 51/195 [00:17<01:01,  2.34it/s] 27%|██▋       | 53/195 [00:17<01:02,  2.27it/s] 28%|██▊       | 54/195 [00:18<00:52,  2.68it/s] 28%|██▊       | 55/195 [00:18<01:07,  2.09it/s] 29%|██▊       | 56/195 [00:19<00:53,  2.60it/s] 29%|██▉       | 57/195 [00:19<01:05,  2.11it/s] 30%|██▉       | 58/195 [00:19<00:51,  2.67it/s] 30%|███       | 59/195 [00:20<01:07,  2.02it/s] 31%|███       | 60/195 [00:20<00:52,  2.59it/s] 31%|███▏      | 61/195 [00:21<00:49,  2.68it/s] 32%|███▏      | 62/195 [00:21<00:45,  2.95it/s] 32%|███▏      | 63/195 [00:21<00:39,  3.34it/s] 33%|███▎      | 64/195 [00:21<00:42,  3.11it/s] 34%|███▍      | 66/195 [00:22<00:46,  2.76it/s] 35%|███▍      | 68/195 [00:23<00:39,  3.20it/s] 35%|███▌      | 69/195 [00:23<00:34,  3.64it/s] 36%|███▌      | 70/195 [00:23<00:36,  3.38it/s] 36%|███▋      | 71/195 [00:24<00:43,  2.86it/s] 37%|███▋      | 72/195 [00:24<00:38,  3.24it/s] 37%|███▋      | 73/195 [00:25<00:46,  2.65it/s] 38%|███▊      | 74/195 [00:25<00:39,  3.05it/s] 38%|███▊      | 75/195 [00:25<00:33,  3.54it/s] 39%|███▉      | 76/195 [00:26<00:53,  2.21it/s] 39%|███▉      | 77/195 [00:26<00:43,  2.70it/s] 40%|████      | 78/195 [00:26<00:47,  2.46it/s] 41%|████      | 79/195 [00:27<00:46,  2.52it/s] 41%|████      | 80/195 [00:27<00:39,  2.93it/s] 42%|████▏     | 81/195 [00:28<00:50,  2.27it/s] 43%|████▎     | 83/195 [00:29<00:48,  2.33it/s] 43%|████▎     | 84/195 [00:29<00:40,  2.77it/s] 44%|████▎     | 85/195 [00:29<00:49,  2.24it/s] 44%|████▍     | 86/195 [00:30<00:40,  2.67it/s] 45%|████▍     | 87/195 [00:30<00:47,  2.26it/s] 45%|████▌     | 88/195 [00:30<00:39,  2.68it/s] 46%|████▌     | 89/195 [00:31<00:52,  2.02it/s] 46%|████▌     | 90/195 [00:31<00:41,  2.54it/s] 47%|████▋     | 91/195 [00:32<00:47,  2.18it/s] 47%|████▋     | 92/195 [00:32<00:51,  2.01it/s] 48%|████▊     | 93/195 [00:33<00:49,  2.04it/s] 48%|████▊     | 94/195 [00:33<00:49,  2.03it/s] 49%|████▊     | 95/195 [00:34<00:42,  2.33it/s] 49%|████▉     | 96/195 [00:34<00:46,  2.14it/s] 50%|████▉     | 97/195 [00:35<00:41,  2.37it/s] 51%|█████     | 99/195 [00:35<00:32,  3.00it/s] 51%|█████▏    | 100/195 [00:35<00:26,  3.60it/s] 52%|█████▏    | 101/195 [00:36<00:38,  2.41it/s] 53%|█████▎    | 103/195 [00:37<00:38,  2.41it/s] 54%|█████▍    | 105/195 [00:38<00:37,  2.42it/s] 55%|█████▍    | 107/195 [00:38<00:36,  2.41it/s] 55%|█████▌    | 108/195 [00:39<00:30,  2.83it/s] 56%|█████▌    | 109/195 [00:39<00:37,  2.30it/s] 56%|█████▋    | 110/195 [00:39<00:30,  2.81it/s] 57%|█████▋    | 111/195 [00:40<00:38,  2.19it/s] 57%|█████▋    | 112/195 [00:40<00:30,  2.75it/s] 58%|█████▊    | 113/195 [00:41<00:30,  2.71it/s] 58%|█████▊    | 114/195 [00:41<00:35,  2.29it/s] 59%|█████▉    | 115/195 [00:41<00:29,  2.67it/s] 59%|█████▉    | 116/195 [00:42<00:36,  2.16it/s] 60%|██████    | 117/195 [00:42<00:30,  2.59it/s] 61%|██████    | 118/195 [00:43<00:38,  1.99it/s] 61%|██████    | 119/195 [00:43<00:32,  2.33it/s] 62%|██████▏   | 120/195 [00:44<00:32,  2.28it/s] 62%|██████▏   | 121/195 [00:44<00:28,  2.57it/s] 63%|██████▎   | 123/195 [00:45<00:21,  3.37it/s] 64%|██████▎   | 124/195 [00:45<00:17,  4.03it/s] 64%|██████▍   | 125/195 [00:45<00:18,  3.85it/s] 65%|██████▍   | 126/195 [00:45<00:15,  4.46it/s] 65%|██████▌   | 127/195 [00:45<00:15,  4.39it/s] 66%|██████▌   | 128/195 [00:45<00:13,  5.01it/s] 66%|██████▌   | 129/195 [00:46<00:13,  4.75it/s] 67%|██████▋   | 130/195 [00:46<00:21,  3.04it/s] 67%|██████▋   | 131/195 [00:46<00:18,  3.48it/s] 68%|██████▊   | 133/195 [00:47<00:16,  3.78it/s] 69%|██████▊   | 134/195 [00:47<00:19,  3.16it/s] 69%|██████▉   | 135/195 [00:48<00:22,  2.72it/s] 70%|██████▉   | 136/195 [00:49<00:28,  2.06it/s] 70%|███████   | 137/195 [00:49<00:32,  1.80it/s] 71%|███████   | 138/195 [00:50<00:31,  1.83it/s] 71%|███████▏  | 139/195 [00:50<00:25,  2.21it/s] 72%|███████▏  | 140/195 [00:50<00:21,  2.52it/s] 72%|███████▏  | 141/195 [00:51<00:25,  2.15it/s] 73%|███████▎  | 142/195 [00:51<00:23,  2.29it/s] 73%|███████▎  | 143/195 [00:52<00:17,  2.95it/s] 74%|███████▍  | 144/195 [00:52<00:18,  2.82it/s] 74%|███████▍  | 145/195 [00:52<00:15,  3.26it/s] 75%|███████▍  | 146/195 [00:53<00:17,  2.84it/s] 75%|███████▌  | 147/195 [00:53<00:16,  2.93it/s] 76%|███████▋  | 149/195 [00:53<00:12,  3.79it/s] 77%|███████▋  | 150/195 [00:53<00:10,  4.38it/s] 77%|███████▋  | 151/195 [00:54<00:13,  3.32it/s] 78%|███████▊  | 153/195 [00:54<00:11,  3.53it/s] 79%|███████▉  | 154/195 [00:55<00:10,  4.09it/s] 79%|███████▉  | 155/195 [00:55<00:12,  3.32it/s] 80%|████████  | 156/195 [00:55<00:11,  3.30it/s] 81%|████████  | 158/195 [00:56<00:09,  3.92it/s] 82%|████████▏ | 160/195 [00:56<00:07,  4.39it/s] 83%|████████▎ | 161/195 [00:56<00:06,  4.89it/s] 83%|████████▎ | 162/195 [00:56<00:06,  4.73it/s] 84%|████████▎ | 163/195 [00:57<00:06,  5.31it/s] 84%|████████▍ | 164/195 [00:57<00:06,  5.05it/s] 85%|████████▍ | 165/195 [00:57<00:05,  5.60it/s] 85%|████████▌ | 166/195 [00:57<00:06,  4.51it/s] 86%|████████▌ | 167/195 [00:57<00:05,  5.09it/s] 86%|████████▌ | 168/195 [00:58<00:06,  3.86it/s] 87%|████████▋ | 169/195 [00:58<00:06,  4.03it/s] 87%|████████▋ | 170/195 [00:58<00:07,  3.50it/s] 88%|████████▊ | 171/195 [00:59<00:06,  3.69it/s] 88%|████████▊ | 172/195 [00:59<00:05,  4.10it/s] 89%|████████▊ | 173/195 [00:59<00:05,  3.69it/s] 89%|████████▉ | 174/195 [00:59<00:04,  4.32it/s] 90%|████████▉ | 175/195 [01:00<00:06,  3.04it/s] 90%|█████████ | 176/195 [01:00<00:07,  2.65it/s] 91%|█████████▏| 178/195 [01:01<00:04,  3.47it/s] 92%|█████████▏| 180/195 [01:01<00:03,  4.01it/s] 93%|█████████▎| 181/195 [01:02<00:04,  3.08it/s] 93%|█████████▎| 182/195 [01:02<00:03,  3.44it/s] 94%|█████████▍| 183/195 [01:03<00:04,  2.45it/s] 94%|█████████▍| 184/195 [01:03<00:03,  2.99it/s] 95%|█████████▍| 185/195 [01:03<00:02,  3.41it/s] 95%|█████████▌| 186/195 [01:03<00:03,  2.79it/s] 96%|█████████▌| 187/195 [01:04<00:02,  2.95it/s] 96%|█████████▋| 188/195 [01:04<00:02,  2.50it/s] 97%|█████████▋| 189/195 [01:04<00:02,  2.85it/s] 97%|█████████▋| 190/195 [01:05<00:02,  2.36it/s] 98%|█████████▊| 191/195 [01:05<00:01,  2.86it/s] 98%|█████████▊| 192/195 [01:06<00:01,  2.68it/s] 99%|█████████▉| 193/195 [01:06<00:00,  2.35it/s]100%|██████████| 195/195 [01:07<00:00,  2.92it/s]100%|██████████| 195/195 [01:09<00:00,  2.82it/s]
2025-08-21 08:04:47 [info     ] Validating outputs
2025-08-21 08:04:47 [info     ] Predict - end                  time=0:1:9
2025-08-21 08:04:47 [info     ] Evaluate - start               split=test
2025-08-21 08:04:47 [info     ] Evaluate - end                 correctness_llm=0.23 monotonicity=0.14
2025-08-21 08:04:47 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:04:47 [info     ] Augmenting questions for IRT estimation num_questions=24
2025-08-21 08:04:47 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:04:47 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1039.33it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3513.35it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 548.65it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5800.10it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1021.54it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3676.90it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 552.71it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6253.49it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1030.87it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3622.02it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 613.33it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5705.43it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 962.12it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3709.42it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 510.27it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5736.64it/s]
2025-08-21 08:04:50 INFO: EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
2025-08-21 08:04:50 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:04:50 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:04:50 [info     ] Evaluate question difficulty - end rmse=3.2908532190358657 split=test
2025-08-21 08:04:50 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 2 finished: 0:1:22

 ********** Run: 3/3 **********
2025-08-21 08:05:12 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:05:12 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:05:12 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:05:12 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:05:14 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:05:14 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:05:18 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:05:18 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:05:18 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:05:19 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:05:22 [info     ] Setting seed                   value=45
2025-08-21 08:05:22 [info     ] Building structured outputter  name=student_kt
2025-08-21 08:05:22 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_chocolate_level_nocontext
2025-08-21 08:05:22 [info     ] Building model                 name=llama3.2:1b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:05:22 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<04:37,  1.43s/it]  2%|▏         | 3/195 [00:02<01:59,  1.60it/s]  2%|▏         | 4/195 [00:02<01:51,  1.71it/s]  3%|▎         | 5/195 [00:02<01:32,  2.06it/s]  3%|▎         | 6/195 [00:03<01:22,  2.28it/s]  4%|▎         | 7/195 [00:03<01:05,  2.87it/s]  4%|▍         | 8/195 [00:03<01:04,  2.88it/s]  5%|▍         | 9/195 [00:04<01:10,  2.65it/s]  5%|▌         | 10/195 [00:04<01:04,  2.88it/s]  6%|▌         | 11/195 [00:04<01:10,  2.60it/s]  6%|▌         | 12/195 [00:05<00:58,  3.12it/s]  7%|▋         | 13/195 [00:05<00:50,  3.62it/s]  7%|▋         | 14/195 [00:05<00:49,  3.66it/s]  8%|▊         | 15/195 [00:05<00:42,  4.20it/s]  8%|▊         | 16/195 [00:06<00:47,  3.74it/s]  9%|▊         | 17/195 [00:06<01:00,  2.92it/s]  9%|▉         | 18/195 [00:06<00:54,  3.27it/s] 10%|▉         | 19/195 [00:06<00:46,  3.82it/s] 10%|█         | 20/195 [00:07<00:45,  3.87it/s] 11%|█         | 21/195 [00:07<00:55,  3.15it/s] 11%|█▏        | 22/195 [00:07<00:47,  3.64it/s] 12%|█▏        | 23/195 [00:07<00:39,  4.30it/s] 12%|█▏        | 24/195 [00:08<00:44,  3.85it/s] 13%|█▎        | 25/195 [00:08<00:41,  4.10it/s] 13%|█▎        | 26/195 [00:08<00:51,  3.28it/s] 14%|█▍        | 27/195 [00:09<00:43,  3.83it/s] 14%|█▍        | 28/195 [00:09<00:48,  3.44it/s] 15%|█▍        | 29/195 [00:09<00:41,  4.01it/s] 15%|█▌        | 30/195 [00:09<00:45,  3.66it/s] 16%|█▌        | 31/195 [00:10<00:47,  3.49it/s] 16%|█▋        | 32/195 [00:11<01:13,  2.23it/s] 17%|█▋        | 33/195 [00:11<00:59,  2.71it/s] 17%|█▋        | 34/195 [00:11<00:55,  2.88it/s] 18%|█▊        | 35/195 [00:11<00:53,  3.00it/s] 18%|█▊        | 36/195 [00:12<00:46,  3.45it/s] 19%|█▉        | 37/195 [00:12<00:49,  3.18it/s] 20%|██        | 39/195 [00:12<00:44,  3.54it/s] 21%|██        | 41/195 [00:13<00:40,  3.79it/s] 22%|██▏       | 43/195 [00:13<00:36,  4.12it/s] 23%|██▎       | 44/195 [00:13<00:33,  4.52it/s] 23%|██▎       | 45/195 [00:14<00:43,  3.49it/s] 24%|██▎       | 46/195 [00:14<00:39,  3.80it/s] 24%|██▍       | 47/195 [00:14<00:37,  4.00it/s] 25%|██▍       | 48/195 [00:15<00:33,  4.33it/s] 25%|██▌       | 49/195 [00:15<00:34,  4.22it/s] 26%|██▌       | 50/195 [00:15<00:32,  4.51it/s] 26%|██▌       | 51/195 [00:16<00:57,  2.52it/s] 27%|██▋       | 53/195 [00:17<01:01,  2.32it/s] 28%|██▊       | 54/195 [00:17<00:50,  2.81it/s] 28%|██▊       | 55/195 [00:18<01:09,  2.01it/s] 29%|██▉       | 57/195 [00:19<01:09,  1.97it/s] 30%|██▉       | 58/195 [00:19<00:56,  2.42it/s] 30%|███       | 59/195 [00:20<01:15,  1.79it/s] 31%|███▏      | 61/195 [00:20<00:57,  2.34it/s] 32%|███▏      | 62/195 [00:21<00:48,  2.75it/s] 32%|███▏      | 63/195 [00:21<00:46,  2.84it/s] 33%|███▎      | 64/195 [00:21<00:40,  3.24it/s] 33%|███▎      | 65/195 [00:21<00:37,  3.43it/s] 34%|███▍      | 66/195 [00:22<00:51,  2.49it/s] 34%|███▍      | 67/195 [00:22<00:42,  2.99it/s] 35%|███▍      | 68/195 [00:22<00:37,  3.42it/s] 35%|███▌      | 69/195 [00:23<00:38,  3.30it/s] 36%|███▋      | 71/195 [00:24<00:44,  2.77it/s] 37%|███▋      | 73/195 [00:24<00:35,  3.43it/s] 38%|███▊      | 74/195 [00:24<00:32,  3.78it/s] 38%|███▊      | 75/195 [00:24<00:37,  3.24it/s] 39%|███▉      | 76/195 [00:25<00:34,  3.43it/s] 39%|███▉      | 77/195 [00:25<00:44,  2.66it/s] 40%|████      | 78/195 [00:26<00:41,  2.83it/s] 41%|████      | 79/195 [00:26<00:33,  3.44it/s] 41%|████      | 80/195 [00:26<00:33,  3.40it/s] 42%|████▏     | 81/195 [00:27<00:44,  2.58it/s] 42%|████▏     | 82/195 [00:27<00:35,  3.21it/s] 43%|████▎     | 83/195 [00:27<00:40,  2.76it/s] 43%|████▎     | 84/195 [00:27<00:33,  3.35it/s] 44%|████▎     | 85/195 [00:28<00:32,  3.41it/s] 44%|████▍     | 86/195 [00:28<00:44,  2.47it/s] 45%|████▌     | 88/195 [00:29<00:43,  2.45it/s] 46%|████▌     | 90/195 [00:30<00:36,  2.86it/s] 47%|████▋     | 91/195 [00:30<00:35,  2.93it/s] 48%|████▊     | 93/195 [00:31<00:31,  3.23it/s] 48%|████▊     | 94/195 [00:31<00:28,  3.58it/s] 49%|████▊     | 95/195 [00:31<00:26,  3.75it/s] 49%|████▉     | 96/195 [00:31<00:27,  3.59it/s] 50%|████▉     | 97/195 [00:32<00:29,  3.32it/s] 50%|█████     | 98/195 [00:32<00:26,  3.68it/s] 51%|█████     | 99/195 [00:32<00:27,  3.54it/s] 51%|█████▏    | 100/195 [00:32<00:26,  3.64it/s] 52%|█████▏    | 101/195 [00:33<00:40,  2.34it/s] 52%|█████▏    | 102/195 [00:33<00:30,  3.01it/s] 53%|█████▎    | 103/195 [00:34<00:45,  2.04it/s] 53%|█████▎    | 104/195 [00:34<00:34,  2.65it/s] 54%|█████▍    | 105/195 [00:35<00:47,  1.91it/s] 54%|█████▍    | 106/195 [00:35<00:35,  2.48it/s] 55%|█████▍    | 107/195 [00:36<00:45,  1.94it/s] 55%|█████▌    | 108/195 [00:36<00:35,  2.46it/s] 56%|█████▌    | 109/195 [00:37<00:42,  2.05it/s] 56%|█████▋    | 110/195 [00:37<00:33,  2.57it/s] 57%|█████▋    | 111/195 [00:38<00:40,  2.08it/s] 57%|█████▋    | 112/195 [00:38<00:31,  2.62it/s] 58%|█████▊    | 113/195 [00:39<00:39,  2.07it/s] 58%|█████▊    | 114/195 [00:39<00:31,  2.60it/s] 59%|█████▉    | 115/195 [00:39<00:37,  2.14it/s] 59%|█████▉    | 116/195 [00:40<00:29,  2.71it/s] 60%|██████    | 117/195 [00:40<00:38,  2.04it/s] 61%|██████    | 118/195 [00:41<00:30,  2.49it/s] 61%|██████    | 119/195 [00:41<00:39,  1.90it/s] 62%|██████▏   | 120/195 [00:41<00:30,  2.42it/s] 62%|██████▏   | 121/195 [00:42<00:27,  2.70it/s] 63%|██████▎   | 122/195 [00:42<00:24,  3.00it/s] 63%|██████▎   | 123/195 [00:42<00:20,  3.60it/s] 64%|██████▎   | 124/195 [00:42<00:19,  3.62it/s] 64%|██████▍   | 125/195 [00:43<00:16,  4.35it/s] 65%|██████▍   | 126/195 [00:43<00:18,  3.65it/s] 66%|██████▌   | 128/195 [00:43<00:16,  4.00it/s] 66%|██████▌   | 129/195 [00:44<00:18,  3.57it/s] 67%|██████▋   | 130/195 [00:44<00:19,  3.42it/s] 68%|██████▊   | 132/195 [00:44<00:15,  4.13it/s] 68%|██████▊   | 133/195 [00:45<00:20,  2.97it/s] 69%|██████▊   | 134/195 [00:45<00:17,  3.40it/s] 69%|██████▉   | 135/195 [00:46<00:23,  2.51it/s] 70%|██████▉   | 136/195 [00:46<00:24,  2.43it/s] 70%|███████   | 137/195 [00:47<00:24,  2.41it/s] 71%|███████   | 138/195 [00:47<00:25,  2.26it/s] 71%|███████▏  | 139/195 [00:48<00:24,  2.25it/s] 72%|███████▏  | 140/195 [00:48<00:25,  2.19it/s] 72%|███████▏  | 141/195 [00:49<00:26,  2.03it/s] 73%|███████▎  | 142/195 [00:49<00:23,  2.27it/s] 73%|███████▎  | 143/195 [00:49<00:18,  2.74it/s] 74%|███████▍  | 144/195 [00:50<00:19,  2.62it/s] 74%|███████▍  | 145/195 [00:50<00:15,  3.24it/s] 75%|███████▍  | 146/195 [00:50<00:16,  2.93it/s] 76%|███████▌  | 148/195 [00:51<00:13,  3.50it/s] 76%|███████▋  | 149/195 [00:51<00:11,  3.87it/s] 77%|███████▋  | 150/195 [00:51<00:12,  3.54it/s] 77%|███████▋  | 151/195 [00:52<00:13,  3.37it/s] 78%|███████▊  | 152/195 [00:52<00:12,  3.46it/s] 78%|███████▊  | 153/195 [00:52<00:11,  3.67it/s] 79%|███████▉  | 154/195 [00:52<00:11,  3.52it/s] 79%|███████▉  | 155/195 [00:53<00:11,  3.54it/s] 80%|████████  | 156/195 [00:53<00:09,  4.12it/s] 81%|████████  | 157/195 [00:53<00:09,  4.01it/s] 81%|████████  | 158/195 [00:53<00:07,  4.77it/s] 82%|████████▏ | 159/195 [00:54<00:08,  4.18it/s] 83%|████████▎ | 161/195 [00:54<00:07,  4.38it/s] 84%|████████▎ | 163/195 [00:54<00:06,  4.74it/s] 85%|████████▍ | 165/195 [00:55<00:06,  4.66it/s] 85%|████████▌ | 166/195 [00:55<00:06,  4.56it/s] 86%|████████▌ | 167/195 [00:55<00:06,  4.17it/s] 86%|████████▌ | 168/195 [00:56<00:06,  3.93it/s] 87%|████████▋ | 169/195 [00:56<00:06,  3.92it/s] 87%|████████▋ | 170/195 [00:56<00:06,  3.63it/s] 88%|████████▊ | 171/195 [00:56<00:05,  4.01it/s] 88%|████████▊ | 172/195 [00:57<00:06,  3.62it/s] 89%|████████▊ | 173/195 [00:57<00:05,  4.12it/s] 89%|████████▉ | 174/195 [00:57<00:05,  3.75it/s] 90%|█████████ | 176/195 [00:58<00:05,  3.78it/s] 91%|█████████ | 177/195 [00:58<00:05,  3.17it/s] 91%|█████████▏| 178/195 [00:58<00:04,  3.67it/s] 92%|█████████▏| 179/195 [00:59<00:04,  3.47it/s] 92%|█████████▏| 180/195 [00:59<00:03,  3.87it/s] 93%|█████████▎| 181/195 [01:00<00:06,  2.21it/s] 94%|█████████▍| 183/195 [01:01<00:05,  2.06it/s] 95%|█████████▍| 185/195 [01:02<00:05,  1.96it/s] 96%|█████████▌| 187/195 [01:03<00:04,  1.99it/s] 97%|█████████▋| 189/195 [01:03<00:02,  2.44it/s] 98%|█████████▊| 191/195 [01:04<00:01,  2.78it/s] 98%|█████████▊| 192/195 [01:04<00:01,  2.99it/s] 99%|█████████▉| 193/195 [01:05<00:00,  2.71it/s] 99%|█████████▉| 194/195 [01:05<00:00,  2.94it/s]100%|██████████| 195/195 [01:05<00:00,  3.07it/s]100%|██████████| 195/195 [01:07<00:00,  2.88it/s]
2025-08-21 08:06:30 [info     ] Validating outputs
2025-08-21 08:06:30 [info     ] Predict - end                  time=0:1:7
2025-08-21 08:06:30 [info     ] Evaluate - start               split=test
2025-08-21 08:06:30 [info     ] Evaluate - end                 correctness_llm=0.24 monotonicity=-0.4
2025-08-21 08:06:30 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:06:30 [info     ] Augmenting questions for IRT estimation num_questions=22
2025-08-21 08:06:30 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:06:30 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1213.43it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3703.29it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 402.69it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8981.38it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 964.56it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 4060.41it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 431.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8030.67it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1109.52it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3777.78it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 477.20it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8013.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1173.56it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3647.95it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 646.70it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8006.58it/s]
2025-08-21 08:06:33 INFO: EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
2025-08-21 08:06:33 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:06:33 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:06:33 [info     ] Evaluate question difficulty - end rmse=3.134778455544282 split=test
2025-08-21 08:06:33 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 3 finished: 0:1:21

 ========== Config: llama3.2:3b~T_0.0~SO_teacher_kt~L_5~SP_teacher_marshmellow_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_miscon_studentlevel_random0 ==========
Config 4/8

 ********** Run: 1/3 **********
2025-08-21 08:06:54 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:06:54 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:06:54 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:06:54 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:06:56 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:06:56 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:07:01 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:07:01 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:07:01 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:07:01 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:07:05 [info     ] Setting seed                   value=43
2025-08-21 08:07:05 [info     ] Building structured outputter  name=teacher_kt
2025-08-21 08:07:05 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_marshmellow_level_nocontext
2025-08-21 08:07:05 [info     ] Building model                 name=llama3.2:3b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:07:05 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:03<12:04,  3.73s/it]  2%|▏         | 3/195 [00:05<04:49,  1.51s/it]  2%|▏         | 4/195 [00:05<03:21,  1.06s/it]  3%|▎         | 5/195 [00:05<02:43,  1.16it/s]  3%|▎         | 6/195 [00:06<02:24,  1.31it/s]  4%|▎         | 7/195 [00:06<01:53,  1.65it/s]  4%|▍         | 8/195 [00:06<01:31,  2.05it/s]  5%|▍         | 9/195 [00:07<01:26,  2.15it/s]  5%|▌         | 10/195 [00:07<01:05,  2.81it/s]  6%|▌         | 11/195 [00:08<01:25,  2.15it/s]  7%|▋         | 13/195 [00:08<01:10,  2.60it/s]  7%|▋         | 14/195 [00:08<01:03,  2.86it/s]  8%|▊         | 15/195 [00:09<01:14,  2.41it/s]  8%|▊         | 16/195 [00:09<01:03,  2.84it/s]  9%|▊         | 17/195 [00:10<00:59,  2.99it/s]  9%|▉         | 18/195 [00:10<00:51,  3.42it/s] 10%|▉         | 19/195 [00:10<00:52,  3.34it/s] 10%|█         | 20/195 [00:10<00:59,  2.93it/s] 11%|█▏        | 22/195 [00:11<00:51,  3.36it/s] 12%|█▏        | 23/195 [00:11<00:45,  3.80it/s] 12%|█▏        | 24/195 [00:11<00:48,  3.54it/s] 13%|█▎        | 25/195 [00:12<00:40,  4.20it/s] 13%|█▎        | 26/195 [00:12<01:02,  2.69it/s] 14%|█▍        | 27/195 [00:12<00:50,  3.34it/s] 14%|█▍        | 28/195 [00:13<01:10,  2.37it/s] 15%|█▍        | 29/195 [00:13<00:57,  2.88it/s] 15%|█▌        | 30/195 [00:14<01:07,  2.43it/s] 16%|█▌        | 31/195 [00:14<00:56,  2.90it/s] 16%|█▋        | 32/195 [00:14<00:59,  2.75it/s] 17%|█▋        | 33/195 [00:15<00:51,  3.16it/s] 17%|█▋        | 34/195 [00:15<00:54,  2.98it/s] 18%|█▊        | 35/195 [00:15<00:43,  3.67it/s] 18%|█▊        | 36/195 [00:16<01:03,  2.50it/s] 19%|█▉        | 38/195 [00:17<01:02,  2.52it/s] 21%|██        | 40/195 [00:17<01:01,  2.51it/s] 22%|██▏       | 42/195 [00:18<01:01,  2.47it/s] 22%|██▏       | 43/195 [00:18<00:52,  2.88it/s] 23%|██▎       | 44/195 [00:19<00:58,  2.57it/s] 23%|██▎       | 45/195 [00:19<00:51,  2.92it/s] 24%|██▎       | 46/195 [00:20<00:58,  2.53it/s] 24%|██▍       | 47/195 [00:20<00:47,  3.13it/s] 25%|██▍       | 48/195 [00:20<00:57,  2.54it/s] 25%|██▌       | 49/195 [00:21<00:47,  3.06it/s] 26%|██▌       | 50/195 [00:21<01:06,  2.20it/s] 26%|██▌       | 51/195 [00:21<00:52,  2.74it/s] 27%|██▋       | 52/195 [00:22<00:52,  2.70it/s] 27%|██▋       | 53/195 [00:22<00:59,  2.40it/s] 28%|██▊       | 54/195 [00:23<00:58,  2.42it/s] 29%|██▊       | 56/195 [00:23<00:50,  2.78it/s] 30%|██▉       | 58/195 [00:24<00:45,  3.02it/s] 31%|███       | 60/195 [00:24<00:40,  3.29it/s] 31%|███▏      | 61/195 [00:25<00:37,  3.53it/s] 32%|███▏      | 62/195 [00:25<00:38,  3.46it/s] 32%|███▏      | 63/195 [00:26<00:47,  2.76it/s] 33%|███▎      | 64/195 [00:26<00:44,  2.94it/s] 33%|███▎      | 65/195 [00:26<00:40,  3.24it/s] 34%|███▍      | 66/195 [00:26<00:35,  3.64it/s] 34%|███▍      | 67/195 [00:27<00:35,  3.58it/s] 35%|███▍      | 68/195 [00:27<00:30,  4.18it/s] 35%|███▌      | 69/195 [00:27<00:34,  3.67it/s] 36%|███▌      | 70/195 [00:27<00:27,  4.48it/s] 36%|███▋      | 71/195 [00:28<00:51,  2.43it/s] 37%|███▋      | 73/195 [00:29<00:52,  2.32it/s] 38%|███▊      | 75/195 [00:29<00:40,  2.96it/s] 39%|███▉      | 77/195 [00:30<00:33,  3.47it/s] 41%|████      | 79/195 [00:30<00:30,  3.77it/s] 42%|████▏     | 81/195 [00:31<00:28,  3.99it/s] 43%|████▎     | 83/195 [00:31<00:26,  4.26it/s] 43%|████▎     | 84/195 [00:31<00:24,  4.53it/s] 44%|████▎     | 85/195 [00:32<00:27,  4.03it/s] 44%|████▍     | 86/195 [00:32<00:33,  3.25it/s] 45%|████▍     | 87/195 [00:32<00:34,  3.17it/s] 45%|████▌     | 88/195 [00:32<00:28,  3.73it/s] 46%|████▌     | 89/195 [00:33<00:30,  3.44it/s] 46%|████▌     | 90/195 [00:33<00:25,  4.04it/s] 47%|████▋     | 91/195 [00:33<00:30,  3.40it/s] 47%|████▋     | 92/195 [00:34<00:26,  3.90it/s] 48%|████▊     | 93/195 [00:34<00:28,  3.55it/s] 48%|████▊     | 94/195 [00:34<00:25,  3.98it/s] 49%|████▊     | 95/195 [00:34<00:25,  3.91it/s] 49%|████▉     | 96/195 [00:35<00:34,  2.85it/s] 50%|████▉     | 97/195 [00:35<00:32,  2.97it/s] 50%|█████     | 98/195 [00:36<00:39,  2.46it/s] 51%|█████     | 99/195 [00:36<00:35,  2.73it/s] 51%|█████▏    | 100/195 [00:37<00:38,  2.48it/s] 52%|█████▏    | 101/195 [00:37<00:34,  2.72it/s] 52%|█████▏    | 102/195 [00:37<00:31,  2.93it/s] 53%|█████▎    | 103/195 [00:37<00:31,  2.92it/s] 53%|█████▎    | 104/195 [00:38<00:28,  3.23it/s] 54%|█████▍    | 105/195 [00:38<00:29,  3.02it/s] 54%|█████▍    | 106/195 [00:38<00:24,  3.61it/s] 55%|█████▍    | 107/195 [00:39<00:28,  3.11it/s] 56%|█████▌    | 109/195 [00:39<00:27,  3.12it/s] 57%|█████▋    | 111/195 [00:40<00:25,  3.27it/s] 58%|█████▊    | 113/195 [00:40<00:25,  3.24it/s] 58%|█████▊    | 114/195 [00:41<00:23,  3.49it/s] 59%|█████▉    | 115/195 [00:41<00:24,  3.21it/s] 60%|██████    | 117/195 [00:42<00:22,  3.43it/s] 61%|██████    | 119/195 [00:42<00:21,  3.54it/s] 62%|██████▏   | 120/195 [00:42<00:18,  4.01it/s] 62%|██████▏   | 121/195 [00:43<00:24,  3.04it/s] 63%|██████▎   | 122/195 [00:43<00:21,  3.44it/s] 63%|██████▎   | 123/195 [00:44<00:25,  2.79it/s] 64%|██████▎   | 124/195 [00:44<00:22,  3.13it/s] 64%|██████▍   | 125/195 [00:44<00:26,  2.65it/s] 65%|██████▍   | 126/195 [00:45<00:24,  2.81it/s] 65%|██████▌   | 127/195 [00:45<00:24,  2.74it/s] 66%|██████▌   | 128/195 [00:45<00:24,  2.72it/s] 66%|██████▌   | 129/195 [00:46<00:24,  2.73it/s] 67%|██████▋   | 130/195 [00:46<00:25,  2.58it/s] 67%|██████▋   | 131/195 [00:47<00:26,  2.41it/s] 68%|██████▊   | 132/195 [00:47<00:25,  2.47it/s] 68%|██████▊   | 133/195 [00:48<00:27,  2.27it/s] 69%|██████▊   | 134/195 [00:48<00:25,  2.35it/s] 70%|██████▉   | 136/195 [00:48<00:19,  3.02it/s] 71%|███████   | 138/195 [00:49<00:16,  3.52it/s] 72%|███████▏  | 140/195 [00:49<00:14,  3.83it/s] 72%|███████▏  | 141/195 [00:50<00:15,  3.39it/s] 73%|███████▎  | 142/195 [00:50<00:15,  3.34it/s] 73%|███████▎  | 143/195 [00:50<00:16,  3.08it/s] 74%|███████▍  | 144/195 [00:51<00:16,  3.09it/s] 74%|███████▍  | 145/195 [00:51<00:17,  2.78it/s] 75%|███████▍  | 146/195 [00:52<00:17,  2.75it/s] 75%|███████▌  | 147/195 [00:52<00:19,  2.50it/s] 76%|███████▋  | 149/195 [00:53<00:15,  2.94it/s] 77%|███████▋  | 150/195 [00:53<00:14,  3.05it/s] 77%|███████▋  | 151/195 [00:53<00:13,  3.26it/s] 78%|███████▊  | 152/195 [00:53<00:12,  3.48it/s] 78%|███████▊  | 153/195 [00:54<00:12,  3.47it/s] 79%|███████▉  | 154/195 [00:54<00:10,  3.92it/s] 79%|███████▉  | 155/195 [00:54<00:10,  3.85it/s] 80%|████████  | 156/195 [00:54<00:11,  3.32it/s] 81%|████████  | 157/195 [00:55<00:11,  3.33it/s] 81%|████████  | 158/195 [00:55<00:11,  3.10it/s] 82%|████████▏ | 160/195 [00:56<00:09,  3.75it/s] 83%|████████▎ | 161/195 [00:56<00:07,  4.36it/s] 83%|████████▎ | 162/195 [00:56<00:08,  3.67it/s] 84%|████████▎ | 163/195 [00:57<00:10,  3.00it/s] 84%|████████▍ | 164/195 [00:57<00:10,  3.01it/s] 85%|████████▍ | 165/195 [00:57<00:08,  3.62it/s] 85%|████████▌ | 166/195 [00:58<00:12,  2.40it/s] 86%|████████▌ | 167/195 [00:58<00:09,  3.05it/s] 86%|████████▌ | 168/195 [00:59<00:11,  2.28it/s] 87%|████████▋ | 169/195 [00:59<00:08,  2.94it/s] 87%|████████▋ | 170/195 [00:59<00:09,  2.71it/s] 88%|████████▊ | 171/195 [00:59<00:07,  3.09it/s] 88%|████████▊ | 172/195 [01:00<00:06,  3.45it/s] 89%|████████▊ | 173/195 [01:00<00:06,  3.65it/s] 89%|████████▉ | 174/195 [01:00<00:05,  4.11it/s] 90%|████████▉ | 175/195 [01:00<00:05,  3.99it/s] 90%|█████████ | 176/195 [01:01<00:05,  3.27it/s] 91%|█████████ | 177/195 [01:01<00:05,  3.35it/s] 91%|█████████▏| 178/195 [01:01<00:05,  2.84it/s] 92%|█████████▏| 179/195 [01:02<00:05,  3.06it/s] 92%|█████████▏| 180/195 [01:02<00:05,  2.78it/s] 93%|█████████▎| 181/195 [01:02<00:04,  3.10it/s] 93%|█████████▎| 182/195 [01:03<00:05,  2.49it/s] 94%|█████████▍| 183/195 [01:03<00:04,  2.66it/s] 94%|█████████▍| 184/195 [01:04<00:04,  2.53it/s] 95%|█████████▌| 186/195 [01:04<00:03,  2.68it/s] 96%|█████████▋| 188/195 [01:05<00:02,  2.75it/s] 97%|█████████▋| 190/195 [01:06<00:01,  3.03it/s] 98%|█████████▊| 191/195 [01:06<00:01,  3.35it/s] 98%|█████████▊| 192/195 [01:06<00:00,  3.28it/s] 99%|█████████▉| 193/195 [01:06<00:00,  3.81it/s] 99%|█████████▉| 194/195 [01:07<00:00,  3.45it/s]100%|██████████| 195/195 [01:09<00:00,  2.80it/s]
2025-08-21 08:08:14 [info     ] Validating outputs
2025-08-21 08:08:14 [info     ] Predict - end                  time=0:1:9
2025-08-21 08:08:14 [info     ] Evaluate - start               split=test
2025-08-21 08:08:14 [info     ] Evaluate - end                 correctness_llm=0.08 monotonicity=0.93
2025-08-21 08:08:14 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:08:14 [info     ] Augmenting questions for IRT estimation num_questions=32
2025-08-21 08:08:14 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:08:14 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 987.29it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3660.93it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 461.49it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5295.84it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 962.94it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3912.69it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 545.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5458.29it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 915.39it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3441.50it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 542.62it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6166.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 939.89it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3390.57it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 594.22it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5519.86it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 908.67it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3640.24it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 661.26it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5846.30it/s]
2025-08-21 08:08:18 INFO: EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
2025-08-21 08:08:18 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:08:18 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:08:18 [info     ] Evaluate question difficulty - end rmse=2.9017106578832954 split=test
2025-08-21 08:08:18 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 1 finished: 0:1:24

 ********** Run: 2/3 **********
2025-08-21 08:08:39 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:08:39 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:08:39 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:08:39 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:08:41 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:08:41 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:08:46 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:08:46 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:08:46 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:08:46 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:08:49 [info     ] Setting seed                   value=44
2025-08-21 08:08:49 [info     ] Building structured outputter  name=teacher_kt
2025-08-21 08:08:49 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_marshmellow_level_nocontext
2025-08-21 08:08:49 [info     ] Building model                 name=llama3.2:3b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:08:49 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<05:10,  1.60s/it]  2%|▏         | 3/195 [00:02<02:51,  1.12it/s]  2%|▏         | 4/195 [00:03<02:02,  1.56it/s]  3%|▎         | 5/195 [00:03<02:01,  1.56it/s]  3%|▎         | 6/195 [00:04<01:43,  1.83it/s]  4%|▍         | 8/195 [00:04<01:14,  2.51it/s]  5%|▍         | 9/195 [00:04<01:04,  2.90it/s]  5%|▌         | 10/195 [00:04<00:58,  3.16it/s]  6%|▌         | 11/195 [00:05<01:06,  2.77it/s]  6%|▌         | 12/195 [00:05<00:56,  3.25it/s]  7%|▋         | 13/195 [00:06<01:06,  2.74it/s]  7%|▋         | 14/195 [00:06<00:56,  3.23it/s]  8%|▊         | 15/195 [00:06<00:56,  3.19it/s]  8%|▊         | 16/195 [00:07<01:03,  2.81it/s]  9%|▉         | 18/195 [00:07<00:51,  3.42it/s] 10%|▉         | 19/195 [00:07<00:43,  4.05it/s] 10%|█         | 20/195 [00:07<00:47,  3.66it/s] 11%|█         | 21/195 [00:08<00:40,  4.27it/s] 11%|█▏        | 22/195 [00:08<00:46,  3.75it/s] 12%|█▏        | 23/195 [00:08<00:38,  4.51it/s] 12%|█▏        | 24/195 [00:08<00:41,  4.10it/s] 13%|█▎        | 25/195 [00:08<00:35,  4.73it/s] 13%|█▎        | 26/195 [00:09<01:02,  2.72it/s] 14%|█▍        | 27/195 [00:09<00:49,  3.42it/s] 14%|█▍        | 28/195 [00:10<01:09,  2.41it/s] 15%|█▍        | 29/195 [00:10<00:56,  2.95it/s] 15%|█▌        | 30/195 [00:11<01:04,  2.54it/s] 16%|█▌        | 31/195 [00:11<00:53,  3.06it/s] 16%|█▋        | 32/195 [00:11<00:51,  3.14it/s] 17%|█▋        | 33/195 [00:11<00:45,  3.60it/s] 17%|█▋        | 34/195 [00:12<00:47,  3.41it/s] 18%|█▊        | 35/195 [00:12<00:38,  4.15it/s] 18%|█▊        | 36/195 [00:12<00:55,  2.88it/s] 19%|█▉        | 38/195 [00:13<00:52,  2.96it/s] 21%|██        | 40/195 [00:14<00:52,  2.94it/s] 21%|██        | 41/195 [00:14<00:44,  3.45it/s] 22%|██▏       | 42/195 [00:14<00:56,  2.72it/s] 23%|██▎       | 44/195 [00:15<00:49,  3.04it/s] 23%|██▎       | 45/195 [00:15<00:44,  3.35it/s] 24%|██▎       | 46/195 [00:16<00:54,  2.74it/s] 24%|██▍       | 47/195 [00:16<00:44,  3.30it/s] 25%|██▍       | 48/195 [00:17<00:58,  2.50it/s] 25%|██▌       | 49/195 [00:17<00:50,  2.88it/s] 26%|██▌       | 50/195 [00:18<01:06,  2.18it/s] 26%|██▌       | 51/195 [00:18<00:53,  2.71it/s] 27%|██▋       | 52/195 [00:18<00:53,  2.68it/s] 27%|██▋       | 53/195 [00:18<00:55,  2.57it/s] 28%|██▊       | 54/195 [00:19<00:55,  2.56it/s] 29%|██▊       | 56/195 [00:19<00:45,  3.08it/s] 30%|██▉       | 58/195 [00:20<00:42,  3.22it/s] 31%|███       | 60/195 [00:20<00:39,  3.43it/s] 31%|███▏      | 61/195 [00:21<00:36,  3.66it/s] 32%|███▏      | 62/195 [00:21<00:37,  3.54it/s] 32%|███▏      | 63/195 [00:22<00:48,  2.72it/s] 33%|███▎      | 64/195 [00:22<00:43,  2.98it/s] 33%|███▎      | 65/195 [00:22<00:39,  3.31it/s] 34%|███▍      | 66/195 [00:22<00:33,  3.79it/s] 34%|███▍      | 67/195 [00:22<00:33,  3.86it/s] 35%|███▍      | 68/195 [00:23<00:27,  4.54it/s] 35%|███▌      | 69/195 [00:23<00:30,  4.14it/s] 36%|███▋      | 71/195 [00:24<00:37,  3.27it/s] 37%|███▋      | 73/195 [00:24<00:41,  2.91it/s] 38%|███▊      | 75/195 [00:25<00:34,  3.46it/s] 39%|███▉      | 77/195 [00:25<00:30,  3.89it/s] 41%|████      | 79/195 [00:26<00:27,  4.19it/s] 42%|████▏     | 81/195 [00:26<00:26,  4.30it/s] 43%|████▎     | 83/195 [00:26<00:24,  4.53it/s] 43%|████▎     | 84/195 [00:27<00:23,  4.66it/s] 44%|████▎     | 85/195 [00:27<00:26,  4.14it/s] 44%|████▍     | 86/195 [00:27<00:32,  3.34it/s] 45%|████▍     | 87/195 [00:28<00:33,  3.23it/s] 45%|████▌     | 88/195 [00:28<00:28,  3.79it/s] 46%|████▌     | 89/195 [00:28<00:29,  3.53it/s] 46%|████▌     | 90/195 [00:28<00:24,  4.21it/s] 47%|████▋     | 91/195 [00:29<00:28,  3.69it/s] 47%|████▋     | 92/195 [00:29<00:23,  4.30it/s] 48%|████▊     | 93/195 [00:29<00:26,  3.90it/s] 48%|████▊     | 94/195 [00:29<00:23,  4.30it/s] 49%|████▊     | 95/195 [00:30<00:24,  4.15it/s] 49%|████▉     | 96/195 [00:30<00:33,  2.95it/s] 50%|████▉     | 97/195 [00:30<00:30,  3.26it/s] 50%|█████     | 98/195 [00:31<00:36,  2.64it/s] 51%|█████     | 99/195 [00:31<00:31,  3.04it/s] 51%|█████▏    | 100/195 [00:32<00:34,  2.78it/s] 52%|█████▏    | 101/195 [00:32<00:30,  3.04it/s] 52%|█████▏    | 102/195 [00:32<00:29,  3.18it/s] 53%|█████▎    | 103/195 [00:33<00:29,  3.14it/s] 53%|█████▎    | 104/195 [00:33<00:26,  3.45it/s] 54%|█████▍    | 105/195 [00:33<00:28,  3.16it/s] 54%|█████▍    | 106/195 [00:33<00:23,  3.75it/s] 55%|█████▍    | 107/195 [00:34<00:27,  3.20it/s] 56%|█████▌    | 109/195 [00:34<00:25,  3.31it/s] 57%|█████▋    | 111/195 [00:35<00:24,  3.50it/s] 58%|█████▊    | 113/195 [00:35<00:23,  3.43it/s] 58%|█████▊    | 114/195 [00:36<00:21,  3.71it/s] 59%|█████▉    | 115/195 [00:36<00:23,  3.36it/s] 60%|██████    | 117/195 [00:36<00:21,  3.55it/s] 61%|██████    | 119/195 [00:37<00:20,  3.63it/s] 62%|██████▏   | 120/195 [00:37<00:18,  4.11it/s] 62%|██████▏   | 121/195 [00:38<00:24,  3.05it/s] 63%|██████▎   | 122/195 [00:38<00:21,  3.45it/s] 63%|██████▎   | 123/195 [00:38<00:25,  2.78it/s] 64%|██████▎   | 124/195 [00:39<00:25,  2.84it/s] 64%|██████▍   | 125/195 [00:39<00:29,  2.35it/s] 65%|██████▍   | 126/195 [00:40<00:27,  2.47it/s] 65%|██████▌   | 127/195 [00:40<00:28,  2.37it/s] 66%|██████▌   | 128/195 [00:41<00:28,  2.38it/s] 66%|██████▌   | 129/195 [00:41<00:27,  2.42it/s] 67%|██████▋   | 130/195 [00:42<00:28,  2.28it/s] 67%|██████▋   | 131/195 [00:42<00:27,  2.29it/s] 68%|██████▊   | 132/195 [00:42<00:25,  2.47it/s] 68%|██████▊   | 133/195 [00:43<00:25,  2.43it/s] 69%|██████▊   | 134/195 [00:43<00:23,  2.61it/s] 70%|██████▉   | 136/195 [00:43<00:17,  3.39it/s] 71%|███████   | 138/195 [00:44<00:14,  3.97it/s] 72%|███████▏  | 140/195 [00:44<00:12,  4.33it/s] 72%|███████▏  | 141/195 [00:45<00:14,  3.75it/s] 73%|███████▎  | 142/195 [00:45<00:15,  3.40it/s] 73%|███████▎  | 143/195 [00:45<00:17,  2.98it/s] 74%|███████▍  | 144/195 [00:46<00:17,  2.92it/s] 74%|███████▍  | 145/195 [00:46<00:19,  2.63it/s] 75%|███████▍  | 146/195 [00:47<00:18,  2.64it/s] 75%|███████▌  | 147/195 [00:47<00:19,  2.45it/s] 76%|███████▋  | 149/195 [00:48<00:15,  2.90it/s] 77%|███████▋  | 150/195 [00:48<00:14,  3.03it/s] 77%|███████▋  | 151/195 [00:48<00:13,  3.24it/s] 78%|███████▊  | 152/195 [00:48<00:12,  3.53it/s] 78%|███████▊  | 153/195 [00:49<00:11,  3.63it/s] 79%|███████▉  | 154/195 [00:49<00:10,  4.08it/s] 79%|███████▉  | 155/195 [00:49<00:10,  3.97it/s] 80%|████████  | 156/195 [00:50<00:11,  3.42it/s] 81%|████████  | 157/195 [00:50<00:11,  3.41it/s] 81%|████████  | 158/195 [00:50<00:11,  3.19it/s] 82%|████████▏ | 160/195 [00:51<00:09,  3.51it/s] 83%|████████▎ | 161/195 [00:51<00:08,  4.08it/s] 83%|████████▎ | 162/195 [00:51<00:09,  3.48it/s] 84%|████████▎ | 163/195 [00:52<00:11,  2.91it/s] 84%|████████▍ | 164/195 [00:52<00:10,  2.95it/s] 85%|████████▍ | 165/195 [00:52<00:08,  3.57it/s] 85%|████████▌ | 166/195 [00:53<00:12,  2.32it/s] 86%|████████▌ | 167/195 [00:53<00:09,  2.96it/s] 86%|████████▌ | 168/195 [00:54<00:12,  2.17it/s] 87%|████████▋ | 169/195 [00:54<00:09,  2.79it/s] 87%|████████▋ | 170/195 [00:54<00:10,  2.44it/s] 88%|████████▊ | 171/195 [00:55<00:08,  2.77it/s] 88%|████████▊ | 172/195 [00:55<00:07,  3.08it/s] 89%|████████▊ | 173/195 [00:55<00:07,  3.13it/s] 89%|████████▉ | 174/195 [00:55<00:05,  3.53it/s] 90%|████████▉ | 175/195 [00:56<00:05,  3.46it/s] 90%|█████████ | 176/195 [00:56<00:06,  2.85it/s] 91%|█████████ | 177/195 [00:57<00:06,  2.95it/s] 91%|█████████▏| 178/195 [00:57<00:07,  2.41it/s] 92%|█████████▏| 179/195 [00:57<00:05,  2.77it/s] 92%|█████████▏| 180/195 [00:58<00:05,  2.62it/s] 93%|█████████▎| 181/195 [00:58<00:04,  2.97it/s] 93%|█████████▎| 182/195 [00:59<00:05,  2.45it/s] 94%|█████████▍| 183/195 [00:59<00:04,  2.65it/s] 94%|█████████▍| 184/195 [00:59<00:04,  2.38it/s] 95%|█████████▌| 186/195 [01:00<00:03,  2.42it/s] 96%|█████████▋| 188/195 [01:01<00:02,  2.44it/s] 97%|█████████▋| 190/195 [01:02<00:01,  2.64it/s] 98%|█████████▊| 191/195 [01:02<00:01,  2.93it/s] 98%|█████████▊| 192/195 [01:02<00:01,  2.86it/s] 99%|█████████▉| 193/195 [01:02<00:00,  3.33it/s] 99%|█████████▉| 194/195 [01:03<00:00,  2.98it/s]100%|██████████| 195/195 [01:03<00:00,  3.67it/s]100%|██████████| 195/195 [01:05<00:00,  2.96it/s]
2025-08-21 08:09:55 [info     ] Validating outputs
2025-08-21 08:09:55 [info     ] Predict - end                  time=0:1:5
2025-08-21 08:09:55 [info     ] Evaluate - start               split=test
2025-08-21 08:09:55 [info     ] Evaluate - end                 correctness_llm=0.08 monotonicity=0.89
2025-08-21 08:09:55 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:09:55 [info     ] Augmenting questions for IRT estimation num_questions=33
2025-08-21 08:09:55 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:09:55 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1126.72it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3319.15it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 509.71it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7712.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1067.10it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3502.74it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 524.27it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7704.05it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 970.01it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3946.48it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 590.77it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7425.42it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1071.62it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3555.04it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 627.41it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7453.70it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 991.76it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3678.55it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 629.38it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7505.15it/s]
2025-08-21 08:09:59 INFO: EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
2025-08-21 08:09:59 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:09:59 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:09:59 [info     ] Evaluate question difficulty - end rmse=2.9650245157786865 split=test
2025-08-21 08:09:59 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 2 finished: 0:1:19

 ********** Run: 3/3 **********
2025-08-21 08:10:22 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:10:22 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:10:22 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:10:22 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:10:24 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:10:24 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:10:28 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:10:28 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:10:28 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:10:29 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:10:32 [info     ] Setting seed                   value=45
2025-08-21 08:10:32 [info     ] Building structured outputter  name=teacher_kt
2025-08-21 08:10:32 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_marshmellow_level_nocontext
2025-08-21 08:10:32 [info     ] Building model                 name=llama3.2:3b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:10:32 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<05:18,  1.64s/it]  2%|▏         | 3/195 [00:02<02:54,  1.10it/s]  3%|▎         | 5/195 [00:03<01:46,  1.78it/s]  3%|▎         | 6/195 [00:03<01:28,  2.14it/s]  4%|▎         | 7/195 [00:04<01:30,  2.07it/s]  4%|▍         | 8/195 [00:04<01:39,  1.88it/s]  5%|▍         | 9/195 [00:04<01:16,  2.42it/s]  5%|▌         | 10/195 [00:05<01:14,  2.47it/s]  6%|▌         | 12/195 [00:05<01:06,  2.77it/s]  7%|▋         | 13/195 [00:06<01:00,  3.01it/s]  7%|▋         | 14/195 [00:06<01:06,  2.74it/s]  8%|▊         | 15/195 [00:06<00:54,  3.29it/s]  8%|▊         | 16/195 [00:07<00:55,  3.22it/s]  9%|▊         | 17/195 [00:07<00:49,  3.59it/s]  9%|▉         | 18/195 [00:07<01:00,  2.95it/s] 10%|█         | 20/195 [00:08<00:48,  3.60it/s] 11%|█▏        | 22/195 [00:08<00:43,  3.95it/s] 12%|█▏        | 24/195 [00:09<00:42,  4.03it/s] 13%|█▎        | 25/195 [00:09<00:37,  4.55it/s] 13%|█▎        | 26/195 [00:09<00:57,  2.92it/s] 14%|█▍        | 27/195 [00:10<00:48,  3.48it/s] 14%|█▍        | 28/195 [00:10<01:08,  2.46it/s] 15%|█▍        | 29/195 [00:10<00:56,  2.94it/s] 15%|█▌        | 30/195 [00:11<01:08,  2.40it/s] 16%|█▌        | 31/195 [00:11<00:57,  2.84it/s] 16%|█▋        | 32/195 [00:12<00:58,  2.76it/s] 17%|█▋        | 33/195 [00:12<00:49,  3.29it/s] 17%|█▋        | 34/195 [00:12<00:52,  3.07it/s] 18%|█▊        | 35/195 [00:12<00:43,  3.69it/s] 18%|█▊        | 36/195 [00:13<01:02,  2.56it/s] 19%|█▉        | 38/195 [00:14<01:01,  2.56it/s] 21%|██        | 40/195 [00:15<01:00,  2.54it/s] 22%|██▏       | 42/195 [00:15<01:00,  2.54it/s] 23%|██▎       | 44/195 [00:16<00:54,  2.75it/s] 23%|██▎       | 45/195 [00:16<00:50,  2.96it/s] 24%|██▎       | 46/195 [00:17<00:57,  2.58it/s] 24%|██▍       | 47/195 [00:17<00:47,  3.10it/s] 25%|██▍       | 48/195 [00:18<00:56,  2.59it/s] 25%|██▌       | 49/195 [00:18<00:47,  3.07it/s] 26%|██▌       | 50/195 [00:18<00:59,  2.42it/s] 26%|██▌       | 51/195 [00:18<00:49,  2.93it/s] 27%|██▋       | 52/195 [00:19<00:51,  2.80it/s] 27%|██▋       | 53/195 [00:19<00:55,  2.55it/s] 28%|██▊       | 54/195 [00:20<00:55,  2.53it/s] 29%|██▊       | 56/195 [00:20<00:47,  2.91it/s] 30%|██▉       | 58/195 [00:21<00:43,  3.15it/s] 31%|███       | 60/195 [00:21<00:38,  3.51it/s] 31%|███▏      | 61/195 [00:22<00:36,  3.66it/s] 32%|███▏      | 62/195 [00:22<00:37,  3.55it/s] 32%|███▏      | 63/195 [00:22<00:48,  2.73it/s] 33%|███▎      | 64/195 [00:23<00:45,  2.88it/s] 33%|███▎      | 65/195 [00:23<00:40,  3.18it/s] 34%|███▍      | 66/195 [00:23<00:37,  3.48it/s] 34%|███▍      | 67/195 [00:24<00:36,  3.47it/s] 35%|███▍      | 68/195 [00:24<00:31,  4.08it/s] 35%|███▌      | 69/195 [00:24<00:34,  3.68it/s] 36%|███▋      | 71/195 [00:25<00:43,  2.86it/s] 37%|███▋      | 73/195 [00:26<00:49,  2.46it/s] 38%|███▊      | 75/195 [00:26<00:39,  3.02it/s] 39%|███▉      | 77/195 [00:27<00:33,  3.51it/s] 41%|████      | 79/195 [00:27<00:30,  3.82it/s] 42%|████▏     | 81/195 [00:28<00:28,  3.96it/s] 43%|████▎     | 83/195 [00:28<00:28,  3.99it/s] 43%|████▎     | 84/195 [00:28<00:26,  4.21it/s] 44%|████▎     | 85/195 [00:29<00:27,  3.98it/s] 44%|████▍     | 86/195 [00:29<00:33,  3.28it/s] 45%|████▍     | 87/195 [00:29<00:33,  3.19it/s] 45%|████▌     | 88/195 [00:29<00:28,  3.74it/s] 46%|████▌     | 89/195 [00:30<00:31,  3.41it/s] 46%|████▌     | 90/195 [00:30<00:26,  3.91it/s] 47%|████▋     | 91/195 [00:30<00:31,  3.34it/s] 47%|████▋     | 92/195 [00:31<00:26,  3.88it/s] 48%|████▊     | 93/195 [00:31<00:29,  3.47it/s] 48%|████▊     | 94/195 [00:31<00:26,  3.81it/s] 49%|████▊     | 95/195 [00:31<00:27,  3.66it/s] 49%|████▉     | 96/195 [00:32<00:39,  2.52it/s] 50%|████▉     | 97/195 [00:32<00:35,  2.76it/s] 50%|█████     | 98/195 [00:33<00:43,  2.24it/s] 51%|█████     | 99/195 [00:33<00:36,  2.60it/s] 51%|█████▏    | 100/195 [00:34<00:39,  2.40it/s] 52%|█████▏    | 101/195 [00:34<00:35,  2.65it/s] 52%|█████▏    | 102/195 [00:34<00:32,  2.87it/s] 53%|█████▎    | 103/195 [00:35<00:31,  2.90it/s] 53%|█████▎    | 104/195 [00:35<00:28,  3.24it/s] 54%|█████▍    | 105/195 [00:35<00:29,  3.02it/s] 54%|█████▍    | 106/195 [00:35<00:24,  3.59it/s] 55%|█████▍    | 107/195 [00:36<00:28,  3.06it/s] 56%|█████▌    | 109/195 [00:36<00:26,  3.21it/s] 57%|█████▋    | 111/195 [00:37<00:24,  3.36it/s] 58%|█████▊    | 113/195 [00:38<00:23,  3.47it/s] 58%|█████▊    | 114/195 [00:38<00:21,  3.79it/s] 59%|█████▉    | 115/195 [00:38<00:22,  3.51it/s] 60%|██████    | 117/195 [00:39<00:21,  3.63it/s] 61%|██████    | 119/195 [00:39<00:20,  3.68it/s] 62%|██████▏   | 120/195 [00:39<00:18,  4.16it/s] 62%|██████▏   | 121/195 [00:40<00:25,  2.94it/s] 63%|██████▎   | 122/195 [00:40<00:22,  3.28it/s] 63%|██████▎   | 123/195 [00:41<00:27,  2.58it/s] 64%|██████▎   | 124/195 [00:41<00:24,  2.93it/s] 64%|██████▍   | 125/195 [00:42<00:27,  2.53it/s] 65%|██████▍   | 126/195 [00:42<00:25,  2.70it/s] 65%|██████▌   | 127/195 [00:42<00:25,  2.64it/s] 66%|██████▌   | 128/195 [00:43<00:25,  2.66it/s] 66%|██████▌   | 129/195 [00:43<00:24,  2.70it/s] 67%|██████▋   | 130/195 [00:43<00:25,  2.54it/s] 67%|██████▋   | 131/195 [00:44<00:27,  2.35it/s] 68%|██████▊   | 132/195 [00:44<00:26,  2.41it/s] 68%|██████▊   | 133/195 [00:45<00:27,  2.28it/s] 69%|██████▊   | 134/195 [00:45<00:25,  2.39it/s] 70%|██████▉   | 136/195 [00:46<00:19,  3.05it/s] 71%|███████   | 138/195 [00:46<00:16,  3.50it/s] 72%|███████▏  | 140/195 [00:47<00:14,  3.73it/s] 72%|███████▏  | 141/195 [00:47<00:16,  3.24it/s] 73%|███████▎  | 142/195 [00:47<00:17,  3.11it/s] 73%|███████▎  | 143/195 [00:48<00:18,  2.80it/s] 74%|███████▍  | 144/195 [00:48<00:17,  2.85it/s] 74%|███████▍  | 145/195 [00:49<00:18,  2.75it/s] 75%|███████▍  | 146/195 [00:49<00:16,  2.89it/s] 75%|███████▌  | 147/195 [00:49<00:17,  2.73it/s] 76%|███████▋  | 149/195 [00:50<00:14,  3.26it/s] 77%|███████▋  | 150/195 [00:50<00:13,  3.41it/s] 77%|███████▋  | 151/195 [00:50<00:12,  3.63it/s] 78%|███████▊  | 152/195 [00:50<00:11,  3.88it/s] 78%|███████▊  | 153/195 [00:51<00:10,  3.89it/s] 79%|███████▉  | 154/195 [00:51<00:09,  4.28it/s] 79%|███████▉  | 155/195 [00:51<00:10,  3.89it/s] 80%|████████  | 156/195 [00:52<00:11,  3.36it/s] 81%|████████  | 157/195 [00:52<00:11,  3.19it/s] 81%|████████  | 158/195 [00:52<00:13,  2.81it/s] 82%|████████▏ | 160/195 [00:53<00:10,  3.40it/s] 83%|████████▎ | 161/195 [00:53<00:08,  3.97it/s] 83%|████████▎ | 162/195 [00:53<00:09,  3.54it/s] 84%|████████▎ | 163/195 [00:54<00:10,  3.07it/s] 84%|████████▍ | 164/195 [00:54<00:09,  3.18it/s] 85%|████████▍ | 165/195 [00:54<00:07,  3.85it/s] 85%|████████▌ | 166/195 [00:55<00:10,  2.66it/s] 86%|████████▌ | 167/195 [00:55<00:08,  3.38it/s] 86%|████████▌ | 168/195 [00:56<00:11,  2.43it/s] 87%|████████▋ | 169/195 [00:56<00:08,  3.12it/s] 87%|████████▋ | 170/195 [00:56<00:09,  2.72it/s] 88%|████████▊ | 171/195 [00:56<00:07,  3.10it/s] 88%|████████▊ | 172/195 [00:57<00:06,  3.45it/s] 89%|████████▊ | 173/195 [00:57<00:06,  3.66it/s] 89%|████████▉ | 174/195 [00:57<00:05,  4.12it/s] 90%|████████▉ | 175/195 [00:57<00:05,  4.00it/s] 90%|█████████ | 176/195 [00:58<00:05,  3.25it/s] 91%|█████████ | 177/195 [00:58<00:05,  3.37it/s] 91%|█████████▏| 178/195 [00:58<00:05,  2.86it/s] 92%|█████████▏| 179/195 [00:59<00:04,  3.26it/s] 92%|█████████▏| 180/195 [00:59<00:04,  3.04it/s] 93%|█████████▎| 181/195 [00:59<00:04,  3.43it/s] 93%|█████████▎| 182/195 [01:00<00:04,  2.83it/s] 94%|█████████▍| 183/195 [01:00<00:03,  3.05it/s] 94%|█████████▍| 184/195 [01:00<00:03,  2.86it/s] 95%|█████████▌| 186/195 [01:01<00:03,  2.92it/s] 96%|█████████▋| 188/195 [01:02<00:02,  2.90it/s] 97%|█████████▋| 190/195 [01:02<00:01,  3.15it/s] 98%|█████████▊| 191/195 [01:02<00:01,  3.47it/s] 98%|█████████▊| 192/195 [01:03<00:00,  3.34it/s] 99%|█████████▉| 193/195 [01:03<00:00,  3.85it/s] 99%|█████████▉| 194/195 [01:03<00:00,  3.45it/s]100%|██████████| 195/195 [01:06<00:00,  2.95it/s]
2025-08-21 08:11:38 [info     ] Validating outputs
2025-08-21 08:11:38 [info     ] Predict - end                  time=0:1:6
2025-08-21 08:11:38 [info     ] Evaluate - start               split=test
2025-08-21 08:11:38 [info     ] Evaluate - end                 correctness_llm=0.08 monotonicity=0.89
2025-08-21 08:11:38 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:11:38 [info     ] Augmenting questions for IRT estimation num_questions=33
2025-08-21 08:11:38 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:11:38 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1243.97it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3327.73it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 523.21it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8004.40it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1003.66it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3627.49it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 482.18it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8694.15it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1019.66it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3432.04it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 580.91it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8532.44it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1001.54it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3427.15it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 582.39it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7907.39it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 873.87it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3841.12it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 629.15it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8074.84it/s]
2025-08-21 08:11:42 INFO: EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
2025-08-21 08:11:42 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:11:42 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:11:42 [info     ] Evaluate question difficulty - end rmse=2.9650245157786865 split=test
2025-08-21 08:11:42 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 3 finished: 0:1:19

 ========== Config: qwen3:14b~T_0.0~SO_student_kt~L_5~SP_student_chocolate_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_miscon_studentlevel_random0 ==========
Config 5/8

 ********** Run: 1/3 **********
2025-08-21 08:12:05 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:12:05 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:12:05 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:12:05 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:12:07 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:12:07 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:12:12 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:12:12 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:12:12 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:12:13 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:12:16 [info     ] Setting seed                   value=43
2025-08-21 08:12:16 [info     ] Building structured outputter  name=student_kt
2025-08-21 08:12:16 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_chocolate_level_nocontext
2025-08-21 08:12:16 [info     ] Building model                 name=qwen3:14b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:12:16 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:05<18:56,  5.86s/it]  2%|▏         | 3/195 [00:08<08:03,  2.52s/it]  3%|▎         | 5/195 [00:10<05:24,  1.71s/it]  4%|▎         | 7/195 [00:11<03:43,  1.19s/it]  5%|▍         | 9/195 [00:12<02:51,  1.08it/s]  5%|▌         | 10/195 [00:12<02:20,  1.32it/s]  6%|▌         | 11/195 [00:13<02:09,  1.42it/s]  7%|▋         | 13/195 [00:13<01:43,  1.76it/s]  8%|▊         | 15/195 [00:14<01:28,  2.04it/s]  9%|▊         | 17/195 [00:15<01:18,  2.27it/s] 10%|▉         | 19/195 [00:15<01:11,  2.47it/s] 10%|█         | 20/195 [00:16<01:04,  2.71it/s] 11%|█         | 21/195 [00:16<01:06,  2.62it/s] 11%|█▏        | 22/195 [00:16<01:00,  2.87it/s] 12%|█▏        | 23/195 [00:17<01:03,  2.71it/s] 12%|█▏        | 24/195 [00:17<00:57,  2.98it/s] 13%|█▎        | 25/195 [00:17<01:05,  2.59it/s] 13%|█▎        | 26/195 [00:18<00:59,  2.85it/s] 14%|█▍        | 27/195 [00:18<01:05,  2.57it/s] 14%|█▍        | 28/195 [00:18<00:58,  2.86it/s] 15%|█▍        | 29/195 [00:19<01:03,  2.63it/s] 15%|█▌        | 30/195 [00:19<01:00,  2.71it/s] 16%|█▌        | 31/195 [00:20<01:04,  2.55it/s] 16%|█▋        | 32/195 [00:20<01:03,  2.56it/s] 17%|█▋        | 33/195 [00:20<01:02,  2.58it/s] 17%|█▋        | 34/195 [00:21<01:04,  2.51it/s] 18%|█▊        | 35/195 [00:21<00:59,  2.69it/s] 18%|█▊        | 36/195 [00:22<01:03,  2.51it/s] 19%|█▉        | 37/195 [00:22<00:55,  2.82it/s] 19%|█▉        | 38/195 [00:22<01:02,  2.53it/s] 21%|██        | 40/195 [00:23<00:59,  2.61it/s] 22%|██▏       | 42/195 [00:24<00:57,  2.67it/s] 23%|██▎       | 44/195 [00:25<00:56,  2.67it/s] 23%|██▎       | 45/195 [00:25<00:47,  3.14it/s] 24%|██▎       | 46/195 [00:25<00:58,  2.56it/s] 25%|██▍       | 48/195 [00:26<00:55,  2.63it/s] 26%|██▌       | 50/195 [00:27<00:59,  2.45it/s] 27%|██▋       | 52/195 [00:28<01:04,  2.22it/s] 28%|██▊       | 54/195 [00:29<01:07,  2.10it/s] 29%|██▊       | 56/195 [00:30<01:06,  2.08it/s] 30%|██▉       | 58/195 [00:31<01:06,  2.06it/s] 31%|███       | 60/195 [00:32<01:02,  2.15it/s] 32%|███▏      | 62/195 [00:33<00:57,  2.32it/s] 33%|███▎      | 64/195 [00:33<00:53,  2.46it/s] 34%|███▍      | 66/195 [00:34<00:49,  2.60it/s] 35%|███▍      | 68/195 [00:35<00:46,  2.73it/s] 36%|███▌      | 70/195 [00:35<00:44,  2.80it/s] 37%|███▋      | 72/195 [00:36<00:43,  2.82it/s] 38%|███▊      | 74/195 [00:37<00:42,  2.83it/s] 39%|███▉      | 76/195 [00:37<00:40,  2.93it/s] 40%|████      | 78/195 [00:38<00:41,  2.82it/s] 41%|████      | 80/195 [00:39<00:39,  2.90it/s] 42%|████▏     | 82/195 [00:39<00:39,  2.84it/s] 43%|████▎     | 84/195 [00:40<00:38,  2.87it/s] 44%|████▍     | 86/195 [00:41<00:37,  2.91it/s] 45%|████▌     | 88/195 [00:42<00:37,  2.88it/s] 46%|████▌     | 90/195 [00:42<00:36,  2.90it/s] 47%|████▋     | 92/195 [00:43<00:36,  2.80it/s] 48%|████▊     | 94/195 [00:44<00:36,  2.80it/s] 49%|████▉     | 96/195 [00:44<00:35,  2.79it/s] 50%|█████     | 98/195 [00:45<00:35,  2.76it/s] 51%|█████▏    | 100/195 [00:46<00:37,  2.55it/s] 52%|█████▏    | 101/195 [00:47<00:38,  2.46it/s] 52%|█████▏    | 102/195 [00:47<00:44,  2.09it/s] 53%|█████▎    | 103/195 [00:48<00:43,  2.11it/s] 53%|█████▎    | 104/195 [00:49<00:49,  1.84it/s] 54%|█████▍    | 105/195 [00:49<00:46,  1.93it/s] 54%|█████▍    | 106/195 [00:50<00:48,  1.83it/s] 55%|█████▍    | 107/195 [00:50<00:45,  1.94it/s] 55%|█████▌    | 108/195 [00:51<00:47,  1.83it/s] 56%|█████▌    | 109/195 [00:51<00:44,  1.94it/s] 56%|█████▋    | 110/195 [00:52<00:47,  1.79it/s] 57%|█████▋    | 111/195 [00:52<00:44,  1.90it/s] 57%|█████▋    | 112/195 [00:53<00:47,  1.76it/s] 58%|█████▊    | 113/195 [00:53<00:43,  1.89it/s] 58%|█████▊    | 114/195 [00:54<00:45,  1.79it/s] 59%|█████▉    | 115/195 [00:54<00:41,  1.92it/s] 59%|█████▉    | 116/195 [00:55<00:43,  1.82it/s] 60%|██████    | 117/195 [00:55<00:40,  1.94it/s] 61%|██████    | 118/195 [00:56<00:42,  1.80it/s] 61%|██████    | 119/195 [00:57<00:39,  1.92it/s] 62%|██████▏   | 120/195 [00:57<00:39,  1.92it/s] 62%|██████▏   | 121/195 [00:57<00:33,  2.18it/s] 63%|██████▎   | 122/195 [00:58<00:34,  2.10it/s] 63%|██████▎   | 123/195 [00:58<00:31,  2.30it/s] 64%|██████▎   | 124/195 [00:59<00:30,  2.30it/s] 64%|██████▍   | 125/195 [00:59<00:28,  2.44it/s] 65%|██████▍   | 126/195 [00:59<00:27,  2.54it/s] 65%|██████▌   | 127/195 [01:00<00:27,  2.48it/s] 66%|██████▌   | 128/195 [01:00<00:25,  2.66it/s] 66%|██████▌   | 129/195 [01:01<00:26,  2.48it/s] 67%|██████▋   | 130/195 [01:01<00:23,  2.73it/s] 67%|██████▋   | 131/195 [01:01<00:26,  2.44it/s] 68%|██████▊   | 133/195 [01:02<00:24,  2.49it/s] 69%|██████▉   | 135/195 [01:03<00:23,  2.57it/s] 70%|███████   | 137/195 [01:04<00:21,  2.65it/s] 71%|███████▏  | 139/195 [01:04<00:21,  2.66it/s] 72%|███████▏  | 141/195 [01:05<00:20,  2.66it/s] 73%|███████▎  | 143/195 [01:06<00:19,  2.69it/s] 74%|███████▍  | 145/195 [01:07<00:18,  2.69it/s] 75%|███████▌  | 147/195 [01:07<00:17,  2.69it/s] 76%|███████▋  | 149/195 [01:08<00:16,  2.73it/s] 77%|███████▋  | 151/195 [01:09<00:16,  2.63it/s] 78%|███████▊  | 153/195 [01:10<00:16,  2.56it/s] 79%|███████▉  | 155/195 [01:10<00:15,  2.60it/s] 81%|████████  | 157/195 [01:11<00:13,  2.73it/s] 82%|████████▏ | 159/195 [01:12<00:13,  2.74it/s] 83%|████████▎ | 161/195 [01:12<00:12,  2.81it/s] 84%|████████▎ | 163/195 [01:13<00:11,  2.85it/s] 85%|████████▍ | 165/195 [01:14<00:10,  2.85it/s] 86%|████████▌ | 167/195 [01:15<00:10,  2.77it/s] 87%|████████▋ | 169/195 [01:15<00:09,  2.74it/s] 88%|████████▊ | 171/195 [01:16<00:08,  2.73it/s] 89%|████████▊ | 173/195 [01:17<00:07,  2.77it/s] 90%|████████▉ | 175/195 [01:17<00:07,  2.80it/s] 91%|█████████ | 177/195 [01:18<00:06,  2.78it/s] 92%|█████████▏| 179/195 [01:19<00:05,  2.74it/s] 93%|█████████▎| 181/195 [01:20<00:05,  2.73it/s] 94%|█████████▍| 183/195 [01:20<00:04,  2.69it/s] 95%|█████████▍| 185/195 [01:21<00:03,  2.70it/s] 96%|█████████▌| 187/195 [01:22<00:02,  2.74it/s] 97%|█████████▋| 189/195 [01:23<00:02,  2.64it/s] 98%|█████████▊| 191/195 [01:23<00:01,  2.63it/s] 99%|█████████▉| 193/195 [01:24<00:00,  2.65it/s]100%|██████████| 195/195 [01:25<00:00,  2.92it/s]100%|██████████| 195/195 [01:27<00:00,  2.23it/s]
2025-08-21 08:13:43 [info     ] Validating outputs
2025-08-21 08:13:43 [info     ] Predict - end                  time=0:1:27
2025-08-21 08:13:43 [info     ] Evaluate - start               split=test
2025-08-21 08:13:43 [info     ] Evaluate - end                 correctness_llm=0.25 monotonicity=0.75
2025-08-21 08:13:43 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:13:43 [info     ] Augmenting questions for IRT estimation num_questions=10
2025-08-21 08:13:43 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:13:43 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1048.69it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3611.31it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 488.18it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6191.51it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1026.25it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3676.98it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 571.04it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7114.16it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1070.56it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3636.11it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 573.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6842.26it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 959.76it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3552.10it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 583.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6926.19it/s]
2025-08-21 08:13:46 INFO: EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
2025-08-21 08:13:46 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:13:46 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:13:46 [info     ] Evaluate question difficulty - end rmse=2.721987415045369 split=test
2025-08-21 08:13:46 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 1 finished: 0:1:40

 ********** Run: 2/3 **********
2025-08-21 08:14:08 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:14:08 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:14:08 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:14:08 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:14:10 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:14:10 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:14:15 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:14:15 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:14:15 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:14:15 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:14:19 [info     ] Setting seed                   value=44
2025-08-21 08:14:19 [info     ] Building structured outputter  name=student_kt
2025-08-21 08:14:19 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_chocolate_level_nocontext
2025-08-21 08:14:19 [info     ] Building model                 name=qwen3:14b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:14:19 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:02<09:19,  2.89s/it]  1%|          | 2/195 [00:04<06:20,  1.97s/it]  2%|▏         | 3/195 [00:05<05:38,  1.76s/it]  2%|▏         | 4/195 [00:07<05:08,  1.61s/it]  3%|▎         | 5/195 [00:07<04:03,  1.28s/it]  4%|▎         | 7/195 [00:08<02:45,  1.13it/s]  5%|▍         | 9/195 [00:09<02:09,  1.44it/s]  6%|▌         | 11/195 [00:10<01:50,  1.67it/s]  7%|▋         | 13/195 [00:11<01:31,  1.99it/s]  8%|▊         | 15/195 [00:11<01:21,  2.21it/s]  9%|▊         | 17/195 [00:12<01:11,  2.49it/s]  9%|▉         | 18/195 [00:12<01:02,  2.84it/s] 10%|▉         | 19/195 [00:13<01:10,  2.49it/s] 11%|█         | 21/195 [00:13<01:06,  2.63it/s] 12%|█▏        | 23/195 [00:14<01:02,  2.77it/s] 13%|█▎        | 25/195 [00:15<01:01,  2.75it/s] 14%|█▍        | 27/195 [00:16<01:01,  2.75it/s] 15%|█▍        | 29/195 [00:16<00:59,  2.79it/s] 15%|█▌        | 30/195 [00:16<00:51,  3.18it/s] 16%|█▌        | 31/195 [00:17<01:07,  2.42it/s] 17%|█▋        | 33/195 [00:18<01:08,  2.38it/s] 18%|█▊        | 35/195 [00:19<01:07,  2.36it/s] 19%|█▉        | 37/195 [00:20<01:04,  2.45it/s] 20%|██        | 39/195 [00:20<01:04,  2.42it/s] 21%|██        | 40/195 [00:21<00:54,  2.82it/s] 21%|██        | 41/195 [00:21<01:04,  2.38it/s] 22%|██▏       | 43/195 [00:22<01:02,  2.44it/s] 23%|██▎       | 45/195 [00:23<00:59,  2.52it/s] 24%|██▍       | 47/195 [00:23<00:56,  2.64it/s] 25%|██▌       | 49/195 [00:24<00:53,  2.70it/s] 26%|██▌       | 51/195 [00:25<01:00,  2.40it/s] 27%|██▋       | 53/195 [00:26<01:03,  2.24it/s] 28%|██▊       | 55/195 [00:27<01:05,  2.12it/s] 29%|██▉       | 57/195 [00:28<01:07,  2.05it/s] 30%|███       | 59/195 [00:29<01:07,  2.02it/s] 31%|███▏      | 61/195 [00:30<01:02,  2.16it/s] 32%|███▏      | 63/195 [00:31<00:57,  2.30it/s] 33%|███▎      | 65/195 [00:32<00:54,  2.39it/s] 34%|███▍      | 67/195 [00:32<00:51,  2.51it/s] 35%|███▌      | 69/195 [00:33<00:49,  2.56it/s] 36%|███▋      | 71/195 [00:34<00:47,  2.62it/s] 37%|███▋      | 73/195 [00:35<00:45,  2.66it/s] 38%|███▊      | 75/195 [00:35<00:43,  2.75it/s] 39%|███▉      | 76/195 [00:35<00:38,  3.10it/s] 39%|███▉      | 77/195 [00:36<00:43,  2.71it/s] 41%|████      | 79/195 [00:37<00:41,  2.77it/s] 42%|████▏     | 81/195 [00:37<00:41,  2.78it/s] 43%|████▎     | 83/195 [00:38<00:40,  2.77it/s] 44%|████▎     | 85/195 [00:39<00:38,  2.83it/s] 44%|████▍     | 86/195 [00:39<00:33,  3.24it/s] 45%|████▍     | 87/195 [00:39<00:42,  2.54it/s] 45%|████▌     | 88/195 [00:40<00:35,  3.03it/s] 46%|████▌     | 89/195 [00:40<00:43,  2.41it/s] 47%|████▋     | 91/195 [00:41<00:41,  2.50it/s] 47%|████▋     | 92/195 [00:41<00:37,  2.74it/s] 48%|████▊     | 93/195 [00:42<00:40,  2.54it/s] 48%|████▊     | 94/195 [00:42<00:36,  2.77it/s] 49%|████▊     | 95/195 [00:42<00:38,  2.61it/s] 49%|████▉     | 96/195 [00:43<00:33,  2.93it/s] 50%|████▉     | 97/195 [00:43<00:35,  2.75it/s] 50%|█████     | 98/195 [00:43<00:31,  3.07it/s] 51%|█████     | 99/195 [00:44<00:34,  2.80it/s] 51%|█████▏    | 100/195 [00:44<00:36,  2.61it/s] 52%|█████▏    | 101/195 [00:45<00:46,  2.04it/s] 52%|█████▏    | 102/195 [00:45<00:44,  2.10it/s] 53%|█████▎    | 103/195 [00:46<00:50,  1.81it/s] 53%|█████▎    | 104/195 [00:47<00:47,  1.92it/s] 54%|█████▍    | 105/195 [00:47<00:52,  1.73it/s] 55%|█████▍    | 107/195 [00:48<00:48,  1.80it/s] 56%|█████▌    | 109/195 [00:49<00:46,  1.83it/s] 56%|█████▋    | 110/195 [00:50<00:38,  2.22it/s] 57%|█████▋    | 111/195 [00:51<00:49,  1.70it/s] 58%|█████▊    | 113/195 [00:52<00:47,  1.74it/s] 59%|█████▉    | 115/195 [00:53<00:45,  1.77it/s] 59%|█████▉    | 116/195 [00:53<00:37,  2.13it/s] 60%|██████    | 117/195 [00:54<00:46,  1.67it/s] 61%|██████    | 119/195 [00:55<00:44,  1.71it/s] 62%|██████▏   | 121/195 [00:56<00:38,  1.93it/s] 63%|██████▎   | 123/195 [00:57<00:34,  2.10it/s] 64%|██████▍   | 125/195 [00:57<00:31,  2.24it/s] 65%|██████▌   | 127/195 [00:58<00:29,  2.28it/s] 66%|██████▌   | 128/195 [00:58<00:25,  2.63it/s] 66%|██████▌   | 129/195 [00:59<00:29,  2.26it/s] 67%|██████▋   | 131/195 [01:00<00:26,  2.37it/s] 68%|██████▊   | 133/195 [01:01<00:25,  2.42it/s] 69%|██████▉   | 135/195 [01:01<00:23,  2.53it/s] 70%|███████   | 137/195 [01:02<00:22,  2.63it/s] 71%|███████▏  | 139/195 [01:03<00:20,  2.67it/s] 72%|███████▏  | 141/195 [01:04<00:20,  2.66it/s] 73%|███████▎  | 143/195 [01:04<00:19,  2.65it/s] 74%|███████▍  | 145/195 [01:05<00:18,  2.66it/s] 75%|███████▌  | 147/195 [01:06<00:17,  2.71it/s] 76%|███████▋  | 149/195 [01:06<00:16,  2.76it/s] 77%|███████▋  | 151/195 [01:07<00:16,  2.65it/s] 78%|███████▊  | 153/195 [01:08<00:16,  2.57it/s] 79%|███████▉  | 155/195 [01:09<00:15,  2.57it/s] 81%|████████  | 157/195 [01:10<00:13,  2.72it/s] 82%|████████▏ | 159/195 [01:10<00:13,  2.70it/s] 83%|████████▎ | 161/195 [01:11<00:12,  2.77it/s] 84%|████████▎ | 163/195 [01:12<00:11,  2.79it/s] 85%|████████▍ | 165/195 [01:12<00:10,  2.77it/s] 85%|████████▌ | 166/195 [01:12<00:09,  3.15it/s] 86%|████████▌ | 167/195 [01:13<00:10,  2.64it/s] 87%|████████▋ | 169/195 [01:14<00:09,  2.72it/s] 88%|████████▊ | 171/195 [01:15<00:08,  2.76it/s] 89%|████████▊ | 173/195 [01:15<00:08,  2.73it/s] 90%|████████▉ | 175/195 [01:16<00:07,  2.71it/s] 91%|█████████ | 177/195 [01:17<00:06,  2.64it/s] 92%|█████████▏| 179/195 [01:18<00:05,  2.67it/s] 93%|█████████▎| 181/195 [01:18<00:05,  2.74it/s] 94%|█████████▍| 183/195 [01:19<00:04,  2.73it/s] 95%|█████████▍| 185/195 [01:20<00:03,  2.75it/s] 96%|█████████▌| 187/195 [01:20<00:02,  2.77it/s] 97%|█████████▋| 189/195 [01:21<00:02,  2.75it/s] 98%|█████████▊| 191/195 [01:22<00:01,  2.69it/s] 99%|█████████▉| 193/195 [01:23<00:00,  2.64it/s]100%|██████████| 195/195 [01:23<00:00,  2.90it/s]100%|██████████| 195/195 [01:25<00:00,  2.27it/s]
2025-08-21 08:15:45 [info     ] Validating outputs
2025-08-21 08:15:45 [info     ] Predict - end                  time=0:1:25
2025-08-21 08:15:45 [info     ] Evaluate - start               split=test
2025-08-21 08:15:45 [info     ] Evaluate - end                 correctness_llm=0.26 monotonicity=0.74
2025-08-21 08:15:45 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:15:45 [info     ] Augmenting questions for IRT estimation num_questions=12
2025-08-21 08:15:45 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:15:45 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1094.75it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3578.37it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 582.51it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6291.01it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1117.93it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3713.88it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 572.29it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6663.67it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 970.90it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3655.62it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 524.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6257.49it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1039.15it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3781.88it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 492.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6324.89it/s]
2025-08-21 08:15:48 INFO: Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
2025-08-21 08:15:48 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:15:48 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:15:48 [info     ] Evaluate question difficulty - end rmse=2.685887969853193 split=test
2025-08-21 08:15:48 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 2 finished: 0:1:39

 ********** Run: 3/3 **********
2025-08-21 08:16:10 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:16:10 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:16:10 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:16:10 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:16:12 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:16:12 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:16:17 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:16:17 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:16:17 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:16:17 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:16:20 [info     ] Setting seed                   value=45
2025-08-21 08:16:20 [info     ] Building structured outputter  name=student_kt
2025-08-21 08:16:20 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_chocolate_level_nocontext
2025-08-21 08:16:20 [info     ] Building model                 name=qwen3:14b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:16:20 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:02<09:23,  2.90s/it]  1%|          | 2/195 [00:04<06:24,  1.99s/it]  2%|▏         | 3/195 [00:05<05:45,  1.80s/it]  2%|▏         | 4/195 [00:06<04:17,  1.35s/it]  3%|▎         | 5/195 [00:07<03:38,  1.15s/it]  3%|▎         | 6/195 [00:08<03:29,  1.11s/it]  4%|▍         | 8/195 [00:09<02:26,  1.28it/s]  5%|▌         | 10/195 [00:10<01:57,  1.57it/s]  6%|▌         | 12/195 [00:10<01:38,  1.86it/s]  7%|▋         | 14/195 [00:11<01:26,  2.10it/s]  8%|▊         | 15/195 [00:11<01:13,  2.46it/s]  8%|▊         | 16/195 [00:12<01:20,  2.23it/s]  9%|▉         | 18/195 [00:12<01:14,  2.39it/s] 10%|█         | 20/195 [00:13<01:08,  2.56it/s] 11%|█▏        | 22/195 [00:14<01:04,  2.67it/s] 12%|█▏        | 23/195 [00:14<00:55,  3.09it/s] 12%|█▏        | 24/195 [00:15<01:05,  2.61it/s] 13%|█▎        | 26/195 [00:15<01:05,  2.59it/s] 14%|█▍        | 28/195 [00:16<01:03,  2.65it/s] 15%|█▌        | 30/195 [00:17<01:02,  2.63it/s] 16%|█▌        | 31/195 [00:17<00:54,  3.02it/s] 16%|█▋        | 32/195 [00:18<01:09,  2.34it/s] 17%|█▋        | 34/195 [00:19<01:08,  2.35it/s] 18%|█▊        | 36/195 [00:19<01:05,  2.43it/s] 19%|█▉        | 38/195 [00:20<01:02,  2.53it/s] 21%|██        | 40/195 [00:21<01:01,  2.53it/s] 22%|██▏       | 42/195 [00:22<01:00,  2.55it/s] 23%|██▎       | 44/195 [00:22<00:59,  2.55it/s] 24%|██▎       | 46/195 [00:23<00:56,  2.64it/s] 25%|██▍       | 48/195 [00:24<00:53,  2.72it/s] 26%|██▌       | 50/195 [00:25<00:56,  2.56it/s] 27%|██▋       | 52/195 [00:26<01:00,  2.35it/s] 28%|██▊       | 54/195 [00:27<01:03,  2.22it/s] 29%|██▊       | 56/195 [00:28<01:05,  2.13it/s] 30%|██▉       | 58/195 [00:29<01:05,  2.08it/s] 31%|███       | 60/195 [00:30<01:02,  2.15it/s] 32%|███▏      | 62/195 [00:30<00:56,  2.34it/s] 33%|███▎      | 64/195 [00:31<00:52,  2.48it/s] 34%|███▍      | 66/195 [00:32<00:49,  2.61it/s] 35%|███▍      | 68/195 [00:32<00:46,  2.71it/s] 36%|███▌      | 70/195 [00:33<00:44,  2.78it/s] 37%|███▋      | 72/195 [00:34<00:43,  2.80it/s] 38%|███▊      | 74/195 [00:34<00:43,  2.81it/s] 39%|███▉      | 76/195 [00:35<00:41,  2.88it/s] 40%|████      | 78/195 [00:36<00:41,  2.85it/s] 41%|████      | 80/195 [00:37<00:40,  2.81it/s] 42%|████▏     | 82/195 [00:37<00:40,  2.77it/s] 43%|████▎     | 83/195 [00:37<00:36,  3.11it/s] 43%|████▎     | 84/195 [00:38<00:42,  2.64it/s] 44%|████▍     | 86/195 [00:39<00:40,  2.70it/s] 45%|████▌     | 88/195 [00:39<00:39,  2.68it/s] 46%|████▌     | 90/195 [00:40<00:39,  2.68it/s] 47%|████▋     | 92/195 [00:41<00:37,  2.72it/s] 48%|████▊     | 94/195 [00:42<00:36,  2.75it/s] 49%|████▉     | 96/195 [00:42<00:35,  2.82it/s] 50%|█████     | 98/195 [00:43<00:34,  2.85it/s] 51%|█████▏    | 100/195 [00:44<00:37,  2.55it/s] 52%|█████▏    | 101/195 [00:44<00:37,  2.48it/s] 52%|█████▏    | 102/195 [00:45<00:44,  2.08it/s] 53%|█████▎    | 103/195 [00:46<00:44,  2.06it/s] 53%|█████▎    | 104/195 [00:46<00:50,  1.82it/s] 54%|█████▍    | 105/195 [00:47<00:46,  1.92it/s] 54%|█████▍    | 106/195 [00:48<00:48,  1.83it/s] 55%|█████▍    | 107/195 [00:48<00:45,  1.92it/s] 55%|█████▌    | 108/195 [00:49<00:47,  1.83it/s] 56%|█████▌    | 109/195 [00:49<00:44,  1.95it/s] 56%|█████▋    | 110/195 [00:50<00:46,  1.83it/s] 57%|█████▋    | 111/195 [00:50<00:43,  1.95it/s] 57%|█████▋    | 112/195 [00:51<00:45,  1.82it/s] 58%|█████▊    | 113/195 [00:51<00:42,  1.94it/s] 58%|█████▊    | 114/195 [00:52<00:44,  1.83it/s] 59%|█████▉    | 115/195 [00:52<00:40,  1.95it/s] 59%|█████▉    | 116/195 [00:53<00:42,  1.84it/s] 60%|██████    | 117/195 [00:53<00:40,  1.95it/s] 61%|██████    | 118/195 [00:54<00:42,  1.83it/s] 61%|██████    | 119/195 [00:54<00:39,  1.94it/s] 62%|██████▏   | 120/195 [00:55<00:38,  1.97it/s] 62%|██████▏   | 121/195 [00:55<00:33,  2.24it/s] 63%|██████▎   | 122/195 [00:56<00:33,  2.19it/s] 63%|██████▎   | 123/195 [00:56<00:30,  2.37it/s] 64%|██████▎   | 124/195 [00:56<00:30,  2.35it/s] 64%|██████▍   | 125/195 [00:57<00:28,  2.45it/s] 65%|██████▍   | 126/195 [00:57<00:27,  2.51it/s] 65%|██████▌   | 127/195 [00:58<00:28,  2.40it/s] 66%|██████▌   | 128/195 [00:58<00:26,  2.56it/s] 66%|██████▌   | 129/195 [00:58<00:28,  2.36it/s] 67%|██████▋   | 130/195 [00:59<00:24,  2.61it/s] 67%|██████▋   | 131/195 [00:59<00:26,  2.40it/s] 68%|██████▊   | 133/195 [01:00<00:25,  2.38it/s] 69%|██████▉   | 135/195 [01:01<00:24,  2.42it/s] 70%|███████   | 137/195 [01:02<00:22,  2.55it/s] 71%|███████▏  | 139/195 [01:02<00:21,  2.64it/s] 72%|███████▏  | 141/195 [01:03<00:20,  2.68it/s] 73%|███████▎  | 143/195 [01:04<00:19,  2.71it/s] 74%|███████▍  | 145/195 [01:04<00:18,  2.78it/s] 75%|███████▌  | 147/195 [01:05<00:17,  2.80it/s] 76%|███████▋  | 149/195 [01:06<00:16,  2.83it/s] 77%|███████▋  | 151/195 [01:07<00:16,  2.69it/s] 78%|███████▊  | 152/195 [01:07<00:13,  3.08it/s] 78%|███████▊  | 153/195 [01:07<00:17,  2.41it/s] 79%|███████▉  | 155/195 [01:08<00:16,  2.43it/s] 81%|████████  | 157/195 [01:09<00:14,  2.55it/s] 82%|████████▏ | 159/195 [01:10<00:13,  2.66it/s] 83%|████████▎ | 161/195 [01:10<00:12,  2.78it/s] 84%|████████▎ | 163/195 [01:11<00:11,  2.85it/s] 84%|████████▍ | 164/195 [01:11<00:09,  3.22it/s] 85%|████████▍ | 165/195 [01:12<00:11,  2.64it/s] 86%|████████▌ | 167/195 [01:13<00:10,  2.65it/s] 87%|████████▋ | 169/195 [01:13<00:09,  2.66it/s] 88%|████████▊ | 171/195 [01:14<00:08,  2.71it/s] 89%|████████▊ | 173/195 [01:15<00:07,  2.76it/s] 90%|████████▉ | 175/195 [01:15<00:07,  2.77it/s] 91%|█████████ | 177/195 [01:16<00:06,  2.74it/s] 92%|█████████▏| 179/195 [01:17<00:05,  2.74it/s] 93%|█████████▎| 181/195 [01:18<00:05,  2.78it/s] 94%|█████████▍| 183/195 [01:18<00:04,  2.77it/s] 94%|█████████▍| 184/195 [01:18<00:03,  3.15it/s] 95%|█████████▍| 185/195 [01:19<00:03,  2.57it/s] 96%|█████████▌| 187/195 [01:20<00:03,  2.59it/s] 97%|█████████▋| 189/195 [01:21<00:02,  2.57it/s] 98%|█████████▊| 191/195 [01:21<00:01,  2.60it/s] 99%|█████████▉| 193/195 [01:22<00:00,  2.65it/s]100%|██████████| 195/195 [01:23<00:00,  2.94it/s]100%|██████████| 195/195 [01:25<00:00,  2.29it/s]
2025-08-21 08:17:46 [info     ] Validating outputs
2025-08-21 08:17:46 [info     ] Predict - end                  time=0:1:25
2025-08-21 08:17:46 [info     ] Evaluate - start               split=test
2025-08-21 08:17:46 [info     ] Evaluate - end                 correctness_llm=0.26 monotonicity=0.65
2025-08-21 08:17:46 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:17:46 [info     ] Augmenting questions for IRT estimation num_questions=10
2025-08-21 08:17:46 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:17:46 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1114.11it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3604.23it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 568.74it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6826.35it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 971.84it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3089.58it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 533.71it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7557.30it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1174.26it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3826.11it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 537.12it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 2176.60it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 999.90it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3656.19it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 587.84it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8249.54it/s]
2025-08-21 08:17:49 INFO: EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
2025-08-21 08:17:49 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:17:49 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:17:49 [info     ] Evaluate question difficulty - end rmse=2.7898170216995397 split=test
2025-08-21 08:17:49 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 3 finished: 0:1:38

 ========== Config: llama3.1:8b~T_0.0~SO_student_kt~L_5~SP_student_chocolate_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_miscon_studentlevel_random0 ==========
Config 6/8

 ********** Run: 1/3 **********
2025-08-21 08:18:10 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:18:10 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:18:10 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:18:10 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:18:12 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:18:12 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:18:16 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:18:16 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:18:16 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:18:17 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:18:20 [info     ] Setting seed                   value=43
2025-08-21 08:18:20 [info     ] Building structured outputter  name=student_kt
2025-08-21 08:18:20 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_chocolate_level_nocontext
2025-08-21 08:18:20 [info     ] Building model                 name=llama3.1:8b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:18:20 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:03<12:40,  3.92s/it]  1%|          | 2/195 [00:04<05:41,  1.77s/it]  2%|▏         | 3/195 [00:05<04:19,  1.35s/it]  2%|▏         | 4/195 [00:05<03:30,  1.10s/it]  3%|▎         | 5/195 [00:06<03:05,  1.02it/s]  4%|▎         | 7/195 [00:07<02:24,  1.30it/s]  4%|▍         | 8/195 [00:08<02:04,  1.50it/s]  5%|▍         | 9/195 [00:08<02:10,  1.42it/s]  5%|▌         | 10/195 [00:09<01:51,  1.66it/s]  6%|▌         | 11/195 [00:10<02:02,  1.50it/s]  6%|▌         | 12/195 [00:10<01:50,  1.65it/s]  7%|▋         | 13/195 [00:11<01:52,  1.62it/s]  8%|▊         | 15/195 [00:11<01:30,  1.99it/s]  8%|▊         | 16/195 [00:11<01:13,  2.43it/s]  9%|▊         | 17/195 [00:12<01:28,  2.02it/s] 10%|▉         | 19/195 [00:13<01:22,  2.13it/s] 11%|█         | 21/195 [00:14<01:15,  2.29it/s] 12%|█▏        | 23/195 [00:15<01:15,  2.28it/s] 12%|█▏        | 24/195 [00:15<01:08,  2.49it/s] 13%|█▎        | 25/195 [00:15<01:09,  2.44it/s] 13%|█▎        | 26/195 [00:16<01:11,  2.37it/s] 14%|█▍        | 27/195 [00:16<01:10,  2.39it/s] 14%|█▍        | 28/195 [00:17<01:07,  2.49it/s] 15%|█▍        | 29/195 [00:17<01:04,  2.59it/s] 15%|█▌        | 30/195 [00:17<01:06,  2.50it/s] 16%|█▌        | 31/195 [00:18<01:34,  1.73it/s] 16%|█▋        | 32/195 [00:19<01:17,  2.10it/s] 17%|█▋        | 33/195 [00:20<01:53,  1.43it/s] 17%|█▋        | 34/195 [00:20<01:28,  1.82it/s] 18%|█▊        | 35/195 [00:21<01:42,  1.55it/s] 18%|█▊        | 36/195 [00:21<01:34,  1.68it/s] 19%|█▉        | 37/195 [00:22<01:19,  1.99it/s] 19%|█▉        | 38/195 [00:23<01:42,  1.54it/s] 20%|██        | 39/195 [00:23<01:21,  1.91it/s] 21%|██        | 40/195 [00:24<01:38,  1.57it/s] 22%|██▏       | 42/195 [00:25<01:20,  1.91it/s] 23%|██▎       | 44/195 [00:25<01:12,  2.10it/s] 23%|██▎       | 45/195 [00:26<01:00,  2.46it/s] 24%|██▎       | 46/195 [00:26<01:11,  2.09it/s] 24%|██▍       | 47/195 [00:26<00:59,  2.50it/s] 25%|██▍       | 48/195 [00:27<01:13,  1.99it/s] 25%|██▌       | 49/195 [00:27<01:01,  2.37it/s] 26%|██▌       | 50/195 [00:28<01:19,  1.82it/s] 27%|██▋       | 52/195 [00:29<01:14,  1.91it/s] 27%|██▋       | 53/195 [00:30<01:05,  2.17it/s] 28%|██▊       | 54/195 [00:30<01:09,  2.04it/s] 28%|██▊       | 55/195 [00:30<01:00,  2.30it/s] 29%|██▊       | 56/195 [00:31<01:06,  2.08it/s] 29%|██▉       | 57/195 [00:31<01:00,  2.28it/s] 30%|██▉       | 58/195 [00:32<01:02,  2.20it/s] 30%|███       | 59/195 [00:32<00:58,  2.34it/s] 31%|███       | 60/195 [00:33<00:57,  2.36it/s] 31%|███▏      | 61/195 [00:33<00:56,  2.39it/s] 32%|███▏      | 62/195 [00:33<00:53,  2.51it/s] 32%|███▏      | 63/195 [00:35<01:25,  1.54it/s] 33%|███▎      | 64/195 [00:35<01:09,  1.89it/s] 33%|███▎      | 65/195 [00:35<00:58,  2.21it/s] 34%|███▍      | 66/195 [00:36<00:56,  2.28it/s] 34%|███▍      | 67/195 [00:36<00:51,  2.47it/s] 35%|███▍      | 68/195 [00:36<00:48,  2.62it/s] 35%|███▌      | 69/195 [00:37<00:48,  2.59it/s] 36%|███▌      | 70/195 [00:37<00:42,  2.93it/s] 36%|███▋      | 71/195 [00:38<01:08,  1.80it/s] 37%|███▋      | 72/195 [00:38<00:53,  2.29it/s] 37%|███▋      | 73/195 [00:39<01:14,  1.63it/s] 38%|███▊      | 74/195 [00:39<01:02,  1.94it/s] 38%|███▊      | 75/195 [00:40<01:04,  1.85it/s] 39%|███▉      | 76/195 [00:41<01:03,  1.87it/s] 40%|████      | 78/195 [00:41<00:55,  2.09it/s] 41%|████      | 79/195 [00:42<00:54,  2.13it/s] 42%|████▏     | 81/195 [00:43<00:49,  2.29it/s] 42%|████▏     | 82/195 [00:43<00:44,  2.54it/s] 43%|████▎     | 83/195 [00:43<00:49,  2.25it/s] 43%|████▎     | 84/195 [00:44<00:44,  2.50it/s] 44%|████▎     | 85/195 [00:44<00:48,  2.29it/s] 44%|████▍     | 86/195 [00:45<00:44,  2.47it/s] 45%|████▍     | 87/195 [00:45<00:41,  2.61it/s] 45%|████▌     | 88/195 [00:46<00:49,  2.18it/s] 46%|████▌     | 89/195 [00:46<00:40,  2.65it/s] 46%|████▌     | 90/195 [00:46<00:44,  2.38it/s] 47%|████▋     | 92/195 [00:47<00:37,  2.74it/s] 48%|████▊     | 93/195 [00:47<00:35,  2.87it/s] 48%|████▊     | 94/195 [00:47<00:34,  2.93it/s] 49%|████▊     | 95/195 [00:48<00:34,  2.88it/s] 49%|████▉     | 96/195 [00:48<00:32,  3.07it/s] 50%|████▉     | 97/195 [00:48<00:33,  2.93it/s] 50%|█████     | 98/195 [00:49<00:29,  3.24it/s] 51%|█████     | 99/195 [00:49<00:32,  2.95it/s] 51%|█████▏    | 100/195 [00:49<00:31,  3.03it/s] 52%|█████▏    | 101/195 [00:50<00:52,  1.80it/s] 52%|█████▏    | 102/195 [00:51<00:44,  2.07it/s] 53%|█████▎    | 103/195 [00:52<00:58,  1.58it/s] 53%|█████▎    | 104/195 [00:52<00:53,  1.69it/s] 54%|█████▍    | 105/195 [00:53<01:00,  1.49it/s] 54%|█████▍    | 106/195 [00:53<00:49,  1.81it/s] 55%|█████▍    | 107/195 [00:54<00:54,  1.62it/s] 56%|█████▌    | 109/195 [00:55<00:46,  1.86it/s] 56%|█████▋    | 110/195 [00:55<00:41,  2.03it/s] 57%|█████▋    | 111/195 [00:56<00:47,  1.78it/s] 57%|█████▋    | 112/195 [00:57<00:43,  1.92it/s] 58%|█████▊    | 113/195 [00:57<00:47,  1.74it/s] 58%|█████▊    | 114/195 [00:58<00:39,  2.04it/s] 59%|█████▉    | 115/195 [00:58<00:45,  1.76it/s] 60%|██████    | 117/195 [00:59<00:39,  2.00it/s] 61%|██████    | 118/195 [01:00<00:35,  2.20it/s] 61%|██████    | 119/195 [01:00<00:39,  1.92it/s] 62%|██████▏   | 120/195 [01:00<00:33,  2.27it/s] 62%|██████▏   | 121/195 [01:01<00:40,  1.83it/s] 63%|██████▎   | 122/195 [01:02<00:33,  2.16it/s] 63%|██████▎   | 123/195 [01:02<00:37,  1.91it/s] 64%|██████▎   | 124/195 [01:03<00:35,  2.01it/s] 64%|██████▍   | 125/195 [01:03<00:32,  2.12it/s] 65%|██████▍   | 126/195 [01:03<00:31,  2.22it/s] 65%|██████▌   | 127/195 [01:04<00:28,  2.35it/s] 66%|██████▌   | 128/195 [01:04<00:29,  2.29it/s] 66%|██████▌   | 129/195 [01:05<00:26,  2.49it/s] 67%|██████▋   | 130/195 [01:05<00:29,  2.18it/s] 67%|██████▋   | 131/195 [01:06<00:27,  2.32it/s] 68%|██████▊   | 132/195 [01:06<00:29,  2.16it/s] 68%|██████▊   | 133/195 [01:06<00:27,  2.28it/s] 69%|██████▊   | 134/195 [01:07<00:27,  2.20it/s] 69%|██████▉   | 135/195 [01:07<00:24,  2.42it/s] 70%|██████▉   | 136/195 [01:08<00:23,  2.52it/s] 70%|███████   | 137/195 [01:08<00:21,  2.72it/s] 71%|███████   | 138/195 [01:08<00:24,  2.36it/s] 71%|███████▏  | 139/195 [01:09<00:21,  2.58it/s] 72%|███████▏  | 140/195 [01:09<00:24,  2.24it/s] 73%|███████▎  | 142/195 [01:10<00:21,  2.51it/s] 73%|███████▎  | 143/195 [01:10<00:18,  2.80it/s] 74%|███████▍  | 144/195 [01:11<00:18,  2.69it/s] 74%|███████▍  | 145/195 [01:11<00:17,  2.79it/s] 75%|███████▍  | 146/195 [01:11<00:17,  2.75it/s] 75%|███████▌  | 147/195 [01:12<00:21,  2.25it/s] 76%|███████▋  | 149/195 [01:13<00:18,  2.50it/s] 77%|███████▋  | 150/195 [01:13<00:18,  2.48it/s] 77%|███████▋  | 151/195 [01:14<00:17,  2.46it/s] 78%|███████▊  | 152/195 [01:14<00:17,  2.48it/s] 78%|███████▊  | 153/195 [01:14<00:16,  2.61it/s] 79%|███████▉  | 154/195 [01:15<00:16,  2.54it/s] 79%|███████▉  | 155/195 [01:15<00:13,  2.87it/s] 80%|████████  | 156/195 [01:16<00:17,  2.23it/s] 81%|████████  | 157/195 [01:16<00:15,  2.50it/s] 81%|████████  | 158/195 [01:17<00:18,  2.01it/s] 82%|████████▏ | 160/195 [01:18<00:17,  1.97it/s] 83%|████████▎ | 161/195 [01:18<00:14,  2.37it/s] 83%|████████▎ | 162/195 [01:19<00:17,  1.91it/s] 84%|████████▍ | 164/195 [01:19<00:13,  2.26it/s] 85%|████████▍ | 165/195 [01:19<00:11,  2.65it/s] 85%|████████▌ | 166/195 [01:20<00:12,  2.33it/s] 86%|████████▌ | 167/195 [01:21<00:13,  2.03it/s] 86%|████████▌ | 168/195 [01:21<00:11,  2.42it/s] 87%|████████▋ | 169/195 [01:21<00:11,  2.29it/s] 87%|████████▋ | 170/195 [01:22<00:09,  2.62it/s] 88%|████████▊ | 171/195 [01:22<00:10,  2.25it/s] 88%|████████▊ | 172/195 [01:23<00:09,  2.35it/s] 89%|████████▊ | 173/195 [01:23<00:10,  2.10it/s] 89%|████████▉ | 174/195 [01:23<00:08,  2.47it/s] 90%|████████▉ | 175/195 [01:24<00:08,  2.47it/s] 90%|█████████ | 176/195 [01:24<00:07,  2.42it/s] 91%|█████████ | 177/195 [01:25<00:07,  2.50it/s] 91%|█████████▏| 178/195 [01:25<00:07,  2.43it/s] 92%|█████████▏| 179/195 [01:25<00:06,  2.63it/s] 92%|█████████▏| 180/195 [01:26<00:07,  2.12it/s] 93%|█████████▎| 182/195 [01:27<00:05,  2.41it/s] 94%|█████████▍| 184/195 [01:27<00:04,  2.74it/s] 95%|█████████▍| 185/195 [01:28<00:03,  2.67it/s] 95%|█████████▌| 186/195 [01:28<00:03,  2.51it/s] 96%|█████████▌| 187/195 [01:29<00:03,  2.38it/s] 96%|█████████▋| 188/195 [01:29<00:02,  2.41it/s] 97%|█████████▋| 189/195 [01:30<00:02,  2.31it/s] 97%|█████████▋| 190/195 [01:30<00:02,  2.17it/s] 98%|█████████▊| 191/195 [01:30<00:01,  2.49it/s] 98%|█████████▊| 192/195 [01:31<00:01,  2.06it/s] 99%|█████████▉| 193/195 [01:31<00:00,  2.57it/s] 99%|█████████▉| 194/195 [01:32<00:00,  2.18it/s]100%|██████████| 195/195 [01:34<00:00,  2.06it/s]
2025-08-21 08:19:55 [info     ] Validating outputs
2025-08-21 08:19:55 [info     ] Predict - end                  time=0:1:34
2025-08-21 08:19:55 [info     ] Evaluate - start               split=test
2025-08-21 08:19:55 [info     ] Evaluate - end                 correctness_llm=0.27 monotonicity=0.95
2025-08-21 08:19:55 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:19:55 [info     ] Augmenting questions for IRT estimation num_questions=6
2025-08-21 08:19:55 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:19:55 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1075.74it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 5451.32it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 439.83it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5762.54it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 964.30it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3658.89it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 561.72it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6534.64it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1011.41it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3492.57it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 482.33it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7798.17it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1056.35it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3363.79it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 516.53it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5976.01it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 982.63it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3520.91it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 548.07it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6560.92it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1065.47it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3573.13it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 585.40it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6252.16it/s]
2025-08-21 08:20:00 INFO: Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
2025-08-21 08:20:00 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:20:00 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:20:00 [info     ] Evaluate question difficulty - end rmse=2.644185545149685 split=test
2025-08-21 08:20:00 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 1 finished: 0:1:50

 ********** Run: 2/3 **********
2025-08-21 08:20:20 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:20:20 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:20:20 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:20:20 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:20:22 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:20:22 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:20:27 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:20:27 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:20:27 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:20:28 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:20:31 [info     ] Setting seed                   value=44
2025-08-21 08:20:31 [info     ] Building structured outputter  name=student_kt
2025-08-21 08:20:31 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_chocolate_level_nocontext
2025-08-21 08:20:31 [info     ] Building model                 name=llama3.1:8b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:20:31 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<06:14,  1.93s/it]  1%|          | 2/195 [00:02<04:11,  1.30s/it]  2%|▏         | 3/195 [00:03<03:55,  1.22s/it]  2%|▏         | 4/195 [00:04<03:29,  1.10s/it]  3%|▎         | 5/195 [00:05<02:52,  1.10it/s]  3%|▎         | 6/195 [00:05<02:26,  1.29it/s]  4%|▎         | 7/195 [00:06<02:05,  1.49it/s]  4%|▍         | 8/195 [00:06<02:01,  1.54it/s]  5%|▍         | 9/195 [00:07<01:44,  1.78it/s]  5%|▌         | 10/195 [00:07<01:47,  1.72it/s]  6%|▌         | 11/195 [00:08<01:39,  1.86it/s]  6%|▌         | 12/195 [00:08<01:33,  1.95it/s]  7%|▋         | 13/195 [00:09<01:24,  2.16it/s]  7%|▋         | 14/195 [00:09<01:27,  2.06it/s]  8%|▊         | 15/195 [00:10<01:21,  2.22it/s]  8%|▊         | 16/195 [00:10<01:33,  1.92it/s]  9%|▊         | 17/195 [00:11<01:19,  2.23it/s]  9%|▉         | 18/195 [00:11<01:33,  1.89it/s] 10%|█         | 20/195 [00:12<01:25,  2.06it/s] 11%|█▏        | 22/195 [00:13<01:23,  2.07it/s] 12%|█▏        | 24/195 [00:14<01:14,  2.31it/s] 13%|█▎        | 26/195 [00:15<01:10,  2.40it/s] 14%|█▍        | 27/195 [00:15<01:01,  2.72it/s] 14%|█▍        | 28/195 [00:15<01:12,  2.29it/s] 15%|█▌        | 30/195 [00:16<01:05,  2.51it/s] 16%|█▌        | 31/195 [00:17<01:18,  2.08it/s] 16%|█▋        | 32/195 [00:17<01:17,  2.11it/s] 17%|█▋        | 33/195 [00:18<01:36,  1.68it/s] 17%|█▋        | 34/195 [00:19<01:28,  1.83it/s] 18%|█▊        | 35/195 [00:19<01:30,  1.77it/s] 18%|█▊        | 36/195 [00:20<01:16,  2.09it/s] 19%|█▉        | 37/195 [00:20<01:27,  1.80it/s] 19%|█▉        | 38/195 [00:21<01:13,  2.15it/s] 20%|██        | 39/195 [00:21<01:27,  1.79it/s] 21%|██        | 41/195 [00:22<01:08,  2.25it/s] 22%|██▏       | 42/195 [00:22<01:05,  2.33it/s] 22%|██▏       | 43/195 [00:23<01:03,  2.40it/s] 23%|██▎       | 44/195 [00:23<01:01,  2.45it/s] 23%|██▎       | 45/195 [00:24<01:04,  2.33it/s] 24%|██▎       | 46/195 [00:24<01:03,  2.36it/s] 24%|██▍       | 47/195 [00:25<01:05,  2.27it/s] 25%|██▍       | 48/195 [00:25<01:03,  2.32it/s] 25%|██▌       | 49/195 [00:25<01:07,  2.17it/s] 26%|██▌       | 50/195 [00:26<01:09,  2.08it/s] 26%|██▌       | 51/195 [00:26<01:10,  2.06it/s] 27%|██▋       | 52/195 [00:27<01:08,  2.10it/s] 27%|██▋       | 53/195 [00:27<01:10,  2.01it/s] 28%|██▊       | 54/195 [00:28<01:10,  2.00it/s] 28%|██▊       | 55/195 [00:28<01:05,  2.15it/s] 29%|██▊       | 56/195 [00:29<01:05,  2.11it/s] 29%|██▉       | 57/195 [00:29<01:01,  2.24it/s] 30%|██▉       | 58/195 [00:30<01:06,  2.05it/s] 30%|███       | 59/195 [00:30<00:55,  2.44it/s] 31%|███       | 60/195 [00:31<01:02,  2.15it/s] 31%|███▏      | 61/195 [00:31<00:50,  2.67it/s] 32%|███▏      | 62/195 [00:31<01:00,  2.19it/s] 32%|███▏      | 63/195 [00:32<01:13,  1.80it/s] 33%|███▎      | 64/195 [00:33<01:10,  1.86it/s] 34%|███▍      | 66/195 [00:33<00:53,  2.42it/s] 34%|███▍      | 67/195 [00:33<00:44,  2.85it/s] 35%|███▍      | 68/195 [00:34<00:46,  2.72it/s] 35%|███▌      | 69/195 [00:34<00:39,  3.18it/s] 36%|███▌      | 70/195 [00:34<00:43,  2.89it/s] 36%|███▋      | 71/195 [00:35<00:59,  2.07it/s] 37%|███▋      | 72/195 [00:36<00:52,  2.35it/s] 37%|███▋      | 73/195 [00:36<01:05,  1.86it/s] 38%|███▊      | 74/195 [00:37<00:59,  2.04it/s] 38%|███▊      | 75/195 [00:37<00:48,  2.47it/s] 39%|███▉      | 76/195 [00:37<00:47,  2.50it/s] 39%|███▉      | 77/195 [00:38<00:40,  2.92it/s] 40%|████      | 78/195 [00:38<00:47,  2.44it/s] 41%|████      | 79/195 [00:38<00:45,  2.55it/s] 41%|████      | 80/195 [00:39<00:38,  3.00it/s] 42%|████▏     | 81/195 [00:39<00:43,  2.63it/s] 42%|████▏     | 82/195 [00:39<00:40,  2.78it/s] 43%|████▎     | 83/195 [00:40<00:47,  2.37it/s] 43%|████▎     | 84/195 [00:40<00:46,  2.39it/s] 44%|████▎     | 85/195 [00:41<00:49,  2.20it/s] 44%|████▍     | 86/195 [00:41<00:47,  2.28it/s] 45%|████▍     | 87/195 [00:42<00:43,  2.48it/s] 45%|████▌     | 88/195 [00:42<00:44,  2.43it/s] 46%|████▌     | 89/195 [00:42<00:39,  2.70it/s] 46%|████▌     | 90/195 [00:43<00:41,  2.51it/s] 47%|████▋     | 91/195 [00:43<00:34,  3.05it/s] 47%|████▋     | 92/195 [00:44<00:40,  2.56it/s] 48%|████▊     | 93/195 [00:44<00:36,  2.83it/s] 48%|████▊     | 94/195 [00:44<00:36,  2.78it/s] 49%|████▊     | 95/195 [00:44<00:30,  3.23it/s] 49%|████▉     | 96/195 [00:45<00:33,  2.94it/s] 50%|████▉     | 97/195 [00:45<00:27,  3.57it/s] 50%|█████     | 98/195 [00:45<00:34,  2.85it/s] 51%|█████▏    | 100/195 [00:46<00:34,  2.76it/s] 52%|█████▏    | 101/195 [00:47<00:43,  2.14it/s] 52%|█████▏    | 102/195 [00:48<00:46,  2.00it/s] 53%|█████▎    | 103/195 [00:48<00:52,  1.75it/s] 53%|█████▎    | 104/195 [00:49<00:51,  1.78it/s] 54%|█████▍    | 105/195 [00:50<00:54,  1.66it/s] 54%|█████▍    | 106/195 [00:50<00:46,  1.92it/s] 55%|█████▍    | 107/195 [00:51<00:53,  1.63it/s] 56%|█████▌    | 109/195 [00:52<00:44,  1.92it/s] 56%|█████▋    | 110/195 [00:52<00:41,  2.06it/s] 57%|█████▋    | 111/195 [00:53<00:47,  1.77it/s] 57%|█████▋    | 112/195 [00:53<00:43,  1.91it/s] 58%|█████▊    | 113/195 [00:54<00:47,  1.74it/s] 58%|█████▊    | 114/195 [00:54<00:39,  2.05it/s] 59%|█████▉    | 115/195 [00:55<00:44,  1.82it/s] 60%|██████    | 117/195 [00:56<00:36,  2.12it/s] 61%|██████    | 118/195 [00:56<00:32,  2.39it/s] 61%|██████    | 119/195 [00:56<00:34,  2.21it/s] 62%|██████▏   | 120/195 [00:57<00:28,  2.62it/s] 62%|██████▏   | 121/195 [00:57<00:34,  2.13it/s] 63%|██████▎   | 122/195 [00:58<00:29,  2.49it/s] 63%|██████▎   | 123/195 [00:58<00:31,  2.26it/s] 64%|██████▎   | 124/195 [00:58<00:30,  2.36it/s] 64%|██████▍   | 125/195 [00:59<00:28,  2.43it/s] 65%|██████▍   | 126/195 [00:59<00:27,  2.52it/s] 65%|██████▌   | 127/195 [00:59<00:24,  2.79it/s] 66%|██████▌   | 128/195 [01:00<00:25,  2.61it/s] 66%|██████▌   | 129/195 [01:00<00:22,  2.91it/s] 67%|██████▋   | 130/195 [01:01<00:26,  2.43it/s] 67%|██████▋   | 131/195 [01:01<00:23,  2.67it/s] 68%|██████▊   | 132/195 [01:02<00:26,  2.42it/s] 68%|██████▊   | 133/195 [01:02<00:23,  2.59it/s] 69%|██████▊   | 134/195 [01:02<00:26,  2.33it/s] 69%|██████▉   | 135/195 [01:03<00:23,  2.56it/s] 70%|██████▉   | 136/195 [01:03<00:24,  2.43it/s] 70%|███████   | 137/195 [01:03<00:23,  2.52it/s] 71%|███████   | 138/195 [01:04<00:23,  2.45it/s] 71%|███████▏  | 139/195 [01:04<00:22,  2.54it/s] 72%|███████▏  | 140/195 [01:05<00:20,  2.65it/s] 72%|███████▏  | 141/195 [01:05<00:19,  2.75it/s] 73%|███████▎  | 142/195 [01:05<00:17,  3.00it/s] 73%|███████▎  | 143/195 [01:06<00:18,  2.87it/s] 74%|███████▍  | 144/195 [01:06<00:17,  2.98it/s] 74%|███████▍  | 145/195 [01:06<00:17,  2.94it/s] 75%|███████▍  | 146/195 [01:07<00:17,  2.83it/s] 75%|███████▌  | 147/195 [01:07<00:16,  2.98it/s] 76%|███████▌  | 148/195 [01:07<00:18,  2.47it/s] 77%|███████▋  | 150/195 [01:08<00:18,  2.42it/s] 78%|███████▊  | 152/195 [01:09<00:17,  2.42it/s] 79%|███████▉  | 154/195 [01:10<00:16,  2.51it/s] 79%|███████▉  | 155/195 [01:10<00:13,  2.89it/s] 80%|████████  | 156/195 [01:11<00:17,  2.26it/s] 81%|████████  | 157/195 [01:11<00:14,  2.64it/s] 81%|████████  | 158/195 [01:12<00:16,  2.22it/s] 82%|████████▏ | 159/195 [01:12<00:14,  2.55it/s] 82%|████████▏ | 160/195 [01:13<00:16,  2.16it/s] 83%|████████▎ | 161/195 [01:13<00:13,  2.49it/s] 83%|████████▎ | 162/195 [01:13<00:15,  2.14it/s] 84%|████████▍ | 164/195 [01:14<00:13,  2.34it/s] 85%|████████▌ | 166/195 [01:15<00:12,  2.39it/s] 86%|████████▌ | 167/195 [01:15<00:10,  2.75it/s] 86%|████████▌ | 168/195 [01:16<00:11,  2.33it/s] 87%|████████▋ | 169/195 [01:16<00:09,  2.67it/s] 87%|████████▋ | 170/195 [01:16<00:10,  2.48it/s] 88%|████████▊ | 171/195 [01:17<00:08,  2.94it/s] 88%|████████▊ | 172/195 [01:17<00:08,  2.74it/s] 89%|████████▊ | 173/195 [01:17<00:06,  3.17it/s] 89%|████████▉ | 174/195 [01:18<00:07,  2.98it/s] 90%|████████▉ | 175/195 [01:18<00:06,  3.17it/s] 90%|█████████ | 176/195 [01:18<00:06,  2.88it/s] 91%|█████████ | 177/195 [01:19<00:05,  3.10it/s] 91%|█████████▏| 178/195 [01:19<00:05,  2.87it/s] 92%|█████████▏| 179/195 [01:19<00:05,  3.06it/s] 92%|█████████▏| 180/195 [01:20<00:05,  2.65it/s] 93%|█████████▎| 181/195 [01:20<00:04,  2.83it/s] 93%|█████████▎| 182/195 [01:21<00:04,  2.61it/s] 94%|█████████▍| 183/195 [01:21<00:04,  2.97it/s] 94%|█████████▍| 184/195 [01:21<00:04,  2.70it/s] 95%|█████████▍| 185/195 [01:22<00:04,  2.33it/s] 95%|█████████▌| 186/195 [01:22<00:03,  2.56it/s] 96%|█████████▌| 187/195 [01:23<00:03,  2.16it/s] 96%|█████████▋| 188/195 [01:23<00:02,  2.47it/s] 97%|█████████▋| 189/195 [01:24<00:02,  2.18it/s] 97%|█████████▋| 190/195 [01:24<00:01,  2.61it/s] 98%|█████████▊| 191/195 [01:24<00:01,  2.33it/s] 98%|█████████▊| 192/195 [01:25<00:01,  2.27it/s] 99%|█████████▉| 193/195 [01:25<00:00,  2.55it/s] 99%|█████████▉| 194/195 [01:25<00:00,  2.56it/s]100%|██████████| 195/195 [01:26<00:00,  3.14it/s]100%|██████████| 195/195 [01:28<00:00,  2.21it/s]
2025-08-21 08:21:59 [info     ] Validating outputs
2025-08-21 08:21:59 [info     ] Predict - end                  time=0:1:28
2025-08-21 08:21:59 [info     ] Evaluate - start               split=test
2025-08-21 08:21:59 [info     ] Evaluate - end                 correctness_llm=0.26 monotonicity=0.76
2025-08-21 08:21:59 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:21:59 [info     ] Augmenting questions for IRT estimation num_questions=5
2025-08-21 08:21:59 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:21:59 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1106.97it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3758.60it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 482.73it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6324.89it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1030.98it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3769.94it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 557.99it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6264.16it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1041.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3707.82it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 546.13it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 2395.77it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1029.17it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3658.31it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 527.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5536.51it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1112.04it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3630.95it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 570.86it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6495.60it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 978.21it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3645.76it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 632.27it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6346.76it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1066.90it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3728.02it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 651.68it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6451.36it/s]
2025-08-21 08:22:05 INFO: Likelihood descrease, stops at iteration 7.
Likelihood descrease, stops at iteration 7.
Likelihood descrease, stops at iteration 7.
Likelihood descrease, stops at iteration 7.
Likelihood descrease, stops at iteration 7.
Likelihood descrease, stops at iteration 7.
Likelihood descrease, stops at iteration 7.
Likelihood descrease, stops at iteration 7.
Likelihood descrease, stops at iteration 7.
Likelihood descrease, stops at iteration 7.
Likelihood descrease, stops at iteration 7.
Likelihood descrease, stops at iteration 7.
Likelihood descrease, stops at iteration 7.
Likelihood descrease, stops at iteration 7.
Likelihood descrease, stops at iteration 7.
Likelihood descrease, stops at iteration 7.
Likelihood descrease, stops at iteration 7.
Likelihood descrease, stops at iteration 7.
2025-08-21 08:22:05 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:22:05 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:22:05 [info     ] Evaluate question difficulty - end rmse=2.9229447885638145 split=test
2025-08-21 08:22:05 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 2 finished: 0:1:44

 ********** Run: 3/3 **********
2025-08-21 08:22:24 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:22:24 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:22:24 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:22:24 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:22:26 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:22:26 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:22:31 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:22:31 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:22:31 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:22:32 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:22:35 [info     ] Setting seed                   value=45
2025-08-21 08:22:35 [info     ] Building structured outputter  name=student_kt
2025-08-21 08:22:35 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_chocolate_level_nocontext
2025-08-21 08:22:35 [info     ] Building model                 name=llama3.1:8b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:22:35 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:02<06:59,  2.16s/it]  1%|          | 2/195 [00:03<04:38,  1.44s/it]  2%|▏         | 3/195 [00:03<03:47,  1.18s/it]  2%|▏         | 4/195 [00:04<03:04,  1.04it/s]  3%|▎         | 5/195 [00:05<02:44,  1.15it/s]  3%|▎         | 6/195 [00:06<02:37,  1.20it/s]  4%|▍         | 8/195 [00:07<02:03,  1.52it/s]  5%|▍         | 9/195 [00:07<01:51,  1.66it/s]  5%|▌         | 10/195 [00:08<01:51,  1.67it/s]  6%|▌         | 11/195 [00:08<01:35,  1.93it/s]  6%|▌         | 12/195 [00:08<01:35,  1.91it/s]  7%|▋         | 13/195 [00:09<01:36,  1.89it/s]  7%|▋         | 14/195 [00:09<01:32,  1.96it/s]  8%|▊         | 15/195 [00:10<01:26,  2.08it/s]  8%|▊         | 16/195 [00:10<01:30,  1.98it/s]  9%|▊         | 17/195 [00:11<01:24,  2.11it/s]  9%|▉         | 18/195 [00:11<01:15,  2.35it/s] 10%|▉         | 19/195 [00:12<01:16,  2.30it/s] 10%|█         | 20/195 [00:12<01:10,  2.50it/s] 11%|█         | 21/195 [00:13<01:24,  2.06it/s] 11%|█▏        | 22/195 [00:13<01:14,  2.32it/s] 12%|█▏        | 23/195 [00:14<01:30,  1.91it/s] 13%|█▎        | 25/195 [00:14<01:21,  2.08it/s] 13%|█▎        | 26/195 [00:15<01:07,  2.49it/s] 14%|█▍        | 27/195 [00:15<01:17,  2.17it/s] 14%|█▍        | 28/195 [00:15<01:03,  2.65it/s] 15%|█▍        | 29/195 [00:16<01:16,  2.17it/s] 16%|█▌        | 31/195 [00:17<01:28,  1.86it/s] 16%|█▋        | 32/195 [00:18<01:12,  2.25it/s] 17%|█▋        | 33/195 [00:18<01:30,  1.79it/s] 17%|█▋        | 34/195 [00:19<01:22,  1.95it/s] 18%|█▊        | 35/195 [00:19<01:30,  1.77it/s] 18%|█▊        | 36/195 [00:20<01:10,  2.25it/s] 19%|█▉        | 37/195 [00:20<01:23,  1.89it/s] 19%|█▉        | 38/195 [00:21<01:13,  2.14it/s] 20%|██        | 39/195 [00:22<01:31,  1.71it/s] 21%|██        | 41/195 [00:22<01:14,  2.08it/s] 22%|██▏       | 42/195 [00:23<01:08,  2.23it/s] 22%|██▏       | 43/195 [00:23<01:06,  2.29it/s] 23%|██▎       | 44/195 [00:23<01:05,  2.30it/s] 23%|██▎       | 45/195 [00:24<01:07,  2.23it/s] 24%|██▎       | 46/195 [00:24<01:05,  2.28it/s] 24%|██▍       | 47/195 [00:25<01:08,  2.16it/s] 25%|██▍       | 48/195 [00:25<01:04,  2.26it/s] 25%|██▌       | 49/195 [00:26<01:05,  2.21it/s] 26%|██▌       | 50/195 [00:26<01:06,  2.18it/s] 26%|██▌       | 51/195 [00:27<01:05,  2.18it/s] 27%|██▋       | 52/195 [00:27<01:03,  2.24it/s] 27%|██▋       | 53/195 [00:28<01:05,  2.17it/s] 28%|██▊       | 54/195 [00:28<01:04,  2.18it/s] 28%|██▊       | 55/195 [00:28<01:02,  2.23it/s] 29%|██▊       | 56/195 [00:29<01:04,  2.17it/s] 29%|██▉       | 57/195 [00:29<01:00,  2.28it/s] 30%|██▉       | 58/195 [00:30<01:07,  2.02it/s] 30%|███       | 59/195 [00:30<00:56,  2.39it/s] 31%|███       | 60/195 [00:31<01:02,  2.17it/s] 31%|███▏      | 61/195 [00:31<00:49,  2.72it/s] 32%|███▏      | 62/195 [00:31<00:56,  2.35it/s] 32%|███▏      | 63/195 [00:32<01:07,  1.96it/s] 33%|███▎      | 64/195 [00:33<01:05,  2.02it/s] 34%|███▍      | 66/195 [00:33<00:48,  2.63it/s] 34%|███▍      | 67/195 [00:33<00:41,  3.11it/s] 35%|███▍      | 68/195 [00:34<00:42,  2.98it/s] 35%|███▌      | 69/195 [00:34<00:36,  3.48it/s] 36%|███▌      | 70/195 [00:34<00:39,  3.19it/s] 36%|███▋      | 71/195 [00:35<00:55,  2.23it/s] 37%|███▋      | 72/195 [00:35<00:49,  2.50it/s] 37%|███▋      | 73/195 [00:36<01:03,  1.93it/s] 38%|███▊      | 74/195 [00:36<00:57,  2.09it/s] 38%|███▊      | 75/195 [00:37<00:47,  2.54it/s] 39%|███▉      | 76/195 [00:37<00:46,  2.55it/s] 39%|███▉      | 77/195 [00:37<00:40,  2.90it/s] 40%|████      | 78/195 [00:38<00:51,  2.28it/s] 41%|████      | 79/195 [00:38<00:47,  2.45it/s] 41%|████      | 80/195 [00:38<00:39,  2.93it/s] 42%|████▏     | 81/195 [00:39<00:46,  2.46it/s] 42%|████▏     | 82/195 [00:39<00:43,  2.57it/s] 43%|████▎     | 83/195 [00:40<00:47,  2.37it/s] 43%|████▎     | 84/195 [00:40<00:44,  2.48it/s] 44%|████▎     | 85/195 [00:41<00:46,  2.36it/s] 44%|████▍     | 86/195 [00:41<00:44,  2.47it/s] 45%|████▍     | 87/195 [00:41<00:39,  2.71it/s] 45%|████▌     | 88/195 [00:42<00:39,  2.71it/s] 46%|████▌     | 89/195 [00:42<00:35,  3.00it/s] 46%|████▌     | 90/195 [00:42<00:37,  2.80it/s] 47%|████▋     | 91/195 [00:43<00:31,  3.31it/s] 47%|████▋     | 92/195 [00:43<00:39,  2.62it/s] 48%|████▊     | 93/195 [00:43<00:35,  2.85it/s] 48%|████▊     | 94/195 [00:44<00:37,  2.66it/s] 49%|████▊     | 95/195 [00:44<00:32,  3.08it/s] 49%|████▉     | 96/195 [00:44<00:35,  2.77it/s] 50%|████▉     | 97/195 [00:45<00:29,  3.35it/s] 50%|█████     | 98/195 [00:45<00:33,  2.85it/s] 51%|█████▏    | 100/195 [00:46<00:34,  2.74it/s] 52%|█████▏    | 101/195 [00:47<00:45,  2.08it/s] 52%|█████▏    | 102/195 [00:47<00:49,  1.90it/s] 53%|█████▎    | 103/195 [00:48<00:56,  1.63it/s] 53%|█████▎    | 104/195 [00:49<00:56,  1.61it/s] 54%|█████▍    | 105/195 [00:50<01:00,  1.50it/s] 54%|█████▍    | 106/195 [00:50<00:49,  1.82it/s] 55%|█████▍    | 107/195 [00:51<00:55,  1.58it/s] 56%|█████▌    | 109/195 [00:52<00:45,  1.88it/s] 56%|█████▋    | 110/195 [00:52<00:42,  2.02it/s] 57%|█████▋    | 111/195 [00:53<00:47,  1.76it/s] 57%|█████▋    | 112/195 [00:53<00:43,  1.90it/s] 58%|█████▊    | 113/195 [00:54<00:47,  1.73it/s] 58%|█████▊    | 114/195 [00:54<00:39,  2.03it/s] 59%|█████▉    | 115/195 [00:55<00:46,  1.74it/s] 60%|██████    | 117/195 [00:56<00:38,  2.05it/s] 61%|██████    | 118/195 [00:56<00:33,  2.32it/s] 61%|██████    | 119/195 [00:56<00:36,  2.09it/s] 62%|██████▏   | 120/195 [00:57<00:30,  2.46it/s] 62%|██████▏   | 121/195 [00:57<00:36,  2.04it/s] 63%|██████▎   | 122/195 [00:58<00:30,  2.40it/s] 63%|██████▎   | 123/195 [00:58<00:32,  2.20it/s] 64%|██████▎   | 124/195 [00:59<00:30,  2.36it/s] 64%|██████▍   | 125/195 [00:59<00:28,  2.49it/s] 65%|██████▍   | 126/195 [00:59<00:26,  2.58it/s] 65%|██████▌   | 127/195 [01:00<00:24,  2.74it/s] 66%|██████▌   | 128/195 [01:00<00:25,  2.67it/s] 66%|██████▌   | 129/195 [01:00<00:22,  2.88it/s] 67%|██████▋   | 130/195 [01:01<00:25,  2.50it/s] 67%|██████▋   | 131/195 [01:01<00:24,  2.64it/s] 68%|██████▊   | 132/195 [01:02<00:25,  2.46it/s] 68%|██████▊   | 133/195 [01:02<00:24,  2.56it/s] 69%|██████▊   | 134/195 [01:02<00:25,  2.37it/s] 69%|██████▉   | 135/195 [01:03<00:23,  2.54it/s] 70%|██████▉   | 136/195 [01:03<00:22,  2.60it/s] 70%|███████   | 137/195 [01:03<00:20,  2.77it/s] 71%|███████   | 138/195 [01:04<00:22,  2.53it/s] 71%|███████▏  | 139/195 [01:04<00:20,  2.78it/s] 72%|███████▏  | 140/195 [01:05<00:22,  2.45it/s] 73%|███████▎  | 142/195 [01:05<00:19,  2.68it/s] 73%|███████▎  | 143/195 [01:06<00:17,  2.97it/s] 74%|███████▍  | 144/195 [01:06<00:18,  2.75it/s] 74%|███████▍  | 145/195 [01:06<00:18,  2.76it/s] 75%|███████▍  | 146/195 [01:07<00:17,  2.73it/s] 75%|███████▌  | 147/195 [01:07<00:17,  2.69it/s] 76%|███████▌  | 148/195 [01:07<00:16,  2.85it/s] 76%|███████▋  | 149/195 [01:08<00:16,  2.74it/s] 77%|███████▋  | 150/195 [01:08<00:17,  2.61it/s] 77%|███████▋  | 151/195 [01:09<00:15,  2.75it/s] 78%|███████▊  | 152/195 [01:09<00:15,  2.77it/s] 78%|███████▊  | 153/195 [01:09<00:15,  2.65it/s] 79%|███████▉  | 154/195 [01:10<00:14,  2.90it/s] 79%|███████▉  | 155/195 [01:10<00:14,  2.77it/s] 80%|████████  | 156/195 [01:10<00:14,  2.70it/s] 81%|████████  | 157/195 [01:11<00:15,  2.41it/s] 81%|████████  | 158/195 [01:11<00:14,  2.53it/s] 82%|████████▏ | 159/195 [01:12<00:14,  2.47it/s] 82%|████████▏ | 160/195 [01:12<00:15,  2.32it/s] 83%|████████▎ | 161/195 [01:12<00:12,  2.62it/s] 83%|████████▎ | 162/195 [01:13<00:15,  2.11it/s] 84%|████████▍ | 164/195 [01:14<00:12,  2.51it/s] 85%|████████▍ | 165/195 [01:14<00:10,  2.96it/s] 85%|████████▌ | 166/195 [01:15<00:11,  2.42it/s] 86%|████████▌ | 167/195 [01:15<00:13,  2.02it/s] 86%|████████▌ | 168/195 [01:15<00:11,  2.40it/s] 87%|████████▋ | 169/195 [01:16<00:11,  2.18it/s] 87%|████████▋ | 170/195 [01:16<00:10,  2.48it/s] 88%|████████▊ | 171/195 [01:17<00:11,  2.06it/s] 88%|████████▊ | 172/195 [01:17<00:10,  2.25it/s] 89%|████████▊ | 173/195 [01:18<00:10,  2.12it/s] 89%|████████▉ | 174/195 [01:18<00:08,  2.52it/s] 90%|████████▉ | 175/195 [01:18<00:07,  2.58it/s] 90%|█████████ | 176/195 [01:19<00:07,  2.67it/s] 91%|█████████ | 177/195 [01:19<00:06,  2.83it/s] 91%|█████████▏| 178/195 [01:19<00:06,  2.73it/s] 92%|█████████▏| 179/195 [01:20<00:05,  2.96it/s] 92%|█████████▏| 180/195 [01:20<00:06,  2.39it/s] 93%|█████████▎| 182/195 [01:21<00:05,  2.53it/s] 94%|█████████▍| 184/195 [01:22<00:04,  2.74it/s] 95%|█████████▍| 185/195 [01:22<00:03,  2.59it/s] 95%|█████████▌| 186/195 [01:23<00:03,  2.49it/s] 96%|█████████▌| 187/195 [01:23<00:03,  2.37it/s] 96%|█████████▋| 188/195 [01:24<00:02,  2.42it/s] 97%|█████████▋| 189/195 [01:24<00:02,  2.31it/s] 97%|█████████▋| 190/195 [01:25<00:02,  2.18it/s] 98%|█████████▊| 191/195 [01:25<00:01,  2.45it/s] 98%|█████████▊| 192/195 [01:26<00:01,  1.88it/s] 99%|█████████▉| 193/195 [01:26<00:00,  2.35it/s] 99%|█████████▉| 194/195 [01:26<00:00,  2.09it/s]100%|██████████| 195/195 [01:29<00:00,  2.19it/s]
2025-08-21 08:24:04 [info     ] Validating outputs
2025-08-21 08:24:04 [info     ] Predict - end                  time=0:1:29
2025-08-21 08:24:04 [info     ] Evaluate - start               split=test
2025-08-21 08:24:04 [info     ] Evaluate - end                 correctness_llm=0.27 monotonicity=0.93
2025-08-21 08:24:04 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:24:04 [info     ] Augmenting questions for IRT estimation num_questions=6
2025-08-21 08:24:04 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:24:04 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1149.21it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3560.30it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 485.55it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6495.60it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 789.42it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3520.45it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 534.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6665.18it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1044.40it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3527.13it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 449.43it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7185.54it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 982.96it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3958.52it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 537.95it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6890.43it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1146.97it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3582.21it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 448.32it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7005.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1073.97it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3629.90it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 484.22it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6761.89it/s]
2025-08-21 08:24:09 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-08-21 08:24:09 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:24:09 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:24:09 [info     ] Evaluate question difficulty - end rmse=2.7841034786966166 split=test
2025-08-21 08:24:09 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 3 finished: 0:1:44

 ========== Config: qwen3:4b~T_0.0~SO_teacher_kt~L_5~SP_teacher_marshmellow_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_miscon_studentlevel_random0 ==========
Config 7/8

 ********** Run: 1/3 **********
2025-08-21 08:24:29 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:24:29 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:24:29 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:24:29 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:24:31 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:24:31 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:24:36 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:24:36 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:24:36 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:24:36 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:24:39 [info     ] Setting seed                   value=43
2025-08-21 08:24:39 [info     ] Building structured outputter  name=teacher_kt
2025-08-21 08:24:39 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_marshmellow_level_nocontext
2025-08-21 08:24:39 [info     ] Building model                 name=qwen3:4b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:24:39 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:03<11:23,  3.53s/it]  2%|▏         | 3/195 [00:04<04:33,  1.42s/it]  2%|▏         | 4/195 [00:05<03:14,  1.02s/it]  3%|▎         | 5/195 [00:05<03:00,  1.05it/s]  4%|▎         | 7/195 [00:06<01:55,  1.63it/s]  4%|▍         | 8/195 [00:06<01:35,  1.96it/s]  5%|▍         | 9/195 [00:07<01:28,  2.10it/s]  5%|▌         | 10/195 [00:07<01:13,  2.53it/s]  6%|▌         | 11/195 [00:07<01:03,  2.88it/s]  6%|▌         | 12/195 [00:07<00:55,  3.31it/s]  7%|▋         | 13/195 [00:07<00:48,  3.72it/s]  7%|▋         | 14/195 [00:08<00:47,  3.79it/s]  8%|▊         | 15/195 [00:08<00:42,  4.28it/s]  8%|▊         | 16/195 [00:08<00:43,  4.11it/s]  9%|▊         | 17/195 [00:08<00:38,  4.61it/s]  9%|▉         | 18/195 [00:08<00:39,  4.43it/s] 10%|▉         | 19/195 [00:09<00:36,  4.81it/s] 10%|█         | 20/195 [00:09<00:38,  4.50it/s] 11%|█         | 21/195 [00:09<00:37,  4.61it/s] 11%|█▏        | 22/195 [00:09<00:42,  4.07it/s] 12%|█▏        | 23/195 [00:10<00:37,  4.61it/s] 12%|█▏        | 24/195 [00:10<00:41,  4.09it/s] 13%|█▎        | 25/195 [00:10<00:37,  4.55it/s] 13%|█▎        | 26/195 [00:10<00:40,  4.13it/s] 14%|█▍        | 27/195 [00:11<00:38,  4.33it/s] 14%|█▍        | 28/195 [00:11<00:40,  4.13it/s] 15%|█▍        | 29/195 [00:11<00:37,  4.39it/s] 15%|█▌        | 30/195 [00:11<00:38,  4.27it/s] 16%|█▌        | 31/195 [00:11<00:37,  4.43it/s] 16%|█▋        | 32/195 [00:12<00:37,  4.32it/s] 17%|█▋        | 33/195 [00:12<00:34,  4.70it/s] 17%|█▋        | 34/195 [00:12<00:36,  4.37it/s] 18%|█▊        | 35/195 [00:12<00:33,  4.79it/s] 18%|█▊        | 36/195 [00:13<00:35,  4.50it/s] 19%|█▉        | 37/195 [00:13<00:33,  4.79it/s] 19%|█▉        | 38/195 [00:13<00:35,  4.47it/s] 20%|██        | 39/195 [00:13<00:31,  4.96it/s] 21%|██        | 40/195 [00:13<00:33,  4.64it/s] 21%|██        | 41/195 [00:14<00:30,  5.06it/s] 22%|██▏       | 42/195 [00:14<00:33,  4.55it/s] 22%|██▏       | 43/195 [00:14<00:31,  4.87it/s] 23%|██▎       | 44/195 [00:14<00:32,  4.65it/s] 23%|██▎       | 45/195 [00:14<00:30,  4.85it/s] 24%|██▎       | 46/195 [00:15<00:34,  4.29it/s] 24%|██▍       | 47/195 [00:15<00:31,  4.74it/s] 25%|██▍       | 48/195 [00:15<00:36,  4.02it/s] 25%|██▌       | 49/195 [00:15<00:30,  4.76it/s] 26%|██▌       | 50/195 [00:16<00:41,  3.52it/s] 27%|██▋       | 52/195 [00:16<00:41,  3.45it/s] 27%|██▋       | 53/195 [00:17<00:38,  3.68it/s] 28%|██▊       | 54/195 [00:17<00:42,  3.33it/s] 28%|██▊       | 55/195 [00:17<00:41,  3.40it/s] 29%|██▊       | 56/195 [00:18<00:40,  3.40it/s] 29%|██▉       | 57/195 [00:18<00:40,  3.42it/s] 30%|██▉       | 58/195 [00:18<00:38,  3.57it/s] 30%|███       | 59/195 [00:18<00:40,  3.37it/s] 31%|███       | 60/195 [00:19<00:35,  3.83it/s] 31%|███▏      | 61/195 [00:19<00:37,  3.54it/s] 32%|███▏      | 63/195 [00:19<00:33,  3.90it/s] 33%|███▎      | 64/195 [00:20<00:30,  4.26it/s] 33%|███▎      | 65/195 [00:20<00:33,  3.88it/s] 34%|███▍      | 66/195 [00:20<00:28,  4.47it/s] 34%|███▍      | 67/195 [00:20<00:32,  3.97it/s] 35%|███▍      | 68/195 [00:20<00:28,  4.40it/s] 35%|███▌      | 69/195 [00:21<00:31,  4.01it/s] 36%|███▌      | 70/195 [00:21<00:27,  4.51it/s] 36%|███▋      | 71/195 [00:21<00:30,  4.04it/s] 37%|███▋      | 72/195 [00:21<00:29,  4.20it/s] 37%|███▋      | 73/195 [00:22<00:29,  4.12it/s] 38%|███▊      | 74/195 [00:22<00:30,  4.02it/s] 38%|███▊      | 75/195 [00:22<00:28,  4.28it/s] 39%|███▉      | 76/195 [00:22<00:27,  4.32it/s] 39%|███▉      | 77/195 [00:23<00:24,  4.87it/s] 40%|████      | 78/195 [00:23<00:25,  4.64it/s] 41%|████      | 79/195 [00:23<00:23,  4.89it/s] 41%|████      | 80/195 [00:23<00:25,  4.54it/s] 42%|████▏     | 81/195 [00:23<00:22,  5.00it/s] 42%|████▏     | 82/195 [00:24<00:23,  4.72it/s] 43%|████▎     | 83/195 [00:24<00:22,  4.95it/s] 43%|████▎     | 84/195 [00:24<00:25,  4.41it/s] 44%|████▎     | 85/195 [00:24<00:22,  4.90it/s] 44%|████▍     | 86/195 [00:24<00:24,  4.48it/s] 45%|████▍     | 87/195 [00:25<00:21,  4.97it/s] 45%|████▌     | 88/195 [00:25<00:25,  4.21it/s] 46%|████▌     | 89/195 [00:25<00:22,  4.70it/s] 46%|████▌     | 90/195 [00:25<00:24,  4.28it/s] 47%|████▋     | 91/195 [00:26<00:21,  4.73it/s] 47%|████▋     | 92/195 [00:26<00:24,  4.15it/s] 48%|████▊     | 93/195 [00:26<00:22,  4.61it/s] 48%|████▊     | 94/195 [00:26<00:24,  4.07it/s] 49%|████▊     | 95/195 [00:26<00:21,  4.56it/s] 49%|████▉     | 96/195 [00:27<00:22,  4.34it/s] 50%|████▉     | 97/195 [00:27<00:21,  4.52it/s] 50%|█████     | 98/195 [00:27<00:23,  4.14it/s] 51%|█████     | 99/195 [00:27<00:22,  4.33it/s] 51%|█████▏    | 100/195 [00:28<00:26,  3.56it/s] 52%|█████▏    | 101/195 [00:28<00:27,  3.41it/s] 52%|█████▏    | 102/195 [00:29<00:33,  2.77it/s] 53%|█████▎    | 103/195 [00:29<00:30,  3.02it/s] 53%|█████▎    | 104/195 [00:29<00:34,  2.63it/s] 54%|█████▍    | 106/195 [00:30<00:30,  2.89it/s] 55%|█████▍    | 107/195 [00:30<00:27,  3.16it/s] 55%|█████▌    | 108/195 [00:31<00:30,  2.84it/s] 56%|█████▌    | 109/195 [00:31<00:28,  3.07it/s] 56%|█████▋    | 110/195 [00:31<00:29,  2.85it/s] 57%|█████▋    | 111/195 [00:32<00:28,  2.94it/s] 57%|█████▋    | 112/195 [00:32<00:27,  3.02it/s] 58%|█████▊    | 113/195 [00:32<00:29,  2.81it/s] 58%|█████▊    | 114/195 [00:33<00:25,  3.16it/s] 59%|█████▉    | 115/195 [00:33<00:29,  2.71it/s] 60%|██████    | 117/195 [00:34<00:27,  2.82it/s] 61%|██████    | 118/195 [00:34<00:25,  3.08it/s] 61%|██████    | 119/195 [00:34<00:26,  2.82it/s] 62%|██████▏   | 120/195 [00:35<00:22,  3.31it/s] 62%|██████▏   | 121/195 [00:35<00:22,  3.34it/s] 63%|██████▎   | 122/195 [00:35<00:18,  3.96it/s] 63%|██████▎   | 123/195 [00:35<00:19,  3.68it/s] 64%|██████▎   | 124/195 [00:36<00:17,  4.01it/s] 64%|██████▍   | 125/195 [00:36<00:18,  3.76it/s] 65%|██████▍   | 126/195 [00:36<00:15,  4.35it/s] 65%|██████▌   | 127/195 [00:36<00:16,  4.08it/s] 66%|██████▌   | 128/195 [00:36<00:14,  4.55it/s] 66%|██████▌   | 129/195 [00:37<00:15,  4.21it/s] 67%|██████▋   | 130/195 [00:37<00:13,  4.75it/s] 67%|██████▋   | 131/195 [00:37<00:14,  4.34it/s] 68%|██████▊   | 132/195 [00:37<00:12,  4.89it/s] 68%|██████▊   | 133/195 [00:38<00:14,  4.27it/s] 69%|██████▊   | 134/195 [00:38<00:13,  4.66it/s] 69%|██████▉   | 135/195 [00:38<00:15,  3.92it/s] 70%|██████▉   | 136/195 [00:38<00:12,  4.59it/s] 70%|███████   | 137/195 [00:39<00:14,  4.11it/s] 71%|███████   | 138/195 [00:39<00:12,  4.59it/s] 71%|███████▏  | 139/195 [00:39<00:14,  3.96it/s] 72%|███████▏  | 140/195 [00:39<00:12,  4.43it/s] 72%|███████▏  | 141/195 [00:40<00:13,  4.13it/s] 73%|███████▎  | 142/195 [00:40<00:11,  4.63it/s] 73%|███████▎  | 143/195 [00:40<00:11,  4.40it/s] 74%|███████▍  | 144/195 [00:40<00:10,  4.64it/s] 74%|███████▍  | 145/195 [00:40<00:11,  4.53it/s] 75%|███████▍  | 146/195 [00:41<00:10,  4.57it/s] 75%|███████▌  | 147/195 [00:41<00:10,  4.56it/s] 76%|███████▌  | 148/195 [00:41<00:10,  4.39it/s] 76%|███████▋  | 149/195 [00:41<00:10,  4.57it/s] 77%|███████▋  | 150/195 [00:42<00:11,  4.07it/s] 77%|███████▋  | 151/195 [00:42<00:10,  4.31it/s] 78%|███████▊  | 152/195 [00:42<00:10,  3.91it/s] 78%|███████▊  | 153/195 [00:42<00:10,  4.16it/s] 79%|███████▉  | 154/195 [00:43<00:10,  3.79it/s] 79%|███████▉  | 155/195 [00:43<00:09,  4.36it/s] 80%|████████  | 156/195 [00:43<00:08,  4.40it/s] 81%|████████  | 157/195 [00:43<00:07,  4.93it/s] 81%|████████  | 158/195 [00:43<00:07,  4.79it/s] 82%|████████▏ | 159/195 [00:43<00:06,  5.31it/s] 82%|████████▏ | 160/195 [00:44<00:07,  4.98it/s] 83%|████████▎ | 161/195 [00:44<00:06,  5.19it/s] 83%|████████▎ | 162/195 [00:44<00:06,  4.75it/s] 84%|████████▎ | 163/195 [00:44<00:06,  4.86it/s] 84%|████████▍ | 164/195 [00:45<00:07,  4.18it/s] 85%|████████▍ | 165/195 [00:45<00:06,  4.65it/s] 85%|████████▌ | 166/195 [00:45<00:07,  4.04it/s] 86%|████████▌ | 167/195 [00:45<00:05,  4.74it/s] 86%|████████▌ | 168/195 [00:46<00:07,  3.61it/s] 87%|████████▋ | 170/195 [00:46<00:06,  3.91it/s] 88%|████████▊ | 171/195 [00:46<00:05,  4.44it/s] 88%|████████▊ | 172/195 [00:47<00:05,  4.05it/s] 89%|████████▊ | 173/195 [00:47<00:04,  4.64it/s] 89%|████████▉ | 174/195 [00:47<00:05,  4.15it/s] 90%|████████▉ | 175/195 [00:47<00:04,  4.70it/s] 90%|█████████ | 176/195 [00:47<00:04,  4.38it/s] 91%|█████████ | 177/195 [00:48<00:03,  4.98it/s] 91%|█████████▏| 178/195 [00:48<00:03,  4.56it/s] 92%|█████████▏| 179/195 [00:48<00:03,  5.16it/s] 92%|█████████▏| 180/195 [00:48<00:03,  4.55it/s] 93%|█████████▎| 181/195 [00:48<00:02,  4.94it/s] 93%|█████████▎| 182/195 [00:49<00:02,  4.40it/s] 94%|█████████▍| 183/195 [00:49<00:02,  5.01it/s] 94%|█████████▍| 184/195 [00:49<00:02,  4.58it/s] 95%|█████████▍| 185/195 [00:49<00:01,  5.19it/s] 95%|█████████▌| 186/195 [00:49<00:01,  4.71it/s] 96%|█████████▌| 187/195 [00:50<00:01,  5.18it/s] 96%|█████████▋| 188/195 [00:50<00:01,  4.68it/s] 97%|█████████▋| 189/195 [00:50<00:01,  5.22it/s] 97%|█████████▋| 190/195 [00:50<00:01,  4.60it/s] 98%|█████████▊| 191/195 [00:50<00:00,  4.78it/s] 98%|█████████▊| 192/195 [00:51<00:00,  4.07it/s] 99%|█████████▉| 193/195 [00:51<00:00,  4.55it/s] 99%|█████████▉| 194/195 [00:51<00:00,  4.13it/s]100%|██████████| 195/195 [00:53<00:00,  3.61it/s]
2025-08-21 08:25:33 [info     ] Validating outputs
2025-08-21 08:25:33 [info     ] Predict - end                  time=0:0:53
2025-08-21 08:25:33 [info     ] Evaluate - start               split=test
2025-08-21 08:25:33 [info     ] Evaluate - end                 correctness_llm=0.25 monotonicity=0.43
2025-08-21 08:25:33 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:25:33 [info     ] Augmenting questions for IRT estimation num_questions=9
2025-08-21 08:25:33 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:25:33 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1172.95it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3710.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 453.00it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8185.15it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1295.97it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3577.19it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 524.42it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8226.43it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1009.46it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 4164.94it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 574.29it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7971.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 901.70it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3514.10it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 630.57it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7704.05it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1032.93it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3721.06it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 599.34it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 9380.23it/s]
2025-08-21 08:25:37 INFO: Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
2025-08-21 08:25:37 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:25:37 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:25:37 [info     ] Evaluate question difficulty - end rmse=2.956637899775237 split=test
2025-08-21 08:25:37 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 1 finished: 0:1:8

 ********** Run: 2/3 **********
2025-08-21 08:25:58 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:25:58 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:25:58 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:25:58 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:26:00 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:26:00 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:26:05 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:26:05 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:26:05 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:26:06 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:26:09 [info     ] Setting seed                   value=44
2025-08-21 08:26:09 [info     ] Building structured outputter  name=teacher_kt
2025-08-21 08:26:09 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_marshmellow_level_nocontext
2025-08-21 08:26:09 [info     ] Building model                 name=qwen3:4b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:26:09 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<03:29,  1.08s/it]  1%|          | 2/195 [00:01<01:49,  1.77it/s]  2%|▏         | 3/195 [00:01<01:24,  2.27it/s]  2%|▏         | 4/195 [00:01<01:06,  2.89it/s]  3%|▎         | 5/195 [00:02<01:26,  2.19it/s]  3%|▎         | 6/195 [00:02<01:25,  2.22it/s]  4%|▎         | 7/195 [00:03<01:05,  2.87it/s]  4%|▍         | 8/195 [00:03<01:03,  2.97it/s]  5%|▌         | 10/195 [00:03<00:54,  3.37it/s]  6%|▌         | 12/195 [00:04<01:00,  3.02it/s]  7%|▋         | 13/195 [00:05<01:13,  2.46it/s]  7%|▋         | 14/195 [00:05<01:06,  2.71it/s]  8%|▊         | 15/195 [00:05<00:58,  3.06it/s]  8%|▊         | 16/195 [00:06<01:13,  2.44it/s]  9%|▉         | 18/195 [00:06<00:56,  3.11it/s] 10%|▉         | 19/195 [00:06<00:48,  3.63it/s] 10%|█         | 20/195 [00:07<00:50,  3.44it/s] 11%|█         | 21/195 [00:07<00:43,  4.03it/s] 11%|█▏        | 22/195 [00:07<00:49,  3.53it/s] 12%|█▏        | 24/195 [00:08<00:45,  3.79it/s] 13%|█▎        | 25/195 [00:08<00:38,  4.36it/s] 13%|█▎        | 26/195 [00:08<00:41,  4.12it/s] 14%|█▍        | 27/195 [00:08<00:36,  4.59it/s] 14%|█▍        | 28/195 [00:09<00:37,  4.42it/s] 15%|█▍        | 29/195 [00:09<00:35,  4.64it/s] 15%|█▌        | 30/195 [00:09<00:34,  4.73it/s] 16%|█▌        | 31/195 [00:09<00:36,  4.47it/s] 16%|█▋        | 32/195 [00:09<00:34,  4.73it/s] 17%|█▋        | 33/195 [00:10<00:37,  4.36it/s] 17%|█▋        | 34/195 [00:10<00:33,  4.78it/s] 18%|█▊        | 35/195 [00:10<00:37,  4.25it/s] 18%|█▊        | 36/195 [00:10<00:32,  4.93it/s] 19%|█▉        | 37/195 [00:11<00:37,  4.21it/s] 20%|██        | 39/195 [00:11<00:34,  4.52it/s] 21%|██        | 40/195 [00:11<00:30,  5.01it/s] 21%|██        | 41/195 [00:11<00:34,  4.42it/s] 22%|██▏       | 42/195 [00:11<00:31,  4.94it/s] 22%|██▏       | 43/195 [00:12<00:35,  4.24it/s] 23%|██▎       | 44/195 [00:12<00:31,  4.80it/s] 23%|██▎       | 45/195 [00:12<00:36,  4.15it/s] 24%|██▎       | 46/195 [00:12<00:31,  4.78it/s] 24%|██▍       | 47/195 [00:13<00:32,  4.49it/s] 25%|██▍       | 48/195 [00:13<00:28,  5.08it/s] 25%|██▌       | 49/195 [00:13<00:31,  4.64it/s] 26%|██▌       | 50/195 [00:13<00:30,  4.77it/s] 26%|██▌       | 51/195 [00:14<00:35,  4.01it/s] 27%|██▋       | 52/195 [00:14<00:37,  3.83it/s] 27%|██▋       | 53/195 [00:14<00:39,  3.61it/s] 28%|██▊       | 54/195 [00:15<00:41,  3.42it/s] 28%|██▊       | 55/195 [00:15<00:40,  3.49it/s] 29%|██▊       | 56/195 [00:15<00:42,  3.24it/s] 29%|██▉       | 57/195 [00:15<00:39,  3.46it/s] 30%|██▉       | 58/195 [00:16<00:45,  3.04it/s] 30%|███       | 59/195 [00:16<00:40,  3.38it/s] 31%|███       | 60/195 [00:16<00:42,  3.16it/s] 31%|███▏      | 61/195 [00:17<00:34,  3.85it/s] 32%|███▏      | 62/195 [00:17<00:39,  3.37it/s] 33%|███▎      | 64/195 [00:17<00:33,  3.93it/s] 33%|███▎      | 65/195 [00:17<00:28,  4.50it/s] 34%|███▍      | 66/195 [00:18<00:32,  4.03it/s] 34%|███▍      | 67/195 [00:18<00:27,  4.59it/s] 35%|███▍      | 68/195 [00:18<00:31,  4.07it/s] 35%|███▌      | 69/195 [00:18<00:27,  4.54it/s] 36%|███▌      | 70/195 [00:19<00:31,  4.00it/s] 36%|███▋      | 71/195 [00:19<00:28,  4.36it/s] 37%|███▋      | 72/195 [00:19<00:31,  3.86it/s] 37%|███▋      | 73/195 [00:19<00:28,  4.32it/s] 38%|███▊      | 74/195 [00:20<00:32,  3.71it/s] 38%|███▊      | 75/195 [00:20<00:28,  4.24it/s] 39%|███▉      | 76/195 [00:20<00:30,  3.97it/s] 40%|████      | 78/195 [00:21<00:27,  4.29it/s] 41%|████      | 79/195 [00:21<00:24,  4.75it/s] 41%|████      | 80/195 [00:21<00:27,  4.25it/s] 42%|████▏     | 81/195 [00:21<00:24,  4.66it/s] 42%|████▏     | 82/195 [00:21<00:26,  4.30it/s] 43%|████▎     | 83/195 [00:22<00:24,  4.52it/s] 43%|████▎     | 84/195 [00:22<00:24,  4.55it/s] 44%|████▎     | 85/195 [00:22<00:24,  4.55it/s] 44%|████▍     | 86/195 [00:22<00:23,  4.68it/s] 45%|████▍     | 87/195 [00:23<00:24,  4.37it/s] 45%|████▌     | 88/195 [00:23<00:22,  4.65it/s] 46%|████▌     | 89/195 [00:23<00:25,  4.22it/s] 46%|████▌     | 90/195 [00:23<00:23,  4.53it/s] 47%|████▋     | 91/195 [00:24<00:25,  4.14it/s] 47%|████▋     | 92/195 [00:24<00:23,  4.32it/s] 48%|████▊     | 93/195 [00:24<00:25,  4.02it/s] 48%|████▊     | 94/195 [00:24<00:23,  4.30it/s] 49%|████▊     | 95/195 [00:24<00:24,  4.14it/s] 49%|████▉     | 96/195 [00:25<00:21,  4.58it/s] 50%|████▉     | 97/195 [00:25<00:22,  4.39it/s] 50%|█████     | 98/195 [00:25<00:21,  4.50it/s] 51%|█████     | 99/195 [00:25<00:23,  4.12it/s] 51%|█████▏    | 100/195 [00:26<00:23,  4.05it/s] 52%|█████▏    | 101/195 [00:26<00:33,  2.84it/s] 53%|█████▎    | 103/195 [00:27<00:32,  2.81it/s] 53%|█████▎    | 104/195 [00:27<00:29,  3.12it/s] 54%|█████▍    | 105/195 [00:28<00:32,  2.75it/s] 54%|█████▍    | 106/195 [00:28<00:28,  3.08it/s] 55%|█████▍    | 107/195 [00:28<00:30,  2.87it/s] 55%|█████▌    | 108/195 [00:29<00:29,  2.93it/s] 56%|█████▌    | 109/195 [00:29<00:28,  2.97it/s] 56%|█████▋    | 110/195 [00:29<00:30,  2.76it/s] 57%|█████▋    | 111/195 [00:30<00:27,  3.06it/s] 57%|█████▋    | 112/195 [00:30<00:30,  2.75it/s] 58%|█████▊    | 114/195 [00:31<00:26,  3.03it/s] 59%|█████▉    | 115/195 [00:31<00:24,  3.28it/s] 59%|█████▉    | 116/195 [00:31<00:26,  2.95it/s] 60%|██████    | 117/195 [00:32<00:26,  2.93it/s] 61%|██████    | 118/195 [00:32<00:25,  3.02it/s] 61%|██████    | 119/195 [00:32<00:26,  2.87it/s] 62%|██████▏   | 120/195 [00:33<00:22,  3.30it/s] 62%|██████▏   | 121/195 [00:33<00:22,  3.26it/s] 63%|██████▎   | 122/195 [00:33<00:18,  3.87it/s] 63%|██████▎   | 123/195 [00:33<00:20,  3.48it/s] 64%|██████▍   | 125/195 [00:34<00:17,  3.91it/s] 65%|██████▌   | 127/195 [00:34<00:15,  4.29it/s] 66%|██████▌   | 128/195 [00:34<00:14,  4.68it/s] 66%|██████▌   | 129/195 [00:35<00:15,  4.24it/s] 67%|██████▋   | 130/195 [00:35<00:13,  4.70it/s] 67%|██████▋   | 131/195 [00:35<00:14,  4.29it/s] 68%|██████▊   | 132/195 [00:35<00:13,  4.66it/s] 68%|██████▊   | 133/195 [00:36<00:14,  4.31it/s] 69%|██████▊   | 134/195 [00:36<00:12,  4.80it/s] 69%|██████▉   | 135/195 [00:36<00:14,  4.19it/s] 70%|██████▉   | 136/195 [00:36<00:12,  4.69it/s] 70%|███████   | 137/195 [00:36<00:13,  4.35it/s] 71%|███████   | 138/195 [00:37<00:12,  4.51it/s] 71%|███████▏  | 139/195 [00:37<00:13,  4.24it/s] 72%|███████▏  | 140/195 [00:37<00:13,  3.99it/s] 72%|███████▏  | 141/195 [00:37<00:12,  4.32it/s] 73%|███████▎  | 142/195 [00:38<00:12,  4.09it/s] 73%|███████▎  | 143/195 [00:38<00:11,  4.53it/s] 74%|███████▍  | 144/195 [00:38<00:13,  3.92it/s] 74%|███████▍  | 145/195 [00:38<00:11,  4.42it/s] 75%|███████▍  | 146/195 [00:39<00:12,  4.06it/s] 75%|███████▌  | 147/195 [00:39<00:10,  4.52it/s] 76%|███████▌  | 148/195 [00:39<00:11,  4.17it/s] 76%|███████▋  | 149/195 [00:39<00:09,  4.67it/s] 77%|███████▋  | 150/195 [00:40<00:11,  3.91it/s] 77%|███████▋  | 151/195 [00:40<00:10,  4.26it/s] 78%|███████▊  | 152/195 [00:40<00:11,  3.77it/s] 78%|███████▊  | 153/195 [00:40<00:10,  4.14it/s] 79%|███████▉  | 154/195 [00:41<00:10,  3.77it/s] 79%|███████▉  | 155/195 [00:41<00:09,  4.37it/s] 80%|████████  | 156/195 [00:41<00:09,  4.18it/s] 81%|████████  | 157/195 [00:41<00:08,  4.70it/s] 81%|████████  | 158/195 [00:41<00:08,  4.29it/s] 82%|████████▏ | 159/195 [00:42<00:07,  4.85it/s] 82%|████████▏ | 160/195 [00:42<00:07,  4.46it/s] 83%|████████▎ | 161/195 [00:42<00:06,  4.94it/s] 83%|████████▎ | 162/195 [00:42<00:07,  4.51it/s] 84%|████████▎ | 163/195 [00:42<00:06,  4.97it/s] 84%|████████▍ | 164/195 [00:43<00:07,  4.36it/s] 85%|████████▍ | 165/195 [00:43<00:05,  5.07it/s] 85%|████████▌ | 166/195 [00:43<00:06,  4.27it/s] 86%|████████▌ | 168/195 [00:44<00:06,  4.40it/s] 87%|████████▋ | 169/195 [00:44<00:05,  4.94it/s] 87%|████████▋ | 170/195 [00:44<00:06,  4.02it/s] 88%|████████▊ | 171/195 [00:44<00:05,  4.58it/s] 88%|████████▊ | 172/195 [00:45<00:05,  4.03it/s] 89%|████████▊ | 173/195 [00:45<00:04,  4.61it/s] 89%|████████▉ | 174/195 [00:45<00:05,  4.01it/s] 90%|████████▉ | 175/195 [00:45<00:04,  4.52it/s] 90%|█████████ | 176/195 [00:45<00:04,  3.94it/s] 91%|█████████ | 177/195 [00:46<00:04,  4.42it/s] 91%|█████████▏| 178/195 [00:46<00:04,  3.94it/s] 92%|█████████▏| 179/195 [00:46<00:03,  4.51it/s] 92%|█████████▏| 180/195 [00:46<00:03,  4.14it/s] 93%|█████████▎| 181/195 [00:47<00:02,  4.69it/s] 93%|█████████▎| 182/195 [00:47<00:03,  4.25it/s] 94%|█████████▍| 183/195 [00:47<00:02,  4.84it/s] 94%|█████████▍| 184/195 [00:47<00:02,  4.09it/s] 95%|█████████▍| 185/195 [00:47<00:02,  4.45it/s] 95%|█████████▌| 186/195 [00:48<00:02,  4.04it/s] 96%|█████████▌| 187/195 [00:48<00:01,  4.55it/s] 96%|█████████▋| 188/195 [00:48<00:01,  4.09it/s] 97%|█████████▋| 189/195 [00:48<00:01,  4.52it/s] 97%|█████████▋| 190/195 [00:49<00:01,  3.97it/s] 98%|█████████▊| 191/195 [00:49<00:00,  4.53it/s] 98%|█████████▊| 192/195 [00:49<00:00,  4.07it/s] 99%|█████████▉| 193/195 [00:49<00:00,  4.56it/s] 99%|█████████▉| 194/195 [00:50<00:00,  4.05it/s]100%|██████████| 195/195 [00:52<00:00,  3.73it/s]
2025-08-21 08:27:01 [info     ] Validating outputs
2025-08-21 08:27:01 [info     ] Predict - end                  time=0:0:52
2025-08-21 08:27:01 [info     ] Evaluate - start               split=test
2025-08-21 08:27:01 [info     ] Evaluate - end                 correctness_llm=0.27 monotonicity=0.3
2025-08-21 08:27:01 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:27:01 [info     ] Augmenting questions for IRT estimation num_questions=11
2025-08-21 08:27:01 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:27:01 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1071.46it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3708.24it/s]
  0%|          | 0/39 [00:00<?, ?it/s] 85%|████████▍ | 33/39 [00:00<00:00, 327.96it/s]100%|██████████| 39/39 [00:00<00:00, 367.60it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 14956.76it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1082.80it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3563.87it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 485.83it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8166.93it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1160.66it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3573.05it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 497.26it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7800.25it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 950.17it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3350.77it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 599.41it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8886.24it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1222.47it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3509.88it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 634.38it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7952.36it/s]
2025-08-21 08:27:05 INFO: Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
2025-08-21 08:27:05 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:27:05 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:27:05 [info     ] Evaluate question difficulty - end rmse=2.936312134602083 split=test
2025-08-21 08:27:05 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 2 finished: 0:1:6

 ********** Run: 3/3 **********
2025-08-21 08:27:28 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:27:28 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:27:28 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:27:28 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:27:29 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:27:29 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:27:34 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:27:34 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:27:34 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:27:35 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:27:38 [info     ] Setting seed                   value=45
2025-08-21 08:27:38 [info     ] Building structured outputter  name=teacher_kt
2025-08-21 08:27:38 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_marshmellow_level_nocontext
2025-08-21 08:27:38 [info     ] Building model                 name=qwen3:4b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:27:38 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<05:31,  1.71s/it]  2%|▏         | 3/195 [00:03<03:00,  1.07it/s]  2%|▏         | 4/195 [00:03<02:30,  1.27it/s]  3%|▎         | 5/195 [00:04<02:23,  1.33it/s]  4%|▎         | 7/195 [00:04<01:38,  1.91it/s]  4%|▍         | 8/195 [00:05<01:24,  2.21it/s]  5%|▍         | 9/195 [00:05<01:21,  2.29it/s]  5%|▌         | 10/195 [00:05<01:06,  2.80it/s]  6%|▌         | 11/195 [00:05<01:01,  3.00it/s]  6%|▌         | 12/195 [00:05<00:50,  3.63it/s]  7%|▋         | 13/195 [00:06<00:50,  3.60it/s]  7%|▋         | 14/195 [00:06<00:42,  4.22it/s]  8%|▊         | 15/195 [00:06<00:46,  3.91it/s]  8%|▊         | 16/195 [00:06<00:38,  4.59it/s]  9%|▊         | 17/195 [00:07<00:41,  4.25it/s]  9%|▉         | 18/195 [00:07<00:38,  4.62it/s] 10%|▉         | 19/195 [00:07<00:41,  4.19it/s] 10%|█         | 20/195 [00:07<00:36,  4.80it/s] 11%|█         | 21/195 [00:08<00:41,  4.21it/s] 11%|█▏        | 22/195 [00:08<00:36,  4.73it/s] 12%|█▏        | 23/195 [00:08<00:42,  4.07it/s] 12%|█▏        | 24/195 [00:08<00:37,  4.61it/s] 13%|█▎        | 25/195 [00:08<00:41,  4.05it/s] 13%|█▎        | 26/195 [00:09<00:36,  4.61it/s] 14%|█▍        | 27/195 [00:09<00:40,  4.15it/s] 14%|█▍        | 28/195 [00:09<00:35,  4.70it/s] 15%|█▍        | 29/195 [00:09<00:38,  4.26it/s] 15%|█▌        | 30/195 [00:10<00:35,  4.70it/s] 16%|█▌        | 31/195 [00:10<00:38,  4.22it/s] 16%|█▋        | 32/195 [00:10<00:34,  4.73it/s] 17%|█▋        | 33/195 [00:10<00:40,  4.02it/s] 17%|█▋        | 34/195 [00:10<00:36,  4.43it/s] 18%|█▊        | 35/195 [00:11<00:39,  4.06it/s] 18%|█▊        | 36/195 [00:11<00:35,  4.47it/s] 19%|█▉        | 37/195 [00:11<00:38,  4.16it/s] 19%|█▉        | 38/195 [00:11<00:33,  4.62it/s] 20%|██        | 39/195 [00:12<00:35,  4.38it/s] 21%|██        | 40/195 [00:12<00:34,  4.45it/s] 21%|██        | 41/195 [00:12<00:33,  4.57it/s] 22%|██▏       | 42/195 [00:12<00:35,  4.31it/s] 22%|██▏       | 43/195 [00:12<00:32,  4.68it/s] 23%|██▎       | 44/195 [00:13<00:36,  4.15it/s] 23%|██▎       | 45/195 [00:13<00:33,  4.48it/s] 24%|██▎       | 46/195 [00:13<00:36,  4.12it/s] 24%|██▍       | 47/195 [00:13<00:32,  4.59it/s] 25%|██▍       | 48/195 [00:14<00:34,  4.20it/s] 25%|██▌       | 49/195 [00:14<00:31,  4.66it/s] 26%|██▌       | 50/195 [00:14<00:37,  3.88it/s] 26%|██▌       | 51/195 [00:14<00:35,  4.10it/s] 27%|██▋       | 52/195 [00:15<00:43,  3.32it/s] 28%|██▊       | 54/195 [00:15<00:43,  3.25it/s] 28%|██▊       | 55/195 [00:16<00:39,  3.50it/s] 29%|██▊       | 56/195 [00:16<00:42,  3.24it/s] 29%|██▉       | 57/195 [00:16<00:41,  3.34it/s] 30%|██▉       | 58/195 [00:17<00:41,  3.30it/s] 30%|███       | 59/195 [00:17<00:43,  3.16it/s] 31%|███       | 60/195 [00:17<00:39,  3.45it/s] 31%|███▏      | 61/195 [00:18<00:38,  3.47it/s] 32%|███▏      | 62/195 [00:18<00:33,  3.98it/s] 32%|███▏      | 63/195 [00:18<00:32,  4.02it/s] 33%|███▎      | 64/195 [00:18<00:32,  4.04it/s] 33%|███▎      | 65/195 [00:18<00:32,  3.95it/s] 34%|███▍      | 66/195 [00:19<00:31,  4.16it/s] 34%|███▍      | 67/195 [00:19<00:33,  3.80it/s] 35%|███▍      | 68/195 [00:19<00:30,  4.17it/s] 35%|███▌      | 69/195 [00:19<00:32,  3.94it/s] 36%|███▌      | 70/195 [00:20<00:28,  4.40it/s] 36%|███▋      | 71/195 [00:20<00:31,  3.96it/s] 37%|███▋      | 72/195 [00:20<00:28,  4.36it/s] 37%|███▋      | 73/195 [00:20<00:31,  3.92it/s] 38%|███▊      | 74/195 [00:21<00:27,  4.34it/s] 38%|███▊      | 75/195 [00:21<00:29,  4.08it/s] 39%|███▉      | 76/195 [00:21<00:25,  4.68it/s] 39%|███▉      | 77/195 [00:21<00:25,  4.59it/s] 40%|████      | 78/195 [00:21<00:22,  5.15it/s] 41%|████      | 79/195 [00:22<00:25,  4.60it/s] 41%|████      | 80/195 [00:22<00:22,  5.21it/s] 42%|████▏     | 81/195 [00:22<00:23,  4.80it/s] 42%|████▏     | 82/195 [00:22<00:21,  5.33it/s] 43%|████▎     | 83/195 [00:22<00:23,  4.71it/s] 43%|████▎     | 84/195 [00:23<00:20,  5.50it/s] 44%|████▎     | 85/195 [00:23<00:24,  4.54it/s] 45%|████▍     | 87/195 [00:23<00:22,  4.85it/s] 45%|████▌     | 88/195 [00:23<00:19,  5.36it/s] 46%|████▌     | 89/195 [00:24<00:22,  4.71it/s] 46%|████▌     | 90/195 [00:24<00:20,  5.19it/s] 47%|████▋     | 91/195 [00:24<00:21,  4.74it/s] 47%|████▋     | 92/195 [00:24<00:20,  5.06it/s] 48%|████▊     | 93/195 [00:25<00:23,  4.33it/s] 48%|████▊     | 94/195 [00:25<00:20,  4.86it/s] 49%|████▊     | 95/195 [00:25<00:23,  4.28it/s] 49%|████▉     | 96/195 [00:25<00:20,  4.87it/s] 50%|████▉     | 97/195 [00:25<00:22,  4.28it/s] 50%|█████     | 98/195 [00:26<00:20,  4.85it/s] 51%|█████     | 99/195 [00:26<00:21,  4.37it/s] 51%|█████▏    | 100/195 [00:26<00:22,  4.24it/s] 52%|█████▏    | 101/195 [00:27<00:33,  2.83it/s] 53%|█████▎    | 103/195 [00:27<00:33,  2.76it/s] 53%|█████▎    | 104/195 [00:28<00:30,  2.98it/s] 54%|█████▍    | 105/195 [00:28<00:33,  2.66it/s] 54%|█████▍    | 106/195 [00:28<00:30,  2.95it/s] 55%|█████▍    | 107/195 [00:29<00:32,  2.71it/s] 55%|█████▌    | 108/195 [00:29<00:30,  2.85it/s] 56%|█████▌    | 109/195 [00:30<00:30,  2.82it/s] 56%|█████▋    | 110/195 [00:30<00:29,  2.85it/s] 57%|█████▋    | 111/195 [00:30<00:31,  2.65it/s] 57%|█████▋    | 112/195 [00:31<00:30,  2.76it/s] 58%|█████▊    | 113/195 [00:31<00:27,  2.95it/s] 58%|█████▊    | 114/195 [00:31<00:28,  2.83it/s] 59%|█████▉    | 115/195 [00:32<00:27,  2.92it/s] 59%|█████▉    | 116/195 [00:32<00:26,  2.93it/s] 60%|██████    | 117/195 [00:32<00:25,  3.10it/s] 61%|██████    | 118/195 [00:33<00:26,  2.86it/s] 61%|██████    | 119/195 [00:33<00:24,  3.15it/s] 62%|██████▏   | 120/195 [00:33<00:24,  3.06it/s] 62%|██████▏   | 121/195 [00:33<00:20,  3.69it/s] 63%|██████▎   | 122/195 [00:34<00:21,  3.38it/s] 63%|██████▎   | 123/195 [00:34<00:17,  4.01it/s] 64%|██████▎   | 124/195 [00:34<00:20,  3.39it/s] 65%|██████▍   | 126/195 [00:35<00:17,  3.83it/s] 65%|██████▌   | 127/195 [00:35<00:15,  4.34it/s] 66%|██████▌   | 128/195 [00:35<00:17,  3.74it/s] 66%|██████▌   | 129/195 [00:35<00:16,  4.07it/s] 67%|██████▋   | 130/195 [00:36<00:16,  3.84it/s] 67%|██████▋   | 131/195 [00:36<00:15,  4.11it/s] 68%|██████▊   | 132/195 [00:36<00:16,  3.86it/s] 68%|██████▊   | 133/195 [00:36<00:14,  4.38it/s] 69%|██████▊   | 134/195 [00:37<00:15,  4.03it/s] 69%|██████▉   | 135/195 [00:37<00:12,  4.62it/s] 70%|██████▉   | 136/195 [00:37<00:13,  4.24it/s] 70%|███████   | 137/195 [00:37<00:12,  4.82it/s] 71%|███████   | 138/195 [00:38<00:13,  4.11it/s] 71%|███████▏  | 139/195 [00:38<00:11,  4.70it/s] 72%|███████▏  | 140/195 [00:38<00:12,  4.27it/s] 72%|███████▏  | 141/195 [00:38<00:10,  5.05it/s] 73%|███████▎  | 142/195 [00:38<00:11,  4.58it/s] 73%|███████▎  | 143/195 [00:39<00:10,  5.12it/s] 74%|███████▍  | 144/195 [00:39<00:11,  4.45it/s] 74%|███████▍  | 145/195 [00:39<00:10,  4.75it/s] 75%|███████▍  | 146/195 [00:39<00:12,  4.00it/s] 75%|███████▌  | 147/195 [00:39<00:10,  4.58it/s] 76%|███████▌  | 148/195 [00:40<00:11,  4.06it/s] 76%|███████▋  | 149/195 [00:40<00:10,  4.59it/s] 77%|███████▋  | 150/195 [00:40<00:11,  4.08it/s] 77%|███████▋  | 151/195 [00:40<00:10,  4.38it/s] 78%|███████▊  | 152/195 [00:41<00:11,  3.89it/s] 78%|███████▊  | 153/195 [00:41<00:09,  4.25it/s] 79%|███████▉  | 154/195 [00:41<00:10,  3.81it/s] 79%|███████▉  | 155/195 [00:41<00:09,  4.42it/s] 80%|████████  | 156/195 [00:42<00:09,  4.02it/s] 81%|████████  | 157/195 [00:42<00:08,  4.42it/s] 81%|████████  | 158/195 [00:42<00:08,  4.23it/s] 82%|████████▏ | 159/195 [00:42<00:07,  4.82it/s] 82%|████████▏ | 160/195 [00:43<00:07,  4.46it/s] 83%|████████▎ | 161/195 [00:43<00:06,  4.93it/s] 83%|████████▎ | 162/195 [00:43<00:07,  4.53it/s] 84%|████████▎ | 163/195 [00:43<00:06,  5.07it/s] 84%|████████▍ | 164/195 [00:43<00:06,  4.53it/s] 85%|████████▍ | 165/195 [00:44<00:05,  5.18it/s] 85%|████████▌ | 166/195 [00:44<00:06,  4.57it/s] 86%|████████▌ | 167/195 [00:44<00:05,  5.20it/s] 86%|████████▌ | 168/195 [00:44<00:06,  4.30it/s] 87%|████████▋ | 169/195 [00:44<00:05,  4.93it/s] 87%|████████▋ | 170/195 [00:45<00:05,  4.19it/s] 88%|████████▊ | 171/195 [00:45<00:04,  4.83it/s] 88%|████████▊ | 172/195 [00:45<00:05,  4.21it/s] 89%|████████▊ | 173/195 [00:45<00:04,  4.86it/s] 89%|████████▉ | 174/195 [00:46<00:04,  4.24it/s] 90%|████████▉ | 175/195 [00:46<00:04,  4.85it/s] 90%|█████████ | 176/195 [00:46<00:04,  4.47it/s] 91%|█████████ | 177/195 [00:46<00:03,  5.05it/s] 91%|█████████▏| 178/195 [00:46<00:03,  4.33it/s] 92%|█████████▏| 179/195 [00:47<00:03,  4.85it/s] 92%|█████████▏| 180/195 [00:47<00:03,  4.30it/s] 93%|█████████▎| 181/195 [00:47<00:02,  4.78it/s] 93%|█████████▎| 182/195 [00:47<00:03,  4.21it/s] 94%|█████████▍| 183/195 [00:47<00:02,  4.71it/s] 94%|█████████▍| 184/195 [00:48<00:02,  4.16it/s] 95%|█████████▍| 185/195 [00:48<00:02,  4.68it/s] 95%|█████████▌| 186/195 [00:48<00:02,  4.15it/s] 96%|█████████▌| 187/195 [00:48<00:01,  4.76it/s] 96%|█████████▋| 188/195 [00:49<00:01,  4.24it/s] 97%|█████████▋| 189/195 [00:49<00:01,  4.78it/s] 97%|█████████▋| 190/195 [00:49<00:01,  4.29it/s] 98%|█████████▊| 191/195 [00:49<00:00,  4.68it/s] 98%|█████████▊| 192/195 [00:50<00:00,  4.21it/s] 99%|█████████▉| 193/195 [00:50<00:00,  4.74it/s] 99%|█████████▉| 194/195 [00:50<00:00,  4.29it/s]100%|██████████| 195/195 [00:50<00:00,  5.07it/s]100%|██████████| 195/195 [00:52<00:00,  3.69it/s]
2025-08-21 08:28:30 [info     ] Validating outputs
2025-08-21 08:28:30 [info     ] Predict - end                  time=0:0:52
2025-08-21 08:28:30 [info     ] Evaluate - start               split=test
2025-08-21 08:28:30 [info     ] Evaluate - end                 correctness_llm=0.25 monotonicity=0.42
2025-08-21 08:28:30 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:28:30 [info     ] Augmenting questions for IRT estimation num_questions=10
2025-08-21 08:28:30 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:28:30 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1215.54it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3708.07it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 512.07it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8811.56it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1028.27it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3589.44it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 603.60it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 9320.68it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1415.49it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3688.67it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 617.07it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8263.48it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1166.66it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3707.90it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 578.00it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8219.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1094.87it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3825.40it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 575.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8395.80it/s]
2025-08-21 08:28:34 INFO: Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
2025-08-21 08:28:34 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:28:34 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:28:34 [info     ] Evaluate question difficulty - end rmse=2.9027344277419442 split=test
2025-08-21 08:28:34 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 3 finished: 0:1:6

 ========== Config: qwen3:8b~T_0.0~SO_student_kt~L_5~SP_student_chocolate_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_miscon_studentlevel_random0 ==========
Config 8/8

 ********** Run: 1/3 **********
2025-08-21 08:28:55 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:28:55 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:28:55 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:28:55 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:28:57 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:28:57 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:29:02 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:29:02 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:29:02 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:29:03 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:29:06 [info     ] Setting seed                   value=43
2025-08-21 08:29:06 [info     ] Building structured outputter  name=student_kt
2025-08-21 08:29:06 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_chocolate_level_nocontext
2025-08-21 08:29:06 [info     ] Building model                 name=qwen3:8b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:29:06 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:04<12:59,  4.02s/it]  2%|▏         | 3/195 [00:05<05:23,  1.68s/it]  2%|▏         | 4/195 [00:06<03:50,  1.21s/it]  3%|▎         | 5/195 [00:06<03:31,  1.11s/it]  3%|▎         | 6/195 [00:07<02:51,  1.10it/s]  4%|▎         | 7/195 [00:08<02:38,  1.18it/s]  4%|▍         | 8/195 [00:08<02:20,  1.33it/s]  5%|▌         | 10/195 [00:09<01:38,  1.88it/s]  6%|▌         | 12/195 [00:09<01:14,  2.45it/s]  7%|▋         | 14/195 [00:10<01:03,  2.86it/s]  8%|▊         | 16/195 [00:10<00:59,  3.00it/s]  9%|▉         | 18/195 [00:11<00:56,  3.14it/s] 10%|█         | 20/195 [00:11<00:52,  3.33it/s] 11%|█▏        | 22/195 [00:12<00:50,  3.44it/s] 12%|█▏        | 24/195 [00:12<00:46,  3.69it/s] 13%|█▎        | 25/195 [00:13<00:49,  3.46it/s] 13%|█▎        | 26/195 [00:13<00:44,  3.81it/s] 14%|█▍        | 27/195 [00:13<00:49,  3.37it/s] 15%|█▍        | 29/195 [00:14<00:49,  3.38it/s] 16%|█▌        | 31/195 [00:15<00:51,  3.17it/s] 16%|█▋        | 32/195 [00:15<00:47,  3.43it/s] 17%|█▋        | 33/195 [00:15<00:54,  2.99it/s] 17%|█▋        | 34/195 [00:16<00:48,  3.31it/s] 18%|█▊        | 35/195 [00:16<00:54,  2.96it/s] 19%|█▉        | 37/195 [00:17<00:56,  2.81it/s] 20%|██        | 39/195 [00:17<00:42,  3.69it/s] 21%|██        | 41/195 [00:18<00:42,  3.65it/s] 22%|██▏       | 43/195 [00:18<00:42,  3.62it/s] 23%|██▎       | 45/195 [00:19<00:42,  3.54it/s] 24%|██▍       | 47/195 [00:19<00:41,  3.54it/s] 25%|██▌       | 49/195 [00:20<00:40,  3.60it/s] 26%|██▌       | 51/195 [00:21<00:45,  3.16it/s] 27%|██▋       | 52/195 [00:21<00:40,  3.57it/s] 27%|██▋       | 53/195 [00:22<00:54,  2.61it/s] 28%|██▊       | 55/195 [00:22<00:55,  2.52it/s] 29%|██▉       | 57/195 [00:23<00:55,  2.50it/s] 30%|███       | 59/195 [00:24<00:54,  2.51it/s] 31%|███▏      | 61/195 [00:25<00:48,  2.75it/s] 32%|███▏      | 62/195 [00:25<00:43,  3.05it/s] 32%|███▏      | 63/195 [00:25<00:46,  2.86it/s] 33%|███▎      | 64/195 [00:25<00:40,  3.23it/s] 33%|███▎      | 65/195 [00:26<00:43,  2.96it/s] 34%|███▍      | 66/195 [00:26<00:37,  3.40it/s] 34%|███▍      | 67/195 [00:26<00:43,  2.96it/s] 35%|███▍      | 68/195 [00:27<00:38,  3.30it/s] 35%|███▌      | 69/195 [00:27<00:44,  2.82it/s] 36%|███▌      | 70/195 [00:27<00:39,  3.18it/s] 36%|███▋      | 71/195 [00:28<00:42,  2.92it/s] 37%|███▋      | 73/195 [00:28<00:37,  3.28it/s] 38%|███▊      | 74/195 [00:28<00:35,  3.40it/s] 38%|███▊      | 75/195 [00:29<00:35,  3.39it/s] 39%|███▉      | 76/195 [00:29<00:38,  3.07it/s] 39%|███▉      | 77/195 [00:29<00:32,  3.63it/s] 40%|████      | 78/195 [00:30<00:38,  3.04it/s] 41%|████      | 80/195 [00:30<00:35,  3.22it/s] 42%|████▏     | 82/195 [00:31<00:32,  3.47it/s] 43%|████▎     | 84/195 [00:31<00:31,  3.51it/s] 44%|████▍     | 86/195 [00:32<00:30,  3.58it/s] 45%|████▌     | 88/195 [00:32<00:29,  3.66it/s] 46%|████▌     | 89/195 [00:33<00:28,  3.69it/s] 46%|████▌     | 90/195 [00:33<00:29,  3.60it/s] 47%|████▋     | 91/195 [00:33<00:31,  3.30it/s] 47%|████▋     | 92/195 [00:34<00:27,  3.72it/s] 48%|████▊     | 93/195 [00:34<00:31,  3.21it/s] 49%|████▊     | 95/195 [00:35<00:31,  3.20it/s] 49%|████▉     | 96/195 [00:35<00:27,  3.62it/s] 50%|████▉     | 97/195 [00:35<00:31,  3.14it/s] 50%|█████     | 98/195 [00:35<00:27,  3.57it/s] 51%|█████     | 99/195 [00:36<00:31,  3.04it/s] 51%|█████▏    | 100/195 [00:36<00:31,  3.02it/s] 52%|█████▏    | 101/195 [00:37<00:38,  2.43it/s] 52%|█████▏    | 102/195 [00:37<00:36,  2.53it/s] 53%|█████▎    | 103/195 [00:38<00:42,  2.16it/s] 53%|█████▎    | 104/195 [00:38<00:38,  2.34it/s] 54%|█████▍    | 105/195 [00:39<00:43,  2.07it/s] 55%|█████▍    | 107/195 [00:39<00:36,  2.41it/s] 55%|█████▌    | 108/195 [00:40<00:36,  2.41it/s] 56%|█████▌    | 109/195 [00:40<00:35,  2.42it/s] 56%|█████▋    | 110/195 [00:41<00:35,  2.38it/s] 57%|█████▋    | 111/195 [00:41<00:33,  2.50it/s] 57%|█████▋    | 112/195 [00:42<00:35,  2.35it/s] 58%|█████▊    | 113/195 [00:42<00:32,  2.49it/s] 58%|█████▊    | 114/195 [00:42<00:37,  2.19it/s] 59%|█████▉    | 115/195 [00:43<00:34,  2.35it/s] 59%|█████▉    | 116/195 [00:43<00:37,  2.09it/s] 61%|██████    | 118/195 [00:44<00:32,  2.39it/s] 61%|██████    | 119/195 [00:45<00:31,  2.41it/s] 62%|██████▏   | 120/195 [00:45<00:29,  2.56it/s] 62%|██████▏   | 121/195 [00:45<00:28,  2.64it/s] 63%|██████▎   | 122/195 [00:45<00:23,  3.09it/s] 63%|██████▎   | 123/195 [00:46<00:25,  2.78it/s] 64%|██████▍   | 125/195 [00:46<00:23,  3.03it/s] 65%|██████▌   | 127/195 [00:47<00:20,  3.28it/s] 66%|██████▌   | 129/195 [00:47<00:19,  3.42it/s] 67%|██████▋   | 131/195 [00:48<00:19,  3.32it/s] 68%|██████▊   | 133/195 [00:49<00:18,  3.27it/s] 69%|██████▊   | 134/195 [00:49<00:17,  3.51it/s] 69%|██████▉   | 135/195 [00:49<00:18,  3.17it/s] 70%|██████▉   | 136/195 [00:50<00:16,  3.51it/s] 70%|███████   | 137/195 [00:50<00:18,  3.11it/s] 71%|███████   | 138/195 [00:50<00:16,  3.52it/s] 71%|███████▏  | 139/195 [00:51<00:18,  3.08it/s] 72%|███████▏  | 140/195 [00:51<00:15,  3.51it/s] 72%|███████▏  | 141/195 [00:51<00:16,  3.23it/s] 73%|███████▎  | 142/195 [00:51<00:14,  3.67it/s] 73%|███████▎  | 143/195 [00:52<00:16,  3.16it/s] 74%|███████▍  | 144/195 [00:52<00:13,  3.65it/s] 74%|███████▍  | 145/195 [00:52<00:14,  3.42it/s] 75%|███████▍  | 146/195 [00:53<00:15,  3.18it/s] 75%|███████▌  | 147/195 [00:53<00:12,  3.72it/s] 76%|███████▌  | 148/195 [00:53<00:14,  3.22it/s] 77%|███████▋  | 150/195 [00:54<00:13,  3.35it/s] 78%|███████▊  | 152/195 [00:54<00:13,  3.27it/s] 79%|███████▉  | 154/195 [00:55<00:13,  3.13it/s] 80%|████████  | 156/195 [00:56<00:12,  3.23it/s] 81%|████████  | 158/195 [00:56<00:11,  3.34it/s] 82%|████████▏ | 160/195 [00:57<00:10,  3.49it/s] 83%|████████▎ | 161/195 [00:57<00:09,  3.49it/s] 83%|████████▎ | 162/195 [00:57<00:08,  3.73it/s] 84%|████████▎ | 163/195 [00:58<00:10,  3.20it/s] 85%|████████▍ | 165/195 [00:58<00:08,  3.52it/s] 85%|████████▌ | 166/195 [00:58<00:08,  3.53it/s] 86%|████████▌ | 167/195 [00:59<00:08,  3.45it/s] 86%|████████▌ | 168/195 [00:59<00:08,  3.37it/s] 87%|████████▋ | 169/195 [00:59<00:07,  3.35it/s] 87%|████████▋ | 170/195 [01:00<00:08,  3.02it/s] 88%|████████▊ | 171/195 [01:00<00:07,  3.27it/s] 88%|████████▊ | 172/195 [01:00<00:07,  3.24it/s] 89%|████████▊ | 173/195 [01:01<00:06,  3.56it/s] 89%|████████▉ | 174/195 [01:01<00:06,  3.05it/s] 90%|████████▉ | 175/195 [01:01<00:05,  3.40it/s] 90%|█████████ | 176/195 [01:02<00:06,  2.92it/s] 91%|█████████▏| 178/195 [01:02<00:05,  2.91it/s] 92%|█████████▏| 180/195 [01:03<00:05,  2.98it/s] 93%|█████████▎| 182/195 [01:04<00:04,  3.11it/s] 94%|█████████▍| 184/195 [01:04<00:03,  3.06it/s] 95%|█████████▌| 186/195 [01:05<00:02,  3.19it/s] 96%|█████████▋| 188/195 [01:05<00:02,  3.28it/s] 97%|█████████▋| 190/195 [01:06<00:01,  3.34it/s] 98%|█████████▊| 192/195 [01:07<00:00,  3.39it/s] 99%|█████████▉| 194/195 [01:07<00:00,  3.44it/s]100%|██████████| 195/195 [01:09<00:00,  2.80it/s]
2025-08-21 08:30:16 [info     ] Validating outputs
2025-08-21 08:30:16 [info     ] Predict - end                  time=0:1:9
2025-08-21 08:30:16 [info     ] Evaluate - start               split=test
2025-08-21 08:30:16 [info     ] Evaluate - end                 correctness_llm=0.29 monotonicity=0.58
2025-08-21 08:30:16 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:30:16 [info     ] Augmenting questions for IRT estimation num_questions=17
2025-08-21 08:30:16 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:30:16 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1265.80it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3831.85it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 564.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6869.47it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1025.18it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3768.55it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 574.57it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6720.10it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 962.66it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3712.36it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 603.50it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7406.69it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1023.93it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3728.36it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 567.49it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6944.21it/s]
2025-08-21 08:30:19 INFO: Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
Likelihood descrease, stops at iteration 4.
2025-08-21 08:30:19 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:30:19 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:30:19 [info     ] Evaluate question difficulty - end rmse=2.697934423673838 split=test
2025-08-21 08:30:19 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 1 finished: 0:1:23

 ********** Run: 2/3 **********
2025-08-21 08:30:39 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:30:39 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:30:39 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:30:39 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:30:41 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:30:41 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:30:46 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:30:46 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:30:46 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:30:47 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:30:49 [info     ] Setting seed                   value=44
2025-08-21 08:30:49 [info     ] Building structured outputter  name=student_kt
2025-08-21 08:30:49 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_chocolate_level_nocontext
2025-08-21 08:30:49 [info     ] Building model                 name=qwen3:8b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:30:49 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<05:12,  1.61s/it]  2%|▏         | 3/195 [00:02<02:28,  1.29it/s]  2%|▏         | 4/195 [00:02<02:03,  1.54it/s]  3%|▎         | 6/195 [00:04<02:02,  1.55it/s]  4%|▎         | 7/195 [00:04<01:44,  1.80it/s]  4%|▍         | 8/195 [00:04<01:23,  2.23it/s]  5%|▍         | 9/195 [00:05<01:18,  2.36it/s]  6%|▌         | 11/195 [00:06<01:26,  2.13it/s]  6%|▌         | 12/195 [00:06<01:16,  2.40it/s]  7%|▋         | 13/195 [00:06<01:15,  2.41it/s]  8%|▊         | 15/195 [00:07<01:04,  2.81it/s]  8%|▊         | 16/195 [00:07<01:00,  2.98it/s]  9%|▊         | 17/195 [00:08<01:02,  2.85it/s] 10%|▉         | 19/195 [00:08<00:52,  3.37it/s] 10%|█         | 20/195 [00:08<00:44,  3.97it/s] 11%|█         | 21/195 [00:09<00:55,  3.11it/s] 12%|█▏        | 23/195 [00:10<01:06,  2.58it/s] 12%|█▏        | 24/195 [00:10<01:06,  2.58it/s] 13%|█▎        | 25/195 [00:10<01:02,  2.74it/s] 13%|█▎        | 26/195 [00:11<00:57,  2.92it/s] 14%|█▍        | 27/195 [00:11<00:54,  3.08it/s] 14%|█▍        | 28/195 [00:11<00:54,  3.09it/s] 15%|█▍        | 29/195 [00:11<00:48,  3.45it/s] 15%|█▌        | 30/195 [00:12<00:50,  3.28it/s] 16%|█▌        | 31/195 [00:12<00:48,  3.38it/s] 16%|█▋        | 32/195 [00:12<00:52,  3.13it/s] 17%|█▋        | 33/195 [00:13<00:48,  3.34it/s] 17%|█▋        | 34/195 [00:13<00:53,  3.00it/s] 18%|█▊        | 35/195 [00:13<00:49,  3.24it/s] 18%|█▊        | 36/195 [00:14<00:50,  3.17it/s] 19%|█▉        | 37/195 [00:14<00:44,  3.54it/s] 19%|█▉        | 38/195 [00:14<00:49,  3.16it/s] 20%|██        | 39/195 [00:14<00:42,  3.65it/s] 21%|██        | 40/195 [00:15<00:52,  2.95it/s] 22%|██▏       | 42/195 [00:15<00:50,  3.05it/s] 23%|██▎       | 44/195 [00:16<00:47,  3.20it/s] 23%|██▎       | 45/195 [00:16<00:47,  3.19it/s] 24%|██▎       | 46/195 [00:17<00:43,  3.44it/s] 24%|██▍       | 47/195 [00:17<00:46,  3.21it/s] 25%|██▍       | 48/195 [00:17<00:40,  3.67it/s] 25%|██▌       | 49/195 [00:18<00:45,  3.24it/s] 26%|██▌       | 51/195 [00:18<00:53,  2.70it/s] 27%|██▋       | 53/195 [00:19<00:57,  2.47it/s] 28%|██▊       | 55/195 [00:20<00:57,  2.42it/s] 29%|██▊       | 56/195 [00:20<00:48,  2.85it/s] 29%|██▉       | 57/195 [00:21<01:02,  2.22it/s] 30%|███       | 59/195 [00:22<01:00,  2.25it/s] 31%|███       | 60/195 [00:22<00:50,  2.70it/s] 31%|███▏      | 61/195 [00:23<00:56,  2.39it/s] 32%|███▏      | 63/195 [00:23<00:48,  2.72it/s] 33%|███▎      | 64/195 [00:23<00:42,  3.09it/s] 33%|███▎      | 65/195 [00:24<00:45,  2.86it/s] 34%|███▍      | 66/195 [00:24<00:39,  3.30it/s] 34%|███▍      | 67/195 [00:24<00:38,  3.28it/s] 35%|███▍      | 68/195 [00:25<00:39,  3.21it/s] 35%|███▌      | 69/195 [00:25<00:36,  3.43it/s] 36%|███▌      | 70/195 [00:25<00:40,  3.08it/s] 36%|███▋      | 71/195 [00:25<00:35,  3.52it/s] 37%|███▋      | 72/195 [00:26<00:40,  3.05it/s] 37%|███▋      | 73/195 [00:26<00:34,  3.58it/s] 38%|███▊      | 74/195 [00:27<00:42,  2.82it/s] 39%|███▉      | 76/195 [00:27<00:38,  3.12it/s] 39%|███▉      | 77/195 [00:27<00:31,  3.76it/s] 40%|████      | 78/195 [00:28<00:38,  3.02it/s] 41%|████      | 79/195 [00:28<00:33,  3.51it/s] 41%|████      | 80/195 [00:28<00:37,  3.08it/s] 42%|████▏     | 82/195 [00:29<00:32,  3.44it/s] 43%|████▎     | 84/195 [00:29<00:31,  3.56it/s] 44%|████▍     | 86/195 [00:30<00:30,  3.58it/s] 45%|████▌     | 88/195 [00:30<00:28,  3.76it/s] 46%|████▌     | 90/195 [00:31<00:28,  3.75it/s] 47%|████▋     | 92/195 [00:32<00:27,  3.73it/s] 48%|████▊     | 94/195 [00:32<00:27,  3.71it/s] 49%|████▉     | 96/195 [00:33<00:26,  3.67it/s] 50%|████▉     | 97/195 [00:33<00:24,  4.01it/s] 50%|█████     | 98/195 [00:33<00:27,  3.53it/s] 51%|█████     | 99/195 [00:33<00:24,  3.84it/s] 51%|█████▏    | 100/195 [00:34<00:31,  3.05it/s] 52%|█████▏    | 101/195 [00:34<00:33,  2.82it/s] 52%|█████▏    | 102/195 [00:35<00:38,  2.44it/s] 53%|█████▎    | 103/195 [00:35<00:38,  2.37it/s] 53%|█████▎    | 104/195 [00:36<00:40,  2.27it/s] 54%|█████▍    | 105/195 [00:36<00:42,  2.11it/s] 54%|█████▍    | 106/195 [00:37<00:40,  2.18it/s] 55%|█████▍    | 107/195 [00:37<00:37,  2.38it/s] 55%|█████▌    | 108/195 [00:38<00:40,  2.13it/s] 56%|█████▌    | 109/195 [00:38<00:38,  2.23it/s] 56%|█████▋    | 110/195 [00:39<00:39,  2.17it/s] 57%|█████▋    | 111/195 [00:39<00:38,  2.18it/s] 57%|█████▋    | 112/195 [00:39<00:33,  2.50it/s] 58%|█████▊    | 113/195 [00:40<00:37,  2.19it/s] 59%|█████▉    | 115/195 [00:41<00:35,  2.26it/s] 60%|██████    | 117/195 [00:42<00:34,  2.29it/s] 61%|██████    | 119/195 [00:42<00:33,  2.30it/s] 62%|██████▏   | 121/195 [00:43<00:29,  2.52it/s] 63%|██████▎   | 123/195 [00:44<00:26,  2.72it/s] 64%|██████▎   | 124/195 [00:44<00:23,  2.99it/s] 64%|██████▍   | 125/195 [00:44<00:24,  2.83it/s] 65%|██████▍   | 126/195 [00:45<00:21,  3.19it/s] 65%|██████▌   | 127/195 [00:45<00:22,  3.07it/s] 66%|██████▌   | 128/195 [00:45<00:20,  3.32it/s] 66%|██████▌   | 129/195 [00:45<00:20,  3.23it/s] 67%|██████▋   | 130/195 [00:46<00:19,  3.35it/s] 67%|██████▋   | 131/195 [00:46<00:21,  3.03it/s] 68%|██████▊   | 132/195 [00:46<00:20,  3.08it/s] 68%|██████▊   | 133/195 [00:47<00:20,  2.99it/s] 69%|██████▊   | 134/195 [00:47<00:20,  2.92it/s] 69%|██████▉   | 135/195 [00:47<00:19,  3.03it/s] 70%|██████▉   | 136/195 [00:48<00:20,  2.89it/s] 70%|███████   | 137/195 [00:48<00:17,  3.23it/s] 71%|███████   | 138/195 [00:48<00:18,  3.02it/s] 71%|███████▏  | 139/195 [00:49<00:16,  3.32it/s] 72%|███████▏  | 140/195 [00:49<00:18,  3.04it/s] 73%|███████▎  | 142/195 [00:50<00:15,  3.36it/s] 74%|███████▍  | 144/195 [00:50<00:14,  3.42it/s] 74%|███████▍  | 145/195 [00:50<00:13,  3.80it/s] 75%|███████▍  | 146/195 [00:51<00:13,  3.52it/s] 75%|███████▌  | 147/195 [00:51<00:12,  3.85it/s] 76%|███████▌  | 148/195 [00:51<00:13,  3.38it/s] 77%|███████▋  | 150/195 [00:52<00:13,  3.37it/s] 78%|███████▊  | 152/195 [00:53<00:13,  3.24it/s] 79%|███████▉  | 154/195 [00:53<00:13,  3.06it/s] 80%|████████  | 156/195 [00:54<00:11,  3.32it/s] 81%|████████  | 158/195 [00:54<00:10,  3.39it/s] 82%|████████▏ | 159/195 [00:54<00:09,  3.85it/s] 82%|████████▏ | 160/195 [00:55<00:10,  3.38it/s] 83%|████████▎ | 161/195 [00:55<00:10,  3.39it/s] 83%|████████▎ | 162/195 [00:55<00:09,  3.65it/s] 84%|████████▎ | 163/195 [00:56<00:10,  3.06it/s] 85%|████████▍ | 165/195 [00:56<00:08,  3.43it/s] 85%|████████▌ | 166/195 [00:57<00:08,  3.49it/s] 86%|████████▌ | 167/195 [00:57<00:08,  3.39it/s] 86%|████████▌ | 168/195 [00:57<00:08,  3.28it/s] 87%|████████▋ | 169/195 [00:58<00:07,  3.40it/s] 87%|████████▋ | 170/195 [00:58<00:07,  3.17it/s] 88%|████████▊ | 171/195 [00:58<00:07,  3.41it/s] 88%|████████▊ | 172/195 [00:58<00:06,  3.37it/s] 89%|████████▊ | 173/195 [00:59<00:05,  3.70it/s] 89%|████████▉ | 174/195 [00:59<00:06,  3.36it/s] 90%|████████▉ | 175/195 [00:59<00:05,  3.90it/s] 90%|█████████ | 176/195 [01:00<00:05,  3.29it/s] 91%|█████████▏| 178/195 [01:00<00:05,  3.16it/s] 92%|█████████▏| 180/195 [01:01<00:04,  3.13it/s] 93%|█████████▎| 182/195 [01:01<00:04,  3.19it/s] 94%|█████████▍| 184/195 [01:02<00:03,  3.03it/s] 95%|█████████▌| 186/195 [01:03<00:02,  3.16it/s] 96%|█████████▋| 188/195 [01:03<00:02,  3.35it/s] 97%|█████████▋| 190/195 [01:04<00:01,  3.34it/s] 98%|█████████▊| 192/195 [01:04<00:00,  3.38it/s] 99%|█████████▉| 194/195 [01:05<00:00,  3.43it/s]100%|██████████| 195/195 [01:07<00:00,  2.88it/s]
2025-08-21 08:31:57 [info     ] Validating outputs
2025-08-21 08:31:57 [info     ] Predict - end                  time=0:1:7
2025-08-21 08:31:57 [info     ] Evaluate - start               split=test
2025-08-21 08:31:57 [info     ] Evaluate - end                 correctness_llm=0.29 monotonicity=0.62
2025-08-21 08:31:57 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:31:57 [info     ] Augmenting questions for IRT estimation num_questions=15
2025-08-21 08:31:57 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:31:57 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1152.69it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3505.52it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 590.93it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8522.53it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1047.01it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3512.82it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 549.26it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 9538.70it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1027.22it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3596.94it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 549.79it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7549.53it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1153.19it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3663.31it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 560.99it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8345.69it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 950.07it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3496.82it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 576.23it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7833.55it/s]
2025-08-21 08:32:01 INFO: Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
2025-08-21 08:32:01 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:32:01 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:32:01 [info     ] Evaluate question difficulty - end rmse=2.839235496493082 split=test
2025-08-21 08:32:01 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 2 finished: 0:1:21

 ********** Run: 3/3 **********
2025-08-21 08:32:21 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-21 08:32:21 [info     ] Reading train split questions  num_questions=92
2025-08-21 08:32:21 [info     ] Reading validation split questions num_questions=23
2025-08-21 08:32:21 [info     ] Reading test split questions   num_questions=39
2025-08-21 08:32:23 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-21 08:32:23 [info     ] Misconceptions as context: bringing correct option forward
2025-08-21 08:32:28 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-21 08:32:28 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-21 08:32:28 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-21 08:32:28 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-21 08:32:31 [info     ] Setting seed                   value=45
2025-08-21 08:32:31 [info     ] Building structured outputter  name=student_kt
2025-08-21 08:32:31 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_chocolate_level_nocontext
2025-08-21 08:32:31 [info     ] Building model                 name=qwen3:8b provider=ollama rate_limit=None temp=0.0
2025-08-21 08:32:31 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<04:06,  1.27s/it]  1%|          | 2/195 [00:01<02:34,  1.25it/s]  2%|▏         | 3/195 [00:01<01:41,  1.89it/s]  2%|▏         | 4/195 [00:02<01:26,  2.21it/s]  3%|▎         | 5/195 [00:02<01:08,  2.76it/s]  3%|▎         | 6/195 [00:03<01:37,  1.93it/s]  4%|▎         | 7/195 [00:03<01:37,  1.92it/s]  4%|▍         | 8/195 [00:04<01:21,  2.30it/s]  5%|▍         | 9/195 [00:04<01:10,  2.64it/s]  5%|▌         | 10/195 [00:05<01:30,  2.04it/s]  6%|▌         | 11/195 [00:05<01:29,  2.06it/s]  6%|▌         | 12/195 [00:05<01:15,  2.44it/s]  7%|▋         | 13/195 [00:05<01:02,  2.91it/s]  7%|▋         | 14/195 [00:06<01:39,  1.83it/s]  8%|▊         | 15/195 [00:07<01:21,  2.20it/s]  8%|▊         | 16/195 [00:08<01:38,  1.82it/s]  9%|▊         | 17/195 [00:08<01:29,  1.99it/s] 10%|▉         | 19/195 [00:08<01:07,  2.61it/s] 10%|█         | 20/195 [00:09<01:01,  2.84it/s] 11%|█         | 21/195 [00:09<01:04,  2.68it/s] 12%|█▏        | 23/195 [00:10<00:58,  2.96it/s] 12%|█▏        | 24/195 [00:10<00:54,  3.14it/s] 13%|█▎        | 25/195 [00:10<00:57,  2.94it/s] 14%|█▍        | 27/195 [00:11<00:52,  3.22it/s] 15%|█▍        | 29/195 [00:11<00:50,  3.30it/s] 16%|█▌        | 31/195 [00:12<00:51,  3.17it/s] 17%|█▋        | 33/195 [00:13<00:51,  3.17it/s] 17%|█▋        | 34/195 [00:13<00:47,  3.41it/s] 18%|█▊        | 35/195 [00:13<00:53,  2.99it/s] 19%|█▉        | 37/195 [00:14<00:47,  3.32it/s] 20%|██        | 39/195 [00:14<00:44,  3.47it/s] 21%|██        | 40/195 [00:15<00:46,  3.34it/s] 21%|██        | 41/195 [00:15<00:41,  3.73it/s] 22%|██▏       | 42/195 [00:15<00:46,  3.31it/s] 23%|██▎       | 44/195 [00:16<00:46,  3.23it/s] 23%|██▎       | 45/195 [00:16<00:41,  3.60it/s] 24%|██▎       | 46/195 [00:17<00:45,  3.29it/s] 24%|██▍       | 47/195 [00:17<00:40,  3.68it/s] 25%|██▍       | 48/195 [00:17<00:43,  3.34it/s] 25%|██▌       | 49/195 [00:17<00:40,  3.65it/s] 26%|██▌       | 50/195 [00:18<00:44,  3.28it/s] 26%|██▌       | 51/195 [00:18<00:53,  2.67it/s] 27%|██▋       | 52/195 [00:19<00:51,  2.75it/s] 27%|██▋       | 53/195 [00:19<01:05,  2.17it/s] 28%|██▊       | 55/195 [00:20<01:01,  2.28it/s] 29%|██▉       | 57/195 [00:21<00:58,  2.35it/s] 30%|███       | 59/195 [00:22<00:56,  2.40it/s] 31%|███       | 60/195 [00:22<00:47,  2.83it/s] 31%|███▏      | 61/195 [00:22<00:51,  2.58it/s] 32%|███▏      | 62/195 [00:22<00:44,  3.02it/s] 32%|███▏      | 63/195 [00:23<00:46,  2.85it/s] 33%|███▎      | 64/195 [00:23<00:39,  3.30it/s] 33%|███▎      | 65/195 [00:23<00:42,  3.08it/s] 34%|███▍      | 66/195 [00:24<00:35,  3.61it/s] 34%|███▍      | 67/195 [00:24<00:36,  3.53it/s] 35%|███▍      | 68/195 [00:24<00:38,  3.30it/s] 35%|███▌      | 69/195 [00:24<00:35,  3.52it/s] 36%|███▌      | 70/195 [00:25<00:43,  2.87it/s] 36%|███▋      | 71/195 [00:25<00:37,  3.29it/s] 37%|███▋      | 72/195 [00:26<00:39,  3.10it/s] 37%|███▋      | 73/195 [00:26<00:33,  3.65it/s] 38%|███▊      | 74/195 [00:26<00:37,  3.27it/s] 38%|███▊      | 75/195 [00:26<00:33,  3.58it/s] 39%|███▉      | 76/195 [00:27<00:37,  3.15it/s] 40%|████      | 78/195 [00:27<00:35,  3.30it/s] 41%|████      | 79/195 [00:27<00:30,  3.77it/s] 41%|████      | 80/195 [00:28<00:34,  3.34it/s] 42%|████▏     | 82/195 [00:28<00:30,  3.72it/s] 43%|████▎     | 84/195 [00:29<00:29,  3.78it/s] 44%|████▍     | 86/195 [00:29<00:31,  3.46it/s] 45%|████▌     | 88/195 [00:30<00:29,  3.59it/s] 46%|████▌     | 89/195 [00:30<00:30,  3.51it/s] 46%|████▌     | 90/195 [00:31<00:28,  3.68it/s] 47%|████▋     | 91/195 [00:31<00:32,  3.17it/s] 48%|████▊     | 93/195 [00:32<00:30,  3.36it/s] 48%|████▊     | 94/195 [00:32<00:26,  3.75it/s] 49%|████▊     | 95/195 [00:32<00:27,  3.68it/s] 49%|████▉     | 96/195 [00:32<00:26,  3.67it/s] 50%|████▉     | 97/195 [00:32<00:25,  3.87it/s] 50%|█████     | 98/195 [00:33<00:29,  3.27it/s] 51%|█████     | 99/195 [00:33<00:25,  3.70it/s] 51%|█████▏    | 100/195 [00:34<00:34,  2.77it/s] 52%|█████▏    | 101/195 [00:34<00:33,  2.83it/s] 52%|█████▏    | 102/195 [00:35<00:38,  2.41it/s] 53%|█████▎    | 103/195 [00:35<00:38,  2.36it/s] 53%|█████▎    | 104/195 [00:36<00:42,  2.15it/s] 54%|█████▍    | 105/195 [00:36<00:39,  2.27it/s] 54%|█████▍    | 106/195 [00:36<00:41,  2.16it/s] 55%|█████▌    | 108/195 [00:37<00:38,  2.29it/s] 56%|█████▋    | 110/195 [00:38<00:36,  2.31it/s] 57%|█████▋    | 112/195 [00:39<00:35,  2.33it/s] 58%|█████▊    | 114/195 [00:40<00:34,  2.32it/s] 59%|█████▉    | 116/195 [00:41<00:33,  2.36it/s] 61%|██████    | 118/195 [00:41<00:32,  2.40it/s] 62%|██████▏   | 120/195 [00:42<00:31,  2.41it/s] 63%|██████▎   | 122/195 [00:43<00:27,  2.61it/s] 63%|██████▎   | 123/195 [00:43<00:25,  2.86it/s] 64%|██████▎   | 124/195 [00:44<00:26,  2.68it/s] 64%|██████▍   | 125/195 [00:44<00:23,  3.00it/s] 65%|██████▍   | 126/195 [00:44<00:25,  2.70it/s] 66%|██████▌   | 128/195 [00:45<00:22,  3.04it/s] 67%|██████▋   | 130/195 [00:45<00:21,  3.06it/s] 67%|██████▋   | 131/195 [00:46<00:19,  3.32it/s] 68%|██████▊   | 132/195 [00:46<00:21,  2.96it/s] 68%|██████▊   | 133/195 [00:46<00:19,  3.25it/s] 69%|██████▊   | 134/195 [00:47<00:21,  2.89it/s] 69%|██████▉   | 135/195 [00:47<00:18,  3.30it/s] 70%|██████▉   | 136/195 [00:47<00:20,  2.84it/s] 71%|███████   | 138/195 [00:48<00:18,  3.07it/s] 71%|███████▏  | 139/195 [00:48<00:16,  3.47it/s] 72%|███████▏  | 140/195 [00:49<00:18,  3.02it/s] 72%|███████▏  | 141/195 [00:49<00:16,  3.32it/s] 73%|███████▎  | 142/195 [00:49<00:17,  3.10it/s] 73%|███████▎  | 143/195 [00:49<00:14,  3.47it/s] 74%|███████▍  | 144/195 [00:50<00:16,  3.05it/s] 75%|███████▍  | 146/195 [00:50<00:15,  3.23it/s] 76%|███████▌  | 148/195 [00:51<00:14,  3.31it/s] 77%|███████▋  | 150/195 [00:52<00:13,  3.24it/s] 78%|███████▊  | 152/195 [00:52<00:13,  3.08it/s] 79%|███████▉  | 154/195 [00:53<00:13,  2.94it/s] 79%|███████▉  | 155/195 [00:53<00:12,  3.27it/s] 80%|████████  | 156/195 [00:54<00:12,  3.18it/s] 81%|████████  | 157/195 [00:54<00:10,  3.50it/s] 81%|████████  | 158/195 [00:54<00:10,  3.54it/s] 82%|████████▏ | 159/195 [00:54<00:09,  3.69it/s] 82%|████████▏ | 160/195 [00:55<00:09,  3.84it/s] 83%|████████▎ | 161/195 [00:55<00:09,  3.72it/s] 83%|████████▎ | 162/195 [00:55<00:08,  4.06it/s] 84%|████████▎ | 163/195 [00:55<00:09,  3.50it/s] 85%|████████▍ | 165/195 [00:56<00:08,  3.59it/s] 85%|████████▌ | 166/195 [00:56<00:07,  4.00it/s] 86%|████████▌ | 167/195 [00:57<00:08,  3.40it/s] 86%|████████▌ | 168/195 [00:57<00:07,  3.81it/s] 87%|████████▋ | 169/195 [00:57<00:08,  3.19it/s] 87%|████████▋ | 170/195 [00:57<00:06,  3.67it/s] 88%|████████▊ | 171/195 [00:58<00:07,  3.41it/s] 88%|████████▊ | 172/195 [00:58<00:06,  3.73it/s] 89%|████████▊ | 173/195 [00:58<00:05,  3.74it/s] 89%|████████▉ | 174/195 [00:59<00:06,  3.43it/s] 90%|████████▉ | 175/195 [00:59<00:05,  3.56it/s] 90%|█████████ | 176/195 [00:59<00:06,  2.96it/s] 91%|█████████▏| 178/195 [01:00<00:05,  3.40it/s] 92%|█████████▏| 180/195 [01:00<00:04,  3.26it/s] 93%|█████████▎| 181/195 [01:00<00:03,  3.82it/s] 93%|█████████▎| 182/195 [01:01<00:04,  3.13it/s] 94%|█████████▍| 184/195 [01:02<00:03,  3.27it/s] 95%|█████████▍| 185/195 [01:02<00:03,  3.09it/s] 95%|█████████▌| 186/195 [01:02<00:02,  3.49it/s] 96%|█████████▌| 187/195 [01:03<00:02,  3.04it/s] 96%|█████████▋| 188/195 [01:03<00:01,  3.71it/s] 97%|█████████▋| 189/195 [01:03<00:02,  2.98it/s] 98%|█████████▊| 191/195 [01:04<00:01,  3.15it/s] 99%|█████████▉| 193/195 [01:04<00:00,  3.24it/s]100%|██████████| 195/195 [01:05<00:00,  3.77it/s]100%|██████████| 195/195 [01:07<00:00,  2.89it/s]
2025-08-21 08:33:39 [info     ] Validating outputs
2025-08-21 08:33:39 [info     ] Predict - end                  time=0:1:7
2025-08-21 08:33:39 [info     ] Evaluate - start               split=test
2025-08-21 08:33:39 [info     ] Evaluate - end                 correctness_llm=0.29 monotonicity=0.73
2025-08-21 08:33:39 [info     ] Evaluate question difficulty - start split=test
2025-08-21 08:33:39 [info     ] Augmenting questions for IRT estimation num_questions=15
2025-08-21 08:33:39 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-21 08:33:39 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1186.75it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3661.02it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 532.65it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8678.73it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1112.67it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 4016.25it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 618.06it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 10134.67it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1035.41it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3818.97it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 625.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7991.32it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1119.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3801.57it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 587.79it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8367.09it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 951.61it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3966.29it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 623.76it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 9582.29it/s]
2025-08-21 08:33:43 INFO: EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
2025-08-21 08:33:43 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-21 08:33:43 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-21 08:33:43 [info     ] Evaluate question difficulty - end rmse=2.9538609378127187 split=test
2025-08-21 08:33:43 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_nocontext_20250821-075331
Run 3 finished: 0:1:21
2025-08-21 08:34:04 [info     ] All experiments completed successfully.
