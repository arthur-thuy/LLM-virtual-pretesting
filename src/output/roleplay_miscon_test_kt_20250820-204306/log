2025-08-20 20:43:02 [info     ] Loaded environment variables from ../.env
2025-08-20 20:43:06 [info     ] Loading config from 'config/roleplay_miscon_test_kt/qwen3:1.7b~T_1.0~SO_teacher_kt~SP_teacher_marshmellow_level_context~EFI_quotes~ES_miscon_studentid_kc_exact1.yaml'
2025-08-20 20:43:06 [info     ] Loading config from 'config/roleplay_miscon_test_kt/llama3.2:3b~T_1.0~SO_student_kt~SP_student_chocolate_level_context~EFI_quotes~ES_miscon_studentid_random1.yaml'
2025-08-20 20:43:06 [info     ] Loading config from 'config/roleplay_miscon_test_kt/qwen3:0.6b~T_1.0~SO_teacher_kt~SP_teacher_marshmellow_level_context~EFI_quotes~ES_miscon_studentid_kc_exact5.yaml'
2025-08-20 20:43:06 [info     ] Loading config from 'config/roleplay_miscon_test_kt/llama3.2:1b~T_0.0~SO_student_kt~SP_student_chocolate_level_context~EFI_quotes~ES_miscon_studentid_random3.yaml'
2025-08-20 20:43:06 [info     ] Loading config from 'config/roleplay_miscon_test_kt/llama3.1:8b~T_0.0~SO_student_kt~SP_student_chocolate_level_context~EFI_quotes~ES_miscon_studentid_random1.yaml'
2025-08-20 20:43:06 [info     ] Loading config from 'config/roleplay_miscon_test_kt/qwen3:4b~T_0.0~SO_student_kt~SP_student_chocolate_level_context~EFI_quotes~ES_miscon_studentid_kc_exact3.yaml'
2025-08-20 20:43:06 [info     ] Loading config from 'config/roleplay_miscon_test_kt/qwen3:8b~T_0.0~SO_student_kt~SP_student_chocolate_level_context~EFI_quotes~ES_miscon_studentid_random3.yaml'
2025-08-20 20:43:06 [info     ] Loading config from 'config/roleplay_miscon_test_kt/qwen3:14b~T_0.0~SO_teacher_kt~SP_teacher_marshmellow_level_context~EFI_quotes~ES_miscon_studentid_random3.yaml'

 ========== Config: qwen3:1.7b~T_1.0~SO_teacher_kt~L_5~SP_teacher_marshmellow_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_miscon_studentlevel_kc_exact1 ==========
Config 1/8

 ********** Run: 1/3 **********
2025-08-20 20:43:06 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 20:43:06 [info     ] Reading train split questions  num_questions=92
2025-08-20 20:43:06 [info     ] Reading validation split questions num_questions=23
2025-08-20 20:43:06 [info     ] Reading test split questions   num_questions=39
2025-08-20 20:43:07 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 20:43:07 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 20:43:12 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 20:43:12 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 20:43:12 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 20:43:12 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 20:43:15 [info     ] Setting seed                   value=43
2025-08-20 20:43:15 [info     ] Building structured outputter  name=teacher_kt
2025-08-20 20:43:15 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_kc_exact native_structured_output=True num_examples=1 system_prompt=teacher_marshmellow_level_context
2025-08-20 20:43:15 [info     ] Building example selector
2025-08-20 20:43:15 [info     ] Building model                 name=qwen3:1.7b provider=ollama rate_limit=None temp=1.0
2025-08-20 20:43:15 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:09<31:36,  9.77s/it]  1%|          | 2/195 [00:09<13:13,  4.11s/it]  2%|▏         | 3/195 [00:10<07:37,  2.38s/it]  2%|▏         | 4/195 [00:10<04:49,  1.52s/it]  3%|▎         | 5/195 [00:10<03:37,  1.14s/it]  4%|▎         | 7/195 [00:11<02:14,  1.39it/s]  5%|▍         | 9/195 [00:11<01:33,  1.99it/s]  6%|▌         | 11/195 [00:12<01:11,  2.57it/s]  6%|▌         | 12/195 [00:12<01:06,  2.75it/s]  7%|▋         | 13/195 [00:12<00:58,  3.13it/s]  7%|▋         | 14/195 [00:13<00:55,  3.28it/s]  8%|▊         | 16/195 [00:13<00:54,  3.27it/s]  9%|▉         | 18/195 [00:14<00:47,  3.71it/s] 10%|▉         | 19/195 [00:14<00:43,  4.03it/s] 10%|█         | 20/195 [00:14<00:55,  3.18it/s] 11%|█         | 21/195 [00:15<00:51,  3.39it/s] 11%|█▏        | 22/195 [00:15<00:45,  3.83it/s] 12%|█▏        | 23/195 [00:15<00:48,  3.58it/s] 13%|█▎        | 25/195 [00:15<00:42,  4.04it/s] 14%|█▍        | 27/195 [00:16<00:43,  3.88it/s] 15%|█▍        | 29/195 [00:16<00:38,  4.37it/s] 15%|█▌        | 30/195 [00:17<00:39,  4.14it/s] 16%|█▌        | 31/195 [00:17<00:37,  4.41it/s] 16%|█▋        | 32/195 [00:17<00:41,  3.90it/s] 17%|█▋        | 34/195 [00:18<00:42,  3.77it/s] 18%|█▊        | 35/195 [00:18<00:38,  4.13it/s] 18%|█▊        | 36/195 [00:18<00:40,  3.95it/s] 19%|█▉        | 37/195 [00:18<00:43,  3.61it/s] 19%|█▉        | 38/195 [00:19<00:42,  3.71it/s] 20%|██        | 39/195 [00:19<00:44,  3.49it/s] 21%|██        | 40/195 [00:19<00:37,  4.08it/s] 21%|██        | 41/195 [00:20<00:40,  3.82it/s] 22%|██▏       | 43/195 [00:20<00:40,  3.78it/s] 23%|██▎       | 45/195 [00:20<00:34,  4.32it/s] 24%|██▍       | 47/195 [00:21<00:30,  4.79it/s] 25%|██▌       | 49/195 [00:21<00:28,  5.09it/s] 26%|██▌       | 51/195 [00:22<00:30,  4.79it/s] 27%|██▋       | 53/195 [00:22<00:28,  4.97it/s] 28%|██▊       | 54/195 [00:22<00:28,  4.96it/s] 28%|██▊       | 55/195 [00:22<00:26,  5.26it/s] 29%|██▊       | 56/195 [00:23<00:32,  4.33it/s] 30%|██▉       | 58/195 [00:23<00:33,  4.09it/s] 31%|███       | 60/195 [00:24<00:31,  4.22it/s] 31%|███▏      | 61/195 [00:24<00:28,  4.73it/s] 32%|███▏      | 62/195 [00:24<00:29,  4.47it/s] 33%|███▎      | 64/195 [00:24<00:27,  4.73it/s] 34%|███▍      | 66/195 [00:25<00:26,  4.78it/s] 35%|███▍      | 68/195 [00:25<00:29,  4.38it/s] 36%|███▌      | 70/195 [00:26<00:27,  4.47it/s] 36%|███▋      | 71/195 [00:26<00:27,  4.48it/s] 37%|███▋      | 72/195 [00:26<00:26,  4.67it/s] 37%|███▋      | 73/195 [00:26<00:26,  4.52it/s] 38%|███▊      | 75/195 [00:27<00:24,  4.80it/s] 39%|███▉      | 76/195 [00:27<00:26,  4.48it/s] 40%|████      | 78/195 [00:28<00:27,  4.26it/s] 41%|████      | 80/195 [00:28<00:25,  4.43it/s] 42%|████▏     | 82/195 [00:28<00:25,  4.35it/s] 43%|████▎     | 84/195 [00:29<00:25,  4.32it/s] 44%|████▎     | 85/195 [00:29<00:23,  4.58it/s] 44%|████▍     | 86/195 [00:29<00:26,  4.16it/s] 45%|████▍     | 87/195 [00:30<00:25,  4.30it/s] 45%|████▌     | 88/195 [00:30<00:28,  3.70it/s] 46%|████▌     | 90/195 [00:30<00:26,  4.04it/s] 47%|████▋     | 91/195 [00:31<00:24,  4.21it/s] 47%|████▋     | 92/195 [00:31<00:25,  3.98it/s] 48%|████▊     | 93/195 [00:31<00:23,  4.43it/s] 48%|████▊     | 94/195 [00:31<00:26,  3.87it/s] 49%|████▉     | 96/195 [00:32<00:24,  4.04it/s] 50%|█████     | 98/195 [00:32<00:24,  4.01it/s] 51%|█████▏    | 100/195 [00:33<00:21,  4.33it/s] 52%|█████▏    | 101/195 [00:33<00:20,  4.49it/s] 52%|█████▏    | 102/195 [00:33<00:24,  3.75it/s] 53%|█████▎    | 103/195 [00:34<00:23,  3.91it/s] 53%|█████▎    | 104/195 [00:34<00:23,  3.89it/s] 54%|█████▍    | 105/195 [00:34<00:25,  3.48it/s] 55%|█████▍    | 107/195 [00:35<00:25,  3.49it/s] 55%|█████▌    | 108/195 [00:35<00:22,  3.80it/s] 56%|█████▌    | 109/195 [00:35<00:23,  3.70it/s] 56%|█████▋    | 110/195 [00:36<00:23,  3.55it/s] 57%|█████▋    | 111/195 [00:36<00:24,  3.47it/s] 57%|█████▋    | 112/195 [00:36<00:25,  3.21it/s] 58%|█████▊    | 113/195 [00:37<00:23,  3.55it/s] 58%|█████▊    | 114/195 [00:37<00:23,  3.47it/s] 59%|█████▉    | 115/195 [00:37<00:22,  3.59it/s] 59%|█████▉    | 116/195 [00:37<00:25,  3.13it/s] 61%|██████    | 118/195 [00:38<00:21,  3.54it/s] 61%|██████    | 119/195 [00:38<00:19,  3.94it/s] 62%|██████▏   | 120/195 [00:38<00:19,  3.88it/s] 62%|██████▏   | 121/195 [00:39<00:16,  4.46it/s] 63%|██████▎   | 122/195 [00:39<00:18,  3.95it/s] 63%|██████▎   | 123/195 [00:39<00:16,  4.29it/s] 64%|██████▎   | 124/195 [00:39<00:14,  4.91it/s] 64%|██████▍   | 125/195 [00:40<00:16,  4.14it/s] 65%|██████▌   | 127/195 [00:40<00:15,  4.48it/s] 66%|██████▌   | 129/195 [00:40<00:13,  4.85it/s] 67%|██████▋   | 130/195 [00:41<00:14,  4.34it/s] 68%|██████▊   | 132/195 [00:41<00:15,  4.15it/s] 68%|██████▊   | 133/195 [00:41<00:13,  4.47it/s] 69%|██████▊   | 134/195 [00:42<00:15,  3.96it/s] 70%|██████▉   | 136/195 [00:42<00:13,  4.33it/s] 71%|███████   | 138/195 [00:42<00:13,  4.30it/s] 72%|███████▏  | 140/195 [00:43<00:10,  5.04it/s] 72%|███████▏  | 141/195 [00:43<00:09,  5.55it/s] 73%|███████▎  | 142/195 [00:43<00:10,  5.23it/s] 73%|███████▎  | 143/195 [00:43<00:09,  5.67it/s] 74%|███████▍  | 144/195 [00:43<00:09,  5.64it/s] 74%|███████▍  | 145/195 [00:44<00:10,  4.84it/s] 75%|███████▍  | 146/195 [00:44<00:09,  5.41it/s] 75%|███████▌  | 147/195 [00:44<00:10,  4.63it/s] 76%|███████▌  | 148/195 [00:44<00:10,  4.59it/s] 76%|███████▋  | 149/195 [00:45<00:09,  4.62it/s] 77%|███████▋  | 150/195 [00:45<00:09,  4.96it/s] 77%|███████▋  | 151/195 [00:45<00:09,  4.44it/s] 78%|███████▊  | 153/195 [00:45<00:09,  4.59it/s] 79%|███████▉  | 155/195 [00:46<00:08,  4.86it/s] 81%|████████  | 157/195 [00:46<00:07,  5.20it/s] 82%|████████▏ | 159/195 [00:47<00:07,  5.05it/s] 82%|████████▏ | 160/195 [00:47<00:07,  4.54it/s] 83%|████████▎ | 161/195 [00:47<00:06,  4.93it/s] 83%|████████▎ | 162/195 [00:47<00:07,  4.37it/s] 84%|████████▍ | 164/195 [00:48<00:06,  4.57it/s] 85%|████████▍ | 165/195 [00:48<00:05,  5.13it/s] 85%|████████▌ | 166/195 [00:48<00:07,  4.04it/s] 86%|████████▌ | 168/195 [00:49<00:06,  4.18it/s] 87%|████████▋ | 170/195 [00:49<00:06,  4.16it/s] 88%|████████▊ | 172/195 [00:50<00:05,  4.23it/s] 89%|████████▉ | 174/195 [00:50<00:04,  4.34it/s] 90%|█████████ | 176/195 [00:50<00:04,  4.72it/s] 91%|█████████▏| 178/195 [00:51<00:03,  4.90it/s] 92%|█████████▏| 180/195 [00:51<00:03,  4.71it/s] 93%|█████████▎| 181/195 [00:51<00:02,  4.86it/s] 93%|█████████▎| 182/195 [00:52<00:02,  4.46it/s] 94%|█████████▍| 184/195 [00:52<00:02,  4.34it/s] 95%|█████████▌| 186/195 [00:53<00:01,  4.58it/s] 96%|█████████▌| 187/195 [00:53<00:01,  4.62it/s] 96%|█████████▋| 188/195 [00:53<00:01,  4.31it/s] 97%|█████████▋| 189/195 [00:53<00:01,  4.14it/s] 97%|█████████▋| 190/195 [00:53<00:01,  4.72it/s] 98%|█████████▊| 191/195 [00:54<00:00,  4.29it/s] 99%|█████████▉| 193/195 [00:54<00:00,  4.42it/s] 99%|█████████▉| 194/195 [00:54<00:00,  4.72it/s]100%|██████████| 195/195 [00:55<00:00,  5.18it/s]100%|██████████| 195/195 [00:57<00:00,  3.41it/s]
2025-08-20 20:44:13 [info     ] Validating outputs
2025-08-20 20:44:13 [info     ] Predict - end                  time=0:0:57
2025-08-20 20:44:13 [info     ] Evaluate - start               split=test
2025-08-20 20:44:13 [error    ] Error computing monotonicity score error='Cannot calculate a linear regression if all x values are identical' llm_group_correctness=array([0., 0., 0., 0., 0.]) student_group_correctness=array([0.56861655, 0.69013588, 0.78119935, 0.84989873, 0.90918367])
2025-08-20 20:44:13 [info     ] Evaluate - end                 correctness_llm=0.0 monotonicity=nan
2025-08-20 20:44:13 [info     ] Evaluate question difficulty - start split=test
2025-08-20 20:44:13 [info     ] Augmenting questions for IRT estimation num_questions=38
2025-08-20 20:44:13 INFO: start loading data
start loading data
2025-08-20 20:44:13 INFO: data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1186.75it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3831.04it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 455.13it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8517.59it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1027.62it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3623.71it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 574.86it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8254.18it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1087.49it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3934.43it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 549.61it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 9696.21it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1081.13it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3625.15it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 585.57it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8381.42it/s]
2025-08-20 20:44:16 INFO: EM converged at iteration 4.
EM converged at iteration 4.
2025-08-20 20:44:16 INFO: parameter estimated
parameter estimated
2025-08-20 20:44:16 INFO: parameter retrieved
parameter retrieved
2025-08-20 20:44:16 [info     ] Evaluate question difficulty - end rmse=2.189146578979627 split=test
2025-08-20 20:44:16 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 1 finished: 0:1:10

 ********** Run: 2/3 **********
2025-08-20 20:44:36 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 20:44:37 [info     ] Reading train split questions  num_questions=92
2025-08-20 20:44:37 [info     ] Reading validation split questions num_questions=23
2025-08-20 20:44:37 [info     ] Reading test split questions   num_questions=39
2025-08-20 20:44:38 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 20:44:38 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 20:44:43 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 20:44:43 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 20:44:43 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 20:44:44 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 20:44:47 [info     ] Setting seed                   value=44
2025-08-20 20:44:47 [info     ] Building structured outputter  name=teacher_kt
2025-08-20 20:44:47 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_kc_exact native_structured_output=True num_examples=1 system_prompt=teacher_marshmellow_level_context
2025-08-20 20:44:47 [info     ] Building example selector
2025-08-20 20:44:47 [info     ] Building model                 name=qwen3:1.7b provider=ollama rate_limit=None temp=1.0
2025-08-20 20:44:47 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:09<30:50,  9.54s/it]  2%|▏         | 3/195 [00:10<08:48,  2.75s/it]  2%|▏         | 4/195 [00:10<06:05,  1.91s/it]  3%|▎         | 5/195 [00:11<04:35,  1.45s/it]  3%|▎         | 6/195 [00:11<03:29,  1.11s/it]  4%|▎         | 7/195 [00:11<02:34,  1.22it/s]  4%|▍         | 8/195 [00:12<02:09,  1.44it/s]  5%|▍         | 9/195 [00:12<01:39,  1.88it/s]  5%|▌         | 10/195 [00:12<01:22,  2.24it/s]  6%|▌         | 12/195 [00:12<00:58,  3.15it/s]  7%|▋         | 14/195 [00:13<00:47,  3.78it/s]  8%|▊         | 16/195 [00:13<00:45,  3.98it/s]  9%|▉         | 18/195 [00:14<00:39,  4.52it/s] 10%|▉         | 19/195 [00:14<00:35,  4.92it/s] 10%|█         | 20/195 [00:14<00:39,  4.44it/s] 11%|█▏        | 22/195 [00:14<00:33,  5.22it/s] 12%|█▏        | 24/195 [00:15<00:31,  5.39it/s] 13%|█▎        | 25/195 [00:15<00:33,  5.01it/s] 13%|█▎        | 26/195 [00:15<00:34,  4.89it/s] 14%|█▍        | 27/195 [00:15<00:32,  5.20it/s] 14%|█▍        | 28/195 [00:16<00:39,  4.18it/s] 15%|█▍        | 29/195 [00:16<00:38,  4.35it/s] 15%|█▌        | 30/195 [00:16<00:41,  4.02it/s] 16%|█▋        | 32/195 [00:17<00:41,  3.90it/s] 17%|█▋        | 33/195 [00:17<00:37,  4.27it/s] 17%|█▋        | 34/195 [00:17<00:41,  3.85it/s] 18%|█▊        | 35/195 [00:17<00:39,  4.07it/s] 18%|█▊        | 36/195 [00:17<00:34,  4.59it/s] 19%|█▉        | 37/195 [00:18<00:36,  4.28it/s] 19%|█▉        | 38/195 [00:18<00:36,  4.31it/s] 20%|██        | 39/195 [00:18<00:34,  4.50it/s] 21%|██        | 40/195 [00:18<00:31,  4.86it/s] 21%|██        | 41/195 [00:19<00:31,  4.90it/s] 22%|██▏       | 43/195 [00:19<00:29,  5.11it/s] 23%|██▎       | 44/195 [00:19<00:28,  5.22it/s] 23%|██▎       | 45/195 [00:19<00:34,  4.35it/s] 24%|██▍       | 47/195 [00:20<00:34,  4.25it/s] 25%|██▌       | 49/195 [00:20<00:31,  4.58it/s] 26%|██▌       | 51/195 [00:21<00:32,  4.48it/s] 27%|██▋       | 52/195 [00:21<00:33,  4.27it/s] 27%|██▋       | 53/195 [00:21<00:35,  3.99it/s] 28%|██▊       | 54/195 [00:22<00:37,  3.81it/s] 28%|██▊       | 55/195 [00:22<00:36,  3.80it/s] 29%|██▊       | 56/195 [00:22<00:38,  3.61it/s] 29%|██▉       | 57/195 [00:22<00:33,  4.14it/s] 30%|██▉       | 58/195 [00:23<00:40,  3.36it/s] 31%|███       | 60/195 [00:23<00:37,  3.55it/s] 32%|███▏      | 62/195 [00:24<00:32,  4.13it/s] 33%|███▎      | 64/195 [00:24<00:30,  4.27it/s] 33%|███▎      | 65/195 [00:24<00:26,  4.83it/s] 34%|███▍      | 66/195 [00:25<00:31,  4.13it/s] 34%|███▍      | 67/195 [00:25<00:31,  4.10it/s] 35%|███▍      | 68/195 [00:25<00:30,  4.16it/s] 35%|███▌      | 69/195 [00:25<00:28,  4.43it/s] 36%|███▌      | 70/195 [00:25<00:26,  4.67it/s] 36%|███▋      | 71/195 [00:26<00:27,  4.57it/s] 37%|███▋      | 72/195 [00:26<00:23,  5.25it/s] 37%|███▋      | 73/195 [00:26<00:28,  4.30it/s] 38%|███▊      | 74/195 [00:26<00:26,  4.61it/s] 38%|███▊      | 75/195 [00:27<00:26,  4.49it/s] 39%|███▉      | 76/195 [00:27<00:25,  4.64it/s] 39%|███▉      | 77/195 [00:27<00:25,  4.55it/s] 40%|████      | 78/195 [00:27<00:30,  3.85it/s] 41%|████      | 80/195 [00:28<00:25,  4.44it/s] 42%|████▏     | 82/195 [00:28<00:24,  4.58it/s] 43%|████▎     | 83/195 [00:28<00:23,  4.70it/s] 43%|████▎     | 84/195 [00:29<00:22,  4.85it/s] 44%|████▎     | 85/195 [00:29<00:23,  4.60it/s] 44%|████▍     | 86/195 [00:29<00:21,  5.05it/s] 45%|████▍     | 87/195 [00:29<00:26,  4.11it/s] 46%|████▌     | 89/195 [00:30<00:24,  4.29it/s] 47%|████▋     | 91/195 [00:30<00:23,  4.42it/s] 48%|████▊     | 93/195 [00:31<00:24,  4.20it/s] 49%|████▊     | 95/195 [00:31<00:23,  4.32it/s] 50%|████▉     | 97/195 [00:32<00:22,  4.37it/s] 51%|█████     | 99/195 [00:32<00:22,  4.29it/s] 52%|█████▏    | 101/195 [00:32<00:21,  4.35it/s] 52%|█████▏    | 102/195 [00:33<00:22,  4.19it/s] 53%|█████▎    | 103/195 [00:33<00:23,  3.87it/s] 53%|█████▎    | 104/195 [00:33<00:25,  3.61it/s] 54%|█████▍    | 105/195 [00:34<00:24,  3.69it/s] 54%|█████▍    | 106/195 [00:34<00:26,  3.34it/s] 55%|█████▌    | 108/195 [00:35<00:23,  3.71it/s] 56%|█████▋    | 110/195 [00:35<00:21,  3.92it/s] 57%|█████▋    | 111/195 [00:35<00:19,  4.22it/s] 57%|█████▋    | 112/195 [00:36<00:24,  3.42it/s] 58%|█████▊    | 113/195 [00:36<00:23,  3.55it/s] 58%|█████▊    | 114/195 [00:36<00:25,  3.21it/s] 59%|█████▉    | 115/195 [00:37<00:24,  3.20it/s] 59%|█████▉    | 116/195 [00:37<00:21,  3.63it/s] 60%|██████    | 117/195 [00:37<00:21,  3.61it/s] 61%|██████    | 118/195 [00:37<00:23,  3.33it/s] 61%|██████    | 119/195 [00:38<00:22,  3.40it/s] 62%|██████▏   | 120/195 [00:38<00:20,  3.74it/s] 62%|██████▏   | 121/195 [00:38<00:19,  3.76it/s] 63%|██████▎   | 122/195 [00:38<00:20,  3.63it/s] 63%|██████▎   | 123/195 [00:39<00:19,  3.63it/s] 64%|██████▎   | 124/195 [00:39<00:17,  3.97it/s] 64%|██████▍   | 125/195 [00:39<00:18,  3.70it/s] 65%|██████▌   | 127/195 [00:40<00:15,  4.36it/s] 66%|██████▌   | 129/195 [00:40<00:15,  4.17it/s] 67%|██████▋   | 131/195 [00:41<00:15,  4.09it/s] 68%|██████▊   | 133/195 [00:41<00:14,  4.19it/s] 69%|██████▉   | 135/195 [00:42<00:14,  4.17it/s] 70%|██████▉   | 136/195 [00:42<00:12,  4.56it/s] 70%|███████   | 137/195 [00:42<00:13,  4.16it/s] 71%|███████▏  | 139/195 [00:42<00:12,  4.65it/s] 72%|███████▏  | 141/195 [00:43<00:11,  4.85it/s] 73%|███████▎  | 143/195 [00:43<00:10,  5.03it/s] 74%|███████▍  | 144/195 [00:43<00:09,  5.25it/s] 74%|███████▍  | 145/195 [00:43<00:09,  5.08it/s] 75%|███████▌  | 147/195 [00:44<00:10,  4.75it/s] 76%|███████▋  | 149/195 [00:44<00:09,  4.78it/s] 77%|███████▋  | 151/195 [00:45<00:08,  4.97it/s] 78%|███████▊  | 153/195 [00:45<00:08,  5.14it/s] 79%|███████▉  | 155/195 [00:45<00:07,  5.29it/s] 81%|████████  | 157/195 [00:46<00:07,  5.43it/s] 82%|████████▏ | 159/195 [00:46<00:06,  5.51it/s] 82%|████████▏ | 160/195 [00:46<00:06,  5.35it/s] 83%|████████▎ | 161/195 [00:47<00:06,  5.13it/s] 83%|████████▎ | 162/195 [00:47<00:07,  4.35it/s] 84%|████████▍ | 164/195 [00:47<00:06,  4.81it/s] 85%|████████▌ | 166/195 [00:48<00:05,  4.91it/s] 86%|████████▌ | 167/195 [00:48<00:05,  5.04it/s] 86%|████████▌ | 168/195 [00:48<00:05,  5.10it/s] 87%|████████▋ | 169/195 [00:48<00:05,  4.78it/s] 87%|████████▋ | 170/195 [00:49<00:05,  4.48it/s] 88%|████████▊ | 171/195 [00:49<00:04,  4.88it/s] 88%|████████▊ | 172/195 [00:49<00:04,  4.69it/s] 89%|████████▊ | 173/195 [00:49<00:05,  4.23it/s] 90%|████████▉ | 175/195 [00:50<00:04,  4.15it/s] 91%|█████████ | 177/195 [00:50<00:03,  4.57it/s] 92%|█████████▏| 179/195 [00:50<00:03,  4.74it/s] 93%|█████████▎| 181/195 [00:51<00:03,  4.55it/s] 94%|█████████▍| 183/195 [00:51<00:02,  4.40it/s] 95%|█████████▍| 185/195 [00:52<00:02,  4.68it/s] 95%|█████████▌| 186/195 [00:52<00:01,  5.19it/s] 96%|█████████▌| 187/195 [00:52<00:01,  4.43it/s] 97%|█████████▋| 189/195 [00:53<00:01,  4.29it/s] 98%|█████████▊| 191/195 [00:53<00:00,  4.61it/s] 98%|█████████▊| 192/195 [00:53<00:00,  4.73it/s] 99%|█████████▉| 193/195 [00:53<00:00,  4.91it/s] 99%|█████████▉| 194/195 [00:54<00:00,  4.77it/s]100%|██████████| 195/195 [00:56<00:00,  3.46it/s]
2025-08-20 20:45:43 [info     ] Validating outputs
2025-08-20 20:45:43 [info     ] Predict - end                  time=0:0:56
2025-08-20 20:45:43 [info     ] Evaluate - start               split=test
2025-08-20 20:45:43 [error    ] Error computing monotonicity score error='Cannot calculate a linear regression if all x values are identical' llm_group_correctness=array([0., 0., 0., 0., 0.]) student_group_correctness=array([0.56861655, 0.69013588, 0.78119935, 0.84989873, 0.90918367])
2025-08-20 20:45:43 [info     ] Evaluate - end                 correctness_llm=0.0 monotonicity=nan
2025-08-20 20:45:43 [info     ] Evaluate question difficulty - start split=test
2025-08-20 20:45:43 [info     ] Augmenting questions for IRT estimation num_questions=39
2025-08-20 20:45:43 INFO: start loading data
start loading data
start loading data
2025-08-20 20:45:43 INFO: data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 998.37it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3518.26it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 485.96it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6246.84it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 900.37it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3477.05it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 629.13it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6331.71it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 895.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3523.26it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 618.46it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 2213.35it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 878.52it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3754.80it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 613.28it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6134.59it/s]
2025-08-20 20:45:46 INFO: EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
2025-08-20 20:45:46 INFO: parameter estimated
parameter estimated
parameter estimated
2025-08-20 20:45:46 INFO: parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 20:45:46 [info     ] Evaluate question difficulty - end rmse=2.1790369211218845 split=test
2025-08-20 20:45:46 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 2 finished: 0:1:9

 ********** Run: 3/3 **********
2025-08-20 20:46:06 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 20:46:06 [info     ] Reading train split questions  num_questions=92
2025-08-20 20:46:06 [info     ] Reading validation split questions num_questions=23
2025-08-20 20:46:06 [info     ] Reading test split questions   num_questions=39
2025-08-20 20:46:08 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 20:46:08 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 20:46:13 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 20:46:13 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 20:46:13 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 20:46:13 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 20:46:16 [info     ] Setting seed                   value=45
2025-08-20 20:46:16 [info     ] Building structured outputter  name=teacher_kt
2025-08-20 20:46:16 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_kc_exact native_structured_output=True num_examples=1 system_prompt=teacher_marshmellow_level_context
2025-08-20 20:46:16 [info     ] Building example selector
2025-08-20 20:46:16 [info     ] Building model                 name=qwen3:1.7b provider=ollama rate_limit=None temp=1.0
2025-08-20 20:46:16 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:09<30:58,  9.58s/it]  2%|▏         | 3/195 [00:10<08:56,  2.79s/it]  2%|▏         | 4/195 [00:10<05:59,  1.88s/it]  3%|▎         | 5/195 [00:11<04:32,  1.44s/it]  3%|▎         | 6/195 [00:11<03:15,  1.04s/it]  4%|▎         | 7/195 [00:11<02:30,  1.25it/s]  4%|▍         | 8/195 [00:11<01:58,  1.57it/s]  5%|▍         | 9/195 [00:12<01:38,  1.89it/s]  6%|▌         | 11/195 [00:12<01:05,  2.79it/s]  6%|▌         | 12/195 [00:12<00:57,  3.19it/s]  7%|▋         | 13/195 [00:12<00:49,  3.71it/s]  7%|▋         | 14/195 [00:13<00:49,  3.65it/s]  8%|▊         | 16/195 [00:13<00:40,  4.44it/s]  9%|▉         | 18/195 [00:13<00:36,  4.91it/s] 10%|▉         | 19/195 [00:13<00:32,  5.36it/s] 10%|█         | 20/195 [00:14<00:35,  4.89it/s] 11%|█         | 21/195 [00:14<00:39,  4.36it/s] 12%|█▏        | 23/195 [00:14<00:36,  4.77it/s] 12%|█▏        | 24/195 [00:15<00:38,  4.42it/s] 13%|█▎        | 25/195 [00:15<00:41,  4.12it/s] 14%|█▍        | 27/195 [00:15<00:41,  4.03it/s] 15%|█▍        | 29/195 [00:16<00:40,  4.11it/s] 16%|█▌        | 31/195 [00:16<00:39,  4.17it/s] 17%|█▋        | 33/195 [00:17<00:38,  4.23it/s] 18%|█▊        | 35/195 [00:17<00:37,  4.29it/s] 19%|█▉        | 37/195 [00:18<00:35,  4.43it/s] 20%|██        | 39/195 [00:18<00:31,  4.97it/s] 21%|██        | 40/195 [00:18<00:31,  4.96it/s] 21%|██        | 41/195 [00:18<00:28,  5.38it/s] 22%|██▏       | 42/195 [00:19<00:30,  5.06it/s] 23%|██▎       | 44/195 [00:19<00:29,  5.07it/s] 23%|██▎       | 45/195 [00:19<00:28,  5.26it/s] 24%|██▎       | 46/195 [00:19<00:27,  5.39it/s] 24%|██▍       | 47/195 [00:19<00:28,  5.27it/s] 25%|██▍       | 48/195 [00:20<00:25,  5.82it/s] 25%|██▌       | 49/195 [00:20<00:29,  4.98it/s] 26%|██▌       | 51/195 [00:20<00:34,  4.20it/s] 27%|██▋       | 53/195 [00:21<00:33,  4.26it/s] 28%|██▊       | 54/195 [00:21<00:35,  3.92it/s] 28%|██▊       | 55/195 [00:21<00:35,  3.90it/s] 29%|██▊       | 56/195 [00:22<00:34,  4.03it/s] 29%|██▉       | 57/195 [00:22<00:32,  4.21it/s] 30%|██▉       | 58/195 [00:22<00:33,  4.10it/s] 30%|███       | 59/195 [00:22<00:34,  3.95it/s] 31%|███       | 60/195 [00:23<00:36,  3.67it/s] 31%|███▏      | 61/195 [00:23<00:36,  3.71it/s] 32%|███▏      | 62/195 [00:23<00:31,  4.23it/s] 32%|███▏      | 63/195 [00:24<00:34,  3.78it/s] 33%|███▎      | 65/195 [00:24<00:31,  4.19it/s] 34%|███▍      | 67/195 [00:24<00:29,  4.36it/s] 35%|███▌      | 69/195 [00:25<00:25,  4.86it/s] 36%|███▌      | 70/195 [00:25<00:23,  5.23it/s] 36%|███▋      | 71/195 [00:25<00:27,  4.58it/s] 37%|███▋      | 73/195 [00:25<00:24,  4.96it/s] 38%|███▊      | 74/195 [00:26<00:24,  4.86it/s] 38%|███▊      | 75/195 [00:26<00:21,  5.46it/s] 39%|███▉      | 76/195 [00:26<00:27,  4.35it/s] 40%|████      | 78/195 [00:27<00:24,  4.83it/s] 41%|████      | 80/195 [00:27<00:23,  4.96it/s] 42%|████▏     | 82/195 [00:27<00:22,  5.03it/s] 43%|████▎     | 84/195 [00:28<00:21,  5.06it/s] 44%|████▎     | 85/195 [00:28<00:22,  4.90it/s] 44%|████▍     | 86/195 [00:28<00:22,  4.77it/s] 45%|████▍     | 87/195 [00:28<00:24,  4.49it/s] 45%|████▌     | 88/195 [00:29<00:22,  4.78it/s] 46%|████▌     | 89/195 [00:29<00:24,  4.41it/s] 47%|████▋     | 91/195 [00:29<00:23,  4.48it/s] 48%|████▊     | 93/195 [00:30<00:21,  4.80it/s] 48%|████▊     | 94/195 [00:30<00:20,  5.01it/s] 49%|████▊     | 95/195 [00:30<00:20,  4.80it/s] 49%|████▉     | 96/195 [00:30<00:19,  4.98it/s] 50%|████▉     | 97/195 [00:30<00:19,  5.07it/s] 50%|█████     | 98/195 [00:31<00:20,  4.70it/s] 51%|█████     | 99/195 [00:31<00:18,  5.12it/s] 51%|█████▏    | 100/195 [00:31<00:21,  4.46it/s] 52%|█████▏    | 101/195 [00:31<00:18,  5.15it/s] 52%|█████▏    | 102/195 [00:32<00:24,  3.79it/s] 53%|█████▎    | 103/195 [00:32<00:24,  3.73it/s] 53%|█████▎    | 104/195 [00:32<00:26,  3.47it/s] 54%|█████▍    | 105/195 [00:33<00:27,  3.32it/s] 54%|█████▍    | 106/195 [00:33<00:22,  3.88it/s] 55%|█████▍    | 107/195 [00:33<00:25,  3.50it/s] 56%|█████▌    | 109/195 [00:34<00:23,  3.63it/s] 57%|█████▋    | 111/195 [00:34<00:23,  3.54it/s] 58%|█████▊    | 113/195 [00:35<00:20,  4.02it/s] 58%|█████▊    | 114/195 [00:35<00:19,  4.08it/s] 59%|█████▉    | 115/195 [00:35<00:19,  4.11it/s] 59%|█████▉    | 116/195 [00:35<00:18,  4.25it/s] 60%|██████    | 117/195 [00:36<00:18,  4.27it/s] 61%|██████    | 118/195 [00:36<00:18,  4.10it/s] 61%|██████    | 119/195 [00:36<00:18,  4.11it/s] 62%|██████▏   | 120/195 [00:36<00:19,  3.88it/s] 62%|██████▏   | 121/195 [00:36<00:16,  4.54it/s] 63%|██████▎   | 122/195 [00:37<00:20,  3.58it/s] 64%|██████▎   | 124/195 [00:37<00:18,  3.90it/s] 65%|██████▍   | 126/195 [00:38<00:15,  4.43it/s] 65%|██████▌   | 127/195 [00:38<00:14,  4.68it/s] 66%|██████▌   | 128/195 [00:38<00:15,  4.28it/s] 67%|██████▋   | 130/195 [00:39<00:15,  4.25it/s] 68%|██████▊   | 132/195 [00:39<00:13,  4.56it/s] 68%|██████▊   | 133/195 [00:39<00:13,  4.55it/s] 69%|██████▊   | 134/195 [00:39<00:13,  4.49it/s] 69%|██████▉   | 135/195 [00:40<00:12,  5.00it/s] 70%|██████▉   | 136/195 [00:40<00:11,  5.29it/s] 70%|███████   | 137/195 [00:40<00:11,  5.12it/s] 71%|███████   | 138/195 [00:40<00:11,  4.85it/s] 72%|███████▏  | 140/195 [00:41<00:10,  5.25it/s] 73%|███████▎  | 142/195 [00:41<00:09,  5.34it/s] 74%|███████▍  | 144/195 [00:41<00:09,  5.33it/s] 75%|███████▍  | 146/195 [00:42<00:09,  5.40it/s] 75%|███████▌  | 147/195 [00:42<00:08,  5.58it/s] 76%|███████▌  | 148/195 [00:42<00:10,  4.66it/s] 77%|███████▋  | 150/195 [00:43<00:09,  4.80it/s] 78%|███████▊  | 152/195 [00:43<00:08,  4.81it/s] 78%|███████▊  | 153/195 [00:43<00:08,  4.78it/s] 79%|███████▉  | 154/195 [00:43<00:08,  4.93it/s] 79%|███████▉  | 155/195 [00:44<00:08,  4.67it/s] 80%|████████  | 156/195 [00:44<00:07,  5.18it/s] 81%|████████  | 157/195 [00:44<00:07,  4.88it/s] 81%|████████  | 158/195 [00:44<00:07,  5.09it/s] 82%|████████▏ | 159/195 [00:44<00:06,  5.31it/s] 82%|████████▏ | 160/195 [00:45<00:07,  4.62it/s] 83%|████████▎ | 162/195 [00:45<00:06,  4.81it/s] 84%|████████▎ | 163/195 [00:45<00:06,  5.01it/s] 84%|████████▍ | 164/195 [00:46<00:07,  4.31it/s] 85%|████████▌ | 166/195 [00:46<00:05,  4.90it/s] 86%|████████▌ | 168/195 [00:46<00:05,  4.91it/s] 87%|████████▋ | 170/195 [00:47<00:05,  4.64it/s] 88%|████████▊ | 172/195 [00:47<00:04,  5.06it/s] 89%|████████▉ | 174/195 [00:47<00:04,  4.88it/s] 90%|████████▉ | 175/195 [00:48<00:03,  5.37it/s] 90%|█████████ | 176/195 [00:48<00:04,  4.35it/s] 91%|█████████▏| 178/195 [00:48<00:03,  4.38it/s] 92%|█████████▏| 179/195 [00:49<00:03,  4.48it/s] 92%|█████████▏| 180/195 [00:49<00:03,  4.09it/s] 93%|█████████▎| 181/195 [00:49<00:03,  4.04it/s] 94%|█████████▍| 183/195 [00:50<00:02,  4.55it/s] 95%|█████████▍| 185/195 [00:50<00:02,  4.70it/s] 96%|█████████▌| 187/195 [00:50<00:01,  4.87it/s] 97%|█████████▋| 189/195 [00:51<00:01,  4.89it/s] 98%|█████████▊| 191/195 [00:51<00:00,  5.20it/s] 99%|█████████▉| 193/195 [00:52<00:00,  4.70it/s]100%|██████████| 195/195 [00:52<00:00,  5.18it/s]100%|██████████| 195/195 [00:54<00:00,  3.56it/s]
2025-08-20 20:47:11 [info     ] Validating outputs
2025-08-20 20:47:11 [info     ] Predict - end                  time=0:0:54
2025-08-20 20:47:11 [info     ] Evaluate - start               split=test
2025-08-20 20:47:11 [error    ] Error computing monotonicity score error='Cannot calculate a linear regression if all x values are identical' llm_group_correctness=array([0., 0., 0., 0., 0.]) student_group_correctness=array([0.56861655, 0.69013588, 0.78119935, 0.84989873, 0.90918367])
2025-08-20 20:47:11 [info     ] Evaluate - end                 correctness_llm=0.0 monotonicity=nan
2025-08-20 20:47:11 [info     ] Evaluate question difficulty - start split=test
2025-08-20 20:47:11 [info     ] Augmenting questions for IRT estimation num_questions=39
2025-08-20 20:47:11 INFO: start loading data
start loading data
start loading data
start loading data
2025-08-20 20:47:11 INFO: data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 977.30it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3413.56it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 527.10it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5288.21it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 832.27it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3540.88it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 563.54it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6459.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 863.91it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3466.29it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 618.43it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5253.20it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 778.93it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3609.40it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 615.82it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5544.88it/s]
2025-08-20 20:47:14 INFO: EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
2025-08-20 20:47:14 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 20:47:14 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 20:47:14 [info     ] Evaluate question difficulty - end rmse=2.1790369211218845 split=test
2025-08-20 20:47:14 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 3 finished: 0:1:7

 ========== Config: llama3.2:3b~T_1.0~SO_student_kt~L_5~SP_student_chocolate_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_miscon_studentlevel_random1 ==========
Config 2/8

 ********** Run: 1/3 **********
2025-08-20 20:47:38 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 20:47:38 [info     ] Reading train split questions  num_questions=92
2025-08-20 20:47:38 [info     ] Reading validation split questions num_questions=23
2025-08-20 20:47:38 [info     ] Reading test split questions   num_questions=39
2025-08-20 20:47:40 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 20:47:40 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 20:47:44 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 20:47:44 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 20:47:44 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 20:47:45 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 20:47:48 [info     ] Setting seed                   value=43
2025-08-20 20:47:48 [info     ] Building structured outputter  name=student_kt
2025-08-20 20:47:48 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_random native_structured_output=True num_examples=1 system_prompt=student_chocolate_level_context
2025-08-20 20:47:48 [info     ] Building example selector
2025-08-20 20:47:48 [info     ] Building model                 name=llama3.2:3b provider=ollama rate_limit=None temp=1.0
2025-08-20 20:47:48 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:10<32:48, 10.15s/it]  2%|▏         | 3/195 [00:10<09:14,  2.89s/it]  2%|▏         | 4/195 [00:11<06:42,  2.11s/it]  3%|▎         | 5/195 [00:12<05:19,  1.68s/it]  3%|▎         | 6/195 [00:12<03:47,  1.21s/it]  4%|▎         | 7/195 [00:13<03:16,  1.04s/it]  4%|▍         | 8/195 [00:13<02:23,  1.30it/s]  5%|▍         | 9/195 [00:13<02:08,  1.45it/s]  6%|▌         | 11/195 [00:14<01:27,  2.10it/s]  7%|▋         | 13/195 [00:14<01:15,  2.40it/s]  7%|▋         | 14/195 [00:15<01:04,  2.82it/s]  8%|▊         | 15/195 [00:15<01:11,  2.51it/s]  9%|▊         | 17/195 [00:16<01:14,  2.40it/s]  9%|▉         | 18/195 [00:16<01:08,  2.59it/s] 10%|▉         | 19/195 [00:17<01:10,  2.49it/s] 10%|█         | 20/195 [00:17<00:57,  3.02it/s] 11%|█         | 21/195 [00:17<01:00,  2.86it/s] 11%|█▏        | 22/195 [00:17<00:50,  3.46it/s] 12%|█▏        | 23/195 [00:18<01:03,  2.70it/s] 12%|█▏        | 24/195 [00:18<00:52,  3.28it/s] 13%|█▎        | 25/195 [00:19<00:56,  3.03it/s] 13%|█▎        | 26/195 [00:19<00:59,  2.82it/s] 14%|█▍        | 27/195 [00:19<00:47,  3.53it/s] 14%|█▍        | 28/195 [00:20<00:57,  2.88it/s] 15%|█▍        | 29/195 [00:20<00:56,  2.94it/s] 15%|█▌        | 30/195 [00:20<00:58,  2.83it/s] 16%|█▌        | 31/195 [00:21<00:58,  2.79it/s] 16%|█▋        | 32/195 [00:21<00:50,  3.20it/s] 17%|█▋        | 33/195 [00:21<00:57,  2.83it/s] 17%|█▋        | 34/195 [00:21<00:45,  3.51it/s] 18%|█▊        | 35/195 [00:22<00:52,  3.05it/s] 18%|█▊        | 36/195 [00:22<00:43,  3.65it/s] 19%|█▉        | 37/195 [00:22<00:49,  3.17it/s] 19%|█▉        | 38/195 [00:23<00:45,  3.47it/s] 20%|██        | 39/195 [00:23<00:54,  2.88it/s] 21%|██        | 41/195 [00:24<00:48,  3.19it/s] 22%|██▏       | 42/195 [00:24<00:53,  2.89it/s] 23%|██▎       | 44/195 [00:25<00:49,  3.08it/s] 24%|██▎       | 46/195 [00:25<00:42,  3.48it/s] 24%|██▍       | 47/195 [00:26<00:46,  3.19it/s] 25%|██▍       | 48/195 [00:26<00:47,  3.11it/s] 25%|██▌       | 49/195 [00:26<00:52,  2.79it/s] 26%|██▌       | 50/195 [00:27<00:58,  2.50it/s] 26%|██▌       | 51/195 [00:27<00:54,  2.66it/s] 27%|██▋       | 52/195 [00:27<00:46,  3.07it/s] 27%|██▋       | 53/195 [00:28<00:47,  2.97it/s] 28%|██▊       | 54/195 [00:28<00:40,  3.52it/s] 28%|██▊       | 55/195 [00:28<00:43,  3.21it/s] 29%|██▊       | 56/195 [00:28<00:35,  3.86it/s] 29%|██▉       | 57/195 [00:29<00:41,  3.34it/s] 30%|███       | 59/195 [00:29<00:40,  3.36it/s] 31%|███▏      | 61/195 [00:30<00:44,  3.03it/s] 32%|███▏      | 62/195 [00:30<00:38,  3.49it/s] 32%|███▏      | 63/195 [00:31<00:42,  3.09it/s] 33%|███▎      | 64/195 [00:31<00:42,  3.11it/s] 33%|███▎      | 65/195 [00:31<00:37,  3.49it/s] 34%|███▍      | 66/195 [00:32<00:42,  3.03it/s] 34%|███▍      | 67/195 [00:32<00:37,  3.39it/s] 35%|███▍      | 68/195 [00:32<00:43,  2.89it/s] 35%|███▌      | 69/195 [00:33<00:35,  3.57it/s] 36%|███▌      | 70/195 [00:33<00:43,  2.87it/s] 36%|███▋      | 71/195 [00:33<00:43,  2.88it/s] 37%|███▋      | 72/195 [00:34<00:37,  3.29it/s] 37%|███▋      | 73/195 [00:34<00:39,  3.09it/s] 38%|███▊      | 74/195 [00:34<00:35,  3.40it/s] 38%|███▊      | 75/195 [00:35<00:40,  2.94it/s] 39%|███▉      | 76/195 [00:35<00:33,  3.57it/s] 39%|███▉      | 77/195 [00:35<00:40,  2.94it/s] 41%|████      | 79/195 [00:36<00:38,  3.01it/s] 42%|████▏     | 81/195 [00:36<00:32,  3.53it/s] 42%|████▏     | 82/195 [00:37<00:33,  3.38it/s] 43%|████▎     | 83/195 [00:37<00:28,  3.87it/s] 43%|████▎     | 84/195 [00:37<00:29,  3.73it/s] 44%|████▎     | 85/195 [00:37<00:24,  4.43it/s] 44%|████▍     | 86/195 [00:38<00:32,  3.39it/s] 45%|████▌     | 88/195 [00:38<00:27,  3.88it/s] 46%|████▌     | 90/195 [00:39<00:25,  4.08it/s] 47%|████▋     | 91/195 [00:39<00:28,  3.66it/s] 47%|████▋     | 92/195 [00:39<00:24,  4.24it/s] 48%|████▊     | 93/195 [00:39<00:29,  3.48it/s] 48%|████▊     | 94/195 [00:40<00:28,  3.54it/s] 49%|████▊     | 95/195 [00:40<00:25,  3.86it/s] 49%|████▉     | 96/195 [00:41<00:35,  2.76it/s] 50%|████▉     | 97/195 [00:41<00:29,  3.28it/s] 50%|█████     | 98/195 [00:41<00:33,  2.91it/s] 51%|█████▏    | 100/195 [00:42<00:33,  2.81it/s] 52%|█████▏    | 101/195 [00:42<00:29,  3.23it/s] 52%|█████▏    | 102/195 [00:43<00:32,  2.88it/s] 53%|█████▎    | 104/195 [00:43<00:32,  2.84it/s] 54%|█████▍    | 105/195 [00:44<00:32,  2.76it/s] 54%|█████▍    | 106/195 [00:44<00:37,  2.36it/s] 55%|█████▍    | 107/195 [00:45<00:35,  2.49it/s] 55%|█████▌    | 108/195 [00:45<00:37,  2.33it/s] 56%|█████▌    | 109/195 [00:46<00:36,  2.33it/s] 56%|█████▋    | 110/195 [00:46<00:30,  2.76it/s] 57%|█████▋    | 111/195 [00:46<00:34,  2.46it/s] 57%|█████▋    | 112/195 [00:46<00:27,  2.98it/s] 58%|█████▊    | 113/195 [00:47<00:27,  3.01it/s] 58%|█████▊    | 114/195 [00:47<00:30,  2.67it/s] 59%|█████▉    | 115/195 [00:47<00:25,  3.15it/s] 59%|█████▉    | 116/195 [00:48<00:27,  2.83it/s] 61%|██████    | 118/195 [00:49<00:30,  2.53it/s] 62%|██████▏   | 120/195 [00:49<00:25,  2.91it/s] 63%|██████▎   | 122/195 [00:50<00:25,  2.82it/s] 64%|██████▎   | 124/195 [00:51<00:24,  2.92it/s] 64%|██████▍   | 125/195 [00:51<00:22,  3.12it/s] 65%|██████▍   | 126/195 [00:51<00:20,  3.41it/s] 65%|██████▌   | 127/195 [00:51<00:20,  3.27it/s] 66%|██████▌   | 129/195 [00:52<00:20,  3.26it/s] 67%|██████▋   | 130/195 [00:52<00:19,  3.36it/s] 67%|██████▋   | 131/195 [00:53<00:18,  3.42it/s] 68%|██████▊   | 132/195 [00:53<00:15,  4.02it/s] 68%|██████▊   | 133/195 [00:53<00:16,  3.75it/s] 69%|██████▊   | 134/195 [00:53<00:14,  4.08it/s] 69%|██████▉   | 135/195 [00:53<00:15,  3.75it/s] 70%|██████▉   | 136/195 [00:54<00:20,  2.84it/s] 70%|███████   | 137/195 [00:54<00:17,  3.37it/s] 71%|███████   | 138/195 [00:55<00:23,  2.44it/s] 72%|███████▏  | 140/195 [00:55<00:18,  2.97it/s] 72%|███████▏  | 141/195 [00:56<00:15,  3.43it/s] 73%|███████▎  | 142/195 [00:56<00:18,  2.93it/s] 73%|███████▎  | 143/195 [00:56<00:15,  3.31it/s] 74%|███████▍  | 144/195 [00:56<00:14,  3.43it/s] 74%|███████▍  | 145/195 [00:57<00:17,  2.92it/s] 75%|███████▍  | 146/195 [00:57<00:17,  2.88it/s] 75%|███████▌  | 147/195 [00:58<00:15,  3.13it/s] 76%|███████▌  | 148/195 [00:58<00:16,  2.80it/s] 77%|███████▋  | 150/195 [00:59<00:15,  2.88it/s] 78%|███████▊  | 152/195 [00:59<00:13,  3.13it/s] 78%|███████▊  | 153/195 [00:59<00:11,  3.57it/s] 79%|███████▉  | 154/195 [01:00<00:12,  3.33it/s] 79%|███████▉  | 155/195 [01:00<00:10,  3.96it/s] 80%|████████  | 156/195 [01:00<00:10,  3.56it/s] 81%|████████  | 157/195 [01:00<00:09,  4.18it/s] 81%|████████  | 158/195 [01:01<00:10,  3.49it/s] 82%|████████▏ | 160/195 [01:01<00:08,  4.19it/s] 83%|████████▎ | 161/195 [01:01<00:09,  3.67it/s] 84%|████████▎ | 163/195 [01:02<00:08,  3.70it/s] 84%|████████▍ | 164/195 [01:02<00:09,  3.33it/s] 85%|████████▍ | 165/195 [01:03<00:09,  3.04it/s] 85%|████████▌ | 166/195 [01:03<00:08,  3.46it/s] 86%|████████▌ | 167/195 [01:04<00:12,  2.28it/s] 86%|████████▌ | 168/195 [01:04<00:09,  2.76it/s] 87%|████████▋ | 169/195 [01:05<00:10,  2.47it/s] 88%|████████▊ | 171/195 [01:05<00:07,  3.13it/s] 88%|████████▊ | 172/195 [01:05<00:06,  3.52it/s] 89%|████████▊ | 173/195 [01:05<00:05,  3.67it/s] 89%|████████▉ | 174/195 [01:06<00:07,  3.00it/s] 90%|████████▉ | 175/195 [01:06<00:05,  3.48it/s] 90%|█████████ | 176/195 [01:06<00:06,  3.04it/s] 91%|█████████ | 177/195 [01:07<00:05,  3.02it/s] 91%|█████████▏| 178/195 [01:07<00:05,  3.24it/s] 92%|█████████▏| 179/195 [01:07<00:04,  3.48it/s] 92%|█████████▏| 180/195 [01:08<00:04,  3.12it/s] 93%|█████████▎| 181/195 [01:08<00:04,  3.06it/s] 94%|█████████▍| 183/195 [01:09<00:04,  2.83it/s] 94%|█████████▍| 184/195 [01:09<00:03,  3.23it/s] 95%|█████████▍| 185/195 [01:09<00:03,  2.87it/s] 95%|█████████▌| 186/195 [01:10<00:03,  2.76it/s] 96%|█████████▌| 187/195 [01:10<00:02,  3.31it/s] 96%|█████████▋| 188/195 [01:11<00:02,  2.52it/s] 97%|█████████▋| 190/195 [01:11<00:01,  2.72it/s] 98%|█████████▊| 192/195 [01:12<00:01,  2.34it/s] 99%|█████████▉| 194/195 [01:13<00:00,  2.65it/s]100%|██████████| 195/195 [01:15<00:00,  2.58it/s]
2025-08-20 20:49:04 [info     ] Validating outputs
2025-08-20 20:49:04 [info     ] Predict - end                  time=0:1:15
2025-08-20 20:49:04 [info     ] Evaluate - start               split=test
2025-08-20 20:49:04 [info     ] Evaluate - end                 correctness_llm=0.05 monotonicity=0.25
2025-08-20 20:49:04 [info     ] Evaluate question difficulty - start split=test
2025-08-20 20:49:04 [info     ] Augmenting questions for IRT estimation num_questions=22
2025-08-20 20:49:04 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 20:49:04 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1072.95it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3477.20it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 464.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6194.12it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1023.21it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3401.49it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 567.59it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6324.89it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 988.92it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3483.86it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 551.27it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6095.11it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1067.45it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3509.20it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 652.48it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8305.55it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1027.37it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3557.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 715.86it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6148.72it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1021.86it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3610.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 660.68it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6312.65it/s]
2025-08-20 20:49:08 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-08-20 20:49:08 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 20:49:08 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 20:49:08 [info     ] Evaluate question difficulty - end rmse=2.762465309718181 split=test
2025-08-20 20:49:08 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 1 finished: 0:1:30

 ********** Run: 2/3 **********
2025-08-20 20:49:27 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 20:49:27 [info     ] Reading train split questions  num_questions=92
2025-08-20 20:49:27 [info     ] Reading validation split questions num_questions=23
2025-08-20 20:49:27 [info     ] Reading test split questions   num_questions=39
2025-08-20 20:49:29 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 20:49:29 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 20:49:34 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 20:49:34 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 20:49:34 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 20:49:34 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 20:49:37 [info     ] Setting seed                   value=44
2025-08-20 20:49:37 [info     ] Building structured outputter  name=student_kt
2025-08-20 20:49:37 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_random native_structured_output=True num_examples=1 system_prompt=student_chocolate_level_context
2025-08-20 20:49:37 [info     ] Building example selector
2025-08-20 20:49:37 [info     ] Building model                 name=llama3.2:3b provider=ollama rate_limit=None temp=1.0
2025-08-20 20:49:37 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:08<26:11,  8.10s/it]  1%|          | 2/195 [00:08<11:52,  3.69s/it]  2%|▏         | 3/195 [00:08<06:38,  2.08s/it]  2%|▏         | 4/195 [00:09<04:33,  1.43s/it]  3%|▎         | 5/195 [00:09<03:20,  1.05s/it]  3%|▎         | 6/195 [00:09<02:18,  1.37it/s]  4%|▎         | 7/195 [00:10<02:18,  1.36it/s]  5%|▍         | 9/195 [00:10<01:29,  2.07it/s]  5%|▌         | 10/195 [00:11<01:28,  2.09it/s]  6%|▌         | 11/195 [00:12<01:33,  1.97it/s]  7%|▋         | 13/195 [00:12<01:13,  2.49it/s]  8%|▊         | 15/195 [00:13<01:10,  2.57it/s]  8%|▊         | 16/195 [00:13<01:19,  2.26it/s]  9%|▊         | 17/195 [00:14<01:10,  2.52it/s]  9%|▉         | 18/195 [00:14<01:18,  2.25it/s] 10%|▉         | 19/195 [00:14<01:08,  2.59it/s] 10%|█         | 20/195 [00:15<00:57,  3.04it/s] 11%|█         | 21/195 [00:15<01:05,  2.64it/s] 11%|█▏        | 22/195 [00:15<00:53,  3.24it/s] 12%|█▏        | 23/195 [00:16<00:52,  3.30it/s] 12%|█▏        | 24/195 [00:16<00:49,  3.46it/s] 13%|█▎        | 25/195 [00:16<00:42,  4.01it/s] 13%|█▎        | 26/195 [00:16<00:46,  3.67it/s] 14%|█▍        | 27/195 [00:17<00:42,  3.95it/s] 14%|█▍        | 28/195 [00:17<00:42,  3.90it/s] 15%|█▍        | 29/195 [00:17<00:50,  3.30it/s] 15%|█▌        | 30/195 [00:18<00:49,  3.31it/s] 16%|█▌        | 31/195 [00:18<01:05,  2.52it/s] 17%|█▋        | 33/195 [00:19<00:59,  2.74it/s] 18%|█▊        | 35/195 [00:19<00:51,  3.13it/s] 19%|█▉        | 37/195 [00:20<00:49,  3.18it/s] 19%|█▉        | 38/195 [00:20<00:45,  3.48it/s] 20%|██        | 39/195 [00:20<00:47,  3.28it/s] 21%|██        | 41/195 [00:21<00:43,  3.53it/s] 22%|██▏       | 42/195 [00:21<00:39,  3.85it/s] 22%|██▏       | 43/195 [00:22<00:45,  3.35it/s] 23%|██▎       | 44/195 [00:22<00:51,  2.91it/s] 24%|██▎       | 46/195 [00:22<00:44,  3.36it/s] 24%|██▍       | 47/195 [00:23<00:42,  3.46it/s] 25%|██▍       | 48/195 [00:23<00:38,  3.78it/s] 25%|██▌       | 49/195 [00:23<00:40,  3.57it/s] 26%|██▌       | 51/195 [00:24<00:38,  3.71it/s] 27%|██▋       | 53/195 [00:24<00:39,  3.62it/s] 28%|██▊       | 54/195 [00:25<00:38,  3.65it/s] 28%|██▊       | 55/195 [00:25<00:41,  3.41it/s] 29%|██▉       | 57/195 [00:25<00:38,  3.56it/s] 30%|██▉       | 58/195 [00:26<00:45,  2.98it/s] 31%|███       | 60/195 [00:27<00:42,  3.16it/s] 32%|███▏      | 62/195 [00:27<00:39,  3.35it/s] 32%|███▏      | 63/195 [00:27<00:34,  3.82it/s] 33%|███▎      | 64/195 [00:28<00:41,  3.13it/s] 33%|███▎      | 65/195 [00:28<00:37,  3.43it/s] 34%|███▍      | 66/195 [00:28<00:42,  3.06it/s] 35%|███▍      | 68/195 [00:29<00:41,  3.07it/s] 35%|███▌      | 69/195 [00:29<00:36,  3.46it/s] 36%|███▌      | 70/195 [00:30<00:42,  2.92it/s] 36%|███▋      | 71/195 [00:30<00:36,  3.42it/s] 37%|███▋      | 72/195 [00:30<00:42,  2.92it/s] 37%|███▋      | 73/195 [00:31<00:46,  2.64it/s] 38%|███▊      | 74/195 [00:31<00:42,  2.83it/s] 38%|███▊      | 75/195 [00:32<00:46,  2.59it/s] 39%|███▉      | 76/195 [00:32<00:38,  3.05it/s] 39%|███▉      | 77/195 [00:32<00:43,  2.71it/s] 40%|████      | 78/195 [00:32<00:37,  3.15it/s] 41%|████      | 79/195 [00:33<00:39,  2.92it/s] 41%|████      | 80/195 [00:33<00:34,  3.35it/s] 42%|████▏     | 81/195 [00:33<00:31,  3.62it/s] 42%|████▏     | 82/195 [00:34<00:32,  3.48it/s] 43%|████▎     | 83/195 [00:34<00:32,  3.49it/s] 43%|████▎     | 84/195 [00:34<00:35,  3.14it/s] 44%|████▎     | 85/195 [00:34<00:28,  3.88it/s] 44%|████▍     | 86/195 [00:35<00:30,  3.53it/s] 45%|████▍     | 87/195 [00:35<00:36,  2.97it/s] 46%|████▌     | 89/195 [00:36<00:32,  3.27it/s] 47%|████▋     | 91/195 [00:36<00:35,  2.97it/s] 47%|████▋     | 92/195 [00:37<00:29,  3.48it/s] 48%|████▊     | 93/195 [00:37<00:32,  3.16it/s] 48%|████▊     | 94/195 [00:37<00:35,  2.89it/s] 49%|████▊     | 95/195 [00:38<00:31,  3.21it/s] 49%|████▉     | 96/195 [00:38<00:34,  2.91it/s] 50%|████▉     | 97/195 [00:38<00:31,  3.13it/s] 50%|█████     | 98/195 [00:39<00:32,  3.03it/s] 51%|█████     | 99/195 [00:39<00:36,  2.61it/s] 51%|█████▏    | 100/195 [00:40<00:38,  2.49it/s] 52%|█████▏    | 101/195 [00:40<00:32,  2.89it/s] 52%|█████▏    | 102/195 [00:40<00:33,  2.78it/s] 53%|█████▎    | 103/195 [00:40<00:28,  3.19it/s] 53%|█████▎    | 104/195 [00:41<00:32,  2.84it/s] 54%|█████▍    | 105/195 [00:41<00:26,  3.37it/s] 54%|█████▍    | 106/195 [00:41<00:27,  3.23it/s] 55%|█████▍    | 107/195 [00:42<00:32,  2.70it/s] 56%|█████▌    | 109/195 [00:42<00:27,  3.08it/s] 56%|█████▋    | 110/195 [00:43<00:28,  2.98it/s] 57%|█████▋    | 111/195 [00:43<00:25,  3.27it/s] 57%|█████▋    | 112/195 [00:44<00:29,  2.79it/s] 58%|█████▊    | 113/195 [00:44<00:27,  2.96it/s] 58%|█████▊    | 114/195 [00:44<00:24,  3.26it/s] 59%|█████▉    | 115/195 [00:44<00:23,  3.39it/s] 59%|█████▉    | 116/195 [00:45<00:27,  2.88it/s] 61%|██████    | 118/195 [00:45<00:26,  2.88it/s] 62%|██████▏   | 120/195 [00:46<00:24,  3.01it/s] 63%|██████▎   | 122/195 [00:47<00:21,  3.34it/s] 63%|██████▎   | 123/195 [00:47<00:22,  3.27it/s] 64%|██████▎   | 124/195 [00:47<00:21,  3.33it/s] 64%|██████▍   | 125/195 [00:48<00:22,  3.17it/s] 65%|██████▌   | 127/195 [00:48<00:21,  3.23it/s] 66%|██████▌   | 128/195 [00:48<00:19,  3.44it/s] 66%|██████▌   | 129/195 [00:49<00:17,  3.75it/s] 67%|██████▋   | 130/195 [00:49<00:20,  3.11it/s] 67%|██████▋   | 131/195 [00:49<00:17,  3.57it/s] 68%|██████▊   | 132/195 [00:50<00:18,  3.49it/s] 68%|██████▊   | 133/195 [00:50<00:15,  3.94it/s] 69%|██████▊   | 134/195 [00:50<00:22,  2.74it/s] 69%|██████▉   | 135/195 [00:51<00:18,  3.22it/s] 70%|██████▉   | 136/195 [00:51<00:22,  2.59it/s] 70%|███████   | 137/195 [00:51<00:20,  2.80it/s] 71%|███████   | 138/195 [00:52<00:18,  3.15it/s] 71%|███████▏  | 139/195 [00:52<00:18,  2.99it/s] 72%|███████▏  | 140/195 [00:52<00:16,  3.29it/s] 72%|███████▏  | 141/195 [00:53<00:16,  3.18it/s] 73%|███████▎  | 142/195 [00:53<00:15,  3.37it/s] 73%|███████▎  | 143/195 [00:53<00:12,  4.16it/s] 74%|███████▍  | 144/195 [00:53<00:14,  3.59it/s] 74%|███████▍  | 145/195 [00:53<00:12,  4.13it/s] 75%|███████▍  | 146/195 [00:54<00:14,  3.46it/s] 76%|███████▌  | 148/195 [00:54<00:13,  3.41it/s] 76%|███████▋  | 149/195 [00:55<00:12,  3.66it/s] 77%|███████▋  | 150/195 [00:55<00:16,  2.71it/s] 77%|███████▋  | 151/195 [00:55<00:13,  3.17it/s] 78%|███████▊  | 152/195 [00:56<00:13,  3.28it/s] 79%|███████▉  | 154/195 [00:56<00:11,  3.68it/s] 79%|███████▉  | 155/195 [00:56<00:11,  3.59it/s] 80%|████████  | 156/195 [00:57<00:09,  4.18it/s] 81%|████████  | 157/195 [00:57<00:10,  3.52it/s] 81%|████████  | 158/195 [00:57<00:10,  3.69it/s] 82%|████████▏ | 159/195 [00:58<00:10,  3.47it/s] 82%|████████▏ | 160/195 [00:58<00:08,  3.99it/s] 83%|████████▎ | 161/195 [00:58<00:10,  3.33it/s] 83%|████████▎ | 162/195 [00:58<00:09,  3.66it/s] 84%|████████▎ | 163/195 [00:59<00:10,  2.99it/s] 84%|████████▍ | 164/195 [00:59<00:08,  3.49it/s] 85%|████████▍ | 165/195 [00:59<00:08,  3.37it/s] 85%|████████▌ | 166/195 [01:00<00:10,  2.84it/s] 86%|████████▌ | 167/195 [01:00<00:12,  2.28it/s] 86%|████████▌ | 168/195 [01:01<00:10,  2.57it/s] 87%|████████▋ | 169/195 [01:01<00:11,  2.28it/s] 88%|████████▊ | 171/195 [01:02<00:08,  2.87it/s] 88%|████████▊ | 172/195 [01:02<00:08,  2.81it/s] 89%|████████▊ | 173/195 [01:03<00:08,  2.58it/s] 89%|████████▉ | 174/195 [01:03<00:08,  2.46it/s] 90%|████████▉ | 175/195 [01:03<00:07,  2.65it/s] 90%|█████████ | 176/195 [01:04<00:06,  2.76it/s] 91%|█████████ | 177/195 [01:04<00:06,  2.93it/s] 91%|█████████▏| 178/195 [01:05<00:06,  2.49it/s] 92%|█████████▏| 179/195 [01:05<00:05,  2.84it/s] 92%|█████████▏| 180/195 [01:05<00:05,  2.68it/s] 93%|█████████▎| 181/195 [01:06<00:05,  2.65it/s] 93%|█████████▎| 182/195 [01:06<00:04,  2.67it/s] 94%|█████████▍| 183/195 [01:06<00:04,  2.45it/s] 94%|█████████▍| 184/195 [01:07<00:04,  2.66it/s] 95%|█████████▍| 185/195 [01:07<00:03,  2.86it/s] 95%|█████████▌| 186/195 [01:08<00:04,  2.21it/s] 96%|█████████▌| 187/195 [01:08<00:02,  2.69it/s] 96%|█████████▋| 188/195 [01:09<00:03,  1.95it/s] 97%|█████████▋| 189/195 [01:09<00:02,  2.50it/s] 97%|█████████▋| 190/195 [01:09<00:02,  2.31it/s] 98%|█████████▊| 191/195 [01:10<00:01,  2.86it/s] 98%|█████████▊| 192/195 [01:10<00:01,  2.87it/s] 99%|█████████▉| 193/195 [01:10<00:00,  2.68it/s] 99%|█████████▉| 194/195 [01:11<00:00,  2.48it/s]100%|██████████| 195/195 [01:11<00:00,  3.08it/s]100%|██████████| 195/195 [01:13<00:00,  2.65it/s]
2025-08-20 20:50:51 [info     ] Validating outputs
2025-08-20 20:50:51 [info     ] Predict - end                  time=0:1:13
2025-08-20 20:50:51 [info     ] Evaluate - start               split=test
2025-08-20 20:50:51 [info     ] Evaluate - end                 correctness_llm=0.1 monotonicity=0.93
2025-08-20 20:50:51 [info     ] Evaluate question difficulty - start split=test
2025-08-20 20:50:51 [info     ] Augmenting questions for IRT estimation num_questions=16
2025-08-20 20:50:51 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 20:50:51 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1043.25it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3335.40it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 459.19it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8119.50it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 973.12it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3574.93it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 543.00it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8019.70it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 915.44it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3291.90it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 548.99it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8063.75it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1065.94it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3355.37it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 575.88it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7937.31it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1054.49it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3447.30it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 579.57it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8057.12it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1010.99it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3508.30it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 640.96it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8300.86it/s]
2025-08-20 20:50:55 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-08-20 20:50:55 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 20:50:55 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 20:50:55 [info     ] Evaluate question difficulty - end rmse=2.579181736301521 split=test
2025-08-20 20:50:55 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 2 finished: 0:1:28

 ********** Run: 3/3 **********
2025-08-20 20:51:14 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 20:51:14 [info     ] Reading train split questions  num_questions=92
2025-08-20 20:51:14 [info     ] Reading validation split questions num_questions=23
2025-08-20 20:51:14 [info     ] Reading test split questions   num_questions=39
2025-08-20 20:51:16 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 20:51:16 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 20:51:21 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 20:51:21 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 20:51:21 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 20:51:22 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 20:51:25 [info     ] Setting seed                   value=45
2025-08-20 20:51:25 [info     ] Building structured outputter  name=student_kt
2025-08-20 20:51:25 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_random native_structured_output=True num_examples=1 system_prompt=student_chocolate_level_context
2025-08-20 20:51:25 [info     ] Building example selector
2025-08-20 20:51:25 [info     ] Building model                 name=llama3.2:3b provider=ollama rate_limit=None temp=1.0
2025-08-20 20:51:25 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:08<26:02,  8.06s/it]  2%|▏         | 3/195 [00:09<07:58,  2.49s/it]  2%|▏         | 4/195 [00:09<05:49,  1.83s/it]  3%|▎         | 5/195 [00:10<04:11,  1.32s/it]  3%|▎         | 6/195 [00:10<03:27,  1.10s/it]  4%|▎         | 7/195 [00:11<02:48,  1.12it/s]  5%|▍         | 9/195 [00:11<01:50,  1.69it/s]  5%|▌         | 10/195 [00:11<01:32,  2.00it/s]  6%|▌         | 11/195 [00:12<01:33,  1.97it/s]  6%|▌         | 12/195 [00:12<01:28,  2.08it/s]  7%|▋         | 13/195 [00:12<01:08,  2.66it/s]  7%|▋         | 14/195 [00:13<01:06,  2.73it/s]  8%|▊         | 16/195 [00:13<01:02,  2.85it/s]  9%|▊         | 17/195 [00:14<01:00,  2.97it/s]  9%|▉         | 18/195 [00:14<01:03,  2.77it/s] 10%|▉         | 19/195 [00:14<00:55,  3.18it/s] 10%|█         | 20/195 [00:15<00:54,  3.18it/s] 11%|█         | 21/195 [00:15<00:56,  3.08it/s] 11%|█▏        | 22/195 [00:15<00:51,  3.35it/s] 12%|█▏        | 23/195 [00:16<01:00,  2.86it/s] 13%|█▎        | 25/195 [00:17<01:04,  2.63it/s] 13%|█▎        | 26/195 [00:17<01:00,  2.80it/s] 14%|█▍        | 27/195 [00:17<00:51,  3.24it/s] 14%|█▍        | 28/195 [00:17<00:57,  2.93it/s] 15%|█▍        | 29/195 [00:18<00:48,  3.39it/s] 15%|█▌        | 30/195 [00:18<00:55,  2.95it/s] 16%|█▌        | 31/195 [00:19<01:11,  2.29it/s] 16%|█▋        | 32/195 [00:19<01:01,  2.67it/s] 17%|█▋        | 33/195 [00:19<01:01,  2.65it/s] 17%|█▋        | 34/195 [00:19<00:50,  3.17it/s] 18%|█▊        | 35/195 [00:20<00:52,  3.04it/s] 18%|█▊        | 36/195 [00:20<00:51,  3.06it/s] 19%|█▉        | 37/195 [00:21<00:55,  2.84it/s] 19%|█▉        | 38/195 [00:21<00:52,  2.97it/s] 20%|██        | 39/195 [00:21<00:55,  2.80it/s] 21%|██        | 41/195 [00:22<00:45,  3.41it/s] 22%|██▏       | 43/195 [00:22<00:39,  3.88it/s] 23%|██▎       | 44/195 [00:22<00:35,  4.31it/s] 23%|██▎       | 45/195 [00:23<00:41,  3.63it/s] 24%|██▎       | 46/195 [00:23<00:45,  3.27it/s] 25%|██▍       | 48/195 [00:23<00:39,  3.75it/s] 26%|██▌       | 50/195 [00:24<00:39,  3.69it/s] 26%|██▌       | 51/195 [00:24<00:35,  4.05it/s] 27%|██▋       | 52/195 [00:25<00:42,  3.36it/s] 28%|██▊       | 54/195 [00:25<00:41,  3.37it/s] 29%|██▊       | 56/195 [00:26<00:38,  3.60it/s] 29%|██▉       | 57/195 [00:26<00:46,  2.94it/s] 30%|███       | 59/195 [00:27<00:44,  3.07it/s] 31%|███       | 60/195 [00:27<00:39,  3.38it/s] 31%|███▏      | 61/195 [00:27<00:38,  3.47it/s] 32%|███▏      | 62/195 [00:28<00:39,  3.35it/s] 32%|███▏      | 63/195 [00:28<00:33,  3.89it/s] 33%|███▎      | 64/195 [00:28<00:36,  3.58it/s] 33%|███▎      | 65/195 [00:28<00:37,  3.47it/s] 34%|███▍      | 66/195 [00:29<00:42,  3.03it/s] 34%|███▍      | 67/195 [00:29<00:34,  3.73it/s] 35%|███▍      | 68/195 [00:29<00:38,  3.34it/s] 36%|███▌      | 70/195 [00:30<00:31,  3.94it/s] 36%|███▋      | 71/195 [00:30<00:34,  3.61it/s] 37%|███▋      | 72/195 [00:31<00:38,  3.18it/s] 38%|███▊      | 74/195 [00:31<00:37,  3.25it/s] 38%|███▊      | 75/195 [00:31<00:32,  3.64it/s] 39%|███▉      | 76/195 [00:32<00:36,  3.28it/s] 39%|███▉      | 77/195 [00:32<00:37,  3.12it/s] 40%|████      | 78/195 [00:32<00:34,  3.43it/s] 41%|████      | 79/195 [00:33<00:35,  3.28it/s] 42%|████▏     | 81/195 [00:33<00:28,  4.06it/s] 42%|████▏     | 82/195 [00:33<00:33,  3.40it/s] 43%|████▎     | 83/195 [00:34<00:32,  3.49it/s] 43%|████▎     | 84/195 [00:34<00:31,  3.48it/s] 44%|████▎     | 85/195 [00:34<00:32,  3.36it/s] 44%|████▍     | 86/195 [00:35<00:35,  3.10it/s] 45%|████▍     | 87/195 [00:35<00:33,  3.23it/s] 45%|████▌     | 88/195 [00:35<00:30,  3.45it/s] 46%|████▌     | 89/195 [00:36<00:36,  2.90it/s] 47%|████▋     | 91/195 [00:36<00:31,  3.34it/s] 47%|████▋     | 92/195 [00:36<00:26,  3.95it/s] 48%|████▊     | 93/195 [00:37<00:32,  3.17it/s] 48%|████▊     | 94/195 [00:37<00:31,  3.18it/s] 49%|████▊     | 95/195 [00:37<00:31,  3.19it/s] 49%|████▉     | 96/195 [00:38<00:28,  3.46it/s] 50%|████▉     | 97/195 [00:38<00:31,  3.13it/s] 50%|█████     | 98/195 [00:39<00:38,  2.52it/s] 51%|█████     | 99/195 [00:39<00:33,  2.83it/s] 51%|█████▏    | 100/195 [00:39<00:33,  2.82it/s] 52%|█████▏    | 101/195 [00:39<00:27,  3.43it/s] 52%|█████▏    | 102/195 [00:40<00:31,  2.94it/s] 53%|█████▎    | 104/195 [00:40<00:29,  3.12it/s] 54%|█████▍    | 105/195 [00:41<00:24,  3.63it/s] 54%|█████▍    | 106/195 [00:41<00:29,  3.05it/s] 55%|█████▍    | 107/195 [00:41<00:27,  3.21it/s] 55%|█████▌    | 108/195 [00:42<00:33,  2.57it/s] 56%|█████▌    | 109/195 [00:42<00:28,  3.02it/s] 56%|█████▋    | 110/195 [00:43<00:30,  2.77it/s] 57%|█████▋    | 111/195 [00:43<00:25,  3.29it/s] 57%|█████▋    | 112/195 [00:43<00:27,  2.97it/s] 58%|█████▊    | 113/195 [00:43<00:27,  3.02it/s] 58%|█████▊    | 114/195 [00:44<00:29,  2.73it/s] 59%|█████▉    | 115/195 [00:44<00:28,  2.83it/s] 59%|█████▉    | 116/195 [00:44<00:25,  3.04it/s] 60%|██████    | 117/195 [00:45<00:30,  2.58it/s] 61%|██████    | 118/195 [00:45<00:28,  2.67it/s] 61%|██████    | 119/195 [00:46<00:24,  3.16it/s] 62%|██████▏   | 120/195 [00:46<00:24,  3.04it/s] 62%|██████▏   | 121/195 [00:46<00:24,  3.07it/s] 63%|██████▎   | 122/195 [00:47<00:28,  2.58it/s] 63%|██████▎   | 123/195 [00:47<00:27,  2.66it/s] 64%|██████▎   | 124/195 [00:47<00:22,  3.23it/s] 64%|██████▍   | 125/195 [00:48<00:26,  2.69it/s] 65%|██████▍   | 126/195 [00:48<00:23,  2.89it/s] 65%|██████▌   | 127/195 [00:48<00:22,  3.06it/s] 66%|██████▌   | 128/195 [00:49<00:19,  3.45it/s] 66%|██████▌   | 129/195 [00:49<00:19,  3.31it/s] 67%|██████▋   | 130/195 [00:49<00:24,  2.65it/s] 67%|██████▋   | 131/195 [00:50<00:21,  3.02it/s] 68%|██████▊   | 132/195 [00:50<00:22,  2.76it/s] 68%|██████▊   | 133/195 [00:50<00:22,  2.75it/s] 69%|██████▊   | 134/195 [00:51<00:23,  2.61it/s] 69%|██████▉   | 135/195 [00:51<00:19,  3.10it/s] 70%|██████▉   | 136/195 [00:51<00:17,  3.36it/s] 70%|███████   | 137/195 [00:52<00:16,  3.59it/s] 71%|███████   | 138/195 [00:52<00:14,  3.84it/s] 71%|███████▏  | 139/195 [00:52<00:17,  3.19it/s] 72%|███████▏  | 140/195 [00:52<00:15,  3.50it/s] 72%|███████▏  | 141/195 [00:53<00:14,  3.73it/s] 73%|███████▎  | 142/195 [00:53<00:13,  3.99it/s] 73%|███████▎  | 143/195 [00:53<00:12,  4.23it/s] 74%|███████▍  | 144/195 [00:53<00:14,  3.41it/s] 75%|███████▍  | 146/195 [00:54<00:13,  3.73it/s] 76%|███████▌  | 148/195 [00:55<00:13,  3.38it/s] 76%|███████▋  | 149/195 [00:55<00:12,  3.70it/s] 77%|███████▋  | 150/195 [00:55<00:13,  3.26it/s] 77%|███████▋  | 151/195 [00:56<00:14,  3.06it/s] 78%|███████▊  | 152/195 [00:56<00:13,  3.09it/s] 78%|███████▊  | 153/195 [00:56<00:12,  3.40it/s] 79%|███████▉  | 154/195 [00:56<00:11,  3.49it/s] 79%|███████▉  | 155/195 [00:57<00:09,  4.07it/s] 80%|████████  | 156/195 [00:57<00:14,  2.77it/s] 81%|████████  | 158/195 [00:58<00:13,  2.70it/s] 82%|████████▏ | 160/195 [00:58<00:10,  3.30it/s] 83%|████████▎ | 162/195 [00:59<00:10,  3.26it/s] 84%|████████▎ | 163/195 [00:59<00:08,  3.73it/s] 84%|████████▍ | 164/195 [01:00<00:10,  3.09it/s] 85%|████████▌ | 166/195 [01:00<00:08,  3.33it/s] 86%|████████▌ | 167/195 [01:01<00:09,  2.90it/s] 86%|████████▌ | 168/195 [01:01<00:08,  3.02it/s] 87%|████████▋ | 169/195 [01:01<00:09,  2.78it/s] 88%|████████▊ | 171/195 [01:02<00:08,  2.96it/s] 88%|████████▊ | 172/195 [01:02<00:07,  2.89it/s] 89%|████████▊ | 173/195 [01:03<00:07,  2.90it/s] 89%|████████▉ | 174/195 [01:03<00:06,  3.05it/s] 90%|████████▉ | 175/195 [01:03<00:07,  2.81it/s] 90%|█████████ | 176/195 [01:04<00:06,  2.95it/s] 91%|█████████ | 177/195 [01:04<00:07,  2.42it/s] 91%|█████████▏| 178/195 [01:05<00:06,  2.68it/s] 92%|█████████▏| 179/195 [01:05<00:07,  2.19it/s] 93%|█████████▎| 181/195 [01:06<00:04,  2.86it/s] 93%|█████████▎| 182/195 [01:06<00:04,  3.04it/s] 94%|█████████▍| 183/195 [01:07<00:04,  2.51it/s] 94%|█████████▍| 184/195 [01:07<00:03,  2.79it/s] 95%|█████████▍| 185/195 [01:07<00:03,  2.84it/s] 95%|█████████▌| 186/195 [01:07<00:02,  3.33it/s] 96%|█████████▌| 187/195 [01:08<00:02,  2.88it/s] 97%|█████████▋| 189/195 [01:08<00:02,  2.90it/s] 97%|█████████▋| 190/195 [01:09<00:01,  3.32it/s] 98%|█████████▊| 191/195 [01:09<00:01,  2.78it/s] 98%|█████████▊| 192/195 [01:09<00:01,  2.97it/s] 99%|█████████▉| 193/195 [01:10<00:00,  2.52it/s]100%|██████████| 195/195 [01:10<00:00,  3.61it/s]100%|██████████| 195/195 [01:12<00:00,  2.68it/s]
2025-08-20 20:52:38 [info     ] Validating outputs
2025-08-20 20:52:38 [info     ] Predict - end                  time=0:1:12
2025-08-20 20:52:38 [info     ] Evaluate - start               split=test
2025-08-20 20:52:38 [info     ] Evaluate - end                 correctness_llm=0.09 monotonicity=0.65
2025-08-20 20:52:38 [info     ] Evaluate question difficulty - start split=test
2025-08-20 20:52:38 [info     ] Augmenting questions for IRT estimation num_questions=25
2025-08-20 20:52:38 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 20:52:38 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1282.61it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3398.60it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 537.21it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8233.35it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1037.09it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3392.96it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 502.46it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7647.86it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 970.90it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3280.41it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 554.64it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8231.04it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1050.23it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3525.16it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 701.74it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8050.49it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 972.67it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3479.64it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 537.58it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8126.25it/s]
2025-08-20 20:52:41 INFO: EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
2025-08-20 20:52:41 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 20:52:41 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 20:52:41 [info     ] Evaluate question difficulty - end rmse=2.5497938240002376 split=test
2025-08-20 20:52:41 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 3 finished: 0:1:26

 ========== Config: qwen3:0.6b~T_1.0~SO_teacher_kt~L_5~SP_teacher_marshmellow_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_miscon_studentlevel_kc_exact5 ==========
Config 3/8

 ********** Run: 1/3 **********
2025-08-20 20:53:00 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 20:53:00 [info     ] Reading train split questions  num_questions=92
2025-08-20 20:53:00 [info     ] Reading validation split questions num_questions=23
2025-08-20 20:53:00 [info     ] Reading test split questions   num_questions=39
2025-08-20 20:53:02 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 20:53:02 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 20:53:06 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 20:53:06 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 20:53:06 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 20:53:07 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 20:53:10 [info     ] Setting seed                   value=43
2025-08-20 20:53:10 [info     ] Building structured outputter  name=teacher_kt
2025-08-20 20:53:10 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_kc_exact native_structured_output=True num_examples=5 system_prompt=teacher_marshmellow_level_context
2025-08-20 20:53:10 [info     ] Building example selector
2025-08-20 20:53:10 [info     ] Building model                 name=qwen3:0.6b provider=ollama rate_limit=None temp=1.0
2025-08-20 20:53:10 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:13<42:41, 13.20s/it]  1%|          | 2/195 [00:13<18:21,  5.71s/it]  2%|▏         | 3/195 [00:14<10:58,  3.43s/it]  3%|▎         | 5/195 [00:15<05:23,  1.70s/it]  3%|▎         | 6/195 [00:15<04:15,  1.35s/it]  4%|▎         | 7/195 [00:15<03:11,  1.02s/it]  4%|▍         | 8/195 [00:16<02:37,  1.19it/s]  5%|▍         | 9/195 [00:16<01:56,  1.60it/s]  5%|▌         | 10/195 [00:16<01:48,  1.71it/s]  6%|▌         | 12/195 [00:17<01:28,  2.07it/s]  7%|▋         | 13/195 [00:18<01:27,  2.09it/s]  8%|▊         | 15/195 [00:18<01:08,  2.62it/s]  8%|▊         | 16/195 [00:18<01:08,  2.62it/s]  9%|▉         | 18/195 [00:19<01:00,  2.94it/s] 10%|█         | 20/195 [00:19<00:50,  3.46it/s] 11%|█▏        | 22/195 [00:20<00:43,  3.99it/s] 12%|█▏        | 24/195 [00:20<00:42,  4.01it/s] 13%|█▎        | 26/195 [00:21<00:38,  4.34it/s] 14%|█▍        | 28/195 [00:21<00:35,  4.66it/s] 15%|█▍        | 29/195 [00:21<00:40,  4.08it/s] 15%|█▌        | 30/195 [00:22<00:40,  4.05it/s] 16%|█▋        | 32/195 [00:22<00:38,  4.26it/s] 17%|█▋        | 34/195 [00:22<00:35,  4.51it/s] 18%|█▊        | 35/195 [00:23<00:35,  4.45it/s] 18%|█▊        | 36/195 [00:23<00:33,  4.76it/s] 19%|█▉        | 37/195 [00:23<00:36,  4.36it/s] 19%|█▉        | 38/195 [00:23<00:41,  3.75it/s] 20%|██        | 39/195 [00:24<00:37,  4.22it/s] 21%|██        | 40/195 [00:25<01:08,  2.26it/s] 21%|██        | 41/195 [00:25<00:58,  2.65it/s] 22%|██▏       | 42/195 [00:25<00:47,  3.21it/s] 22%|██▏       | 43/195 [00:25<00:44,  3.42it/s] 23%|██▎       | 44/195 [00:26<00:47,  3.21it/s] 23%|██▎       | 45/195 [00:26<00:40,  3.73it/s] 24%|██▎       | 46/195 [00:26<00:37,  3.92it/s] 24%|██▍       | 47/195 [00:26<00:35,  4.18it/s] 25%|██▍       | 48/195 [00:27<00:42,  3.46it/s] 25%|██▌       | 49/195 [00:27<00:42,  3.40it/s] 26%|██▌       | 51/195 [00:27<00:39,  3.68it/s] 27%|██▋       | 52/195 [00:28<00:48,  2.95it/s] 27%|██▋       | 53/195 [00:28<00:39,  3.58it/s] 28%|██▊       | 54/195 [00:28<00:37,  3.75it/s] 28%|██▊       | 55/195 [00:29<00:39,  3.58it/s] 29%|██▊       | 56/195 [00:29<00:34,  4.08it/s] 29%|██▉       | 57/195 [00:29<00:41,  3.33it/s] 30%|███       | 59/195 [00:30<00:35,  3.88it/s] 31%|███       | 60/195 [00:30<00:31,  4.31it/s] 31%|███▏      | 61/195 [00:30<00:32,  4.15it/s] 32%|███▏      | 62/195 [00:31<00:42,  3.10it/s] 33%|███▎      | 64/195 [00:31<00:34,  3.75it/s] 33%|███▎      | 65/195 [00:31<00:30,  4.33it/s] 34%|███▍      | 66/195 [00:31<00:33,  3.81it/s] 34%|███▍      | 67/195 [00:32<00:28,  4.48it/s] 35%|███▍      | 68/195 [00:32<00:30,  4.19it/s] 35%|███▌      | 69/195 [00:32<00:28,  4.48it/s] 36%|███▌      | 70/195 [00:32<00:26,  4.63it/s] 36%|███▋      | 71/195 [00:32<00:26,  4.68it/s] 37%|███▋      | 72/195 [00:33<00:28,  4.32it/s] 37%|███▋      | 73/195 [00:33<00:40,  3.05it/s] 38%|███▊      | 74/195 [00:34<00:44,  2.72it/s] 38%|███▊      | 75/195 [00:34<00:34,  3.46it/s] 39%|███▉      | 76/195 [00:34<00:40,  2.96it/s] 39%|███▉      | 77/195 [00:35<00:47,  2.47it/s] 40%|████      | 78/195 [00:35<00:54,  2.16it/s] 41%|████      | 80/195 [00:36<00:42,  2.71it/s] 42%|████▏     | 81/195 [00:36<00:42,  2.66it/s] 43%|████▎     | 83/195 [00:37<00:33,  3.35it/s] 43%|████▎     | 84/195 [00:37<00:29,  3.81it/s] 44%|████▎     | 85/195 [00:37<00:28,  3.83it/s] 44%|████▍     | 86/195 [00:37<00:26,  4.14it/s] 45%|████▍     | 87/195 [00:38<00:30,  3.49it/s] 45%|████▌     | 88/195 [00:38<00:31,  3.44it/s] 46%|████▌     | 90/195 [00:38<00:23,  4.38it/s] 47%|████▋     | 91/195 [00:38<00:22,  4.63it/s] 47%|████▋     | 92/195 [00:39<00:20,  5.04it/s] 48%|████▊     | 93/195 [00:39<00:22,  4.60it/s] 49%|████▊     | 95/195 [00:39<00:22,  4.37it/s] 49%|████▉     | 96/195 [00:40<00:26,  3.79it/s] 50%|█████     | 98/195 [00:40<00:21,  4.42it/s] 51%|█████     | 99/195 [00:40<00:19,  5.03it/s] 51%|█████▏    | 100/195 [00:40<00:20,  4.54it/s] 52%|█████▏    | 101/195 [00:41<00:20,  4.61it/s] 52%|█████▏    | 102/195 [00:41<00:29,  3.14it/s] 53%|█████▎    | 103/195 [00:42<00:33,  2.78it/s] 54%|█████▍    | 105/195 [00:42<00:28,  3.21it/s] 54%|█████▍    | 106/195 [00:42<00:24,  3.65it/s] 55%|█████▍    | 107/195 [00:43<00:23,  3.71it/s] 55%|█████▌    | 108/195 [00:43<00:23,  3.68it/s] 56%|█████▌    | 109/195 [00:43<00:21,  3.92it/s] 56%|█████▋    | 110/195 [00:43<00:22,  3.77it/s] 57%|█████▋    | 111/195 [00:44<00:28,  2.97it/s] 57%|█████▋    | 112/195 [00:44<00:27,  2.99it/s] 58%|█████▊    | 113/195 [00:44<00:22,  3.61it/s] 58%|█████▊    | 114/195 [00:45<00:23,  3.41it/s] 59%|█████▉    | 115/195 [00:45<00:22,  3.59it/s] 59%|█████▉    | 116/195 [00:45<00:20,  3.80it/s] 60%|██████    | 117/195 [00:46<00:21,  3.62it/s] 61%|██████    | 118/195 [00:46<00:20,  3.78it/s] 61%|██████    | 119/195 [00:46<00:19,  3.90it/s] 62%|██████▏   | 120/195 [00:46<00:19,  3.76it/s] 62%|██████▏   | 121/195 [00:47<00:23,  3.19it/s] 63%|██████▎   | 122/195 [00:47<00:23,  3.08it/s] 64%|██████▎   | 124/195 [00:47<00:19,  3.71it/s] 64%|██████▍   | 125/195 [00:48<00:17,  4.10it/s] 65%|██████▍   | 126/195 [00:48<00:17,  4.04it/s] 65%|██████▌   | 127/195 [00:48<00:14,  4.58it/s] 66%|██████▌   | 128/195 [00:48<00:15,  4.36it/s] 66%|██████▌   | 129/195 [00:49<00:20,  3.29it/s] 67%|██████▋   | 130/195 [00:49<00:21,  3.06it/s] 68%|██████▊   | 132/195 [00:50<00:16,  3.78it/s] 68%|██████▊   | 133/195 [00:50<00:14,  4.42it/s] 69%|██████▊   | 134/195 [00:50<00:14,  4.14it/s] 69%|██████▉   | 135/195 [00:50<00:14,  4.24it/s] 70%|██████▉   | 136/195 [00:50<00:12,  4.78it/s] 70%|███████   | 137/195 [00:51<00:15,  3.78it/s] 71%|███████   | 138/195 [00:51<00:16,  3.55it/s] 71%|███████▏  | 139/195 [00:51<00:12,  4.36it/s] 72%|███████▏  | 140/195 [00:51<00:13,  4.02it/s] 72%|███████▏  | 141/195 [00:52<00:13,  3.86it/s] 73%|███████▎  | 142/195 [00:52<00:13,  4.04it/s] 73%|███████▎  | 143/195 [00:52<00:13,  3.90it/s] 74%|███████▍  | 144/195 [00:53<00:16,  3.13it/s] 75%|███████▍  | 146/195 [00:53<00:13,  3.61it/s] 76%|███████▌  | 148/195 [00:54<00:12,  3.83it/s] 77%|███████▋  | 150/195 [00:54<00:11,  4.07it/s] 78%|███████▊  | 152/195 [00:54<00:09,  4.36it/s] 78%|███████▊  | 153/195 [00:55<00:08,  4.85it/s] 79%|███████▉  | 154/195 [00:55<00:08,  4.61it/s] 79%|███████▉  | 155/195 [00:55<00:08,  4.83it/s] 80%|████████  | 156/195 [00:55<00:08,  4.78it/s] 81%|████████  | 157/195 [00:55<00:08,  4.69it/s] 81%|████████  | 158/195 [00:56<00:07,  4.83it/s] 82%|████████▏ | 159/195 [00:56<00:07,  4.53it/s] 82%|████████▏ | 160/195 [00:56<00:07,  4.43it/s] 83%|████████▎ | 161/195 [00:56<00:07,  4.69it/s] 83%|████████▎ | 162/195 [00:56<00:07,  4.66it/s] 84%|████████▎ | 163/195 [00:57<00:08,  3.76it/s] 85%|████████▍ | 165/195 [00:57<00:07,  4.02it/s] 85%|████████▌ | 166/195 [00:58<00:09,  3.08it/s] 86%|████████▌ | 167/195 [00:58<00:07,  3.70it/s] 86%|████████▌ | 168/195 [00:58<00:07,  3.48it/s] 87%|████████▋ | 170/195 [00:59<00:06,  3.87it/s] 88%|████████▊ | 171/195 [00:59<00:05,  4.41it/s] 88%|████████▊ | 172/195 [00:59<00:06,  3.38it/s] 89%|████████▉ | 174/195 [01:00<00:05,  4.08it/s] 90%|████████▉ | 175/195 [01:00<00:04,  4.11it/s] 90%|█████████ | 176/195 [01:01<00:05,  3.17it/s] 91%|█████████▏| 178/195 [01:01<00:04,  4.07it/s] 92%|█████████▏| 179/195 [01:01<00:04,  3.40it/s] 93%|█████████▎| 181/195 [01:02<00:03,  3.76it/s] 93%|█████████▎| 182/195 [01:02<00:03,  4.29it/s] 94%|█████████▍| 183/195 [01:02<00:03,  3.71it/s] 94%|█████████▍| 184/195 [01:03<00:03,  2.92it/s] 95%|█████████▍| 185/195 [01:03<00:03,  3.13it/s] 95%|█████████▌| 186/195 [01:04<00:03,  2.30it/s] 96%|█████████▌| 187/195 [01:04<00:03,  2.63it/s] 96%|█████████▋| 188/195 [01:05<00:02,  2.34it/s] 97%|█████████▋| 189/195 [01:05<00:02,  2.83it/s] 97%|█████████▋| 190/195 [01:05<00:01,  3.02it/s] 98%|█████████▊| 191/195 [01:05<00:01,  3.64it/s] 98%|█████████▊| 192/195 [01:05<00:00,  3.79it/s] 99%|█████████▉| 193/195 [01:06<00:00,  4.02it/s] 99%|█████████▉| 194/195 [01:06<00:00,  3.06it/s]100%|██████████| 195/195 [01:08<00:00,  2.83it/s]
2025-08-20 20:54:19 [info     ] Validating outputs
2025-08-20 20:54:19 [info     ] Predict - end                  time=0:1:8
2025-08-20 20:54:19 [info     ] Evaluate - start               split=test
2025-08-20 20:54:19 [info     ] Evaluate - end                 correctness_llm=0.26 monotonicity=0.31
2025-08-20 20:54:19 [info     ] Evaluate question difficulty - start split=test
2025-08-20 20:54:19 [info     ] Augmenting questions for IRT estimation num_questions=3
2025-08-20 20:54:19 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 20:54:19 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1686.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3456.62it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 536.02it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6028.77it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1232.22it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3593.85it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 560.39it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5522.97it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1036.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3449.04it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 636.24it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5738.88it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1089.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3594.17it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 546.83it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5652.70it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1006.17it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3513.19it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 637.35it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5793.24it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1067.10it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3550.64it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 608.20it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5648.35it/s]
2025-08-20 20:54:23 INFO: Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
2025-08-20 20:54:23 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 20:54:23 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 20:54:23 [info     ] Evaluate question difficulty - end rmse=2.1567819666315375 split=test
2025-08-20 20:54:23 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 1 finished: 0:1:23

 ********** Run: 2/3 **********
2025-08-20 20:54:44 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 20:54:44 [info     ] Reading train split questions  num_questions=92
2025-08-20 20:54:44 [info     ] Reading validation split questions num_questions=23
2025-08-20 20:54:44 [info     ] Reading test split questions   num_questions=39
2025-08-20 20:54:46 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 20:54:46 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 20:54:50 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 20:54:50 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 20:54:50 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 20:54:51 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 20:54:54 [info     ] Setting seed                   value=44
2025-08-20 20:54:54 [info     ] Building structured outputter  name=teacher_kt
2025-08-20 20:54:54 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_kc_exact native_structured_output=True num_examples=5 system_prompt=teacher_marshmellow_level_context
2025-08-20 20:54:54 [info     ] Building example selector
2025-08-20 20:54:54 [info     ] Building model                 name=qwen3:0.6b provider=ollama rate_limit=None temp=1.0
2025-08-20 20:54:54 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:12<38:55, 12.04s/it]  2%|▏         | 3/195 [00:12<10:30,  3.28s/it]  2%|▏         | 4/195 [00:12<06:57,  2.18s/it]  3%|▎         | 5/195 [00:13<05:28,  1.73s/it]  3%|▎         | 6/195 [00:13<04:12,  1.33s/it]  4%|▍         | 8/195 [00:14<02:31,  1.23it/s]  5%|▍         | 9/195 [00:14<02:06,  1.47it/s]  5%|▌         | 10/195 [00:15<01:48,  1.71it/s]  6%|▌         | 11/195 [00:15<01:28,  2.08it/s]  6%|▌         | 12/195 [00:15<01:20,  2.27it/s]  7%|▋         | 13/195 [00:16<01:42,  1.78it/s]  7%|▋         | 14/195 [00:16<01:18,  2.32it/s]  8%|▊         | 15/195 [00:16<01:12,  2.48it/s]  8%|▊         | 16/195 [00:17<01:04,  2.77it/s]  9%|▊         | 17/195 [00:17<00:54,  3.29it/s]  9%|▉         | 18/195 [00:17<01:01,  2.90it/s] 10%|█         | 20/195 [00:18<01:05,  2.66it/s] 11%|█         | 21/195 [00:18<01:00,  2.90it/s] 11%|█▏        | 22/195 [00:19<01:00,  2.85it/s] 12%|█▏        | 24/195 [00:19<00:49,  3.48it/s] 13%|█▎        | 26/195 [00:20<00:44,  3.78it/s] 14%|█▍        | 28/195 [00:20<00:39,  4.22it/s] 15%|█▍        | 29/195 [00:20<00:38,  4.36it/s] 15%|█▌        | 30/195 [00:20<00:37,  4.42it/s] 16%|█▌        | 31/195 [00:21<00:37,  4.39it/s] 16%|█▋        | 32/195 [00:21<00:36,  4.51it/s] 17%|█▋        | 33/195 [00:21<00:39,  4.15it/s] 17%|█▋        | 34/195 [00:21<00:36,  4.38it/s] 18%|█▊        | 35/195 [00:22<00:40,  3.98it/s] 18%|█▊        | 36/195 [00:22<00:46,  3.44it/s] 19%|█▉        | 37/195 [00:22<00:41,  3.83it/s] 19%|█▉        | 38/195 [00:22<00:37,  4.22it/s] 20%|██        | 39/195 [00:22<00:33,  4.71it/s] 21%|██        | 40/195 [00:23<00:36,  4.27it/s] 22%|██▏       | 42/195 [00:23<00:34,  4.43it/s] 22%|██▏       | 43/195 [00:24<00:53,  2.86it/s] 23%|██▎       | 44/195 [00:24<00:47,  3.20it/s] 23%|██▎       | 45/195 [00:24<00:38,  3.87it/s] 24%|██▎       | 46/195 [00:24<00:38,  3.91it/s] 24%|██▍       | 47/195 [00:25<00:33,  4.40it/s] 25%|██▍       | 48/195 [00:25<00:33,  4.41it/s] 25%|██▌       | 49/195 [00:25<00:29,  4.92it/s] 26%|██▌       | 50/195 [00:25<00:31,  4.66it/s] 26%|██▌       | 51/195 [00:26<00:55,  2.60it/s] 27%|██▋       | 52/195 [00:26<00:51,  2.80it/s] 27%|██▋       | 53/195 [00:26<00:42,  3.34it/s] 28%|██▊       | 54/195 [00:27<00:40,  3.48it/s] 28%|██▊       | 55/195 [00:27<00:39,  3.54it/s] 29%|██▊       | 56/195 [00:27<00:47,  2.92it/s] 29%|██▉       | 57/195 [00:28<00:39,  3.47it/s] 30%|██▉       | 58/195 [00:28<00:44,  3.05it/s] 31%|███       | 60/195 [00:29<00:37,  3.58it/s] 31%|███▏      | 61/195 [00:29<00:31,  4.21it/s] 32%|███▏      | 62/195 [00:29<00:40,  3.28it/s] 32%|███▏      | 63/195 [00:30<00:45,  2.91it/s] 33%|███▎      | 65/195 [00:30<00:49,  2.64it/s] 34%|███▍      | 66/195 [00:31<00:46,  2.75it/s] 34%|███▍      | 67/195 [00:31<00:38,  3.35it/s] 35%|███▍      | 68/195 [00:31<00:37,  3.43it/s] 35%|███▌      | 69/195 [00:31<00:32,  3.86it/s] 36%|███▌      | 70/195 [00:32<00:34,  3.65it/s] 36%|███▋      | 71/195 [00:32<00:27,  4.45it/s] 37%|███▋      | 72/195 [00:32<00:32,  3.84it/s] 38%|███▊      | 74/195 [00:33<00:29,  4.05it/s] 39%|███▉      | 76/195 [00:33<00:27,  4.29it/s] 40%|████      | 78/195 [00:33<00:26,  4.45it/s] 41%|████      | 80/195 [00:34<00:24,  4.70it/s] 42%|████▏     | 81/195 [00:34<00:30,  3.76it/s] 42%|████▏     | 82/195 [00:34<00:29,  3.82it/s] 43%|████▎     | 83/195 [00:35<00:31,  3.61it/s] 43%|████▎     | 84/195 [00:35<00:26,  4.21it/s] 44%|████▎     | 85/195 [00:35<00:28,  3.84it/s] 44%|████▍     | 86/195 [00:35<00:24,  4.40it/s] 45%|████▍     | 87/195 [00:36<00:27,  3.99it/s] 45%|████▌     | 88/195 [00:36<00:35,  2.97it/s] 46%|████▌     | 89/195 [00:37<00:34,  3.07it/s] 47%|████▋     | 91/195 [00:37<00:40,  2.55it/s] 47%|████▋     | 92/195 [00:38<00:33,  3.09it/s] 48%|████▊     | 93/195 [00:38<00:33,  3.03it/s] 48%|████▊     | 94/195 [00:38<00:31,  3.20it/s] 49%|████▊     | 95/195 [00:39<00:31,  3.23it/s] 49%|████▉     | 96/195 [00:39<00:33,  2.95it/s] 50%|████▉     | 97/195 [00:39<00:29,  3.36it/s] 50%|█████     | 98/195 [00:39<00:24,  3.91it/s] 51%|█████     | 99/195 [00:40<00:25,  3.78it/s] 51%|█████▏    | 100/195 [00:40<00:24,  3.95it/s] 52%|█████▏    | 101/195 [00:40<00:25,  3.70it/s] 52%|█████▏    | 102/195 [00:40<00:23,  3.90it/s] 53%|█████▎    | 103/195 [00:41<00:25,  3.56it/s] 53%|█████▎    | 104/195 [00:41<00:20,  4.38it/s] 54%|█████▍    | 105/195 [00:41<00:25,  3.57it/s] 54%|█████▍    | 106/195 [00:41<00:25,  3.53it/s] 55%|█████▍    | 107/195 [00:42<00:25,  3.52it/s] 55%|█████▌    | 108/195 [00:42<00:21,  4.04it/s] 56%|█████▌    | 109/195 [00:42<00:23,  3.66it/s] 56%|█████▋    | 110/195 [00:42<00:19,  4.28it/s] 57%|█████▋    | 111/195 [00:43<00:23,  3.61it/s] 57%|█████▋    | 112/195 [00:43<00:20,  4.09it/s] 58%|█████▊    | 113/195 [00:43<00:21,  3.90it/s] 58%|█████▊    | 114/195 [00:44<00:22,  3.68it/s] 59%|█████▉    | 115/195 [00:44<00:26,  3.07it/s] 60%|██████    | 117/195 [00:44<00:21,  3.67it/s] 61%|██████    | 119/195 [00:45<00:19,  3.89it/s] 62%|██████▏   | 121/195 [00:45<00:17,  4.31it/s] 63%|██████▎   | 123/195 [00:46<00:15,  4.60it/s] 64%|██████▍   | 125/195 [00:46<00:14,  4.88it/s] 65%|██████▌   | 127/195 [00:46<00:13,  4.87it/s] 66%|██████▌   | 129/195 [00:47<00:12,  5.21it/s] 67%|██████▋   | 130/195 [00:47<00:12,  5.32it/s] 67%|██████▋   | 131/195 [00:47<00:13,  4.88it/s] 68%|██████▊   | 132/195 [00:47<00:12,  5.23it/s] 68%|██████▊   | 133/195 [00:48<00:13,  4.48it/s] 69%|██████▊   | 134/195 [00:48<00:12,  4.90it/s] 69%|██████▉   | 135/195 [00:48<00:16,  3.74it/s] 70%|██████▉   | 136/195 [00:48<00:13,  4.33it/s] 70%|███████   | 137/195 [00:49<00:14,  4.01it/s] 71%|███████   | 138/195 [00:49<00:12,  4.68it/s] 71%|███████▏  | 139/195 [00:49<00:12,  4.50it/s] 72%|███████▏  | 140/195 [00:49<00:12,  4.48it/s] 72%|███████▏  | 141/195 [00:49<00:11,  4.74it/s] 73%|███████▎  | 142/195 [00:50<00:16,  3.19it/s] 73%|███████▎  | 143/195 [00:50<00:18,  2.74it/s] 74%|███████▍  | 145/195 [00:51<00:16,  2.96it/s] 75%|███████▍  | 146/195 [00:51<00:17,  2.83it/s] 76%|███████▌  | 148/195 [00:52<00:13,  3.47it/s] 77%|███████▋  | 150/195 [00:52<00:11,  4.02it/s] 77%|███████▋  | 151/195 [00:52<00:10,  4.36it/s] 78%|███████▊  | 152/195 [00:53<00:09,  4.35it/s] 78%|███████▊  | 153/195 [00:53<00:11,  3.59it/s] 79%|███████▉  | 154/195 [00:53<00:12,  3.16it/s] 79%|███████▉  | 155/195 [00:54<00:11,  3.61it/s] 80%|████████  | 156/195 [00:54<00:09,  3.90it/s] 81%|████████  | 157/195 [00:54<00:10,  3.77it/s] 81%|████████  | 158/195 [00:54<00:08,  4.25it/s] 82%|████████▏ | 159/195 [00:55<00:09,  3.72it/s] 83%|████████▎ | 161/195 [00:55<00:08,  3.82it/s] 83%|████████▎ | 162/195 [00:55<00:07,  4.44it/s] 84%|████████▎ | 163/195 [00:55<00:07,  4.45it/s] 84%|████████▍ | 164/195 [00:56<00:07,  4.29it/s] 85%|████████▍ | 165/195 [00:56<00:07,  4.24it/s] 85%|████████▌ | 166/195 [00:56<00:07,  4.01it/s] 86%|████████▌ | 167/195 [00:56<00:06,  4.27it/s] 86%|████████▌ | 168/195 [00:57<00:07,  3.50it/s] 87%|████████▋ | 169/195 [00:57<00:08,  3.05it/s] 88%|████████▊ | 171/195 [00:58<00:06,  3.50it/s] 88%|████████▊ | 172/195 [00:58<00:07,  2.88it/s] 89%|████████▊ | 173/195 [00:58<00:06,  3.33it/s] 89%|████████▉ | 174/195 [00:59<00:07,  2.72it/s] 90%|████████▉ | 175/195 [00:59<00:07,  2.68it/s] 91%|█████████ | 177/195 [01:00<00:05,  3.29it/s] 92%|█████████▏| 179/195 [01:00<00:04,  3.77it/s] 92%|█████████▏| 180/195 [01:00<00:03,  4.16it/s] 93%|█████████▎| 181/195 [01:01<00:04,  3.23it/s] 94%|█████████▍| 183/195 [01:02<00:04,  2.45it/s] 94%|█████████▍| 184/195 [01:02<00:03,  2.84it/s] 95%|█████████▍| 185/195 [01:03<00:03,  2.92it/s] 95%|█████████▌| 186/195 [01:03<00:02,  3.26it/s] 96%|█████████▌| 187/195 [01:03<00:02,  3.51it/s] 96%|█████████▋| 188/195 [01:03<00:01,  3.53it/s] 97%|█████████▋| 189/195 [01:03<00:01,  3.82it/s] 97%|█████████▋| 190/195 [01:05<00:02,  1.95it/s] 98%|█████████▊| 192/195 [01:05<00:01,  2.68it/s] 99%|█████████▉| 193/195 [01:05<00:00,  2.48it/s] 99%|█████████▉| 194/195 [01:06<00:00,  3.02it/s]100%|██████████| 195/195 [01:06<00:00,  3.53it/s]100%|██████████| 195/195 [01:08<00:00,  2.85it/s]
2025-08-20 20:56:03 [info     ] Validating outputs
2025-08-20 20:56:03 [info     ] Predict - end                  time=0:1:8
2025-08-20 20:56:03 [info     ] Evaluate - start               split=test
2025-08-20 20:56:03 [info     ] Evaluate - end                 correctness_llm=0.29 monotonicity=0.31
2025-08-20 20:56:03 [info     ] Evaluate question difficulty - start split=test
2025-08-20 20:56:03 [info     ] Augmenting questions for IRT estimation num_questions=8
2025-08-20 20:56:03 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 20:56:03 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1004.21it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3483.05it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 504.91it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6289.66it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 953.00it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3109.79it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 645.29it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6047.40it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 988.29it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3485.13it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 537.49it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5609.50it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 932.07it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3617.14it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 614.23it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5496.09it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 975.78it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3674.83it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 629.59it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6234.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 987.23it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3638.05it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 588.23it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6671.24it/s]
2025-08-20 20:56:07 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-08-20 20:56:07 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 20:56:07 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 20:56:07 [info     ] Evaluate question difficulty - end rmse=2.2045015449059506 split=test
2025-08-20 20:56:07 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 2 finished: 0:1:23

 ********** Run: 3/3 **********
2025-08-20 20:56:26 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 20:56:26 [info     ] Reading train split questions  num_questions=92
2025-08-20 20:56:26 [info     ] Reading validation split questions num_questions=23
2025-08-20 20:56:26 [info     ] Reading test split questions   num_questions=39
2025-08-20 20:56:28 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 20:56:28 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 20:56:34 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 20:56:34 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 20:56:34 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 20:56:34 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 20:56:37 [info     ] Setting seed                   value=45
2025-08-20 20:56:37 [info     ] Building structured outputter  name=teacher_kt
2025-08-20 20:56:37 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_kc_exact native_structured_output=True num_examples=5 system_prompt=teacher_marshmellow_level_context
2025-08-20 20:56:37 [info     ] Building example selector
2025-08-20 20:56:37 [info     ] Building model                 name=qwen3:0.6b provider=ollama rate_limit=None temp=1.0
2025-08-20 20:56:37 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:11<37:28, 11.59s/it]  1%|          | 2/195 [00:11<15:37,  4.86s/it]  2%|▏         | 3/195 [00:12<08:59,  2.81s/it]  2%|▏         | 4/195 [00:12<05:41,  1.79s/it]  3%|▎         | 5/195 [00:13<04:25,  1.40s/it]  3%|▎         | 6/195 [00:13<03:17,  1.05s/it]  4%|▎         | 7/195 [00:13<02:22,  1.31it/s]  4%|▍         | 8/195 [00:14<02:10,  1.44it/s]  5%|▍         | 9/195 [00:14<01:55,  1.62it/s]  5%|▌         | 10/195 [00:14<01:41,  1.83it/s]  6%|▌         | 12/195 [00:15<01:16,  2.41it/s]  7%|▋         | 14/195 [00:15<01:00,  2.98it/s]  8%|▊         | 15/195 [00:16<01:05,  2.75it/s]  8%|▊         | 16/195 [00:16<01:02,  2.87it/s]  9%|▉         | 18/195 [00:17<00:53,  3.31it/s] 10%|▉         | 19/195 [00:17<01:00,  2.90it/s] 10%|█         | 20/195 [00:18<01:02,  2.79it/s] 11%|█         | 21/195 [00:18<01:02,  2.79it/s] 11%|█▏        | 22/195 [00:18<00:51,  3.36it/s] 12%|█▏        | 23/195 [00:18<00:49,  3.48it/s] 12%|█▏        | 24/195 [00:19<00:47,  3.59it/s] 13%|█▎        | 25/195 [00:19<00:59,  2.88it/s] 13%|█▎        | 26/195 [00:20<01:02,  2.69it/s] 14%|█▍        | 28/195 [00:20<00:48,  3.48it/s] 15%|█▍        | 29/195 [00:20<00:42,  3.92it/s] 15%|█▌        | 30/195 [00:20<00:42,  3.86it/s] 16%|█▌        | 31/195 [00:20<00:35,  4.56it/s] 16%|█▋        | 32/195 [00:21<00:35,  4.55it/s] 17%|█▋        | 33/195 [00:21<00:34,  4.72it/s] 17%|█▋        | 34/195 [00:21<00:34,  4.69it/s] 18%|█▊        | 35/195 [00:21<00:36,  4.33it/s] 18%|█▊        | 36/195 [00:22<00:54,  2.94it/s] 19%|█▉        | 38/195 [00:22<00:46,  3.41it/s] 21%|██        | 40/195 [00:23<00:39,  3.95it/s] 21%|██        | 41/195 [00:23<00:35,  4.32it/s] 22%|██▏       | 42/195 [00:23<00:44,  3.42it/s] 22%|██▏       | 43/195 [00:24<00:43,  3.52it/s] 23%|██▎       | 44/195 [00:24<00:37,  3.99it/s] 23%|██▎       | 45/195 [00:24<00:46,  3.23it/s] 24%|██▍       | 47/195 [00:25<00:36,  4.06it/s] 25%|██▍       | 48/195 [00:25<00:41,  3.52it/s] 25%|██▌       | 49/195 [00:25<00:43,  3.32it/s] 26%|██▌       | 51/195 [00:26<00:40,  3.53it/s] 27%|██▋       | 52/195 [00:27<00:53,  2.68it/s] 27%|██▋       | 53/195 [00:27<00:47,  3.00it/s] 28%|██▊       | 54/195 [00:27<00:45,  3.10it/s] 28%|██▊       | 55/195 [00:28<00:52,  2.66it/s] 29%|██▉       | 57/195 [00:28<00:44,  3.12it/s] 30%|██▉       | 58/195 [00:28<00:41,  3.29it/s] 30%|███       | 59/195 [00:29<00:38,  3.54it/s] 31%|███       | 60/195 [00:29<00:36,  3.69it/s] 31%|███▏      | 61/195 [00:29<00:42,  3.15it/s] 32%|███▏      | 62/195 [00:30<00:50,  2.62it/s] 32%|███▏      | 63/195 [00:30<00:48,  2.70it/s] 33%|███▎      | 64/195 [00:30<00:45,  2.90it/s] 33%|███▎      | 65/195 [00:31<00:36,  3.55it/s] 34%|███▍      | 66/195 [00:31<00:36,  3.49it/s] 34%|███▍      | 67/195 [00:31<00:31,  4.07it/s] 35%|███▍      | 68/195 [00:31<00:34,  3.65it/s] 35%|███▌      | 69/195 [00:32<00:38,  3.24it/s] 36%|███▌      | 70/195 [00:32<00:35,  3.52it/s] 36%|███▋      | 71/195 [00:32<00:40,  3.08it/s] 37%|███▋      | 72/195 [00:33<00:36,  3.35it/s] 37%|███▋      | 73/195 [00:33<00:35,  3.40it/s] 38%|███▊      | 74/195 [00:33<00:43,  2.79it/s] 38%|███▊      | 75/195 [00:34<00:38,  3.12it/s] 39%|███▉      | 76/195 [00:34<00:42,  2.80it/s] 39%|███▉      | 77/195 [00:35<00:44,  2.65it/s] 40%|████      | 78/195 [00:35<00:49,  2.36it/s] 41%|████      | 79/195 [00:35<00:38,  3.02it/s] 41%|████      | 80/195 [00:36<00:39,  2.92it/s] 42%|████▏     | 82/195 [00:36<00:32,  3.43it/s] 43%|████▎     | 83/195 [00:36<00:28,  3.92it/s] 43%|████▎     | 84/195 [00:36<00:28,  3.96it/s] 44%|████▎     | 85/195 [00:37<00:28,  3.85it/s] 44%|████▍     | 86/195 [00:37<00:33,  3.29it/s] 45%|████▍     | 87/195 [00:37<00:31,  3.47it/s] 45%|████▌     | 88/195 [00:37<00:26,  3.98it/s] 46%|████▌     | 89/195 [00:38<00:28,  3.68it/s] 47%|████▋     | 91/195 [00:38<00:26,  3.99it/s] 47%|████▋     | 92/195 [00:38<00:25,  4.10it/s] 48%|████▊     | 93/195 [00:39<00:25,  4.06it/s] 48%|████▊     | 94/195 [00:39<00:31,  3.25it/s] 49%|████▊     | 95/195 [00:39<00:29,  3.40it/s] 49%|████▉     | 96/195 [00:40<00:27,  3.63it/s] 50%|████▉     | 97/195 [00:40<00:25,  3.80it/s] 50%|█████     | 98/195 [00:40<00:23,  4.18it/s] 51%|█████     | 99/195 [00:40<00:22,  4.18it/s] 51%|█████▏    | 100/195 [00:41<00:22,  4.31it/s] 52%|█████▏    | 101/195 [00:41<00:30,  3.10it/s] 52%|█████▏    | 102/195 [00:41<00:25,  3.63it/s] 53%|█████▎    | 103/195 [00:42<00:26,  3.46it/s] 53%|█████▎    | 104/195 [00:42<00:24,  3.74it/s] 54%|█████▍    | 105/195 [00:42<00:24,  3.69it/s] 54%|█████▍    | 106/195 [00:42<00:21,  4.24it/s] 55%|█████▍    | 107/195 [00:42<00:20,  4.34it/s] 55%|█████▌    | 108/195 [00:43<00:21,  4.04it/s] 56%|█████▌    | 109/195 [00:43<00:18,  4.58it/s] 56%|█████▋    | 110/195 [00:43<00:19,  4.29it/s] 57%|█████▋    | 111/195 [00:43<00:18,  4.56it/s] 57%|█████▋    | 112/195 [00:44<00:19,  4.28it/s] 58%|█████▊    | 113/195 [00:44<00:18,  4.52it/s] 58%|█████▊    | 114/195 [00:44<00:18,  4.44it/s] 59%|█████▉    | 115/195 [00:44<00:18,  4.40it/s] 59%|█████▉    | 116/195 [00:45<00:18,  4.28it/s] 60%|██████    | 117/195 [00:45<00:17,  4.53it/s] 61%|██████    | 118/195 [00:45<00:20,  3.81it/s] 62%|██████▏   | 120/195 [00:45<00:18,  4.15it/s] 63%|██████▎   | 122/195 [00:46<00:15,  4.61it/s] 64%|██████▎   | 124/195 [00:46<00:14,  5.00it/s] 64%|██████▍   | 125/195 [00:46<00:14,  4.97it/s] 65%|██████▍   | 126/195 [00:47<00:13,  5.20it/s] 65%|██████▌   | 127/195 [00:47<00:15,  4.45it/s] 66%|██████▌   | 128/195 [00:47<00:14,  4.54it/s] 66%|██████▌   | 129/195 [00:47<00:14,  4.46it/s] 67%|██████▋   | 130/195 [00:48<00:14,  4.53it/s] 67%|██████▋   | 131/195 [00:48<00:14,  4.56it/s] 68%|██████▊   | 132/195 [00:48<00:14,  4.27it/s] 68%|██████▊   | 133/195 [00:48<00:15,  4.01it/s] 69%|██████▊   | 134/195 [00:49<00:14,  4.14it/s] 69%|██████▉   | 135/195 [00:49<00:13,  4.30it/s] 70%|██████▉   | 136/195 [00:49<00:14,  4.12it/s] 70%|███████   | 137/195 [00:49<00:13,  4.36it/s] 71%|███████   | 138/195 [00:49<00:12,  4.63it/s] 71%|███████▏  | 139/195 [00:50<00:13,  4.21it/s] 72%|███████▏  | 140/195 [00:50<00:11,  4.64it/s] 72%|███████▏  | 141/195 [00:50<00:13,  4.07it/s] 73%|███████▎  | 142/195 [00:50<00:10,  4.95it/s] 73%|███████▎  | 143/195 [00:51<00:13,  3.81it/s] 74%|███████▍  | 144/195 [00:51<00:10,  4.64it/s] 74%|███████▍  | 145/195 [00:51<00:13,  3.67it/s] 75%|███████▍  | 146/195 [00:51<00:12,  4.07it/s] 75%|███████▌  | 147/195 [00:52<00:10,  4.39it/s] 76%|███████▌  | 148/195 [00:52<00:09,  4.98it/s] 76%|███████▋  | 149/195 [00:52<00:10,  4.36it/s] 77%|███████▋  | 150/195 [00:52<00:12,  3.60it/s] 77%|███████▋  | 151/195 [00:53<00:12,  3.46it/s] 78%|███████▊  | 153/195 [00:53<00:09,  4.21it/s] 79%|███████▉  | 155/195 [00:54<00:10,  3.87it/s] 80%|████████  | 156/195 [00:54<00:11,  3.41it/s] 81%|████████  | 157/195 [00:54<00:09,  3.91it/s] 81%|████████  | 158/195 [00:54<00:09,  3.93it/s] 82%|████████▏ | 159/195 [00:55<00:08,  4.27it/s] 82%|████████▏ | 160/195 [00:55<00:07,  4.69it/s] 83%|████████▎ | 161/195 [00:55<00:07,  4.35it/s] 84%|████████▎ | 163/195 [00:55<00:07,  4.51it/s] 85%|████████▍ | 165/195 [00:56<00:06,  4.95it/s] 85%|████████▌ | 166/195 [00:56<00:05,  5.50it/s] 86%|████████▌ | 167/195 [00:56<00:06,  4.23it/s] 86%|████████▌ | 168/195 [00:56<00:05,  4.95it/s] 87%|████████▋ | 169/195 [00:57<00:05,  4.59it/s] 87%|████████▋ | 170/195 [00:57<00:05,  4.43it/s] 88%|████████▊ | 171/195 [00:57<00:04,  4.90it/s] 88%|████████▊ | 172/195 [00:57<00:05,  4.01it/s] 89%|████████▉ | 174/195 [00:58<00:07,  2.71it/s] 90%|████████▉ | 175/195 [00:59<00:06,  3.18it/s] 90%|█████████ | 176/195 [00:59<00:05,  3.34it/s] 91%|█████████ | 177/195 [00:59<00:04,  3.67it/s] 91%|█████████▏| 178/195 [00:59<00:04,  3.83it/s] 92%|█████████▏| 179/195 [01:00<00:04,  3.89it/s] 92%|█████████▏| 180/195 [01:00<00:05,  2.95it/s] 93%|█████████▎| 182/195 [01:00<00:03,  3.72it/s] 94%|█████████▍| 183/195 [01:01<00:02,  4.22it/s] 94%|█████████▍| 184/195 [01:01<00:03,  3.41it/s] 95%|█████████▍| 185/195 [01:01<00:03,  3.26it/s] 96%|█████████▌| 187/195 [01:02<00:02,  3.84it/s] 96%|█████████▋| 188/195 [01:02<00:02,  3.25it/s] 97%|█████████▋| 190/195 [01:03<00:01,  3.89it/s] 98%|█████████▊| 192/195 [01:03<00:00,  4.11it/s] 99%|█████████▉| 193/195 [01:03<00:00,  4.11it/s] 99%|█████████▉| 194/195 [01:03<00:00,  4.34it/s]100%|██████████| 195/195 [01:04<00:00,  3.45it/s]100%|██████████| 195/195 [01:06<00:00,  2.93it/s]
2025-08-20 20:57:44 [info     ] Validating outputs
2025-08-20 20:57:44 [info     ] Predict - end                  time=0:1:6
2025-08-20 20:57:44 [info     ] Evaluate - start               split=test
2025-08-20 20:57:44 [info     ] Evaluate - end                 correctness_llm=0.31 monotonicity=-0.61
2025-08-20 20:57:44 [info     ] Evaluate question difficulty - start split=test
2025-08-20 20:57:44 [info     ] Augmenting questions for IRT estimation num_questions=7
2025-08-20 20:57:44 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 20:57:44 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1106.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3477.35it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 434.76it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7022.27it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1121.99it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3679.79it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 567.15it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6153.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 697.11it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3508.75it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 610.21it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8945.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1128.15it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3598.12it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 666.00it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7064.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1004.55it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3571.88it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 587.96it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7465.07it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 976.56it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3430.46it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 752.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7150.54it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1051.81it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3670.79it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 652.67it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6861.45it/s]
2025-08-20 20:57:49 INFO: EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
2025-08-20 20:57:49 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 20:57:49 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 20:57:49 [info     ] Evaluate question difficulty - end rmse=2.5191423416907406 split=test
2025-08-20 20:57:49 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 3 finished: 0:1:22

 ========== Config: llama3.2:1b~T_0.0~SO_student_kt~L_5~SP_student_chocolate_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_miscon_studentlevel_random3 ==========
Config 4/8

 ********** Run: 1/3 **********
2025-08-20 20:58:09 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 20:58:09 [info     ] Reading train split questions  num_questions=92
2025-08-20 20:58:09 [info     ] Reading validation split questions num_questions=23
2025-08-20 20:58:09 [info     ] Reading test split questions   num_questions=39
2025-08-20 20:58:11 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 20:58:11 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 20:58:15 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 20:58:15 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 20:58:15 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 20:58:16 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 20:58:19 [info     ] Setting seed                   value=43
2025-08-20 20:58:19 [info     ] Building structured outputter  name=student_kt
2025-08-20 20:58:19 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_random native_structured_output=True num_examples=3 system_prompt=student_chocolate_level_context
2025-08-20 20:58:19 [info     ] Building example selector
2025-08-20 20:58:19 [info     ] Building model                 name=llama3.2:1b provider=ollama rate_limit=None temp=0.0
2025-08-20 20:58:19 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:11<36:41, 11.35s/it]  1%|          | 2/195 [00:11<15:45,  4.90s/it]  2%|▏         | 3/195 [00:12<09:17,  2.91s/it]  2%|▏         | 4/195 [00:12<06:01,  1.89s/it]  3%|▎         | 5/195 [00:13<04:18,  1.36s/it]  3%|▎         | 6/195 [00:13<03:21,  1.07s/it]  4%|▎         | 7/195 [00:13<02:25,  1.29it/s]  4%|▍         | 8/195 [00:14<01:57,  1.59it/s]  5%|▍         | 9/195 [00:14<01:32,  2.02it/s]  5%|▌         | 10/195 [00:14<01:21,  2.27it/s]  6%|▌         | 11/195 [00:14<01:02,  2.96it/s]  6%|▌         | 12/195 [00:14<01:03,  2.90it/s]  7%|▋         | 14/195 [00:15<00:53,  3.39it/s]  8%|▊         | 15/195 [00:15<00:50,  3.58it/s]  8%|▊         | 16/195 [00:16<00:51,  3.48it/s]  9%|▊         | 17/195 [00:16<00:46,  3.86it/s]  9%|▉         | 18/195 [00:16<00:48,  3.64it/s] 10%|▉         | 19/195 [00:16<00:47,  3.71it/s] 10%|█         | 20/195 [00:17<00:47,  3.69it/s] 11%|█         | 21/195 [00:17<00:41,  4.22it/s] 11%|█▏        | 22/195 [00:17<00:40,  4.30it/s] 12%|█▏        | 23/195 [00:17<00:39,  4.41it/s] 12%|█▏        | 24/195 [00:17<00:43,  3.90it/s] 13%|█▎        | 25/195 [00:18<00:42,  4.00it/s] 13%|█▎        | 26/195 [00:18<00:43,  3.89it/s] 14%|█▍        | 27/195 [00:18<00:42,  3.93it/s] 14%|█▍        | 28/195 [00:18<00:41,  4.03it/s] 15%|█▍        | 29/195 [00:19<00:43,  3.81it/s] 15%|█▌        | 30/195 [00:19<00:40,  4.09it/s] 16%|█▌        | 31/195 [00:20<00:55,  2.93it/s] 16%|█▋        | 32/195 [00:20<01:06,  2.43it/s] 17%|█▋        | 33/195 [00:20<00:53,  3.03it/s] 17%|█▋        | 34/195 [00:21<01:11,  2.24it/s] 18%|█▊        | 35/195 [00:21<00:54,  2.91it/s] 18%|█▊        | 36/195 [00:21<00:51,  3.07it/s] 19%|█▉        | 37/195 [00:22<00:56,  2.82it/s] 19%|█▉        | 38/195 [00:22<00:55,  2.84it/s] 20%|██        | 39/195 [00:22<00:43,  3.59it/s] 21%|██        | 40/195 [00:23<00:53,  2.92it/s] 21%|██        | 41/195 [00:23<00:43,  3.57it/s] 22%|██▏       | 42/195 [00:23<00:44,  3.43it/s] 22%|██▏       | 43/195 [00:24<00:53,  2.86it/s] 23%|██▎       | 44/195 [00:24<00:46,  3.22it/s] 23%|██▎       | 45/195 [00:24<00:40,  3.66it/s] 24%|██▎       | 46/195 [00:24<00:44,  3.38it/s] 24%|██▍       | 47/195 [00:25<00:35,  4.20it/s] 25%|██▍       | 48/195 [00:25<00:40,  3.60it/s] 26%|██▌       | 50/195 [00:25<00:36,  3.92it/s] 26%|██▌       | 51/195 [00:26<00:52,  2.74it/s] 27%|██▋       | 52/195 [00:26<00:44,  3.22it/s] 27%|██▋       | 53/195 [00:27<01:03,  2.23it/s] 28%|██▊       | 54/195 [00:27<00:52,  2.71it/s] 28%|██▊       | 55/195 [00:28<00:52,  2.69it/s] 29%|██▊       | 56/195 [00:28<01:05,  2.14it/s] 30%|██▉       | 58/195 [00:29<00:58,  2.32it/s] 31%|███       | 60/195 [00:30<00:48,  2.77it/s] 31%|███▏      | 61/195 [00:30<00:45,  2.92it/s] 32%|███▏      | 62/195 [00:30<00:43,  3.09it/s] 32%|███▏      | 63/195 [00:30<00:41,  3.14it/s] 33%|███▎      | 64/195 [00:31<00:41,  3.17it/s] 33%|███▎      | 65/195 [00:31<00:34,  3.78it/s] 34%|███▍      | 66/195 [00:31<00:41,  3.14it/s] 34%|███▍      | 67/195 [00:32<00:41,  3.07it/s] 35%|███▌      | 69/195 [00:32<00:33,  3.77it/s] 36%|███▌      | 70/195 [00:32<00:28,  4.43it/s] 36%|███▋      | 71/195 [00:33<00:39,  3.11it/s] 37%|███▋      | 72/195 [00:33<00:34,  3.54it/s] 37%|███▋      | 73/195 [00:33<00:30,  3.94it/s] 38%|███▊      | 74/195 [00:33<00:34,  3.49it/s] 38%|███▊      | 75/195 [00:34<00:32,  3.68it/s] 39%|███▉      | 76/195 [00:34<00:34,  3.46it/s] 39%|███▉      | 77/195 [00:34<00:41,  2.84it/s] 40%|████      | 78/195 [00:35<00:35,  3.31it/s] 41%|████      | 79/195 [00:35<00:30,  3.75it/s] 41%|████      | 80/195 [00:35<00:33,  3.46it/s] 42%|████▏     | 81/195 [00:35<00:30,  3.68it/s] 42%|████▏     | 82/195 [00:36<00:48,  2.33it/s] 43%|████▎     | 83/195 [00:36<00:37,  2.99it/s] 43%|████▎     | 84/195 [00:37<00:41,  2.66it/s] 44%|████▎     | 85/195 [00:37<00:41,  2.64it/s] 44%|████▍     | 86/195 [00:37<00:32,  3.36it/s] 45%|████▍     | 87/195 [00:38<00:38,  2.82it/s] 46%|████▌     | 89/195 [00:38<00:33,  3.12it/s] 46%|████▌     | 90/195 [00:38<00:28,  3.70it/s] 47%|████▋     | 91/195 [00:39<00:34,  3.02it/s] 47%|████▋     | 92/195 [00:40<00:44,  2.31it/s] 48%|████▊     | 93/195 [00:40<00:38,  2.63it/s] 48%|████▊     | 94/195 [00:40<00:36,  2.80it/s] 49%|████▊     | 95/195 [00:41<00:40,  2.48it/s] 49%|████▉     | 96/195 [00:41<00:45,  2.18it/s] 50%|████▉     | 97/195 [00:42<00:41,  2.35it/s] 50%|█████     | 98/195 [00:42<00:36,  2.63it/s] 51%|█████     | 99/195 [00:42<00:30,  3.15it/s] 51%|█████▏    | 100/195 [00:43<00:36,  2.64it/s] 52%|█████▏    | 102/195 [00:44<00:38,  2.39it/s] 53%|█████▎    | 104/195 [00:45<00:41,  2.22it/s] 54%|█████▍    | 106/195 [00:45<00:40,  2.22it/s] 55%|█████▌    | 108/195 [00:46<00:32,  2.69it/s] 56%|█████▌    | 109/195 [00:46<00:28,  3.02it/s] 56%|█████▋    | 110/195 [00:47<00:35,  2.39it/s] 57%|█████▋    | 111/195 [00:47<00:29,  2.83it/s] 57%|█████▋    | 112/195 [00:48<00:36,  2.28it/s] 58%|█████▊    | 113/195 [00:48<00:31,  2.63it/s] 58%|█████▊    | 114/195 [00:49<00:36,  2.20it/s] 59%|█████▉    | 115/195 [00:49<00:30,  2.61it/s] 59%|█████▉    | 116/195 [00:50<00:39,  1.98it/s] 60%|██████    | 117/195 [00:50<00:30,  2.52it/s] 61%|██████    | 118/195 [00:50<00:39,  1.96it/s] 61%|██████    | 119/195 [00:51<00:29,  2.55it/s] 62%|██████▏   | 120/195 [00:51<00:28,  2.64it/s] 62%|██████▏   | 121/195 [00:51<00:30,  2.40it/s] 63%|██████▎   | 122/195 [00:52<00:27,  2.67it/s] 64%|██████▎   | 124/195 [00:52<00:20,  3.45it/s] 64%|██████▍   | 125/195 [00:52<00:17,  4.11it/s] 65%|██████▍   | 126/195 [00:52<00:18,  3.71it/s] 65%|██████▌   | 127/195 [00:53<00:15,  4.44it/s] 66%|██████▌   | 128/195 [00:53<00:16,  4.18it/s] 66%|██████▌   | 129/195 [00:53<00:13,  4.80it/s] 67%|██████▋   | 130/195 [00:53<00:14,  4.60it/s] 67%|██████▋   | 131/195 [00:54<00:21,  2.98it/s] 68%|██████▊   | 132/195 [00:54<00:18,  3.50it/s] 68%|██████▊   | 133/195 [00:54<00:17,  3.53it/s] 69%|██████▊   | 134/195 [00:55<00:24,  2.54it/s] 69%|██████▉   | 135/195 [00:55<00:19,  3.10it/s] 70%|██████▉   | 136/195 [00:55<00:19,  3.10it/s] 70%|███████   | 137/195 [00:56<00:15,  3.74it/s] 71%|███████   | 138/195 [00:56<00:15,  3.67it/s] 71%|███████▏  | 139/195 [00:56<00:13,  4.17it/s] 72%|███████▏  | 140/195 [00:56<00:13,  4.17it/s] 72%|███████▏  | 141/195 [00:57<00:16,  3.35it/s] 73%|███████▎  | 142/195 [00:57<00:17,  2.97it/s] 73%|███████▎  | 143/195 [00:58<00:20,  2.60it/s] 74%|███████▍  | 145/195 [00:58<00:14,  3.46it/s] 75%|███████▍  | 146/195 [00:58<00:15,  3.22it/s] 75%|███████▌  | 147/195 [00:59<00:14,  3.42it/s] 76%|███████▌  | 148/195 [00:59<00:15,  3.01it/s] 76%|███████▋  | 149/195 [00:59<00:13,  3.44it/s] 77%|███████▋  | 150/195 [00:59<00:11,  4.01it/s] 77%|███████▋  | 151/195 [01:00<00:18,  2.42it/s] 78%|███████▊  | 153/195 [01:01<00:13,  3.14it/s] 79%|███████▉  | 154/195 [01:01<00:11,  3.54it/s] 79%|███████▉  | 155/195 [01:01<00:12,  3.13it/s] 80%|████████  | 156/195 [01:01<00:11,  3.29it/s] 81%|████████  | 158/195 [01:02<00:10,  3.59it/s] 82%|████████▏ | 160/195 [01:02<00:08,  4.00it/s] 83%|████████▎ | 161/195 [01:03<00:08,  4.18it/s] 83%|████████▎ | 162/195 [01:03<00:07,  4.22it/s] 84%|████████▎ | 163/195 [01:03<00:07,  4.30it/s] 84%|████████▍ | 164/195 [01:03<00:07,  4.29it/s] 85%|████████▍ | 165/195 [01:04<00:07,  4.13it/s] 85%|████████▌ | 166/195 [01:04<00:06,  4.16it/s] 86%|████████▌ | 167/195 [01:04<00:07,  3.53it/s] 87%|████████▋ | 169/195 [01:05<00:06,  4.13it/s] 87%|████████▋ | 170/195 [01:05<00:05,  4.62it/s] 88%|████████▊ | 171/195 [01:05<00:06,  3.76it/s] 88%|████████▊ | 172/195 [01:05<00:05,  4.31it/s] 89%|████████▊ | 173/195 [01:05<00:05,  4.09it/s] 89%|████████▉ | 174/195 [01:06<00:06,  3.17it/s] 90%|████████▉ | 175/195 [01:06<00:06,  3.32it/s] 90%|█████████ | 176/195 [01:06<00:04,  4.11it/s] 91%|█████████ | 177/195 [01:07<00:05,  3.23it/s] 92%|█████████▏| 179/195 [01:07<00:04,  3.72it/s] 92%|█████████▏| 180/195 [01:08<00:04,  3.36it/s] 93%|█████████▎| 181/195 [01:08<00:04,  2.97it/s] 93%|█████████▎| 182/195 [01:08<00:03,  3.55it/s] 94%|█████████▍| 183/195 [01:09<00:04,  2.94it/s] 94%|█████████▍| 184/195 [01:09<00:03,  2.87it/s] 95%|█████████▌| 186/195 [01:10<00:02,  3.29it/s] 96%|█████████▌| 187/195 [01:10<00:02,  3.71it/s] 96%|█████████▋| 188/195 [01:10<00:02,  3.46it/s] 97%|█████████▋| 189/195 [01:10<00:01,  4.02it/s] 97%|█████████▋| 190/195 [01:11<00:01,  3.73it/s] 98%|█████████▊| 191/195 [01:11<00:01,  3.68it/s] 98%|█████████▊| 192/195 [01:11<00:00,  3.50it/s] 99%|█████████▉| 193/195 [01:11<00:00,  3.34it/s] 99%|█████████▉| 194/195 [01:12<00:00,  2.64it/s]100%|██████████| 195/195 [01:14<00:00,  2.61it/s]
2025-08-20 20:59:34 [info     ] Validating outputs
2025-08-20 20:59:34 [info     ] Predict - end                  time=0:1:14
2025-08-20 20:59:34 [info     ] Evaluate - start               split=test
2025-08-20 20:59:34 [info     ] Evaluate - end                 correctness_llm=0.33 monotonicity=-0.9
2025-08-20 20:59:34 [info     ] Evaluate question difficulty - start split=test
2025-08-20 20:59:34 [info     ] Augmenting questions for IRT estimation num_questions=23
2025-08-20 20:59:34 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 20:59:34 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 952.35it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3569.46it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 492.74it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5903.91it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 953.03it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3589.75it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 575.74it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6441.45it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 988.82it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3695.76it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 617.29it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6188.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1058.98it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3641.05it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 709.60it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5796.67it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1043.47it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3820.31it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 629.45it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5873.20it/s]
2025-08-20 20:59:37 INFO: EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
2025-08-20 20:59:37 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 20:59:37 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 20:59:37 [info     ] Evaluate question difficulty - end rmse=2.7095394640968284 split=test
2025-08-20 20:59:37 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 1 finished: 0:1:28

 ********** Run: 2/3 **********
2025-08-20 20:59:58 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 20:59:58 [info     ] Reading train split questions  num_questions=92
2025-08-20 20:59:58 [info     ] Reading validation split questions num_questions=23
2025-08-20 20:59:58 [info     ] Reading test split questions   num_questions=39
2025-08-20 21:00:00 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 21:00:00 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 21:00:04 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 21:00:04 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 21:00:04 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 21:00:04 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 21:00:08 [info     ] Setting seed                   value=44
2025-08-20 21:00:08 [info     ] Building structured outputter  name=student_kt
2025-08-20 21:00:08 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_random native_structured_output=True num_examples=3 system_prompt=student_chocolate_level_context
2025-08-20 21:00:08 [info     ] Building example selector
2025-08-20 21:00:08 [info     ] Building model                 name=llama3.2:1b provider=ollama rate_limit=None temp=0.0
2025-08-20 21:00:08 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:09<29:45,  9.20s/it]  1%|          | 2/195 [00:09<13:19,  4.14s/it]  2%|▏         | 3/195 [00:10<07:56,  2.48s/it]  2%|▏         | 4/195 [00:10<05:14,  1.65s/it]  3%|▎         | 5/195 [00:11<03:45,  1.19s/it]  3%|▎         | 6/195 [00:11<02:59,  1.05it/s]  4%|▎         | 7/195 [00:11<02:10,  1.44it/s]  4%|▍         | 8/195 [00:11<01:43,  1.81it/s]  5%|▍         | 9/195 [00:12<01:23,  2.22it/s]  5%|▌         | 10/195 [00:12<01:08,  2.70it/s]  6%|▌         | 11/195 [00:12<00:58,  3.17it/s]  6%|▌         | 12/195 [00:12<00:50,  3.60it/s]  7%|▋         | 13/195 [00:12<00:46,  3.93it/s]  7%|▋         | 14/195 [00:13<00:41,  4.41it/s]  8%|▊         | 15/195 [00:13<00:47,  3.76it/s]  9%|▊         | 17/195 [00:13<00:42,  4.17it/s]  9%|▉         | 18/195 [00:14<00:37,  4.74it/s] 10%|▉         | 19/195 [00:14<00:43,  4.09it/s] 10%|█         | 20/195 [00:14<00:35,  4.87it/s] 11%|█         | 21/195 [00:14<00:39,  4.41it/s] 11%|█▏        | 22/195 [00:14<00:38,  4.51it/s] 12%|█▏        | 23/195 [00:15<00:42,  4.06it/s] 12%|█▏        | 24/195 [00:15<00:39,  4.32it/s] 13%|█▎        | 25/195 [00:15<00:39,  4.33it/s] 13%|█▎        | 26/195 [00:16<00:44,  3.84it/s] 14%|█▍        | 27/195 [00:16<00:39,  4.23it/s] 14%|█▍        | 28/195 [00:16<00:48,  3.44it/s] 15%|█▌        | 30/195 [00:17<00:41,  3.96it/s] 16%|█▌        | 31/195 [00:17<00:53,  3.09it/s] 16%|█▋        | 32/195 [00:17<00:46,  3.49it/s] 17%|█▋        | 33/195 [00:18<00:53,  3.02it/s] 17%|█▋        | 34/195 [00:18<00:44,  3.58it/s] 18%|█▊        | 35/195 [00:18<00:51,  3.13it/s] 19%|█▉        | 37/195 [00:19<00:46,  3.39it/s] 19%|█▉        | 38/195 [00:19<00:39,  3.96it/s] 20%|██        | 39/195 [00:19<00:43,  3.56it/s] 21%|██        | 40/195 [00:19<00:38,  4.04it/s] 21%|██        | 41/195 [00:20<00:41,  3.71it/s] 22%|██▏       | 42/195 [00:20<00:37,  4.03it/s] 22%|██▏       | 43/195 [00:20<00:40,  3.73it/s] 23%|██▎       | 44/195 [00:20<00:37,  4.04it/s] 23%|██▎       | 45/195 [00:21<00:37,  3.96it/s] 24%|██▎       | 46/195 [00:21<00:39,  3.82it/s] 24%|██▍       | 47/195 [00:21<00:33,  4.39it/s] 25%|██▍       | 48/195 [00:21<00:36,  4.06it/s] 25%|██▌       | 49/195 [00:22<00:31,  4.65it/s] 26%|██▌       | 50/195 [00:22<00:36,  3.93it/s] 26%|██▌       | 51/195 [00:23<00:53,  2.68it/s] 27%|██▋       | 52/195 [00:23<00:43,  3.27it/s] 27%|██▋       | 53/195 [00:23<00:58,  2.43it/s] 28%|██▊       | 54/195 [00:24<00:46,  3.02it/s] 28%|██▊       | 55/195 [00:24<00:42,  3.29it/s] 29%|██▊       | 56/195 [00:24<00:57,  2.42it/s] 29%|██▉       | 57/195 [00:25<00:47,  2.90it/s] 30%|██▉       | 58/195 [00:25<00:57,  2.37it/s] 30%|███       | 59/195 [00:25<00:49,  2.77it/s] 31%|███       | 60/195 [00:26<00:51,  2.61it/s] 31%|███▏      | 61/195 [00:26<00:42,  3.18it/s] 32%|███▏      | 62/195 [00:26<00:39,  3.39it/s] 32%|███▏      | 63/195 [00:27<00:35,  3.72it/s] 33%|███▎      | 64/195 [00:27<00:35,  3.72it/s] 33%|███▎      | 65/195 [00:27<00:31,  4.12it/s] 34%|███▍      | 66/195 [00:27<00:32,  3.98it/s] 34%|███▍      | 67/195 [00:28<00:43,  2.93it/s] 35%|███▍      | 68/195 [00:28<00:38,  3.27it/s] 35%|███▌      | 69/195 [00:28<00:33,  3.78it/s] 36%|███▌      | 70/195 [00:29<00:40,  3.06it/s] 36%|███▋      | 71/195 [00:29<00:35,  3.46it/s] 37%|███▋      | 72/195 [00:29<00:30,  4.09it/s] 37%|███▋      | 73/195 [00:29<00:32,  3.76it/s] 38%|███▊      | 74/195 [00:29<00:27,  4.38it/s] 38%|███▊      | 75/195 [00:30<00:31,  3.81it/s] 39%|███▉      | 76/195 [00:30<00:27,  4.28it/s] 39%|███▉      | 77/195 [00:30<00:27,  4.23it/s] 40%|████      | 78/195 [00:30<00:25,  4.61it/s] 41%|████      | 79/195 [00:31<00:26,  4.43it/s] 41%|████      | 80/195 [00:31<00:37,  3.04it/s] 42%|████▏     | 81/195 [00:31<00:35,  3.24it/s] 42%|████▏     | 82/195 [00:32<00:44,  2.53it/s] 43%|████▎     | 83/195 [00:32<00:38,  2.89it/s] 43%|████▎     | 84/195 [00:33<00:46,  2.37it/s] 44%|████▎     | 85/195 [00:33<00:40,  2.69it/s] 44%|████▍     | 86/195 [00:33<00:34,  3.16it/s] 45%|████▍     | 87/195 [00:34<00:44,  2.43it/s] 45%|████▌     | 88/195 [00:34<00:37,  2.82it/s] 46%|████▌     | 89/195 [00:34<00:31,  3.34it/s] 46%|████▌     | 90/195 [00:35<00:30,  3.41it/s] 47%|████▋     | 91/195 [00:35<00:37,  2.81it/s] 47%|████▋     | 92/195 [00:36<00:40,  2.54it/s] 48%|████▊     | 94/195 [00:36<00:30,  3.37it/s] 49%|████▊     | 95/195 [00:36<00:26,  3.80it/s] 49%|████▉     | 96/195 [00:37<00:32,  3.03it/s] 50%|████▉     | 97/195 [00:37<00:30,  3.23it/s] 51%|█████     | 99/195 [00:37<00:26,  3.67it/s] 51%|█████▏    | 100/195 [00:38<00:37,  2.52it/s] 52%|█████▏    | 101/195 [00:38<00:33,  2.84it/s] 52%|█████▏    | 102/195 [00:39<00:41,  2.22it/s] 53%|█████▎    | 103/195 [00:39<00:34,  2.63it/s] 53%|█████▎    | 104/195 [00:40<00:39,  2.31it/s] 54%|█████▍    | 105/195 [00:40<00:32,  2.73it/s] 54%|█████▍    | 106/195 [00:41<00:44,  1.98it/s] 55%|█████▌    | 108/195 [00:41<00:34,  2.55it/s] 56%|█████▌    | 109/195 [00:42<00:28,  3.06it/s] 56%|█████▋    | 110/195 [00:42<00:39,  2.18it/s] 57%|█████▋    | 111/195 [00:43<00:32,  2.59it/s] 57%|█████▋    | 112/195 [00:43<00:37,  2.23it/s] 58%|█████▊    | 113/195 [00:43<00:33,  2.48it/s] 58%|█████▊    | 114/195 [00:44<00:36,  2.21it/s] 59%|█████▉    | 115/195 [00:44<00:31,  2.50it/s] 59%|█████▉    | 116/195 [00:45<00:37,  2.13it/s] 60%|██████    | 117/195 [00:45<00:31,  2.44it/s] 61%|██████    | 118/195 [00:46<00:31,  2.42it/s] 61%|██████    | 119/195 [00:46<00:27,  2.76it/s] 62%|██████▏   | 120/195 [00:46<00:32,  2.34it/s] 62%|██████▏   | 121/195 [00:47<00:25,  2.87it/s] 63%|██████▎   | 122/195 [00:47<00:20,  3.53it/s] 63%|██████▎   | 123/195 [00:47<00:19,  3.70it/s] 64%|██████▎   | 124/195 [00:47<00:16,  4.38it/s] 64%|██████▍   | 125/195 [00:47<00:16,  4.36it/s] 65%|██████▍   | 126/195 [00:48<00:14,  4.75it/s] 65%|██████▌   | 127/195 [00:48<00:14,  4.81it/s] 66%|██████▌   | 128/195 [00:48<00:15,  4.45it/s] 66%|██████▌   | 129/195 [00:48<00:14,  4.68it/s] 67%|██████▋   | 130/195 [00:48<00:14,  4.45it/s] 67%|██████▋   | 131/195 [00:49<00:25,  2.54it/s] 68%|██████▊   | 132/195 [00:49<00:20,  3.03it/s] 68%|██████▊   | 133/195 [00:50<00:19,  3.25it/s] 69%|██████▊   | 134/195 [00:50<00:19,  3.09it/s] 69%|██████▉   | 135/195 [00:50<00:21,  2.74it/s] 70%|███████   | 137/195 [00:51<00:17,  3.39it/s] 71%|███████   | 138/195 [00:51<00:14,  3.99it/s] 71%|███████▏  | 139/195 [00:51<00:14,  3.83it/s] 72%|███████▏  | 140/195 [00:51<00:12,  4.50it/s] 72%|███████▏  | 141/195 [00:52<00:13,  3.95it/s] 73%|███████▎  | 142/195 [00:52<00:11,  4.57it/s] 73%|███████▎  | 143/195 [00:52<00:12,  4.15it/s] 74%|███████▍  | 144/195 [00:52<00:10,  4.77it/s] 74%|███████▍  | 145/195 [00:53<00:13,  3.81it/s] 75%|███████▍  | 146/195 [00:53<00:14,  3.40it/s] 76%|███████▌  | 148/195 [00:53<00:11,  4.04it/s] 77%|███████▋  | 150/195 [00:54<00:10,  4.40it/s] 77%|███████▋  | 151/195 [00:54<00:08,  4.97it/s] 78%|███████▊  | 152/195 [00:54<00:11,  3.78it/s] 78%|███████▊  | 153/195 [00:55<00:11,  3.72it/s] 79%|███████▉  | 155/195 [00:55<00:09,  4.32it/s] 81%|████████  | 157/195 [00:55<00:08,  4.71it/s] 81%|████████  | 158/195 [00:56<00:07,  5.20it/s] 82%|████████▏ | 159/195 [00:56<00:07,  4.50it/s] 82%|████████▏ | 160/195 [00:56<00:07,  4.85it/s] 83%|████████▎ | 161/195 [00:56<00:07,  4.60it/s] 83%|████████▎ | 162/195 [00:56<00:06,  5.23it/s] 84%|████████▎ | 163/195 [00:57<00:07,  4.51it/s] 84%|████████▍ | 164/195 [00:57<00:06,  5.08it/s] 85%|████████▍ | 165/195 [00:57<00:06,  4.69it/s] 85%|████████▌ | 166/195 [00:57<00:06,  4.44it/s] 86%|████████▌ | 167/195 [00:58<00:06,  4.03it/s] 86%|████████▌ | 168/195 [00:58<00:08,  3.05it/s] 87%|████████▋ | 169/195 [00:59<00:09,  2.69it/s] 87%|████████▋ | 170/195 [00:59<00:09,  2.77it/s] 88%|████████▊ | 171/195 [00:59<00:09,  2.53it/s] 88%|████████▊ | 172/195 [01:00<00:11,  2.03it/s] 89%|████████▊ | 173/195 [01:00<00:09,  2.28it/s] 89%|████████▉ | 174/195 [01:01<00:07,  2.70it/s] 90%|████████▉ | 175/195 [01:01<00:08,  2.40it/s] 90%|█████████ | 176/195 [01:01<00:06,  2.77it/s] 91%|█████████▏| 178/195 [01:02<00:05,  3.18it/s] 92%|█████████▏| 179/195 [01:02<00:05,  3.06it/s] 92%|█████████▏| 180/195 [01:02<00:04,  3.65it/s] 93%|█████████▎| 181/195 [01:03<00:04,  3.24it/s] 94%|█████████▍| 183/195 [01:03<00:03,  3.35it/s] 94%|█████████▍| 184/195 [01:04<00:03,  3.08it/s] 95%|█████████▍| 185/195 [01:04<00:02,  3.70it/s] 95%|█████████▌| 186/195 [01:04<00:02,  3.38it/s] 96%|█████████▌| 187/195 [01:04<00:02,  3.94it/s] 96%|█████████▋| 188/195 [01:05<00:02,  3.35it/s] 97%|█████████▋| 189/195 [01:05<00:02,  2.78it/s] 97%|█████████▋| 190/195 [01:06<00:01,  3.33it/s] 98%|█████████▊| 191/195 [01:06<00:01,  3.37it/s] 98%|█████████▊| 192/195 [01:06<00:00,  3.56it/s] 99%|█████████▉| 193/195 [01:06<00:00,  3.39it/s] 99%|█████████▉| 194/195 [01:07<00:00,  3.74it/s]100%|██████████| 195/195 [01:07<00:00,  4.37it/s]100%|██████████| 195/195 [01:09<00:00,  2.80it/s]
2025-08-20 21:01:17 [info     ] Validating outputs
2025-08-20 21:01:17 [info     ] Predict - end                  time=0:1:9
2025-08-20 21:01:17 [info     ] Evaluate - start               split=test
2025-08-20 21:01:17 [info     ] Evaluate - end                 correctness_llm=0.32 monotonicity=0.53
2025-08-20 21:01:17 [info     ] Evaluate question difficulty - start split=test
2025-08-20 21:01:17 [info     ] Augmenting questions for IRT estimation num_questions=23
2025-08-20 21:01:17 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 21:01:17 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 923.48it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3617.38it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 458.48it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6001.66it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 959.42it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3960.63it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 495.35it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5837.00it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 926.01it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3462.55it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 587.03it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5834.68it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 961.49it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3618.02it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 589.38it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5613.79it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 923.01it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3436.29it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 613.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5939.74it/s]
2025-08-20 21:01:21 INFO: EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
2025-08-20 21:01:21 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 21:01:21 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 21:01:21 [info     ] Evaluate question difficulty - end rmse=2.857353702919736 split=test
2025-08-20 21:01:21 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 2 finished: 0:1:23

 ********** Run: 3/3 **********
2025-08-20 21:01:43 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 21:01:43 [info     ] Reading train split questions  num_questions=92
2025-08-20 21:01:43 [info     ] Reading validation split questions num_questions=23
2025-08-20 21:01:43 [info     ] Reading test split questions   num_questions=39
2025-08-20 21:01:44 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 21:01:44 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 21:01:49 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 21:01:49 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 21:01:49 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 21:01:50 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 21:01:53 [info     ] Setting seed                   value=45
2025-08-20 21:01:53 [info     ] Building structured outputter  name=student_kt
2025-08-20 21:01:53 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_random native_structured_output=True num_examples=3 system_prompt=student_chocolate_level_context
2025-08-20 21:01:53 [info     ] Building example selector
2025-08-20 21:01:53 [info     ] Building model                 name=llama3.2:1b provider=ollama rate_limit=None temp=0.0
2025-08-20 21:01:53 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:09<30:09,  9.33s/it]  1%|          | 2/195 [00:09<13:23,  4.16s/it]  2%|▏         | 3/195 [00:10<07:34,  2.37s/it]  2%|▏         | 4/195 [00:10<05:15,  1.65s/it]  3%|▎         | 6/195 [00:11<02:55,  1.08it/s]  4%|▎         | 7/195 [00:11<02:24,  1.30it/s]  4%|▍         | 8/195 [00:11<01:53,  1.65it/s]  5%|▍         | 9/195 [00:12<01:47,  1.73it/s]  5%|▌         | 10/195 [00:12<01:37,  1.90it/s]  6%|▌         | 11/195 [00:12<01:17,  2.36it/s]  6%|▌         | 12/195 [00:13<01:07,  2.73it/s]  7%|▋         | 13/195 [00:13<01:02,  2.91it/s]  7%|▋         | 14/195 [00:13<00:51,  3.51it/s]  8%|▊         | 15/195 [00:13<00:53,  3.35it/s]  8%|▊         | 16/195 [00:14<00:50,  3.53it/s]  9%|▊         | 17/195 [00:14<00:55,  3.21it/s]  9%|▉         | 18/195 [00:14<00:46,  3.80it/s] 10%|▉         | 19/195 [00:14<00:48,  3.61it/s] 10%|█         | 20/195 [00:15<00:43,  4.01it/s] 11%|█         | 21/195 [00:15<00:47,  3.65it/s] 11%|█▏        | 22/195 [00:15<00:42,  4.12it/s] 12%|█▏        | 23/195 [00:15<00:48,  3.56it/s] 13%|█▎        | 25/195 [00:16<00:44,  3.84it/s] 13%|█▎        | 26/195 [00:16<00:39,  4.33it/s] 14%|█▍        | 27/195 [00:16<00:42,  3.96it/s] 14%|█▍        | 28/195 [00:17<00:35,  4.70it/s] 15%|█▍        | 29/195 [00:17<00:44,  3.75it/s] 15%|█▌        | 30/195 [00:17<00:38,  4.27it/s] 16%|█▌        | 31/195 [00:18<00:53,  3.08it/s] 16%|█▋        | 32/195 [00:18<01:05,  2.49it/s] 17%|█▋        | 33/195 [00:19<01:03,  2.55it/s] 17%|█▋        | 34/195 [00:19<01:01,  2.64it/s] 18%|█▊        | 35/195 [00:20<01:09,  2.31it/s] 18%|█▊        | 36/195 [00:20<00:57,  2.78it/s] 19%|█▉        | 37/195 [00:20<00:49,  3.18it/s] 19%|█▉        | 38/195 [00:20<00:47,  3.31it/s] 20%|██        | 39/195 [00:20<00:44,  3.50it/s] 21%|██        | 40/195 [00:21<00:41,  3.73it/s] 21%|██        | 41/195 [00:21<00:45,  3.35it/s] 22%|██▏       | 43/195 [00:22<00:44,  3.40it/s] 23%|██▎       | 45/195 [00:22<00:40,  3.66it/s] 24%|██▎       | 46/195 [00:23<00:46,  3.24it/s] 24%|██▍       | 47/195 [00:23<00:42,  3.51it/s] 25%|██▍       | 48/195 [00:23<00:35,  4.18it/s] 25%|██▌       | 49/195 [00:23<00:41,  3.55it/s] 26%|██▌       | 51/195 [00:24<00:42,  3.43it/s] 27%|██▋       | 53/195 [00:25<00:51,  2.75it/s] 28%|██▊       | 55/195 [00:25<00:47,  2.96it/s] 29%|██▊       | 56/195 [00:26<00:51,  2.69it/s] 29%|██▉       | 57/195 [00:26<00:45,  3.03it/s] 30%|██▉       | 58/195 [00:27<00:58,  2.35it/s] 30%|███       | 59/195 [00:27<00:50,  2.71it/s] 31%|███       | 60/195 [00:28<00:56,  2.39it/s] 31%|███▏      | 61/195 [00:28<00:50,  2.66it/s] 32%|███▏      | 62/195 [00:28<00:54,  2.45it/s] 32%|███▏      | 63/195 [00:29<00:49,  2.65it/s] 33%|███▎      | 64/195 [00:29<00:43,  3.04it/s] 33%|███▎      | 65/195 [00:29<00:41,  3.15it/s] 34%|███▍      | 66/195 [00:30<00:55,  2.31it/s] 34%|███▍      | 67/195 [00:30<00:48,  2.66it/s] 35%|███▍      | 68/195 [00:30<00:40,  3.14it/s] 35%|███▌      | 69/195 [00:31<00:42,  3.00it/s] 36%|███▌      | 70/195 [00:31<00:34,  3.60it/s] 36%|███▋      | 71/195 [00:31<00:44,  2.76it/s] 37%|███▋      | 72/195 [00:32<00:44,  2.79it/s] 38%|███▊      | 74/195 [00:32<00:36,  3.31it/s] 39%|███▉      | 76/195 [00:33<00:35,  3.33it/s] 39%|███▉      | 77/195 [00:33<00:39,  2.99it/s] 40%|████      | 78/195 [00:33<00:32,  3.57it/s] 41%|████      | 79/195 [00:34<00:37,  3.10it/s] 42%|████▏     | 81/195 [00:34<00:35,  3.26it/s] 42%|████▏     | 82/195 [00:35<00:40,  2.79it/s] 43%|████▎     | 84/195 [00:35<00:36,  3.04it/s] 44%|████▎     | 85/195 [00:36<00:31,  3.47it/s] 44%|████▍     | 86/195 [00:36<00:35,  3.07it/s] 45%|████▍     | 87/195 [00:37<00:44,  2.41it/s] 45%|████▌     | 88/195 [00:37<00:44,  2.38it/s] 46%|████▌     | 89/195 [00:38<00:44,  2.39it/s] 47%|████▋     | 91/195 [00:38<00:44,  2.33it/s] 47%|████▋     | 92/195 [00:39<00:39,  2.59it/s] 48%|████▊     | 93/195 [00:39<00:37,  2.73it/s] 48%|████▊     | 94/195 [00:39<00:37,  2.72it/s] 49%|████▊     | 95/195 [00:40<00:45,  2.21it/s] 49%|████▉     | 96/195 [00:40<00:41,  2.37it/s] 50%|█████     | 98/195 [00:41<00:34,  2.81it/s] 51%|█████     | 99/195 [00:41<00:37,  2.56it/s] 51%|█████▏    | 100/195 [00:42<00:33,  2.88it/s] 52%|█████▏    | 101/195 [00:42<00:42,  2.20it/s] 52%|█████▏    | 102/195 [00:43<00:35,  2.65it/s] 53%|█████▎    | 103/195 [00:43<00:43,  2.14it/s] 53%|█████▎    | 104/195 [00:43<00:34,  2.66it/s] 54%|█████▍    | 105/195 [00:44<00:47,  1.89it/s] 54%|█████▍    | 106/195 [00:44<00:38,  2.32it/s] 55%|█████▍    | 107/195 [00:45<00:41,  2.14it/s] 55%|█████▌    | 108/195 [00:45<00:33,  2.56it/s] 56%|█████▌    | 109/195 [00:46<00:40,  2.15it/s] 56%|█████▋    | 110/195 [00:46<00:31,  2.70it/s] 57%|█████▋    | 111/195 [00:47<00:38,  2.19it/s] 57%|█████▋    | 112/195 [00:47<00:29,  2.79it/s] 58%|█████▊    | 113/195 [00:47<00:36,  2.23it/s] 58%|█████▊    | 114/195 [00:48<00:28,  2.85it/s] 59%|█████▉    | 115/195 [00:48<00:35,  2.23it/s] 59%|█████▉    | 116/195 [00:48<00:28,  2.75it/s] 60%|██████    | 117/195 [00:49<00:38,  2.02it/s] 61%|██████    | 118/195 [00:49<00:32,  2.39it/s] 61%|██████    | 119/195 [00:50<00:27,  2.80it/s] 62%|██████▏   | 120/195 [00:50<00:26,  2.84it/s] 63%|██████▎   | 122/195 [00:50<00:19,  3.71it/s] 64%|██████▎   | 124/195 [00:51<00:16,  4.30it/s] 64%|██████▍   | 125/195 [00:51<00:14,  4.75it/s] 65%|██████▍   | 126/195 [00:51<00:15,  4.34it/s] 65%|██████▌   | 127/195 [00:51<00:14,  4.63it/s] 66%|██████▌   | 128/195 [00:52<00:14,  4.48it/s] 66%|██████▌   | 129/195 [00:52<00:13,  4.77it/s] 67%|██████▋   | 130/195 [00:52<00:14,  4.39it/s] 67%|██████▋   | 131/195 [00:53<00:24,  2.59it/s] 68%|██████▊   | 132/195 [00:53<00:20,  3.05it/s] 68%|██████▊   | 133/195 [00:54<00:27,  2.25it/s] 69%|██████▉   | 135/195 [00:54<00:20,  2.90it/s] 70%|██████▉   | 136/195 [00:55<00:20,  2.92it/s] 71%|███████   | 138/195 [00:55<00:20,  2.79it/s] 71%|███████▏  | 139/195 [00:56<00:18,  2.98it/s] 72%|███████▏  | 141/195 [00:56<00:16,  3.27it/s] 73%|███████▎  | 142/195 [00:56<00:14,  3.70it/s] 73%|███████▎  | 143/195 [00:57<00:15,  3.28it/s] 74%|███████▍  | 144/195 [00:57<00:12,  3.95it/s] 74%|███████▍  | 145/195 [00:57<00:13,  3.62it/s] 75%|███████▌  | 147/195 [00:57<00:11,  4.28it/s] 76%|███████▌  | 148/195 [00:58<00:12,  3.78it/s] 76%|███████▋  | 149/195 [00:58<00:11,  3.90it/s] 77%|███████▋  | 151/195 [00:59<00:11,  3.80it/s] 78%|███████▊  | 152/195 [00:59<00:13,  3.31it/s] 78%|███████▊  | 153/195 [00:59<00:11,  3.71it/s] 79%|███████▉  | 154/195 [01:00<00:13,  2.98it/s] 79%|███████▉  | 155/195 [01:00<00:12,  3.10it/s] 81%|████████  | 157/195 [01:00<00:09,  3.95it/s] 82%|████████▏ | 159/195 [01:01<00:08,  4.39it/s] 82%|████████▏ | 160/195 [01:01<00:07,  4.84it/s] 83%|████████▎ | 161/195 [01:01<00:07,  4.36it/s] 83%|████████▎ | 162/195 [01:01<00:07,  4.68it/s] 84%|████████▎ | 163/195 [01:01<00:06,  4.59it/s] 84%|████████▍ | 164/195 [01:02<00:06,  4.86it/s] 85%|████████▍ | 165/195 [01:02<00:06,  4.56it/s] 85%|████████▌ | 166/195 [01:02<00:07,  3.97it/s] 86%|████████▌ | 167/195 [01:02<00:05,  4.80it/s] 86%|████████▌ | 168/195 [01:03<00:07,  3.38it/s] 87%|████████▋ | 170/195 [01:04<00:07,  3.20it/s] 88%|████████▊ | 171/195 [01:04<00:06,  3.62it/s] 88%|████████▊ | 172/195 [01:04<00:06,  3.63it/s] 89%|████████▊ | 173/195 [01:04<00:05,  3.72it/s] 89%|████████▉ | 174/195 [01:05<00:06,  3.23it/s] 90%|████████▉ | 175/195 [01:05<00:05,  3.59it/s] 90%|█████████ | 176/195 [01:05<00:06,  3.11it/s] 91%|█████████ | 177/195 [01:05<00:04,  3.66it/s] 91%|█████████▏| 178/195 [01:06<00:04,  3.97it/s] 92%|█████████▏| 179/195 [01:06<00:04,  3.99it/s] 92%|█████████▏| 180/195 [01:06<00:03,  4.21it/s] 93%|█████████▎| 181/195 [01:06<00:04,  3.42it/s] 93%|█████████▎| 182/195 [01:07<00:04,  3.20it/s] 94%|█████████▍| 183/195 [01:07<00:03,  3.13it/s] 95%|█████████▍| 185/195 [01:08<00:02,  3.51it/s] 95%|█████████▌| 186/195 [01:08<00:02,  4.17it/s] 96%|█████████▌| 187/195 [01:08<00:02,  3.31it/s] 97%|█████████▋| 189/195 [01:09<00:01,  3.53it/s] 97%|█████████▋| 190/195 [01:09<00:01,  3.78it/s] 98%|█████████▊| 191/195 [01:09<00:01,  3.37it/s] 98%|█████████▊| 192/195 [01:09<00:00,  4.04it/s] 99%|█████████▉| 193/195 [01:10<00:00,  3.43it/s] 99%|█████████▉| 194/195 [01:10<00:00,  4.02it/s]100%|██████████| 195/195 [01:10<00:00,  4.59it/s]100%|██████████| 195/195 [01:12<00:00,  2.68it/s]
2025-08-20 21:03:06 [info     ] Validating outputs
2025-08-20 21:03:06 [info     ] Predict - end                  time=0:1:12
2025-08-20 21:03:06 [info     ] Evaluate - start               split=test
2025-08-20 21:03:06 [info     ] Evaluate - end                 correctness_llm=0.31 monotonicity=-1.24
2025-08-20 21:03:06 [info     ] Evaluate question difficulty - start split=test
2025-08-20 21:03:06 [info     ] Augmenting questions for IRT estimation num_questions=23
2025-08-20 21:03:06 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 21:03:06 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 978.28it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3473.95it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 498.41it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7967.47it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1127.76it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3487.21it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 615.98it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8289.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1064.66it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3511.54it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 544.45it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8139.76it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1014.20it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3466.44it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 595.71it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8208.03it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1061.47it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3479.05it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 648.20it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8376.64it/s]
2025-08-20 21:03:09 INFO: EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
2025-08-20 21:03:09 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 21:03:09 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 21:03:09 [info     ] Evaluate question difficulty - end rmse=2.877130051113103 split=test
2025-08-20 21:03:09 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 3 finished: 0:1:26

 ========== Config: llama3.1:8b~T_0.0~SO_student_kt~L_5~SP_student_chocolate_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_miscon_studentlevel_random1 ==========
Config 5/8

 ********** Run: 1/3 **********
2025-08-20 21:03:30 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 21:03:30 [info     ] Reading train split questions  num_questions=92
2025-08-20 21:03:30 [info     ] Reading validation split questions num_questions=23
2025-08-20 21:03:30 [info     ] Reading test split questions   num_questions=39
2025-08-20 21:03:32 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 21:03:32 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 21:03:36 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 21:03:36 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 21:03:36 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 21:03:37 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 21:03:40 [info     ] Setting seed                   value=43
2025-08-20 21:03:40 [info     ] Building structured outputter  name=student_kt
2025-08-20 21:03:40 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_random native_structured_output=True num_examples=1 system_prompt=student_chocolate_level_context
2025-08-20 21:03:40 [info     ] Building example selector
2025-08-20 21:03:40 [info     ] Building model                 name=llama3.1:8b provider=ollama rate_limit=None temp=0.0
2025-08-20 21:03:40 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:11<37:04, 11.47s/it]  1%|          | 2/195 [00:11<16:11,  5.03s/it]  2%|▏         | 3/195 [00:13<10:55,  3.41s/it]  2%|▏         | 4/195 [00:14<07:35,  2.38s/it]  3%|▎         | 5/195 [00:15<05:46,  1.83s/it]  4%|▎         | 7/195 [00:16<03:36,  1.15s/it]  4%|▍         | 8/195 [00:16<02:46,  1.12it/s]  5%|▍         | 9/195 [00:17<02:36,  1.19it/s]  6%|▌         | 11/195 [00:17<02:05,  1.47it/s]  7%|▋         | 13/195 [00:18<01:46,  1.71it/s]  7%|▋         | 14/195 [00:18<01:29,  2.02it/s]  8%|▊         | 15/195 [00:19<01:40,  1.79it/s]  8%|▊         | 16/195 [00:19<01:22,  2.18it/s]  9%|▊         | 17/195 [00:20<01:30,  1.97it/s]  9%|▉         | 18/195 [00:20<01:13,  2.41it/s] 10%|▉         | 19/195 [00:21<01:19,  2.22it/s] 10%|█         | 20/195 [00:21<01:06,  2.64it/s] 11%|█         | 21/195 [00:21<01:07,  2.59it/s] 11%|█▏        | 22/195 [00:22<01:12,  2.38it/s] 12%|█▏        | 24/195 [00:23<01:11,  2.40it/s] 13%|█▎        | 26/195 [00:23<01:05,  2.56it/s] 14%|█▍        | 27/195 [00:24<01:04,  2.60it/s] 14%|█▍        | 28/195 [00:24<01:01,  2.72it/s] 15%|█▍        | 29/195 [00:24<01:02,  2.64it/s] 15%|█▌        | 30/195 [00:25<00:58,  2.83it/s] 16%|█▌        | 31/195 [00:26<01:28,  1.86it/s] 17%|█▋        | 33/195 [00:27<01:15,  2.16it/s] 17%|█▋        | 34/195 [00:27<01:18,  2.06it/s] 18%|█▊        | 35/195 [00:28<01:18,  2.03it/s] 18%|█▊        | 36/195 [00:28<01:09,  2.28it/s] 19%|█▉        | 37/195 [00:28<01:13,  2.15it/s] 19%|█▉        | 38/195 [00:29<01:12,  2.17it/s] 20%|██        | 39/195 [00:29<01:11,  2.17it/s] 21%|██        | 40/195 [00:30<01:11,  2.17it/s] 21%|██        | 41/195 [00:30<01:06,  2.31it/s] 22%|██▏       | 42/195 [00:31<01:14,  2.06it/s] 22%|██▏       | 43/195 [00:31<01:07,  2.25it/s] 23%|██▎       | 44/195 [00:32<01:20,  1.89it/s] 23%|██▎       | 45/195 [00:32<01:10,  2.13it/s] 24%|██▎       | 46/195 [00:33<01:17,  1.93it/s] 24%|██▍       | 47/195 [00:33<01:06,  2.22it/s] 25%|██▍       | 48/195 [00:34<01:07,  2.17it/s] 25%|██▌       | 49/195 [00:34<00:57,  2.56it/s] 26%|██▌       | 50/195 [00:35<01:16,  1.90it/s] 26%|██▌       | 51/195 [00:35<01:19,  1.80it/s] 27%|██▋       | 52/195 [00:36<01:10,  2.02it/s] 27%|██▋       | 53/195 [00:36<01:13,  1.94it/s] 28%|██▊       | 54/195 [00:37<01:07,  2.10it/s] 28%|██▊       | 55/195 [00:37<01:04,  2.18it/s] 29%|██▊       | 56/195 [00:37<01:02,  2.24it/s] 29%|██▉       | 57/195 [00:38<01:01,  2.24it/s] 30%|██▉       | 58/195 [00:38<01:00,  2.28it/s] 30%|███       | 59/195 [00:39<00:56,  2.39it/s] 31%|███       | 60/195 [00:39<00:55,  2.42it/s] 31%|███▏      | 61/195 [00:39<00:53,  2.53it/s] 32%|███▏      | 62/195 [00:40<00:55,  2.40it/s] 32%|███▏      | 63/195 [00:40<00:48,  2.70it/s] 33%|███▎      | 64/195 [00:41<00:53,  2.44it/s] 33%|███▎      | 65/195 [00:41<00:45,  2.85it/s] 34%|███▍      | 66/195 [00:41<00:47,  2.72it/s] 34%|███▍      | 67/195 [00:41<00:41,  3.11it/s] 35%|███▍      | 68/195 [00:42<00:42,  2.99it/s] 35%|███▌      | 69/195 [00:42<00:35,  3.52it/s] 36%|███▌      | 70/195 [00:43<00:46,  2.70it/s] 36%|███▋      | 71/195 [00:43<00:41,  2.98it/s] 37%|███▋      | 72/195 [00:44<00:54,  2.25it/s] 37%|███▋      | 73/195 [00:44<01:01,  1.99it/s] 38%|███▊      | 74/195 [00:45<01:05,  1.85it/s] 38%|███▊      | 75/195 [00:45<01:07,  1.79it/s] 39%|███▉      | 76/195 [00:46<00:52,  2.28it/s] 39%|███▉      | 77/195 [00:46<00:53,  2.23it/s] 40%|████      | 78/195 [00:46<00:46,  2.50it/s] 41%|████      | 79/195 [00:47<00:44,  2.58it/s] 41%|████      | 80/195 [00:47<00:42,  2.68it/s] 42%|████▏     | 81/195 [00:48<00:51,  2.23it/s] 42%|████▏     | 82/195 [00:48<00:45,  2.48it/s] 43%|████▎     | 83/195 [00:49<00:55,  2.03it/s] 43%|████▎     | 84/195 [00:49<00:49,  2.26it/s] 44%|████▎     | 85/195 [00:50<00:54,  2.02it/s] 44%|████▍     | 86/195 [00:50<00:43,  2.49it/s] 45%|████▍     | 87/195 [00:50<00:47,  2.30it/s] 45%|████▌     | 88/195 [00:51<00:41,  2.55it/s] 46%|████▌     | 89/195 [00:51<00:40,  2.62it/s] 46%|████▌     | 90/195 [00:51<00:37,  2.81it/s] 47%|████▋     | 91/195 [00:52<00:37,  2.76it/s] 47%|████▋     | 92/195 [00:52<00:38,  2.67it/s] 48%|████▊     | 93/195 [00:52<00:35,  2.87it/s] 48%|████▊     | 94/195 [00:53<00:38,  2.60it/s] 49%|████▊     | 95/195 [00:53<00:33,  2.97it/s] 49%|████▉     | 96/195 [00:54<00:39,  2.50it/s] 50%|█████     | 98/195 [00:54<00:35,  2.73it/s] 51%|█████     | 99/195 [00:54<00:30,  3.18it/s] 51%|█████▏    | 100/195 [00:55<00:42,  2.23it/s] 52%|█████▏    | 102/195 [00:56<00:44,  2.11it/s] 53%|█████▎    | 103/195 [00:56<00:38,  2.38it/s] 53%|█████▎    | 104/195 [00:57<00:46,  1.94it/s] 54%|█████▍    | 105/195 [00:58<00:41,  2.17it/s] 54%|█████▍    | 106/195 [00:58<00:45,  1.98it/s] 55%|█████▍    | 107/195 [00:59<00:42,  2.05it/s] 55%|█████▌    | 108/195 [00:59<00:44,  1.94it/s] 56%|█████▌    | 109/195 [01:00<00:39,  2.17it/s] 56%|█████▋    | 110/195 [01:00<00:46,  1.84it/s] 57%|█████▋    | 111/195 [01:01<00:39,  2.14it/s] 57%|█████▋    | 112/195 [01:01<00:46,  1.79it/s] 58%|█████▊    | 113/195 [01:02<00:40,  2.04it/s] 58%|█████▊    | 114/195 [01:02<00:43,  1.87it/s] 59%|█████▉    | 115/195 [01:03<00:40,  1.99it/s] 59%|█████▉    | 116/195 [01:03<00:42,  1.87it/s] 60%|██████    | 117/195 [01:04<00:38,  2.01it/s] 61%|██████    | 118/195 [01:04<00:38,  2.00it/s] 61%|██████    | 119/195 [01:05<00:35,  2.12it/s] 62%|██████▏   | 120/195 [01:05<00:34,  2.17it/s] 62%|██████▏   | 121/195 [01:06<00:34,  2.16it/s] 63%|██████▎   | 122/195 [01:06<00:31,  2.29it/s] 63%|██████▎   | 123/195 [01:07<00:34,  2.10it/s] 64%|██████▎   | 124/195 [01:07<00:31,  2.24it/s] 64%|██████▍   | 125/195 [01:07<00:34,  2.04it/s] 65%|██████▍   | 126/195 [01:08<00:29,  2.31it/s] 65%|██████▌   | 127/195 [01:08<00:34,  1.96it/s] 66%|██████▌   | 128/195 [01:09<00:28,  2.35it/s] 66%|██████▌   | 129/195 [01:09<00:32,  2.05it/s] 67%|██████▋   | 130/195 [01:10<00:25,  2.52it/s] 67%|██████▋   | 131/195 [01:10<00:32,  1.96it/s] 68%|██████▊   | 133/195 [01:11<00:29,  2.09it/s] 69%|██████▊   | 134/195 [01:11<00:26,  2.32it/s] 69%|██████▉   | 135/195 [01:12<00:27,  2.19it/s] 70%|██████▉   | 136/195 [01:12<00:23,  2.47it/s] 70%|███████   | 137/195 [01:13<00:25,  2.31it/s] 71%|███████   | 138/195 [01:13<00:23,  2.47it/s] 71%|███████▏  | 139/195 [01:14<00:23,  2.36it/s] 72%|███████▏  | 140/195 [01:14<00:21,  2.52it/s] 72%|███████▏  | 141/195 [01:14<00:22,  2.43it/s] 73%|███████▎  | 142/195 [01:15<00:20,  2.64it/s] 73%|███████▎  | 143/195 [01:15<00:20,  2.58it/s] 74%|███████▍  | 144/195 [01:15<00:19,  2.68it/s] 74%|███████▍  | 145/195 [01:16<00:21,  2.32it/s] 75%|███████▍  | 146/195 [01:16<00:19,  2.49it/s] 75%|███████▌  | 147/195 [01:17<00:20,  2.29it/s] 76%|███████▌  | 148/195 [01:17<00:18,  2.56it/s] 76%|███████▋  | 149/195 [01:18<00:19,  2.42it/s] 77%|███████▋  | 150/195 [01:18<00:17,  2.57it/s] 77%|███████▋  | 151/195 [01:18<00:17,  2.54it/s] 78%|███████▊  | 152/195 [01:19<00:16,  2.63it/s] 78%|███████▊  | 153/195 [01:19<00:16,  2.58it/s] 79%|███████▉  | 154/195 [01:19<00:15,  2.65it/s] 79%|███████▉  | 155/195 [01:20<00:12,  3.10it/s] 80%|████████  | 156/195 [01:20<00:17,  2.25it/s] 81%|████████  | 157/195 [01:21<00:13,  2.74it/s] 81%|████████  | 158/195 [01:21<00:17,  2.07it/s] 82%|████████▏ | 160/195 [01:22<00:14,  2.43it/s] 83%|████████▎ | 161/195 [01:22<00:12,  2.65it/s] 83%|████████▎ | 162/195 [01:23<00:14,  2.30it/s] 84%|████████▎ | 163/195 [01:23<00:12,  2.57it/s] 84%|████████▍ | 164/195 [01:24<00:13,  2.36it/s] 85%|████████▍ | 165/195 [01:24<00:11,  2.59it/s] 85%|████████▌ | 166/195 [01:24<00:11,  2.49it/s] 86%|████████▌ | 167/195 [01:25<00:13,  2.08it/s] 86%|████████▌ | 168/195 [01:26<00:13,  1.95it/s] 87%|████████▋ | 169/195 [01:26<00:15,  1.70it/s] 87%|████████▋ | 170/195 [01:27<00:14,  1.74it/s] 88%|████████▊ | 172/195 [01:28<00:10,  2.11it/s] 89%|████████▊ | 173/195 [01:28<00:08,  2.47it/s] 89%|████████▉ | 174/195 [01:28<00:09,  2.33it/s] 90%|████████▉ | 175/195 [01:29<00:08,  2.50it/s] 90%|█████████ | 176/195 [01:29<00:08,  2.30it/s] 91%|█████████ | 177/195 [01:30<00:07,  2.35it/s] 91%|█████████▏| 178/195 [01:30<00:06,  2.51it/s] 92%|█████████▏| 179/195 [01:30<00:07,  2.22it/s] 92%|█████████▏| 180/195 [01:31<00:05,  2.67it/s] 93%|█████████▎| 181/195 [01:31<00:06,  2.30it/s] 94%|█████████▍| 183/195 [01:32<00:04,  2.57it/s] 94%|█████████▍| 184/195 [01:32<00:03,  2.85it/s] 95%|█████████▍| 185/195 [01:33<00:04,  2.47it/s] 95%|█████████▌| 186/195 [01:33<00:03,  2.40it/s] 96%|█████████▌| 187/195 [01:34<00:03,  2.22it/s] 96%|█████████▋| 188/195 [01:34<00:03,  2.14it/s] 97%|█████████▋| 189/195 [01:35<00:02,  2.08it/s] 97%|█████████▋| 190/195 [01:35<00:02,  1.95it/s] 98%|█████████▊| 191/195 [01:35<00:01,  2.35it/s] 98%|█████████▊| 192/195 [01:36<00:01,  1.95it/s] 99%|█████████▉| 193/195 [01:36<00:00,  2.25it/s] 99%|█████████▉| 194/195 [01:37<00:00,  1.81it/s]100%|██████████| 195/195 [01:40<00:00,  1.95it/s]
2025-08-20 21:05:20 [info     ] Validating outputs
2025-08-20 21:05:20 [info     ] Predict - end                  time=0:1:40
2025-08-20 21:05:20 [info     ] Evaluate - start               split=test
2025-08-20 21:05:20 [info     ] Evaluate - end                 correctness_llm=0.26 monotonicity=0.55
2025-08-20 21:05:20 [info     ] Evaluate question difficulty - start split=test
2025-08-20 21:05:20 [info     ] Augmenting questions for IRT estimation num_questions=8
2025-08-20 21:05:20 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 21:05:20 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 998.54it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3630.71it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 519.27it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6150.01it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1009.08it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3648.28it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 516.92it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6102.71it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 977.37it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3556.58it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 577.07it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6307.22it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1015.82it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3634.09it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 543.11it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5943.35it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1012.91it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3714.98it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 524.64it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6230.93it/s]
2025-08-20 21:05:24 INFO: Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
Likelihood descrease, stops at iteration 5.
2025-08-20 21:05:24 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 21:05:24 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 21:05:24 [info     ] Evaluate question difficulty - end rmse=2.525549982420936 split=test
2025-08-20 21:05:24 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 1 finished: 0:1:54

 ********** Run: 2/3 **********
2025-08-20 21:05:46 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 21:05:46 [info     ] Reading train split questions  num_questions=92
2025-08-20 21:05:46 [info     ] Reading validation split questions num_questions=23
2025-08-20 21:05:46 [info     ] Reading test split questions   num_questions=39
2025-08-20 21:05:48 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 21:05:48 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 21:05:52 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 21:05:52 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 21:05:52 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 21:05:53 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 21:05:56 [info     ] Setting seed                   value=44
2025-08-20 21:05:56 [info     ] Building structured outputter  name=student_kt
2025-08-20 21:05:56 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_random native_structured_output=True num_examples=1 system_prompt=student_chocolate_level_context
2025-08-20 21:05:56 [info     ] Building example selector
2025-08-20 21:05:56 [info     ] Building model                 name=llama3.1:8b provider=ollama rate_limit=None temp=0.0
2025-08-20 21:05:56 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:08<28:18,  8.76s/it]  1%|          | 2/195 [00:09<12:13,  3.80s/it]  2%|▏         | 3/195 [00:10<09:00,  2.82s/it]  2%|▏         | 4/195 [00:11<06:26,  2.02s/it]  3%|▎         | 5/195 [00:12<05:00,  1.58s/it]  4%|▎         | 7/195 [00:13<03:11,  1.02s/it]  4%|▍         | 8/195 [00:13<02:40,  1.17it/s]  5%|▍         | 9/195 [00:14<02:26,  1.27it/s]  5%|▌         | 10/195 [00:14<01:58,  1.57it/s]  6%|▌         | 11/195 [00:15<01:55,  1.60it/s]  6%|▌         | 12/195 [00:15<01:41,  1.80it/s]  7%|▋         | 13/195 [00:15<01:27,  2.08it/s]  7%|▋         | 14/195 [00:16<01:25,  2.13it/s]  8%|▊         | 15/195 [00:16<01:23,  2.15it/s]  8%|▊         | 16/195 [00:17<01:14,  2.39it/s]  9%|▊         | 17/195 [00:17<01:15,  2.36it/s]  9%|▉         | 18/195 [00:17<01:08,  2.60it/s] 10%|▉         | 19/195 [00:18<01:06,  2.66it/s] 10%|█         | 20/195 [00:18<01:10,  2.46it/s] 11%|█         | 21/195 [00:19<01:13,  2.36it/s] 11%|█▏        | 22/195 [00:19<01:09,  2.51it/s] 12%|█▏        | 23/195 [00:19<01:13,  2.35it/s] 13%|█▎        | 25/195 [00:20<01:06,  2.54it/s] 13%|█▎        | 26/195 [00:20<01:04,  2.62it/s] 14%|█▍        | 27/195 [00:21<01:13,  2.30it/s] 14%|█▍        | 28/195 [00:21<01:10,  2.37it/s] 15%|█▍        | 29/195 [00:22<01:07,  2.46it/s] 15%|█▌        | 30/195 [00:22<01:09,  2.38it/s] 16%|█▌        | 31/195 [00:23<01:05,  2.51it/s] 16%|█▋        | 32/195 [00:23<01:19,  2.04it/s] 17%|█▋        | 33/195 [00:24<01:19,  2.04it/s] 17%|█▋        | 34/195 [00:24<01:20,  2.01it/s] 18%|█▊        | 35/195 [00:25<01:20,  1.99it/s] 18%|█▊        | 36/195 [00:25<01:13,  2.15it/s] 19%|█▉        | 37/195 [00:26<01:17,  2.03it/s] 19%|█▉        | 38/195 [00:26<01:11,  2.20it/s] 20%|██        | 39/195 [00:27<01:14,  2.09it/s] 21%|██        | 40/195 [00:27<01:08,  2.25it/s] 21%|██        | 41/195 [00:27<01:05,  2.37it/s] 22%|██▏       | 42/195 [00:28<01:13,  2.08it/s] 22%|██▏       | 43/195 [00:28<01:07,  2.26it/s] 23%|██▎       | 44/195 [00:29<01:16,  1.97it/s] 23%|██▎       | 45/195 [00:29<01:05,  2.29it/s] 24%|██▎       | 46/195 [00:30<01:06,  2.23it/s] 24%|██▍       | 47/195 [00:30<01:07,  2.20it/s] 25%|██▍       | 48/195 [00:31<01:02,  2.36it/s] 25%|██▌       | 49/195 [00:31<00:56,  2.57it/s] 26%|██▌       | 50/195 [00:32<01:09,  2.08it/s] 27%|██▋       | 52/195 [00:33<01:07,  2.13it/s] 27%|██▋       | 53/195 [00:33<00:58,  2.41it/s] 28%|██▊       | 54/195 [00:33<01:10,  2.00it/s] 28%|██▊       | 55/195 [00:34<01:00,  2.30it/s] 29%|██▊       | 56/195 [00:34<01:10,  1.97it/s] 29%|██▉       | 57/195 [00:35<01:00,  2.27it/s] 30%|██▉       | 58/195 [00:35<01:06,  2.06it/s] 30%|███       | 59/195 [00:36<01:02,  2.18it/s] 31%|███       | 60/195 [00:36<00:57,  2.34it/s] 31%|███▏      | 61/195 [00:37<00:57,  2.31it/s] 32%|███▏      | 62/195 [00:37<00:53,  2.48it/s] 32%|███▏      | 63/195 [00:37<00:56,  2.35it/s] 33%|███▎      | 64/195 [00:38<00:49,  2.65it/s] 33%|███▎      | 65/195 [00:38<00:56,  2.31it/s] 34%|███▍      | 67/195 [00:39<00:48,  2.62it/s] 35%|███▌      | 69/195 [00:39<00:44,  2.86it/s] 36%|███▌      | 70/195 [00:40<00:39,  3.15it/s] 36%|███▋      | 71/195 [00:40<00:50,  2.44it/s] 37%|███▋      | 72/195 [00:41<00:50,  2.45it/s] 37%|███▋      | 73/195 [00:41<00:44,  2.74it/s] 38%|███▊      | 74/195 [00:42<00:55,  2.16it/s] 38%|███▊      | 75/195 [00:42<00:49,  2.44it/s] 39%|███▉      | 76/195 [00:42<00:44,  2.70it/s] 39%|███▉      | 77/195 [00:43<00:41,  2.85it/s] 40%|████      | 78/195 [00:43<00:39,  2.99it/s] 41%|████      | 79/195 [00:43<00:35,  3.30it/s] 41%|████      | 80/195 [00:43<00:37,  3.05it/s] 42%|████▏     | 81/195 [00:44<00:39,  2.86it/s] 42%|████▏     | 82/195 [00:44<00:44,  2.56it/s] 43%|████▎     | 83/195 [00:45<00:43,  2.59it/s] 43%|████▎     | 84/195 [00:45<00:47,  2.33it/s] 44%|████▎     | 85/195 [00:46<00:47,  2.32it/s] 44%|████▍     | 86/195 [00:46<00:42,  2.54it/s] 45%|████▍     | 87/195 [00:46<00:41,  2.61it/s] 45%|████▌     | 88/195 [00:47<00:40,  2.63it/s] 46%|████▌     | 89/195 [00:47<00:36,  2.88it/s] 46%|████▌     | 90/195 [00:47<00:39,  2.65it/s] 47%|████▋     | 91/195 [00:48<00:35,  2.95it/s] 47%|████▋     | 92/195 [00:48<00:42,  2.42it/s] 48%|████▊     | 93/195 [00:48<00:34,  2.93it/s] 48%|████▊     | 94/195 [00:49<00:39,  2.55it/s] 49%|████▉     | 96/195 [00:50<00:38,  2.57it/s] 50%|████▉     | 97/195 [00:50<00:32,  2.99it/s] 50%|█████     | 98/195 [00:51<00:42,  2.30it/s] 51%|█████▏    | 100/195 [00:51<00:41,  2.28it/s] 52%|█████▏    | 102/195 [00:52<00:42,  2.16it/s] 53%|█████▎    | 103/195 [00:53<00:38,  2.40it/s] 53%|█████▎    | 104/195 [00:54<00:47,  1.92it/s] 54%|█████▍    | 105/195 [00:54<00:42,  2.10it/s] 54%|█████▍    | 106/195 [00:55<00:50,  1.76it/s] 55%|█████▍    | 107/195 [00:55<00:42,  2.06it/s] 55%|█████▌    | 108/195 [00:56<00:49,  1.75it/s] 56%|█████▋    | 110/195 [00:57<00:45,  1.88it/s] 57%|█████▋    | 112/195 [00:58<00:42,  1.96it/s] 58%|█████▊    | 113/195 [00:58<00:37,  2.20it/s] 58%|█████▊    | 114/195 [00:59<00:38,  2.09it/s] 59%|█████▉    | 115/195 [00:59<00:36,  2.17it/s] 59%|█████▉    | 116/195 [01:00<00:38,  2.05it/s] 60%|██████    | 117/195 [01:00<00:36,  2.13it/s] 61%|██████    | 118/195 [01:00<00:37,  2.04it/s] 61%|██████    | 119/195 [01:01<00:35,  2.14it/s] 62%|██████▏   | 120/195 [01:01<00:34,  2.18it/s] 62%|██████▏   | 121/195 [01:02<00:34,  2.16it/s] 63%|██████▎   | 122/195 [01:02<00:34,  2.14it/s] 63%|██████▎   | 123/195 [01:03<00:34,  2.06it/s] 64%|██████▎   | 124/195 [01:03<00:33,  2.14it/s] 64%|██████▍   | 125/195 [01:04<00:34,  2.05it/s] 65%|██████▍   | 126/195 [01:04<00:30,  2.27it/s] 65%|██████▌   | 127/195 [01:05<00:32,  2.09it/s] 66%|██████▌   | 128/195 [01:05<00:26,  2.50it/s] 66%|██████▌   | 129/195 [01:06<00:31,  2.08it/s] 67%|██████▋   | 130/195 [01:06<00:25,  2.54it/s] 67%|██████▋   | 131/195 [01:06<00:30,  2.07it/s] 68%|██████▊   | 133/195 [01:07<00:28,  2.18it/s] 69%|██████▊   | 134/195 [01:08<00:25,  2.43it/s] 69%|██████▉   | 135/195 [01:08<00:25,  2.34it/s] 70%|██████▉   | 136/195 [01:08<00:22,  2.57it/s] 70%|███████   | 137/195 [01:09<00:23,  2.48it/s] 71%|███████   | 138/195 [01:09<00:22,  2.58it/s] 71%|███████▏  | 139/195 [01:10<00:21,  2.56it/s] 72%|███████▏  | 140/195 [01:10<00:22,  2.48it/s] 72%|███████▏  | 141/195 [01:10<00:20,  2.62it/s] 73%|███████▎  | 142/195 [01:11<00:22,  2.39it/s] 73%|███████▎  | 143/195 [01:11<00:19,  2.72it/s] 74%|███████▍  | 144/195 [01:12<00:20,  2.46it/s] 74%|███████▍  | 145/195 [01:12<00:18,  2.76it/s] 75%|███████▍  | 146/195 [01:12<00:19,  2.52it/s] 75%|███████▌  | 147/195 [01:13<00:18,  2.65it/s] 76%|███████▌  | 148/195 [01:13<00:19,  2.39it/s] 76%|███████▋  | 149/195 [01:13<00:17,  2.59it/s] 77%|███████▋  | 150/195 [01:14<00:19,  2.28it/s] 77%|███████▋  | 151/195 [01:14<00:16,  2.66it/s] 78%|███████▊  | 152/195 [01:15<00:20,  2.10it/s] 79%|███████▉  | 154/195 [01:16<00:16,  2.46it/s] 80%|████████  | 156/195 [01:16<00:16,  2.34it/s] 81%|████████  | 158/195 [01:17<00:15,  2.40it/s] 82%|████████▏ | 160/195 [01:18<00:13,  2.56it/s] 83%|████████▎ | 161/195 [01:18<00:12,  2.69it/s] 83%|████████▎ | 162/195 [01:19<00:12,  2.57it/s] 84%|████████▎ | 163/195 [01:19<00:11,  2.69it/s] 84%|████████▍ | 164/195 [01:19<00:11,  2.60it/s] 85%|████████▍ | 165/195 [01:20<00:10,  2.74it/s] 85%|████████▌ | 166/195 [01:20<00:11,  2.48it/s] 86%|████████▌ | 167/195 [01:21<00:12,  2.23it/s] 86%|████████▌ | 168/195 [01:21<00:09,  2.71it/s] 87%|████████▋ | 169/195 [01:22<00:15,  1.71it/s] 87%|████████▋ | 170/195 [01:22<00:11,  2.19it/s] 88%|████████▊ | 171/195 [01:23<00:10,  2.25it/s] 88%|████████▊ | 172/195 [01:23<00:09,  2.53it/s] 89%|████████▊ | 173/195 [01:24<00:12,  1.75it/s] 90%|████████▉ | 175/195 [01:25<00:10,  1.94it/s] 90%|█████████ | 176/195 [01:25<00:08,  2.21it/s] 91%|█████████ | 177/195 [01:26<00:09,  1.91it/s] 91%|█████████▏| 178/195 [01:26<00:07,  2.31it/s] 92%|█████████▏| 179/195 [01:27<00:08,  1.92it/s] 93%|█████████▎| 181/195 [01:28<00:06,  2.20it/s] 93%|█████████▎| 182/195 [01:28<00:05,  2.56it/s] 94%|█████████▍| 183/195 [01:28<00:05,  2.34it/s] 94%|█████████▍| 184/195 [01:28<00:04,  2.63it/s] 95%|█████████▍| 185/195 [01:29<00:04,  2.40it/s] 95%|█████████▌| 186/195 [01:29<00:03,  2.40it/s] 96%|█████████▌| 187/195 [01:30<00:03,  2.34it/s] 96%|█████████▋| 188/195 [01:31<00:03,  2.05it/s] 97%|█████████▋| 189/195 [01:31<00:02,  2.49it/s] 97%|█████████▋| 190/195 [01:31<00:02,  2.15it/s] 98%|█████████▊| 192/195 [01:32<00:01,  2.40it/s] 99%|█████████▉| 193/195 [01:32<00:00,  2.46it/s] 99%|█████████▉| 194/195 [01:33<00:00,  2.49it/s]100%|██████████| 195/195 [01:33<00:00,  2.85it/s]100%|██████████| 195/195 [01:35<00:00,  2.04it/s]
2025-08-20 21:07:32 [info     ] Validating outputs
2025-08-20 21:07:32 [info     ] Predict - end                  time=0:1:35
2025-08-20 21:07:32 [info     ] Evaluate - start               split=test
2025-08-20 21:07:32 [info     ] Evaluate - end                 correctness_llm=0.25 monotonicity=0.66
2025-08-20 21:07:32 [info     ] Evaluate question difficulty - start split=test
2025-08-20 21:07:32 [info     ] Augmenting questions for IRT estimation num_questions=7
2025-08-20 21:07:32 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 21:07:32 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1044.10it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3753.08it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 522.07it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6697.11it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1101.40it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3490.18it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 497.02it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7013.89it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1006.41it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3500.26it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 577.45it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7071.32it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1105.30it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3747.66it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 651.29it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7171.50it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 982.40it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3780.49it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 606.25it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6103.98it/s]
2025-08-20 21:07:35 INFO: EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
2025-08-20 21:07:35 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 21:07:35 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 21:07:35 [info     ] Evaluate question difficulty - end rmse=2.998302434488271 split=test
2025-08-20 21:07:35 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 2 finished: 0:1:49

 ********** Run: 3/3 **********
2025-08-20 21:07:55 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 21:07:55 [info     ] Reading train split questions  num_questions=92
2025-08-20 21:07:55 [info     ] Reading validation split questions num_questions=23
2025-08-20 21:07:55 [info     ] Reading test split questions   num_questions=39
2025-08-20 21:07:57 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 21:07:57 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 21:08:01 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 21:08:01 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 21:08:01 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 21:08:02 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 21:08:05 [info     ] Setting seed                   value=45
2025-08-20 21:08:05 [info     ] Building structured outputter  name=student_kt
2025-08-20 21:08:05 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_random native_structured_output=True num_examples=1 system_prompt=student_chocolate_level_context
2025-08-20 21:08:05 [info     ] Building example selector
2025-08-20 21:08:05 [info     ] Building model                 name=llama3.1:8b provider=ollama rate_limit=None temp=0.0
2025-08-20 21:08:05 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:08<28:51,  8.92s/it]  1%|          | 2/195 [00:09<12:22,  3.85s/it]  2%|▏         | 3/195 [00:10<09:01,  2.82s/it]  2%|▏         | 4/195 [00:11<05:52,  1.84s/it]  3%|▎         | 5/195 [00:12<04:49,  1.53s/it]  3%|▎         | 6/195 [00:12<03:42,  1.18s/it]  4%|▎         | 7/195 [00:13<02:57,  1.06it/s]  4%|▍         | 8/195 [00:13<02:30,  1.25it/s]  5%|▍         | 9/195 [00:13<02:02,  1.51it/s]  5%|▌         | 10/195 [00:14<01:55,  1.60it/s]  6%|▌         | 11/195 [00:14<01:33,  1.96it/s]  6%|▌         | 12/195 [00:15<01:40,  1.81it/s]  7%|▋         | 13/195 [00:15<01:20,  2.25it/s]  7%|▋         | 14/195 [00:16<01:37,  1.86it/s]  8%|▊         | 16/195 [00:17<01:29,  2.01it/s]  9%|▉         | 18/195 [00:18<01:21,  2.18it/s] 10%|█         | 20/195 [00:18<01:13,  2.40it/s] 11%|█         | 21/195 [00:18<01:04,  2.68it/s] 11%|█▏        | 22/195 [00:19<01:07,  2.57it/s] 12%|█▏        | 23/195 [00:19<00:57,  2.98it/s] 12%|█▏        | 24/195 [00:20<01:05,  2.62it/s] 13%|█▎        | 26/195 [00:20<01:10,  2.41it/s] 14%|█▍        | 28/195 [00:21<01:07,  2.49it/s] 15%|█▍        | 29/195 [00:21<00:59,  2.81it/s] 15%|█▌        | 30/195 [00:22<01:08,  2.40it/s] 16%|█▌        | 31/195 [00:22<01:03,  2.60it/s] 16%|█▋        | 32/195 [00:23<01:18,  2.07it/s] 17%|█▋        | 33/195 [00:24<01:17,  2.09it/s] 17%|█▋        | 34/195 [00:24<01:28,  1.83it/s] 18%|█▊        | 35/195 [00:25<01:19,  2.01it/s] 18%|█▊        | 36/195 [00:25<01:17,  2.05it/s] 19%|█▉        | 37/195 [00:25<01:10,  2.25it/s] 19%|█▉        | 38/195 [00:26<01:15,  2.07it/s] 20%|██        | 39/195 [00:26<01:08,  2.29it/s] 21%|██        | 40/195 [00:27<01:20,  1.93it/s] 21%|██        | 41/195 [00:27<01:04,  2.37it/s] 22%|██▏       | 42/195 [00:28<01:27,  1.75it/s] 23%|██▎       | 44/195 [00:29<01:21,  1.86it/s] 24%|██▎       | 46/195 [00:30<01:15,  1.97it/s] 25%|██▍       | 48/195 [00:31<01:12,  2.03it/s] 26%|██▌       | 50/195 [00:32<01:11,  2.03it/s] 26%|██▌       | 51/195 [00:33<01:13,  1.96it/s] 27%|██▋       | 52/195 [00:33<01:08,  2.09it/s] 27%|██▋       | 53/195 [00:34<01:15,  1.88it/s] 28%|██▊       | 54/195 [00:34<01:06,  2.11it/s] 28%|██▊       | 55/195 [00:35<01:13,  1.90it/s] 29%|██▉       | 57/195 [00:36<01:07,  2.04it/s] 30%|██▉       | 58/195 [00:36<00:59,  2.32it/s] 30%|███       | 59/195 [00:36<01:06,  2.04it/s] 31%|███▏      | 61/195 [00:37<00:58,  2.31it/s] 32%|███▏      | 62/195 [00:37<00:50,  2.65it/s] 32%|███▏      | 63/195 [00:38<00:55,  2.37it/s] 33%|███▎      | 64/195 [00:38<00:47,  2.77it/s] 33%|███▎      | 65/195 [00:39<00:52,  2.45it/s] 34%|███▍      | 67/195 [00:39<00:43,  2.91it/s] 35%|███▍      | 68/195 [00:39<00:39,  3.19it/s] 35%|███▌      | 69/195 [00:40<00:40,  3.10it/s] 36%|███▌      | 70/195 [00:40<00:37,  3.30it/s] 36%|███▋      | 71/195 [00:41<00:48,  2.58it/s] 37%|███▋      | 73/195 [00:41<00:43,  2.80it/s] 38%|███▊      | 74/195 [00:42<00:53,  2.27it/s] 38%|███▊      | 75/195 [00:42<00:53,  2.24it/s] 39%|███▉      | 76/195 [00:43<00:44,  2.66it/s] 39%|███▉      | 77/195 [00:43<00:44,  2.63it/s] 40%|████      | 78/195 [00:43<00:39,  2.99it/s] 41%|████      | 79/195 [00:44<00:40,  2.90it/s] 41%|████      | 80/195 [00:44<00:37,  3.04it/s] 42%|████▏     | 81/195 [00:44<00:45,  2.50it/s] 42%|████▏     | 82/195 [00:45<00:46,  2.45it/s] 43%|████▎     | 83/195 [00:45<00:45,  2.44it/s] 43%|████▎     | 84/195 [00:46<00:41,  2.67it/s] 44%|████▎     | 85/195 [00:46<00:43,  2.55it/s] 44%|████▍     | 86/195 [00:46<00:40,  2.72it/s] 45%|████▍     | 87/195 [00:47<00:39,  2.72it/s] 45%|████▌     | 88/195 [00:47<00:41,  2.58it/s] 46%|████▌     | 89/195 [00:47<00:36,  2.93it/s] 46%|████▌     | 90/195 [00:48<00:41,  2.55it/s] 47%|████▋     | 91/195 [00:48<00:34,  2.98it/s] 47%|████▋     | 92/195 [00:49<00:41,  2.45it/s] 48%|████▊     | 94/195 [00:49<00:38,  2.65it/s] 49%|████▊     | 95/195 [00:49<00:33,  3.01it/s] 49%|████▉     | 96/195 [00:50<00:36,  2.71it/s] 50%|████▉     | 97/195 [00:50<00:31,  3.10it/s] 50%|█████     | 98/195 [00:51<00:42,  2.28it/s] 51%|█████▏    | 100/195 [00:52<00:41,  2.27it/s] 52%|█████▏    | 101/195 [00:52<00:39,  2.36it/s] 52%|█████▏    | 102/195 [00:53<00:45,  2.04it/s] 53%|█████▎    | 103/195 [00:53<00:42,  2.15it/s] 53%|█████▎    | 104/195 [00:54<00:47,  1.92it/s] 54%|█████▍    | 105/195 [00:54<00:43,  2.08it/s] 54%|█████▍    | 106/195 [00:55<00:45,  1.95it/s] 55%|█████▍    | 107/195 [00:55<00:44,  1.96it/s] 55%|█████▌    | 108/195 [00:56<00:47,  1.82it/s] 56%|█████▌    | 109/195 [00:56<00:42,  2.03it/s] 56%|█████▋    | 110/195 [00:57<00:48,  1.76it/s] 57%|█████▋    | 111/195 [00:58<00:44,  1.89it/s] 57%|█████▋    | 112/195 [00:58<00:45,  1.81it/s] 58%|█████▊    | 113/195 [00:59<00:44,  1.86it/s] 58%|█████▊    | 114/195 [00:59<00:43,  1.87it/s] 59%|█████▉    | 115/195 [01:00<00:40,  2.00it/s] 59%|█████▉    | 116/195 [01:00<00:40,  1.93it/s] 60%|██████    | 117/195 [01:01<00:38,  2.05it/s] 61%|██████    | 118/195 [01:01<00:38,  2.01it/s] 61%|██████    | 119/195 [01:02<00:36,  2.07it/s] 62%|██████▏   | 120/195 [01:02<00:36,  2.07it/s] 62%|██████▏   | 121/195 [01:03<00:36,  2.01it/s] 63%|██████▎   | 122/195 [01:03<00:34,  2.09it/s] 63%|██████▎   | 123/195 [01:04<00:36,  2.00it/s] 64%|██████▎   | 124/195 [01:04<00:32,  2.16it/s] 64%|██████▍   | 125/195 [01:04<00:34,  2.06it/s] 65%|██████▍   | 126/195 [01:05<00:29,  2.35it/s] 65%|██████▌   | 127/195 [01:05<00:34,  2.00it/s] 66%|██████▌   | 129/195 [01:06<00:32,  2.01it/s] 67%|██████▋   | 130/195 [01:07<00:27,  2.35it/s] 67%|██████▋   | 131/195 [01:07<00:30,  2.09it/s] 68%|██████▊   | 132/195 [01:08<00:27,  2.26it/s] 68%|██████▊   | 133/195 [01:08<00:29,  2.10it/s] 69%|██████▊   | 134/195 [01:09<00:27,  2.19it/s] 69%|██████▉   | 135/195 [01:09<00:26,  2.24it/s] 70%|██████▉   | 136/195 [01:09<00:24,  2.40it/s] 70%|███████   | 137/195 [01:10<00:23,  2.50it/s] 71%|███████   | 138/195 [01:10<00:21,  2.67it/s] 71%|███████▏  | 139/195 [01:10<00:22,  2.54it/s] 72%|███████▏  | 140/195 [01:11<00:20,  2.73it/s] 72%|███████▏  | 141/195 [01:11<00:19,  2.79it/s] 73%|███████▎  | 142/195 [01:12<00:21,  2.49it/s] 73%|███████▎  | 143/195 [01:12<00:17,  2.93it/s] 74%|███████▍  | 144/195 [01:12<00:20,  2.51it/s] 74%|███████▍  | 145/195 [01:12<00:15,  3.15it/s] 75%|███████▍  | 146/195 [01:13<00:20,  2.39it/s] 76%|███████▌  | 148/195 [01:14<00:19,  2.37it/s] 76%|███████▋  | 149/195 [01:14<00:16,  2.79it/s] 77%|███████▋  | 150/195 [01:15<00:20,  2.19it/s] 78%|███████▊  | 152/195 [01:16<00:18,  2.28it/s] 79%|███████▉  | 154/195 [01:16<00:15,  2.60it/s] 80%|████████  | 156/195 [01:17<00:15,  2.55it/s] 81%|████████  | 157/195 [01:17<00:13,  2.88it/s] 81%|████████  | 158/195 [01:18<00:14,  2.48it/s] 82%|████████▏ | 160/195 [01:19<00:14,  2.48it/s] 83%|████████▎ | 162/195 [01:19<00:12,  2.58it/s] 84%|████████▎ | 163/195 [01:20<00:10,  2.94it/s] 84%|████████▍ | 164/195 [01:20<00:11,  2.61it/s] 85%|████████▍ | 165/195 [01:20<00:10,  2.80it/s] 85%|████████▌ | 166/195 [01:21<00:11,  2.45it/s] 86%|████████▌ | 167/195 [01:22<00:14,  1.96it/s] 87%|████████▋ | 169/195 [01:23<00:14,  1.76it/s] 87%|████████▋ | 170/195 [01:23<00:11,  2.09it/s] 88%|████████▊ | 171/195 [01:24<00:11,  2.04it/s] 88%|████████▊ | 172/195 [01:24<00:11,  1.99it/s] 89%|████████▊ | 173/195 [01:25<00:10,  2.02it/s] 89%|████████▉ | 174/195 [01:25<00:10,  1.93it/s] 90%|█████████ | 176/195 [01:26<00:08,  2.22it/s] 91%|█████████ | 177/195 [01:26<00:07,  2.57it/s] 91%|█████████▏| 178/195 [01:27<00:07,  2.20it/s] 92%|█████████▏| 179/195 [01:27<00:06,  2.55it/s] 92%|█████████▏| 180/195 [01:28<00:06,  2.40it/s] 93%|█████████▎| 181/195 [01:28<00:05,  2.64it/s] 93%|█████████▎| 182/195 [01:28<00:05,  2.55it/s] 94%|█████████▍| 183/195 [01:29<00:04,  2.78it/s] 94%|█████████▍| 184/195 [01:29<00:04,  2.62it/s] 95%|█████████▍| 185/195 [01:29<00:03,  2.83it/s] 95%|█████████▌| 186/195 [01:30<00:03,  2.35it/s] 96%|█████████▌| 187/195 [01:30<00:03,  2.18it/s] 96%|█████████▋| 188/195 [01:31<00:03,  2.03it/s] 97%|█████████▋| 189/195 [01:32<00:03,  1.91it/s] 97%|█████████▋| 190/195 [01:32<00:02,  1.97it/s] 98%|█████████▊| 191/195 [01:32<00:01,  2.09it/s] 98%|█████████▊| 192/195 [01:33<00:01,  2.16it/s] 99%|█████████▉| 193/195 [01:33<00:00,  2.12it/s] 99%|█████████▉| 194/195 [01:34<00:00,  2.32it/s]100%|██████████| 195/195 [01:34<00:00,  2.51it/s]100%|██████████| 195/195 [01:36<00:00,  2.02it/s]
2025-08-20 21:09:42 [info     ] Validating outputs
2025-08-20 21:09:42 [info     ] Predict - end                  time=0:1:36
2025-08-20 21:09:42 [info     ] Evaluate - start               split=test
2025-08-20 21:09:42 [info     ] Evaluate - end                 correctness_llm=0.24 monotonicity=0.44
2025-08-20 21:09:42 [info     ] Evaluate question difficulty - start split=test
2025-08-20 21:09:42 [info     ] Augmenting questions for IRT estimation num_questions=5
2025-08-20 21:09:42 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 21:09:42 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1081.01it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3211.88it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 528.99it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5805.84it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1034.14it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3567.67it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 502.82it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5788.67it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1080.13it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3487.58it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 555.35it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5983.32it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1007.93it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3559.99it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 534.74it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6110.33it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1021.19it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3669.31it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 571.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6396.54it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1419.67it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3817.99it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 625.71it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6134.59it/s]
2025-08-20 21:09:47 INFO: Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
Likelihood descrease, stops at iteration 6.
2025-08-20 21:09:47 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 21:09:47 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 21:09:47 [info     ] Evaluate question difficulty - end rmse=2.4466852513979496 split=test
2025-08-20 21:09:47 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 3 finished: 0:1:51

 ========== Config: qwen3:4b~T_0.0~SO_student_kt~L_5~SP_student_chocolate_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_miscon_studentlevel_kc_exact3 ==========
Config 6/8

 ********** Run: 1/3 **********
2025-08-20 21:10:06 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 21:10:06 [info     ] Reading train split questions  num_questions=92
2025-08-20 21:10:06 [info     ] Reading validation split questions num_questions=23
2025-08-20 21:10:06 [info     ] Reading test split questions   num_questions=39
2025-08-20 21:10:07 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 21:10:07 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 21:10:12 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 21:10:12 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 21:10:12 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 21:10:13 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 21:10:16 [info     ] Setting seed                   value=43
2025-08-20 21:10:16 [info     ] Building structured outputter  name=student_kt
2025-08-20 21:10:16 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_kc_exact native_structured_output=True num_examples=3 system_prompt=student_chocolate_level_context
2025-08-20 21:10:16 [info     ] Building example selector
2025-08-20 21:10:16 [info     ] Building model                 name=qwen3:4b provider=ollama rate_limit=None temp=0.0
2025-08-20 21:10:16 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:13<44:55, 13.89s/it]  2%|▏         | 3/195 [00:15<13:11,  4.12s/it]  2%|▏         | 4/195 [00:15<08:51,  2.78s/it]  3%|▎         | 5/195 [00:16<06:48,  2.15s/it]  4%|▎         | 7/195 [00:17<04:00,  1.28s/it]  5%|▍         | 9/195 [00:17<02:46,  1.11it/s]  6%|▌         | 11/195 [00:18<02:00,  1.53it/s]  6%|▌         | 12/195 [00:18<01:40,  1.82it/s]  7%|▋         | 13/195 [00:18<01:30,  2.02it/s]  7%|▋         | 14/195 [00:18<01:16,  2.37it/s]  8%|▊         | 15/195 [00:19<01:08,  2.64it/s]  8%|▊         | 16/195 [00:19<00:57,  3.12it/s]  9%|▊         | 17/195 [00:19<00:57,  3.11it/s]  9%|▉         | 18/195 [00:19<00:49,  3.59it/s] 10%|▉         | 19/195 [00:20<00:51,  3.41it/s] 10%|█         | 20/195 [00:20<00:44,  3.89it/s] 11%|█         | 21/195 [00:20<00:50,  3.41it/s] 11%|█▏        | 22/195 [00:20<00:44,  3.85it/s] 12%|█▏        | 23/195 [00:21<00:45,  3.82it/s] 12%|█▏        | 24/195 [00:21<00:42,  4.00it/s] 13%|█▎        | 25/195 [00:21<00:41,  4.12it/s] 13%|█▎        | 26/195 [00:21<00:43,  3.89it/s] 14%|█▍        | 27/195 [00:22<00:48,  3.46it/s] 14%|█▍        | 28/195 [00:22<00:50,  3.30it/s] 15%|█▍        | 29/195 [00:22<00:51,  3.22it/s] 15%|█▌        | 30/195 [00:23<00:49,  3.36it/s] 16%|█▌        | 31/195 [00:23<00:49,  3.34it/s] 16%|█▋        | 32/195 [00:23<00:50,  3.23it/s] 17%|█▋        | 33/195 [00:24<00:51,  3.12it/s] 17%|█▋        | 34/195 [00:24<00:48,  3.34it/s] 18%|█▊        | 35/195 [00:24<00:50,  3.17it/s] 18%|█▊        | 36/195 [00:24<00:43,  3.69it/s] 19%|█▉        | 37/195 [00:25<00:43,  3.60it/s] 19%|█▉        | 38/195 [00:25<00:40,  3.91it/s] 20%|██        | 39/195 [00:25<00:41,  3.79it/s] 21%|██        | 40/195 [00:26<00:39,  3.89it/s] 21%|██        | 41/195 [00:26<00:38,  4.01it/s] 22%|██▏       | 42/195 [00:26<00:40,  3.79it/s] 22%|██▏       | 43/195 [00:26<00:37,  4.06it/s] 23%|██▎       | 44/195 [00:27<00:41,  3.64it/s] 23%|██▎       | 45/195 [00:27<00:36,  4.06it/s] 24%|██▎       | 46/195 [00:27<00:38,  3.85it/s] 24%|██▍       | 47/195 [00:27<00:33,  4.38it/s] 25%|██▍       | 48/195 [00:28<00:39,  3.74it/s] 26%|██▌       | 50/195 [00:28<00:39,  3.68it/s] 27%|██▋       | 52/195 [00:29<00:41,  3.45it/s] 28%|██▊       | 54/195 [00:29<00:41,  3.37it/s] 28%|██▊       | 55/195 [00:30<00:39,  3.54it/s] 29%|██▊       | 56/195 [00:30<00:44,  3.12it/s] 29%|██▉       | 57/195 [00:30<00:40,  3.41it/s] 30%|██▉       | 58/195 [00:31<00:44,  3.05it/s] 30%|███       | 59/195 [00:31<00:40,  3.38it/s] 31%|███       | 60/195 [00:31<00:42,  3.15it/s] 32%|███▏      | 62/195 [00:32<00:38,  3.46it/s] 33%|███▎      | 64/195 [00:32<00:35,  3.73it/s] 34%|███▍      | 66/195 [00:33<00:32,  3.93it/s] 34%|███▍      | 67/195 [00:33<00:29,  4.29it/s] 35%|███▍      | 68/195 [00:33<00:31,  3.97it/s] 35%|███▌      | 69/195 [00:33<00:28,  4.35it/s] 36%|███▌      | 70/195 [00:34<00:31,  3.98it/s] 36%|███▋      | 71/195 [00:34<00:30,  4.07it/s] 37%|███▋      | 72/195 [00:34<00:30,  4.02it/s] 37%|███▋      | 73/195 [00:34<00:30,  3.96it/s] 38%|███▊      | 74/195 [00:35<00:31,  3.83it/s] 38%|███▊      | 75/195 [00:35<00:33,  3.57it/s] 39%|███▉      | 76/195 [00:35<00:28,  4.18it/s] 39%|███▉      | 77/195 [00:35<00:31,  3.72it/s] 40%|████      | 78/195 [00:36<00:26,  4.48it/s] 41%|████      | 79/195 [00:36<00:33,  3.51it/s] 42%|████▏     | 81/195 [00:36<00:29,  3.89it/s] 42%|████▏     | 82/195 [00:37<00:26,  4.31it/s] 43%|████▎     | 83/195 [00:37<00:27,  4.06it/s] 43%|████▎     | 84/195 [00:37<00:25,  4.43it/s] 44%|████▎     | 85/195 [00:37<00:26,  4.08it/s] 44%|████▍     | 86/195 [00:38<00:26,  4.08it/s] 45%|████▍     | 87/195 [00:38<00:25,  4.26it/s] 45%|████▌     | 88/195 [00:38<00:27,  3.94it/s] 46%|████▌     | 89/195 [00:38<00:23,  4.46it/s] 46%|████▌     | 90/195 [00:39<00:27,  3.88it/s] 47%|████▋     | 92/195 [00:39<00:25,  4.11it/s] 48%|████▊     | 93/195 [00:39<00:22,  4.47it/s] 48%|████▊     | 94/195 [00:40<00:26,  3.82it/s] 49%|████▊     | 95/195 [00:40<00:23,  4.25it/s] 49%|████▉     | 96/195 [00:40<00:25,  3.82it/s] 50%|████▉     | 97/195 [00:40<00:23,  4.22it/s] 50%|█████     | 98/195 [00:41<00:25,  3.79it/s] 51%|█████     | 99/195 [00:41<00:22,  4.22it/s] 51%|█████▏    | 100/195 [00:41<00:28,  3.34it/s] 52%|█████▏    | 101/195 [00:42<00:29,  3.23it/s] 52%|█████▏    | 102/195 [00:42<00:32,  2.90it/s] 53%|█████▎    | 103/195 [00:42<00:32,  2.83it/s] 53%|█████▎    | 104/195 [00:43<00:32,  2.83it/s] 54%|█████▍    | 105/195 [00:43<00:33,  2.72it/s] 54%|█████▍    | 106/195 [00:43<00:30,  2.91it/s] 55%|█████▍    | 107/195 [00:44<00:32,  2.69it/s] 55%|█████▌    | 108/195 [00:44<00:28,  3.06it/s] 56%|█████▌    | 109/195 [00:45<00:32,  2.67it/s] 57%|█████▋    | 111/195 [00:45<00:31,  2.71it/s] 58%|█████▊    | 113/195 [00:46<00:30,  2.72it/s] 59%|█████▉    | 115/195 [00:47<00:29,  2.71it/s] 60%|██████    | 117/195 [00:47<00:28,  2.73it/s] 61%|██████    | 119/195 [00:48<00:27,  2.80it/s] 62%|██████▏   | 121/195 [00:49<00:24,  3.01it/s] 63%|██████▎   | 122/195 [00:49<00:22,  3.30it/s] 63%|██████▎   | 123/195 [00:49<00:23,  3.11it/s] 64%|██████▍   | 125/195 [00:50<00:21,  3.23it/s] 65%|██████▍   | 126/195 [00:50<00:19,  3.46it/s] 65%|██████▌   | 127/195 [00:50<00:20,  3.29it/s] 66%|██████▌   | 129/195 [00:51<00:19,  3.44it/s] 67%|██████▋   | 130/195 [00:51<00:17,  3.69it/s] 67%|██████▋   | 131/195 [00:52<00:19,  3.24it/s] 68%|██████▊   | 132/195 [00:52<00:17,  3.58it/s] 68%|██████▊   | 133/195 [00:52<00:19,  3.24it/s] 69%|██████▊   | 134/195 [00:52<00:16,  3.66it/s] 69%|██████▉   | 135/195 [00:53<00:17,  3.45it/s] 70%|███████   | 137/195 [00:53<00:16,  3.59it/s] 71%|███████▏  | 139/195 [00:54<00:15,  3.72it/s] 72%|███████▏  | 140/195 [00:54<00:13,  4.13it/s] 72%|███████▏  | 141/195 [00:54<00:14,  3.82it/s] 73%|███████▎  | 143/195 [00:55<00:13,  3.91it/s] 74%|███████▍  | 145/195 [00:55<00:12,  4.01it/s] 75%|███████▌  | 147/195 [00:56<00:11,  4.10it/s] 76%|███████▌  | 148/195 [00:56<00:10,  4.42it/s] 76%|███████▋  | 149/195 [00:56<00:11,  4.07it/s] 77%|███████▋  | 150/195 [00:56<00:10,  4.19it/s] 77%|███████▋  | 151/195 [00:57<00:11,  3.67it/s] 78%|███████▊  | 152/195 [00:57<00:10,  3.95it/s] 78%|███████▊  | 153/195 [00:57<00:12,  3.45it/s] 79%|███████▉  | 154/195 [00:58<00:11,  3.54it/s] 79%|███████▉  | 155/195 [00:58<00:11,  3.63it/s] 80%|████████  | 156/195 [00:58<00:10,  3.84it/s] 81%|████████  | 157/195 [00:58<00:09,  4.06it/s] 81%|████████  | 158/195 [00:59<00:09,  3.88it/s] 82%|████████▏ | 159/195 [00:59<00:08,  4.26it/s] 82%|████████▏ | 160/195 [00:59<00:08,  3.95it/s] 83%|████████▎ | 161/195 [00:59<00:07,  4.30it/s] 83%|████████▎ | 162/195 [00:59<00:08,  3.93it/s] 84%|████████▎ | 163/195 [01:00<00:07,  4.34it/s] 84%|████████▍ | 164/195 [01:00<00:07,  4.04it/s] 85%|████████▍ | 165/195 [01:00<00:06,  4.37it/s] 85%|████████▌ | 166/195 [01:00<00:07,  3.88it/s] 86%|████████▌ | 167/195 [01:01<00:06,  4.25it/s] 86%|████████▌ | 168/195 [01:01<00:07,  3.85it/s] 87%|████████▋ | 169/195 [01:01<00:06,  4.28it/s] 87%|████████▋ | 170/195 [01:01<00:06,  3.79it/s] 88%|████████▊ | 171/195 [01:02<00:05,  4.31it/s] 88%|████████▊ | 172/195 [01:02<00:06,  3.76it/s] 89%|████████▉ | 174/195 [01:03<00:05,  3.70it/s] 90%|████████▉ | 175/195 [01:03<00:04,  4.08it/s] 90%|█████████ | 176/195 [01:03<00:05,  3.56it/s] 91%|█████████ | 177/195 [01:03<00:04,  3.85it/s] 91%|█████████▏| 178/195 [01:04<00:04,  3.52it/s] 92%|█████████▏| 179/195 [01:04<00:04,  3.89it/s] 92%|█████████▏| 180/195 [01:04<00:04,  3.64it/s] 93%|█████████▎| 181/195 [01:04<00:03,  3.99it/s] 93%|█████████▎| 182/195 [01:05<00:03,  3.50it/s] 94%|█████████▍| 183/195 [01:05<00:03,  3.92it/s] 94%|█████████▍| 184/195 [01:05<00:02,  3.70it/s] 95%|█████████▍| 185/195 [01:05<00:02,  3.85it/s] 95%|█████████▌| 186/195 [01:06<00:02,  3.91it/s] 96%|█████████▌| 187/195 [01:06<00:01,  4.04it/s] 96%|█████████▋| 188/195 [01:06<00:01,  4.05it/s] 97%|█████████▋| 189/195 [01:06<00:01,  3.95it/s] 97%|█████████▋| 190/195 [01:07<00:01,  4.18it/s] 98%|█████████▊| 191/195 [01:07<00:01,  3.93it/s] 98%|█████████▊| 192/195 [01:07<00:00,  4.00it/s] 99%|█████████▉| 193/195 [01:08<00:00,  3.54it/s] 99%|█████████▉| 194/195 [01:08<00:00,  3.94it/s]100%|██████████| 195/195 [01:08<00:00,  4.57it/s]100%|██████████| 195/195 [01:10<00:00,  2.76it/s]
2025-08-20 21:11:27 [info     ] Validating outputs
2025-08-20 21:11:27 [info     ] Predict - end                  time=0:1:10
2025-08-20 21:11:27 [info     ] Evaluate - start               split=test
2025-08-20 21:11:27 [info     ] Evaluate - end                 correctness_llm=0.23 monotonicity=0.93
2025-08-20 21:11:27 [info     ] Evaluate question difficulty - start split=test
2025-08-20 21:11:27 [info     ] Augmenting questions for IRT estimation num_questions=2
2025-08-20 21:11:27 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 21:11:27 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1107.72it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3693.84it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 521.02it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6514.34it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1133.33it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3780.57it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 497.93it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6805.78it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1026.58it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3520.83it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 516.12it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6430.16it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1142.60it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3712.19it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 553.34it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6826.35it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 952.14it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3669.47it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 564.28it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6458.45it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1077.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3727.93it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 570.10it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6712.42it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1095.81it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3819.86it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 556.12it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7431.06it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1210.38it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3961.49it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 572.48it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6949.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1031.27it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3751.27it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 540.76it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6547.75it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1096.18it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3728.70it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 579.04it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6680.35it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1100.00it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3679.30it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 583.39it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6859.84it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1232.63it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3631.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 627.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7369.51it/s]
2025-08-20 21:11:36 INFO: EM converged at iteration 12.
EM converged at iteration 12.
EM converged at iteration 12.
EM converged at iteration 12.
EM converged at iteration 12.
EM converged at iteration 12.
EM converged at iteration 12.
EM converged at iteration 12.
EM converged at iteration 12.
EM converged at iteration 12.
EM converged at iteration 12.
EM converged at iteration 12.
EM converged at iteration 12.
EM converged at iteration 12.
EM converged at iteration 12.
EM converged at iteration 12.
EM converged at iteration 12.
2025-08-20 21:11:36 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 21:11:36 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 21:11:36 [info     ] Evaluate question difficulty - end rmse=2.5623475534369695 split=test
2025-08-20 21:11:36 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 1 finished: 0:1:30

 ********** Run: 2/3 **********
2025-08-20 21:11:50 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 21:11:50 [info     ] Reading train split questions  num_questions=92
2025-08-20 21:11:50 [info     ] Reading validation split questions num_questions=23
2025-08-20 21:11:50 [info     ] Reading test split questions   num_questions=39
2025-08-20 21:11:52 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 21:11:52 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 21:11:56 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 21:11:56 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 21:11:56 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 21:11:57 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 21:12:00 [info     ] Setting seed                   value=44
2025-08-20 21:12:00 [info     ] Building structured outputter  name=student_kt
2025-08-20 21:12:00 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_kc_exact native_structured_output=True num_examples=3 system_prompt=student_chocolate_level_context
2025-08-20 21:12:00 [info     ] Building example selector
2025-08-20 21:12:00 [info     ] Building model                 name=qwen3:4b provider=ollama rate_limit=None temp=0.0
2025-08-20 21:12:00 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:11<37:46, 11.68s/it]  2%|▏         | 3/195 [00:12<10:50,  3.39s/it]  2%|▏         | 4/195 [00:13<07:52,  2.48s/it]  3%|▎         | 5/195 [00:14<06:06,  1.93s/it]  3%|▎         | 6/195 [00:14<04:32,  1.44s/it]  4%|▎         | 7/195 [00:14<03:22,  1.08s/it]  4%|▍         | 8/195 [00:15<02:41,  1.15it/s]  5%|▍         | 9/195 [00:15<02:04,  1.49it/s]  5%|▌         | 10/195 [00:15<01:49,  1.69it/s]  6%|▌         | 12/195 [00:16<01:17,  2.35it/s]  7%|▋         | 13/195 [00:16<01:04,  2.80it/s]  7%|▋         | 14/195 [00:16<01:03,  2.83it/s]  8%|▊         | 15/195 [00:17<00:54,  3.32it/s]  8%|▊         | 16/195 [00:17<00:53,  3.35it/s]  9%|▊         | 17/195 [00:17<00:46,  3.79it/s]  9%|▉         | 18/195 [00:17<00:47,  3.73it/s] 10%|▉         | 19/195 [00:18<00:45,  3.89it/s] 10%|█         | 20/195 [00:18<00:43,  4.05it/s] 11%|█         | 21/195 [00:18<00:45,  3.85it/s] 11%|█▏        | 22/195 [00:18<00:41,  4.18it/s] 12%|█▏        | 23/195 [00:19<00:43,  3.97it/s] 12%|█▏        | 24/195 [00:19<00:39,  4.32it/s] 13%|█▎        | 25/195 [00:19<00:42,  3.99it/s] 13%|█▎        | 26/195 [00:19<00:47,  3.56it/s] 14%|█▍        | 27/195 [00:20<00:41,  4.00it/s] 14%|█▍        | 28/195 [00:20<00:43,  3.81it/s] 15%|█▍        | 29/195 [00:20<00:41,  3.96it/s] 15%|█▌        | 30/195 [00:21<00:50,  3.27it/s] 16%|█▌        | 31/195 [00:21<00:48,  3.41it/s] 16%|█▋        | 32/195 [00:21<00:51,  3.14it/s] 17%|█▋        | 33/195 [00:21<00:46,  3.49it/s] 17%|█▋        | 34/195 [00:22<00:50,  3.18it/s] 18%|█▊        | 35/195 [00:22<00:46,  3.41it/s] 18%|█▊        | 36/195 [00:22<00:45,  3.47it/s] 19%|█▉        | 37/195 [00:23<00:51,  3.10it/s] 20%|██        | 39/195 [00:23<00:44,  3.54it/s] 21%|██        | 40/195 [00:23<00:39,  3.94it/s] 21%|██        | 41/195 [00:24<00:43,  3.57it/s] 22%|██▏       | 42/195 [00:24<00:38,  3.93it/s] 22%|██▏       | 43/195 [00:24<00:40,  3.79it/s] 23%|██▎       | 44/195 [00:24<00:39,  3.87it/s] 23%|██▎       | 45/195 [00:25<00:37,  4.03it/s] 24%|██▎       | 46/195 [00:25<00:38,  3.82it/s] 24%|██▍       | 47/195 [00:25<00:35,  4.16it/s] 25%|██▍       | 48/195 [00:25<00:39,  3.74it/s] 25%|██▌       | 49/195 [00:26<00:34,  4.26it/s] 26%|██▌       | 50/195 [00:26<00:41,  3.49it/s] 27%|██▋       | 52/195 [00:27<00:44,  3.23it/s] 28%|██▊       | 54/195 [00:27<00:45,  3.12it/s] 29%|██▊       | 56/195 [00:28<00:46,  3.02it/s] 30%|██▉       | 58/195 [00:29<00:46,  2.94it/s] 31%|███       | 60/195 [00:29<00:45,  3.00it/s] 32%|███▏      | 62/195 [00:30<00:40,  3.27it/s] 33%|███▎      | 64/195 [00:30<00:37,  3.51it/s] 34%|███▍      | 66/195 [00:31<00:35,  3.67it/s] 34%|███▍      | 67/195 [00:31<00:32,  3.98it/s] 35%|███▍      | 68/195 [00:31<00:33,  3.74it/s] 35%|███▌      | 69/195 [00:31<00:30,  4.15it/s] 36%|███▌      | 70/195 [00:32<00:32,  3.87it/s] 36%|███▋      | 71/195 [00:32<00:31,  3.98it/s] 37%|███▋      | 72/195 [00:32<00:31,  3.89it/s] 37%|███▋      | 73/195 [00:33<00:31,  3.89it/s] 38%|███▊      | 74/195 [00:33<00:29,  4.03it/s] 38%|███▊      | 75/195 [00:33<00:34,  3.52it/s] 39%|███▉      | 76/195 [00:33<00:28,  4.11it/s] 39%|███▉      | 77/195 [00:34<00:34,  3.39it/s] 41%|████      | 79/195 [00:34<00:33,  3.42it/s] 42%|████▏     | 81/195 [00:35<00:32,  3.49it/s] 42%|████▏     | 82/195 [00:35<00:30,  3.74it/s] 43%|████▎     | 83/195 [00:35<00:31,  3.58it/s] 43%|████▎     | 84/195 [00:36<00:27,  3.99it/s] 44%|████▎     | 85/195 [00:36<00:30,  3.60it/s] 45%|████▍     | 87/195 [00:36<00:29,  3.69it/s] 45%|████▌     | 88/195 [00:37<00:26,  4.04it/s] 46%|████▌     | 89/195 [00:37<00:29,  3.64it/s] 46%|████▌     | 90/195 [00:37<00:26,  3.96it/s] 47%|████▋     | 91/195 [00:37<00:28,  3.71it/s] 47%|████▋     | 92/195 [00:38<00:28,  3.61it/s] 48%|████▊     | 93/195 [00:38<00:26,  3.79it/s] 48%|████▊     | 94/195 [00:38<00:28,  3.58it/s] 49%|████▊     | 95/195 [00:38<00:24,  4.01it/s] 49%|████▉     | 96/195 [00:39<00:26,  3.76it/s] 50%|████▉     | 97/195 [00:39<00:24,  4.04it/s] 50%|█████     | 98/195 [00:39<00:27,  3.48it/s] 51%|█████     | 99/195 [00:40<00:24,  3.93it/s] 51%|█████▏    | 100/195 [00:40<00:31,  3.04it/s] 52%|█████▏    | 101/195 [00:40<00:28,  3.34it/s] 52%|█████▏    | 102/195 [00:41<00:35,  2.65it/s] 53%|█████▎    | 104/195 [00:42<00:34,  2.65it/s] 54%|█████▍    | 106/195 [00:42<00:32,  2.76it/s] 55%|█████▌    | 108/195 [00:43<00:30,  2.81it/s] 56%|█████▋    | 110/195 [00:44<00:29,  2.86it/s] 57%|█████▋    | 112/195 [00:44<00:29,  2.83it/s] 58%|█████▊    | 114/195 [00:45<00:29,  2.78it/s] 59%|█████▉    | 116/195 [00:46<00:28,  2.73it/s] 61%|██████    | 118/195 [00:47<00:28,  2.75it/s] 62%|██████▏   | 120/195 [00:47<00:26,  2.86it/s] 63%|██████▎   | 122/195 [00:48<00:23,  3.14it/s] 63%|██████▎   | 123/195 [00:48<00:21,  3.41it/s] 64%|██████▎   | 124/195 [00:48<00:21,  3.32it/s] 64%|██████▍   | 125/195 [00:48<00:20,  3.48it/s] 65%|██████▍   | 126/195 [00:49<00:20,  3.29it/s] 65%|██████▌   | 127/195 [00:49<00:19,  3.45it/s] 66%|██████▌   | 128/195 [00:49<00:19,  3.47it/s] 66%|██████▌   | 129/195 [00:50<00:18,  3.51it/s] 67%|██████▋   | 130/195 [00:50<00:19,  3.40it/s] 67%|██████▋   | 131/195 [00:50<00:18,  3.49it/s] 68%|██████▊   | 132/195 [00:50<00:18,  3.47it/s] 68%|██████▊   | 133/195 [00:51<00:17,  3.52it/s] 69%|██████▊   | 134/195 [00:51<00:17,  3.48it/s] 69%|██████▉   | 135/195 [00:51<00:17,  3.40it/s] 70%|██████▉   | 136/195 [00:52<00:16,  3.58it/s] 70%|███████   | 137/195 [00:52<00:18,  3.18it/s] 71%|███████   | 138/195 [00:52<00:15,  3.61it/s] 71%|███████▏  | 139/195 [00:53<00:16,  3.33it/s] 72%|███████▏  | 140/195 [00:53<00:17,  3.14it/s] 72%|███████▏  | 141/195 [00:53<00:16,  3.18it/s] 73%|███████▎  | 142/195 [00:54<00:17,  3.11it/s] 73%|███████▎  | 143/195 [00:54<00:15,  3.38it/s] 74%|███████▍  | 144/195 [00:54<00:14,  3.59it/s] 74%|███████▍  | 145/195 [00:54<00:13,  3.68it/s] 75%|███████▍  | 146/195 [00:54<00:12,  4.00it/s] 75%|███████▌  | 147/195 [00:55<00:12,  3.70it/s] 76%|███████▌  | 148/195 [00:55<00:11,  4.19it/s] 76%|███████▋  | 149/195 [00:55<00:13,  3.47it/s] 77%|███████▋  | 151/195 [00:56<00:12,  3.50it/s] 78%|███████▊  | 152/195 [00:56<00:11,  3.80it/s] 78%|███████▊  | 153/195 [00:57<00:12,  3.39it/s] 79%|███████▉  | 154/195 [00:57<00:11,  3.70it/s] 79%|███████▉  | 155/195 [00:57<00:11,  3.47it/s] 80%|████████  | 156/195 [00:57<00:09,  3.98it/s] 81%|████████  | 157/195 [00:58<00:10,  3.73it/s] 81%|████████  | 158/195 [00:58<00:08,  4.18it/s] 82%|████████▏ | 159/195 [00:58<00:09,  3.95it/s] 82%|████████▏ | 160/195 [00:58<00:07,  4.40it/s] 83%|████████▎ | 161/195 [00:58<00:08,  3.89it/s] 83%|████████▎ | 162/195 [00:59<00:08,  4.07it/s] 84%|████████▎ | 163/195 [00:59<00:07,  4.28it/s] 84%|████████▍ | 164/195 [00:59<00:07,  4.14it/s] 85%|████████▍ | 165/195 [00:59<00:06,  4.52it/s] 85%|████████▌ | 166/195 [01:00<00:07,  3.88it/s] 86%|████████▌ | 168/195 [01:00<00:06,  4.04it/s] 87%|████████▋ | 169/195 [01:00<00:05,  4.41it/s] 87%|████████▋ | 170/195 [01:01<00:06,  3.95it/s] 88%|████████▊ | 172/195 [01:01<00:05,  4.06it/s] 89%|████████▉ | 174/195 [01:02<00:05,  4.10it/s] 90%|████████▉ | 175/195 [01:02<00:04,  4.44it/s] 90%|█████████ | 176/195 [01:02<00:04,  4.06it/s] 91%|█████████ | 177/195 [01:02<00:04,  4.27it/s] 91%|█████████▏| 178/195 [01:03<00:04,  4.09it/s] 92%|█████████▏| 179/195 [01:03<00:04,  3.99it/s] 92%|█████████▏| 180/195 [01:03<00:03,  4.19it/s] 93%|█████████▎| 181/195 [01:03<00:03,  3.88it/s] 93%|█████████▎| 182/195 [01:03<00:02,  4.39it/s] 94%|█████████▍| 183/195 [01:04<00:03,  3.58it/s] 95%|█████████▍| 185/195 [01:04<00:02,  3.70it/s] 95%|█████████▌| 186/195 [01:05<00:02,  4.06it/s] 96%|█████████▌| 187/195 [01:05<00:02,  3.61it/s] 97%|█████████▋| 189/195 [01:05<00:01,  3.60it/s] 98%|█████████▊| 191/195 [01:06<00:01,  3.70it/s] 98%|█████████▊| 192/195 [01:06<00:00,  3.99it/s] 99%|█████████▉| 193/195 [01:07<00:00,  3.66it/s] 99%|█████████▉| 194/195 [01:07<00:00,  3.99it/s]100%|██████████| 195/195 [01:07<00:00,  4.50it/s]100%|██████████| 195/195 [01:09<00:00,  2.81it/s]
2025-08-20 21:13:10 [info     ] Validating outputs
2025-08-20 21:13:10 [info     ] Predict - end                  time=0:1:9
2025-08-20 21:13:10 [info     ] Evaluate - start               split=test
2025-08-20 21:13:10 [info     ] Evaluate - end                 correctness_llm=0.24 monotonicity=0.76
2025-08-20 21:13:10 [info     ] Evaluate question difficulty - start split=test
2025-08-20 21:13:10 [info     ] Augmenting questions for IRT estimation num_questions=4
2025-08-20 21:13:10 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 21:13:10 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1029.85it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3389.58it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 531.35it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6796.33it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1008.45it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3445.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 539.70it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7002.18it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 998.88it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3549.02it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 571.13it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6905.02it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1119.16it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3692.92it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 544.94it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6681.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 949.00it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3651.37it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 580.55it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6962.33it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1019.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3448.10it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 565.98it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6657.63it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 985.07it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3717.09it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 641.64it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7740.61it/s]
2025-08-20 21:13:16 INFO: EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
2025-08-20 21:13:16 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 21:13:16 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 21:13:16 [info     ] Evaluate question difficulty - end rmse=2.4845425360368605 split=test
2025-08-20 21:13:16 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 2 finished: 0:1:25

 ********** Run: 3/3 **********
2025-08-20 21:13:33 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 21:13:33 [info     ] Reading train split questions  num_questions=92
2025-08-20 21:13:33 [info     ] Reading validation split questions num_questions=23
2025-08-20 21:13:33 [info     ] Reading test split questions   num_questions=39
2025-08-20 21:13:35 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 21:13:35 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 21:13:39 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 21:13:39 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 21:13:39 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 21:13:40 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 21:13:43 [info     ] Setting seed                   value=45
2025-08-20 21:13:43 [info     ] Building structured outputter  name=student_kt
2025-08-20 21:13:43 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_kc_exact native_structured_output=True num_examples=3 system_prompt=student_chocolate_level_context
2025-08-20 21:13:43 [info     ] Building example selector
2025-08-20 21:13:43 [info     ] Building model                 name=qwen3:4b provider=ollama rate_limit=None temp=0.0
2025-08-20 21:13:43 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:11<37:06, 11.48s/it]  1%|          | 2/195 [00:12<16:34,  5.15s/it]  2%|▏         | 3/195 [00:13<10:19,  3.23s/it]  2%|▏         | 4/195 [00:13<07:02,  2.21s/it]  3%|▎         | 5/195 [00:14<05:07,  1.62s/it]  4%|▎         | 7/195 [00:15<03:04,  1.02it/s]  5%|▍         | 9/195 [00:15<02:07,  1.46it/s]  6%|▌         | 11/195 [00:16<01:39,  1.85it/s]  6%|▌         | 12/195 [00:16<01:24,  2.17it/s]  7%|▋         | 13/195 [00:16<01:17,  2.36it/s]  7%|▋         | 14/195 [00:16<01:04,  2.79it/s]  8%|▊         | 15/195 [00:17<01:04,  2.79it/s]  8%|▊         | 16/195 [00:17<00:52,  3.40it/s]  9%|▊         | 17/195 [00:17<00:50,  3.51it/s]  9%|▉         | 18/195 [00:17<00:44,  4.02it/s] 10%|▉         | 19/195 [00:18<00:43,  4.03it/s] 10%|█         | 20/195 [00:18<00:41,  4.25it/s] 11%|█         | 21/195 [00:18<00:39,  4.45it/s] 11%|█▏        | 22/195 [00:18<00:43,  3.98it/s] 12%|█▏        | 23/195 [00:18<00:36,  4.66it/s] 12%|█▏        | 24/195 [00:19<00:40,  4.20it/s] 13%|█▎        | 26/195 [00:19<00:45,  3.72it/s] 14%|█▍        | 27/195 [00:19<00:42,  3.95it/s] 14%|█▍        | 28/195 [00:20<00:51,  3.27it/s] 15%|█▌        | 30/195 [00:21<00:50,  3.25it/s] 16%|█▌        | 31/195 [00:21<00:48,  3.36it/s] 16%|█▋        | 32/195 [00:21<00:51,  3.19it/s] 17%|█▋        | 33/195 [00:21<00:48,  3.35it/s] 17%|█▋        | 34/195 [00:22<00:52,  3.06it/s] 18%|█▊        | 35/195 [00:22<00:47,  3.34it/s] 18%|█▊        | 36/195 [00:22<00:47,  3.37it/s] 19%|█▉        | 37/195 [00:23<00:43,  3.60it/s] 19%|█▉        | 38/195 [00:23<00:41,  3.74it/s] 20%|██        | 39/195 [00:23<00:40,  3.89it/s] 21%|██        | 40/195 [00:23<00:38,  4.05it/s] 21%|██        | 41/195 [00:24<00:39,  3.93it/s] 22%|██▏       | 42/195 [00:24<00:35,  4.28it/s] 22%|██▏       | 43/195 [00:24<00:37,  4.05it/s] 23%|██▎       | 44/195 [00:24<00:34,  4.39it/s] 23%|██▎       | 45/195 [00:24<00:36,  4.15it/s] 24%|██▎       | 46/195 [00:25<00:33,  4.50it/s] 24%|██▍       | 47/195 [00:25<00:35,  4.15it/s] 25%|██▍       | 48/195 [00:25<00:32,  4.58it/s] 25%|██▌       | 49/195 [00:25<00:37,  3.90it/s] 26%|██▌       | 51/195 [00:26<00:42,  3.36it/s] 27%|██▋       | 53/195 [00:27<00:44,  3.17it/s] 28%|██▊       | 55/195 [00:27<00:44,  3.16it/s] 29%|██▉       | 57/195 [00:28<00:44,  3.11it/s] 30%|███       | 59/195 [00:29<00:43,  3.11it/s] 31%|███▏      | 61/195 [00:29<00:40,  3.29it/s] 32%|███▏      | 63/195 [00:30<00:38,  3.40it/s] 33%|███▎      | 65/195 [00:30<00:37,  3.48it/s] 34%|███▍      | 66/195 [00:31<00:34,  3.79it/s] 34%|███▍      | 67/195 [00:31<00:36,  3.51it/s] 35%|███▍      | 68/195 [00:31<00:32,  3.90it/s] 35%|███▌      | 69/195 [00:31<00:33,  3.71it/s] 36%|███▌      | 70/195 [00:32<00:33,  3.70it/s] 36%|███▋      | 71/195 [00:32<00:32,  3.83it/s] 37%|███▋      | 72/195 [00:32<00:34,  3.57it/s] 37%|███▋      | 73/195 [00:32<00:29,  4.07it/s] 38%|███▊      | 74/195 [00:33<00:33,  3.57it/s] 39%|███▉      | 76/195 [00:33<00:30,  3.89it/s] 40%|████      | 78/195 [00:34<00:28,  4.06it/s] 41%|████      | 80/195 [00:34<00:28,  4.09it/s] 42%|████▏     | 82/195 [00:35<00:27,  4.15it/s] 43%|████▎     | 83/195 [00:35<00:25,  4.45it/s] 43%|████▎     | 84/195 [00:35<00:27,  4.11it/s] 44%|████▎     | 85/195 [00:35<00:25,  4.38it/s] 44%|████▍     | 86/195 [00:36<00:29,  3.75it/s] 45%|████▍     | 87/195 [00:36<00:25,  4.15it/s] 45%|████▌     | 88/195 [00:36<00:28,  3.79it/s] 46%|████▌     | 89/195 [00:36<00:25,  4.22it/s] 46%|████▌     | 90/195 [00:37<00:28,  3.68it/s] 47%|████▋     | 92/195 [00:37<00:28,  3.64it/s] 48%|████▊     | 94/195 [00:38<00:27,  3.65it/s] 49%|████▉     | 96/195 [00:38<00:26,  3.67it/s] 50%|████▉     | 97/195 [00:38<00:25,  3.91it/s] 50%|█████     | 98/195 [00:39<00:26,  3.64it/s] 51%|█████     | 99/195 [00:39<00:23,  4.08it/s] 51%|█████▏    | 100/195 [00:39<00:29,  3.23it/s] 52%|█████▏    | 101/195 [00:40<00:26,  3.50it/s] 52%|█████▏    | 102/195 [00:40<00:33,  2.79it/s] 53%|█████▎    | 103/195 [00:40<00:29,  3.12it/s] 53%|█████▎    | 104/195 [00:41<00:34,  2.64it/s] 54%|█████▍    | 106/195 [00:42<00:32,  2.76it/s] 55%|█████▌    | 108/195 [00:42<00:31,  2.75it/s] 56%|█████▋    | 110/195 [00:43<00:30,  2.75it/s] 57%|█████▋    | 112/195 [00:44<00:30,  2.74it/s] 58%|█████▊    | 114/195 [00:45<00:28,  2.80it/s] 59%|█████▉    | 116/195 [00:45<00:27,  2.83it/s] 61%|██████    | 118/195 [00:46<00:26,  2.86it/s] 62%|██████▏   | 120/195 [00:47<00:25,  2.97it/s] 63%|██████▎   | 122/195 [00:47<00:23,  3.12it/s] 64%|██████▎   | 124/195 [00:48<00:21,  3.32it/s] 64%|██████▍   | 125/195 [00:48<00:19,  3.56it/s] 65%|██████▍   | 126/195 [00:48<00:20,  3.45it/s] 65%|██████▌   | 127/195 [00:48<00:18,  3.71it/s] 66%|██████▌   | 128/195 [00:49<00:19,  3.45it/s] 66%|██████▌   | 129/195 [00:49<00:18,  3.65it/s] 67%|██████▋   | 130/195 [00:49<00:19,  3.39it/s] 67%|██████▋   | 131/195 [00:50<00:17,  3.56it/s] 68%|██████▊   | 132/195 [00:50<00:17,  3.54it/s] 68%|██████▊   | 133/195 [00:50<00:17,  3.62it/s] 69%|██████▊   | 134/195 [00:50<00:17,  3.56it/s] 69%|██████▉   | 135/195 [00:51<00:16,  3.74it/s] 70%|██████▉   | 136/195 [00:51<00:15,  3.72it/s] 70%|███████   | 137/195 [00:51<00:15,  3.68it/s] 71%|███████   | 138/195 [00:51<00:15,  3.78it/s] 71%|███████▏  | 139/195 [00:52<00:15,  3.64it/s] 72%|███████▏  | 140/195 [00:52<00:14,  3.68it/s] 72%|███████▏  | 141/195 [00:52<00:14,  3.62it/s] 73%|███████▎  | 142/195 [00:52<00:13,  3.83it/s] 73%|███████▎  | 143/195 [00:53<00:14,  3.53it/s] 74%|███████▍  | 144/195 [00:53<00:13,  3.91it/s] 74%|███████▍  | 145/195 [00:53<00:14,  3.38it/s] 75%|███████▍  | 146/195 [00:54<00:12,  3.98it/s] 75%|███████▌  | 147/195 [00:54<00:13,  3.60it/s] 76%|███████▌  | 148/195 [00:54<00:11,  4.19it/s] 76%|███████▋  | 149/195 [00:54<00:13,  3.52it/s] 77%|███████▋  | 150/195 [00:55<00:11,  3.90it/s] 77%|███████▋  | 151/195 [00:55<00:12,  3.41it/s] 78%|███████▊  | 153/195 [00:55<00:11,  3.57it/s] 79%|███████▉  | 154/195 [00:56<00:10,  3.90it/s] 79%|███████▉  | 155/195 [00:56<00:11,  3.48it/s] 80%|████████  | 156/195 [00:56<00:09,  4.00it/s] 81%|████████  | 157/195 [00:57<00:10,  3.72it/s] 81%|████████  | 158/195 [00:57<00:08,  4.21it/s] 82%|████████▏ | 159/195 [00:57<00:09,  3.82it/s] 82%|████████▏ | 160/195 [00:57<00:08,  4.27it/s] 83%|████████▎ | 161/195 [00:57<00:08,  3.83it/s] 83%|████████▎ | 162/195 [00:58<00:07,  4.28it/s] 84%|████████▎ | 163/195 [00:58<00:08,  3.83it/s] 84%|████████▍ | 164/195 [00:58<00:07,  4.28it/s] 85%|████████▍ | 165/195 [00:59<00:08,  3.55it/s] 85%|████████▌ | 166/195 [00:59<00:07,  4.09it/s] 86%|████████▌ | 167/195 [00:59<00:07,  3.80it/s] 86%|████████▌ | 168/195 [00:59<00:06,  4.13it/s] 87%|████████▋ | 169/195 [01:00<00:06,  3.74it/s] 87%|████████▋ | 170/195 [01:00<00:05,  4.20it/s] 88%|████████▊ | 171/195 [01:00<00:06,  3.97it/s] 88%|████████▊ | 172/195 [01:00<00:05,  4.17it/s] 89%|████████▊ | 173/195 [01:00<00:05,  4.15it/s] 89%|████████▉ | 174/195 [01:01<00:05,  3.93it/s] 90%|████████▉ | 175/195 [01:01<00:04,  4.28it/s] 90%|█████████ | 176/195 [01:01<00:05,  3.77it/s] 91%|█████████ | 177/195 [01:01<00:04,  4.35it/s] 91%|█████████▏| 178/195 [01:02<00:04,  3.64it/s] 92%|█████████▏| 180/195 [01:02<00:03,  3.92it/s] 93%|█████████▎| 181/195 [01:02<00:03,  4.32it/s] 93%|█████████▎| 182/195 [01:03<00:03,  3.83it/s] 94%|█████████▍| 183/195 [01:03<00:02,  4.07it/s] 94%|█████████▍| 184/195 [01:03<00:02,  3.68it/s] 95%|█████████▍| 185/195 [01:04<00:02,  3.73it/s] 95%|█████████▌| 186/195 [01:04<00:02,  3.62it/s] 96%|█████████▌| 187/195 [01:04<00:02,  3.56it/s] 96%|█████████▋| 188/195 [01:04<00:01,  3.73it/s] 97%|█████████▋| 189/195 [01:05<00:01,  3.58it/s] 97%|█████████▋| 190/195 [01:05<00:01,  4.09it/s] 98%|█████████▊| 191/195 [01:05<00:01,  3.60it/s] 98%|█████████▊| 192/195 [01:05<00:00,  4.19it/s] 99%|█████████▉| 193/195 [01:06<00:00,  3.61it/s]100%|██████████| 195/195 [01:06<00:00,  4.61it/s]100%|██████████| 195/195 [01:08<00:00,  2.84it/s]
2025-08-20 21:14:52 [info     ] Validating outputs
2025-08-20 21:14:52 [info     ] Predict - end                  time=0:1:8
2025-08-20 21:14:52 [info     ] Evaluate - start               split=test
2025-08-20 21:14:52 [info     ] Evaluate - end                 correctness_llm=0.23 monotonicity=0.59
2025-08-20 21:14:52 [info     ] Evaluate question difficulty - start split=test
2025-08-20 21:14:52 [info     ] Augmenting questions for IRT estimation num_questions=1
2025-08-20 21:14:52 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 21:14:52 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 973.90it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3492.19it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 515.64it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5185.47it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1092.92it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3705.97it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 520.83it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6557.99it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1034.14it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3353.52it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 506.17it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6763.45it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1063.23it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3579.62it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 639.99it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6574.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1050.45it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3537.74it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 541.93it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6431.57it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1178.98it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3492.19it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 493.17it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6710.89it/s]
2025-08-20 21:14:56 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-08-20 21:14:56 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 21:14:56 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 21:14:56 [info     ] Evaluate question difficulty - end rmse=2.326795059987315 split=test
2025-08-20 21:14:56 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 3 finished: 0:1:23

 ========== Config: qwen3:8b~T_0.0~SO_student_kt~L_5~SP_student_chocolate_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_miscon_studentlevel_random3 ==========
Config 7/8

 ********** Run: 1/3 **********
2025-08-20 21:15:15 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 21:15:15 [info     ] Reading train split questions  num_questions=92
2025-08-20 21:15:15 [info     ] Reading validation split questions num_questions=23
2025-08-20 21:15:15 [info     ] Reading test split questions   num_questions=39
2025-08-20 21:15:17 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 21:15:17 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 21:15:22 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 21:15:22 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 21:15:22 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 21:15:22 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 21:15:25 [info     ] Setting seed                   value=43
2025-08-20 21:15:25 [info     ] Building structured outputter  name=student_kt
2025-08-20 21:15:25 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_random native_structured_output=True num_examples=3 system_prompt=student_chocolate_level_context
2025-08-20 21:15:25 [info     ] Building example selector
2025-08-20 21:15:25 [info     ] Building model                 name=qwen3:8b provider=ollama rate_limit=None temp=0.0
2025-08-20 21:15:25 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:11<38:24, 11.88s/it]  1%|          | 2/195 [00:12<17:19,  5.39s/it]  2%|▏         | 3/195 [00:13<09:59,  3.12s/it]  2%|▏         | 4/195 [00:13<06:21,  2.00s/it]  3%|▎         | 5/195 [00:13<04:32,  1.44s/it]  4%|▎         | 7/195 [00:14<03:00,  1.04it/s]  4%|▍         | 8/195 [00:15<02:26,  1.28it/s]  5%|▍         | 9/195 [00:16<02:38,  1.18it/s]  5%|▌         | 10/195 [00:16<02:03,  1.50it/s]  6%|▌         | 11/195 [00:16<01:51,  1.65it/s]  6%|▌         | 12/195 [00:17<01:32,  1.97it/s]  7%|▋         | 13/195 [00:17<01:22,  2.21it/s]  7%|▋         | 14/195 [00:17<01:23,  2.17it/s]  8%|▊         | 15/195 [00:18<01:41,  1.78it/s]  9%|▊         | 17/195 [00:19<01:14,  2.39it/s] 10%|▉         | 19/195 [00:19<01:04,  2.73it/s] 11%|█         | 21/195 [00:20<00:57,  3.04it/s] 12%|█▏        | 23/195 [00:21<01:06,  2.58it/s] 12%|█▏        | 24/195 [00:21<01:08,  2.49it/s] 13%|█▎        | 26/195 [00:22<01:01,  2.76it/s] 14%|█▍        | 28/195 [00:22<00:57,  2.91it/s] 15%|█▌        | 30/195 [00:23<00:58,  2.83it/s] 16%|█▌        | 31/195 [00:23<00:54,  3.03it/s] 16%|█▋        | 32/195 [00:24<00:56,  2.87it/s] 17%|█▋        | 33/195 [00:24<00:53,  3.05it/s] 17%|█▋        | 34/195 [00:25<00:56,  2.83it/s] 18%|█▊        | 35/195 [00:25<00:57,  2.78it/s] 18%|█▊        | 36/195 [00:25<00:50,  3.14it/s] 19%|█▉        | 37/195 [00:26<00:59,  2.66it/s] 20%|██        | 39/195 [00:26<00:52,  2.96it/s] 21%|██        | 40/195 [00:27<00:52,  2.95it/s] 21%|██        | 41/195 [00:27<00:48,  3.17it/s] 22%|██▏       | 42/195 [00:27<00:50,  3.01it/s] 22%|██▏       | 43/195 [00:27<00:45,  3.37it/s] 23%|██▎       | 44/195 [00:28<00:56,  2.65it/s] 24%|██▎       | 46/195 [00:29<00:51,  2.90it/s] 25%|██▍       | 48/195 [00:29<00:48,  3.02it/s] 25%|██▌       | 49/195 [00:29<00:44,  3.28it/s] 26%|██▌       | 50/195 [00:30<00:48,  2.98it/s] 26%|██▌       | 51/195 [00:30<00:56,  2.56it/s] 27%|██▋       | 52/195 [00:31<00:55,  2.56it/s] 27%|██▋       | 53/195 [00:31<01:01,  2.31it/s] 28%|██▊       | 54/195 [00:32<00:59,  2.36it/s] 28%|██▊       | 55/195 [00:32<01:03,  2.19it/s] 29%|██▊       | 56/195 [00:33<00:58,  2.37it/s] 29%|██▉       | 57/195 [00:33<01:03,  2.18it/s] 30%|██▉       | 58/195 [00:34<00:59,  2.28it/s] 30%|███       | 59/195 [00:34<01:04,  2.11it/s] 31%|███       | 60/195 [00:34<00:55,  2.43it/s] 31%|███▏      | 61/195 [00:35<00:55,  2.42it/s] 32%|███▏      | 63/195 [00:35<00:47,  2.75it/s] 33%|███▎      | 64/195 [00:36<00:46,  2.79it/s] 33%|███▎      | 65/195 [00:36<00:42,  3.10it/s] 34%|███▍      | 66/195 [00:36<00:43,  2.94it/s] 35%|███▍      | 68/195 [00:37<00:42,  3.02it/s] 36%|███▌      | 70/195 [00:38<00:40,  3.11it/s] 37%|███▋      | 72/195 [00:38<00:38,  3.18it/s] 38%|███▊      | 74/195 [00:39<00:37,  3.24it/s] 38%|███▊      | 75/195 [00:39<00:36,  3.27it/s] 39%|███▉      | 76/195 [00:39<00:34,  3.49it/s] 39%|███▉      | 77/195 [00:40<00:36,  3.22it/s] 41%|████      | 79/195 [00:40<00:34,  3.39it/s] 41%|████      | 80/195 [00:40<00:31,  3.70it/s] 42%|████▏     | 81/195 [00:41<00:33,  3.41it/s] 42%|████▏     | 82/195 [00:41<00:30,  3.75it/s] 43%|████▎     | 83/195 [00:41<00:33,  3.30it/s] 43%|████▎     | 84/195 [00:42<00:31,  3.51it/s] 44%|████▎     | 85/195 [00:42<00:35,  3.12it/s] 44%|████▍     | 86/195 [00:42<00:35,  3.08it/s] 45%|████▍     | 87/195 [00:43<00:32,  3.32it/s] 45%|████▌     | 88/195 [00:43<00:35,  2.98it/s] 46%|████▌     | 89/195 [00:43<00:31,  3.37it/s] 46%|████▌     | 90/195 [00:44<00:36,  2.87it/s] 47%|████▋     | 92/195 [00:44<00:34,  2.98it/s] 48%|████▊     | 94/195 [00:45<00:33,  3.01it/s] 49%|████▉     | 96/195 [00:46<00:30,  3.22it/s] 50%|████▉     | 97/195 [00:46<00:30,  3.23it/s] 50%|█████     | 98/195 [00:46<00:29,  3.26it/s] 51%|█████     | 99/195 [00:47<00:33,  2.89it/s] 51%|█████▏    | 100/195 [00:47<00:33,  2.83it/s] 52%|█████▏    | 101/195 [00:48<00:42,  2.22it/s] 53%|█████▎    | 103/195 [00:49<00:43,  2.09it/s] 54%|█████▍    | 105/195 [00:50<00:42,  2.12it/s] 55%|█████▍    | 107/195 [00:51<00:40,  2.18it/s] 56%|█████▌    | 109/195 [00:51<00:39,  2.16it/s] 57%|█████▋    | 111/195 [00:52<00:39,  2.11it/s] 58%|█████▊    | 113/195 [00:53<00:39,  2.10it/s] 59%|█████▉    | 115/195 [00:54<00:37,  2.12it/s] 60%|██████    | 117/195 [00:55<00:36,  2.13it/s] 61%|██████    | 119/195 [00:56<00:35,  2.15it/s] 62%|██████▏   | 121/195 [00:57<00:31,  2.36it/s] 63%|██████▎   | 122/195 [00:57<00:28,  2.59it/s] 63%|██████▎   | 123/195 [00:57<00:27,  2.64it/s] 64%|██████▎   | 124/195 [00:58<00:27,  2.56it/s] 64%|██████▍   | 125/195 [00:58<00:24,  2.85it/s] 65%|██████▍   | 126/195 [00:59<00:25,  2.67it/s] 66%|██████▌   | 128/195 [00:59<00:24,  2.69it/s] 67%|██████▋   | 130/195 [01:00<00:23,  2.76it/s] 67%|██████▋   | 131/195 [01:00<00:21,  3.00it/s] 68%|██████▊   | 132/195 [01:01<00:21,  2.88it/s] 68%|██████▊   | 133/195 [01:01<00:22,  2.74it/s] 69%|██████▊   | 134/195 [01:01<00:19,  3.08it/s] 69%|██████▉   | 135/195 [01:02<00:21,  2.79it/s] 70%|██████▉   | 136/195 [01:02<00:19,  3.03it/s] 70%|███████   | 137/195 [01:02<00:20,  2.86it/s] 71%|███████   | 138/195 [01:03<00:18,  3.15it/s] 71%|███████▏  | 139/195 [01:03<00:20,  2.79it/s] 72%|███████▏  | 140/195 [01:03<00:18,  2.99it/s] 72%|███████▏  | 141/195 [01:04<00:18,  2.92it/s] 73%|███████▎  | 142/195 [01:04<00:16,  3.28it/s] 73%|███████▎  | 143/195 [01:04<00:16,  3.12it/s] 74%|███████▍  | 144/195 [01:04<00:14,  3.57it/s] 74%|███████▍  | 145/195 [01:05<00:16,  3.03it/s] 75%|███████▌  | 147/195 [01:05<00:14,  3.25it/s] 76%|███████▋  | 149/195 [01:06<00:14,  3.21it/s] 77%|███████▋  | 150/195 [01:06<00:13,  3.39it/s] 77%|███████▋  | 151/195 [01:07<00:14,  2.99it/s] 78%|███████▊  | 152/195 [01:07<00:13,  3.19it/s] 78%|███████▊  | 153/195 [01:07<00:14,  2.89it/s] 79%|███████▉  | 154/195 [01:08<00:13,  3.00it/s] 79%|███████▉  | 155/195 [01:08<00:13,  3.00it/s] 80%|████████  | 156/195 [01:08<00:12,  3.15it/s] 81%|████████  | 157/195 [01:09<00:11,  3.34it/s] 81%|████████  | 158/195 [01:09<00:10,  3.36it/s] 82%|████████▏ | 159/195 [01:09<00:09,  3.63it/s] 82%|████████▏ | 160/195 [01:09<00:10,  3.33it/s] 83%|████████▎ | 161/195 [01:10<00:08,  3.78it/s] 83%|████████▎ | 162/195 [01:10<00:10,  3.10it/s] 84%|████████▍ | 164/195 [01:11<00:09,  3.30it/s] 85%|████████▌ | 166/195 [01:11<00:09,  3.08it/s] 86%|████████▌ | 168/195 [01:12<00:08,  3.15it/s] 87%|████████▋ | 170/195 [01:13<00:07,  3.19it/s] 88%|████████▊ | 172/195 [01:13<00:06,  3.41it/s] 89%|████████▉ | 174/195 [01:14<00:06,  3.32it/s] 90%|█████████ | 176/195 [01:14<00:05,  3.29it/s] 91%|█████████ | 177/195 [01:15<00:05,  3.22it/s] 91%|█████████▏| 178/195 [01:15<00:05,  3.39it/s] 92%|█████████▏| 179/195 [01:15<00:05,  2.93it/s] 93%|█████████▎| 181/195 [01:16<00:04,  3.14it/s] 93%|█████████▎| 182/195 [01:16<00:03,  3.66it/s] 94%|█████████▍| 183/195 [01:17<00:04,  2.96it/s] 94%|█████████▍| 184/195 [01:17<00:03,  2.94it/s] 95%|█████████▍| 185/195 [01:17<00:03,  3.15it/s] 95%|█████████▌| 186/195 [01:18<00:03,  2.89it/s] 96%|█████████▌| 187/195 [01:18<00:02,  3.31it/s] 96%|█████████▋| 188/195 [01:18<00:02,  3.10it/s] 97%|█████████▋| 189/195 [01:18<00:01,  3.41it/s] 97%|█████████▋| 190/195 [01:19<00:01,  3.15it/s] 98%|█████████▊| 191/195 [01:19<00:01,  3.13it/s] 98%|█████████▊| 192/195 [01:19<00:00,  3.24it/s] 99%|█████████▉| 193/195 [01:20<00:00,  3.35it/s] 99%|█████████▉| 194/195 [01:20<00:00,  3.26it/s]100%|██████████| 195/195 [01:22<00:00,  2.36it/s]
2025-08-20 21:16:48 [info     ] Validating outputs
2025-08-20 21:16:48 [info     ] Predict - end                  time=0:1:22
2025-08-20 21:16:48 [info     ] Evaluate - start               split=test
2025-08-20 21:16:48 [info     ] Evaluate - end                 correctness_llm=0.35 monotonicity=0.93
2025-08-20 21:16:48 [info     ] Evaluate question difficulty - start split=test
2025-08-20 21:16:48 [info     ] Augmenting questions for IRT estimation num_questions=15
2025-08-20 21:16:48 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 21:16:48 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1335.28it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3497.64it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 505.99it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8610.01it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1172.58it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3445.85it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 558.37it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7563.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1154.86it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3906.99it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 577.77it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7892.51it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1011.96it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3601.21it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 597.48it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7637.91it/s]
2025-08-20 21:16:51 INFO: EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
2025-08-20 21:16:51 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 21:16:51 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 21:16:51 [info     ] Evaluate question difficulty - end rmse=2.0188193308201425 split=test
2025-08-20 21:16:51 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 1 finished: 0:1:35

 ********** Run: 2/3 **********
2025-08-20 21:17:19 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 21:17:19 [info     ] Reading train split questions  num_questions=92
2025-08-20 21:17:19 [info     ] Reading validation split questions num_questions=23
2025-08-20 21:17:19 [info     ] Reading test split questions   num_questions=39
2025-08-20 21:17:21 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 21:17:21 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 21:17:25 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 21:17:25 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 21:17:25 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 21:17:26 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 21:17:29 [info     ] Setting seed                   value=44
2025-08-20 21:17:29 [info     ] Building structured outputter  name=student_kt
2025-08-20 21:17:29 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_random native_structured_output=True num_examples=3 system_prompt=student_chocolate_level_context
2025-08-20 21:17:29 [info     ] Building example selector
2025-08-20 21:17:29 [info     ] Building model                 name=qwen3:8b provider=ollama rate_limit=None temp=0.0
2025-08-20 21:17:29 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:09<32:05,  9.93s/it]  1%|          | 2/195 [00:10<13:55,  4.33s/it]  2%|▏         | 3/195 [00:10<08:06,  2.53s/it]  3%|▎         | 5/195 [00:12<05:05,  1.61s/it]  3%|▎         | 6/195 [00:12<03:48,  1.21s/it]  4%|▎         | 7/195 [00:13<03:02,  1.03it/s]  4%|▍         | 8/195 [00:13<02:29,  1.25it/s]  5%|▌         | 10/195 [00:14<01:49,  1.69it/s]  6%|▌         | 12/195 [00:15<01:44,  1.76it/s]  7%|▋         | 13/195 [00:15<01:32,  1.97it/s]  7%|▋         | 14/195 [00:16<01:54,  1.58it/s]  8%|▊         | 15/195 [00:16<01:38,  1.82it/s]  8%|▊         | 16/195 [00:17<01:19,  2.24it/s]  9%|▊         | 17/195 [00:17<01:15,  2.36it/s]  9%|▉         | 18/195 [00:17<01:02,  2.83it/s] 10%|▉         | 19/195 [00:17<01:03,  2.78it/s] 11%|█         | 21/195 [00:18<00:53,  3.25it/s] 11%|█▏        | 22/195 [00:18<00:44,  3.88it/s] 12%|█▏        | 23/195 [00:19<00:54,  3.16it/s] 13%|█▎        | 25/195 [00:19<00:52,  3.27it/s] 13%|█▎        | 26/195 [00:19<00:51,  3.28it/s] 14%|█▍        | 27/195 [00:20<00:53,  3.11it/s] 14%|█▍        | 28/195 [00:20<00:51,  3.26it/s] 15%|█▍        | 29/195 [00:20<00:51,  3.21it/s] 15%|█▌        | 30/195 [00:21<00:53,  3.06it/s] 16%|█▌        | 31/195 [00:21<00:48,  3.41it/s] 16%|█▋        | 32/195 [00:21<00:54,  3.00it/s] 17%|█▋        | 34/195 [00:22<00:52,  3.04it/s] 18%|█▊        | 36/195 [00:23<00:50,  3.15it/s] 19%|█▉        | 38/195 [00:23<00:47,  3.31it/s] 20%|██        | 39/195 [00:24<00:46,  3.32it/s] 21%|██        | 40/195 [00:24<00:47,  3.26it/s] 21%|██        | 41/195 [00:24<00:47,  3.22it/s] 22%|██▏       | 42/195 [00:24<00:46,  3.30it/s] 22%|██▏       | 43/195 [00:25<00:49,  3.10it/s] 23%|██▎       | 44/195 [00:25<00:45,  3.32it/s] 23%|██▎       | 45/195 [00:25<00:48,  3.11it/s] 24%|██▎       | 46/195 [00:26<00:43,  3.44it/s] 24%|██▍       | 47/195 [00:26<00:46,  3.21it/s] 25%|██▍       | 48/195 [00:26<00:40,  3.67it/s] 25%|██▌       | 49/195 [00:27<00:44,  3.27it/s] 26%|██▌       | 50/195 [00:27<00:45,  3.19it/s] 26%|██▌       | 51/195 [00:27<00:55,  2.59it/s] 27%|██▋       | 52/195 [00:28<00:55,  2.58it/s] 27%|██▋       | 53/195 [00:28<01:02,  2.27it/s] 28%|██▊       | 54/195 [00:29<00:58,  2.40it/s] 28%|██▊       | 55/195 [00:29<01:04,  2.18it/s] 29%|██▊       | 56/195 [00:30<00:56,  2.44it/s] 29%|██▉       | 57/195 [00:30<01:04,  2.13it/s] 30%|██▉       | 58/195 [00:31<00:56,  2.43it/s] 30%|███       | 59/195 [00:31<01:07,  2.02it/s] 31%|███       | 60/195 [00:31<00:54,  2.46it/s] 31%|███▏      | 61/195 [00:32<00:56,  2.37it/s] 32%|███▏      | 63/195 [00:33<00:49,  2.64it/s] 33%|███▎      | 64/195 [00:33<00:41,  3.14it/s] 33%|███▎      | 65/195 [00:33<00:50,  2.56it/s] 34%|███▍      | 67/195 [00:34<00:44,  2.88it/s] 35%|███▍      | 68/195 [00:34<00:39,  3.20it/s] 35%|███▌      | 69/195 [00:34<00:40,  3.10it/s] 36%|███▌      | 70/195 [00:35<00:41,  3.00it/s] 36%|███▋      | 71/195 [00:35<00:36,  3.37it/s] 37%|███▋      | 72/195 [00:35<00:40,  3.02it/s] 38%|███▊      | 74/195 [00:36<00:39,  3.07it/s] 38%|███▊      | 75/195 [00:36<00:39,  3.06it/s] 39%|███▉      | 76/195 [00:37<00:35,  3.38it/s] 39%|███▉      | 77/195 [00:37<00:36,  3.26it/s] 40%|████      | 78/195 [00:37<00:31,  3.71it/s] 41%|████      | 79/195 [00:37<00:36,  3.15it/s] 42%|████▏     | 81/195 [00:38<00:35,  3.25it/s] 43%|████▎     | 83/195 [00:39<00:33,  3.31it/s] 44%|████▎     | 85/195 [00:39<00:34,  3.23it/s] 45%|████▍     | 87/195 [00:40<00:31,  3.39it/s] 46%|████▌     | 89/195 [00:41<00:33,  3.21it/s] 47%|████▋     | 91/195 [00:41<00:32,  3.24it/s] 48%|████▊     | 93/195 [00:42<00:32,  3.16it/s] 49%|████▊     | 95/195 [00:42<00:31,  3.22it/s] 50%|████▉     | 97/195 [00:43<00:30,  3.22it/s] 51%|█████     | 99/195 [00:44<00:30,  3.12it/s] 52%|█████▏    | 101/195 [00:45<00:34,  2.72it/s] 52%|█████▏    | 102/195 [00:45<00:34,  2.71it/s] 53%|█████▎    | 103/195 [00:46<00:37,  2.47it/s] 53%|█████▎    | 104/195 [00:46<00:38,  2.39it/s] 54%|█████▍    | 105/195 [00:46<00:38,  2.36it/s] 54%|█████▍    | 106/195 [00:47<00:39,  2.23it/s] 55%|█████▍    | 107/195 [00:47<00:38,  2.31it/s] 55%|█████▌    | 108/195 [00:48<00:40,  2.17it/s] 56%|█████▌    | 109/195 [00:48<00:36,  2.34it/s] 56%|█████▋    | 110/195 [00:49<00:39,  2.15it/s] 57%|█████▋    | 111/195 [00:49<00:35,  2.34it/s] 57%|█████▋    | 112/195 [00:50<00:40,  2.05it/s] 58%|█████▊    | 113/195 [00:50<00:35,  2.34it/s] 58%|█████▊    | 114/195 [00:51<00:41,  1.98it/s] 59%|█████▉    | 115/195 [00:51<00:35,  2.27it/s] 59%|█████▉    | 116/195 [00:52<00:38,  2.07it/s] 60%|██████    | 117/195 [00:52<00:34,  2.27it/s] 61%|██████    | 118/195 [00:53<00:38,  2.02it/s] 62%|██████▏   | 120/195 [00:53<00:33,  2.23it/s] 62%|██████▏   | 121/195 [00:54<00:29,  2.53it/s] 63%|██████▎   | 122/195 [00:54<00:29,  2.44it/s] 63%|██████▎   | 123/195 [00:54<00:27,  2.67it/s] 64%|██████▎   | 124/195 [00:55<00:28,  2.52it/s] 64%|██████▍   | 125/195 [00:55<00:25,  2.74it/s] 65%|██████▍   | 126/195 [00:56<00:26,  2.61it/s] 66%|██████▌   | 128/195 [00:56<00:23,  2.81it/s] 67%|██████▋   | 130/195 [00:57<00:23,  2.81it/s] 67%|██████▋   | 131/195 [00:57<00:20,  3.08it/s] 68%|██████▊   | 132/195 [00:57<00:20,  3.01it/s] 68%|██████▊   | 133/195 [00:58<00:20,  3.00it/s] 69%|██████▊   | 134/195 [00:58<00:19,  3.09it/s] 69%|██████▉   | 135/195 [00:58<00:20,  2.97it/s] 70%|██████▉   | 136/195 [00:59<00:18,  3.20it/s] 70%|███████   | 137/195 [00:59<00:19,  3.00it/s] 71%|███████   | 138/195 [00:59<00:17,  3.32it/s] 71%|███████▏  | 139/195 [01:00<00:18,  2.98it/s] 72%|███████▏  | 140/195 [01:00<00:16,  3.33it/s] 72%|███████▏  | 141/195 [01:00<00:18,  3.00it/s] 73%|███████▎  | 143/195 [01:01<00:15,  3.29it/s] 74%|███████▍  | 145/195 [01:01<00:14,  3.38it/s] 75%|███████▌  | 147/195 [01:02<00:14,  3.39it/s] 76%|███████▋  | 149/195 [01:03<00:13,  3.41it/s] 77%|███████▋  | 150/195 [01:03<00:13,  3.42it/s] 77%|███████▋  | 151/195 [01:03<00:13,  3.23it/s] 78%|███████▊  | 152/195 [01:04<00:13,  3.16it/s] 78%|███████▊  | 153/195 [01:04<00:13,  3.10it/s] 79%|███████▉  | 154/195 [01:04<00:14,  2.74it/s] 80%|████████  | 156/195 [01:05<00:12,  3.13it/s] 81%|████████  | 158/195 [01:06<00:11,  3.30it/s] 82%|████████▏ | 160/195 [01:06<00:10,  3.37it/s] 83%|████████▎ | 162/195 [01:07<00:09,  3.31it/s] 84%|████████▍ | 164/195 [01:07<00:09,  3.40it/s] 85%|████████▍ | 165/195 [01:08<00:08,  3.35it/s] 85%|████████▌ | 166/195 [01:08<00:08,  3.28it/s] 86%|████████▌ | 167/195 [01:08<00:08,  3.22it/s] 86%|████████▌ | 168/195 [01:09<00:08,  3.27it/s] 87%|████████▋ | 169/195 [01:09<00:08,  3.09it/s] 87%|████████▋ | 170/195 [01:09<00:07,  3.21it/s] 88%|████████▊ | 171/195 [01:10<00:07,  3.10it/s] 89%|████████▊ | 173/195 [01:10<00:06,  3.25it/s] 89%|████████▉ | 174/195 [01:10<00:06,  3.22it/s] 90%|████████▉ | 175/195 [01:11<00:05,  3.35it/s] 90%|█████████ | 176/195 [01:11<00:06,  3.08it/s] 91%|█████████ | 177/195 [01:11<00:05,  3.41it/s] 91%|█████████▏| 178/195 [01:12<00:05,  3.05it/s] 92%|█████████▏| 180/195 [01:13<00:05,  2.79it/s] 93%|█████████▎| 182/195 [01:13<00:04,  2.87it/s] 94%|█████████▍| 184/195 [01:14<00:03,  3.03it/s] 95%|█████████▍| 185/195 [01:14<00:03,  3.05it/s] 95%|█████████▌| 186/195 [01:14<00:03,  2.92it/s] 96%|█████████▌| 187/195 [01:15<00:02,  3.10it/s] 96%|█████████▋| 188/195 [01:15<00:02,  3.07it/s] 97%|█████████▋| 189/195 [01:15<00:01,  3.08it/s] 97%|█████████▋| 190/195 [01:16<00:01,  3.09it/s] 98%|█████████▊| 191/195 [01:16<00:01,  2.95it/s] 98%|█████████▊| 192/195 [01:16<00:00,  3.25it/s] 99%|█████████▉| 193/195 [01:17<00:00,  3.02it/s] 99%|█████████▉| 194/195 [01:17<00:00,  3.37it/s]100%|██████████| 195/195 [01:17<00:00,  3.67it/s]100%|██████████| 195/195 [01:19<00:00,  2.45it/s]
2025-08-20 21:18:49 [info     ] Validating outputs
2025-08-20 21:18:49 [info     ] Predict - end                  time=0:1:19
2025-08-20 21:18:49 [info     ] Evaluate - start               split=test
2025-08-20 21:18:49 [info     ] Evaluate - end                 correctness_llm=0.32 monotonicity=0.62
2025-08-20 21:18:49 [info     ] Evaluate question difficulty - start split=test
2025-08-20 21:18:49 [info     ] Augmenting questions for IRT estimation num_questions=14
2025-08-20 21:18:49 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 21:18:49 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1026.18it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3501.46it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 609.39it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7217.34it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1215.94it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3538.73it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 544.96it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5816.19it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 977.27it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3507.32it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 569.39it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6229.60it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1029.28it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3589.04it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 671.40it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6173.28it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 934.23it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3885.74it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 665.84it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6808.94it/s]
2025-08-20 21:18:53 INFO: EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
2025-08-20 21:18:53 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 21:18:53 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 21:18:53 [info     ] Evaluate question difficulty - end rmse=2.21897658196228 split=test
2025-08-20 21:18:53 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 2 finished: 0:1:34

 ********** Run: 3/3 **********
2025-08-20 21:19:14 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 21:19:14 [info     ] Reading train split questions  num_questions=92
2025-08-20 21:19:14 [info     ] Reading validation split questions num_questions=23
2025-08-20 21:19:14 [info     ] Reading test split questions   num_questions=39
2025-08-20 21:19:16 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 21:19:16 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 21:19:21 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 21:19:21 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 21:19:21 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 21:19:22 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 21:19:25 [info     ] Setting seed                   value=45
2025-08-20 21:19:25 [info     ] Building structured outputter  name=student_kt
2025-08-20 21:19:25 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_random native_structured_output=True num_examples=3 system_prompt=student_chocolate_level_context
2025-08-20 21:19:25 [info     ] Building example selector
2025-08-20 21:19:25 [info     ] Building model                 name=qwen3:8b provider=ollama rate_limit=None temp=0.0
2025-08-20 21:19:25 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:10<32:54, 10.18s/it]  1%|          | 2/195 [00:10<14:03,  4.37s/it]  2%|▏         | 3/195 [00:12<09:57,  3.11s/it]  2%|▏         | 4/195 [00:12<06:24,  2.02s/it]  3%|▎         | 5/195 [00:13<05:23,  1.70s/it]  4%|▎         | 7/195 [00:14<03:13,  1.03s/it]  5%|▍         | 9/195 [00:15<02:18,  1.35it/s]  5%|▌         | 10/195 [00:15<01:58,  1.57it/s]  6%|▌         | 11/195 [00:15<01:50,  1.66it/s]  7%|▋         | 13/195 [00:16<01:23,  2.17it/s]  8%|▊         | 15/195 [00:16<01:11,  2.51it/s]  9%|▊         | 17/195 [00:17<01:03,  2.81it/s]  9%|▉         | 18/195 [00:17<00:59,  2.95it/s] 10%|▉         | 19/195 [00:18<00:56,  3.09it/s] 10%|█         | 20/195 [00:18<00:56,  3.10it/s] 11%|█         | 21/195 [00:18<00:50,  3.43it/s] 11%|█▏        | 22/195 [00:18<00:51,  3.35it/s] 12%|█▏        | 23/195 [00:18<00:44,  3.87it/s] 12%|█▏        | 24/195 [00:19<00:48,  3.49it/s] 13%|█▎        | 26/195 [00:19<00:48,  3.48it/s] 14%|█▍        | 27/195 [00:20<00:48,  3.48it/s] 14%|█▍        | 28/195 [00:20<00:51,  3.22it/s] 15%|█▍        | 29/195 [00:20<00:48,  3.44it/s] 15%|█▌        | 30/195 [00:21<00:55,  3.00it/s] 16%|█▌        | 31/195 [00:21<00:52,  3.15it/s] 16%|█▋        | 32/195 [00:21<00:57,  2.84it/s] 17%|█▋        | 34/195 [00:22<00:55,  2.93it/s] 18%|█▊        | 36/195 [00:23<00:52,  3.06it/s] 19%|█▉        | 38/195 [00:24<00:53,  2.92it/s] 21%|██        | 40/195 [00:24<00:50,  3.06it/s] 21%|██        | 41/195 [00:24<00:51,  3.01it/s] 22%|██▏       | 42/195 [00:25<00:47,  3.22it/s] 22%|██▏       | 43/195 [00:25<00:51,  2.95it/s] 23%|██▎       | 44/195 [00:25<00:47,  3.19it/s] 23%|██▎       | 45/195 [00:26<00:49,  3.04it/s] 24%|██▎       | 46/195 [00:26<00:43,  3.45it/s] 24%|██▍       | 47/195 [00:26<00:48,  3.03it/s] 25%|██▌       | 49/195 [00:27<00:44,  3.32it/s] 26%|██▌       | 50/195 [00:27<00:44,  3.29it/s] 26%|██▌       | 51/195 [00:28<00:52,  2.73it/s] 27%|██▋       | 52/195 [00:28<00:51,  2.80it/s] 27%|██▋       | 53/195 [00:29<00:58,  2.42it/s] 28%|██▊       | 54/195 [00:29<00:54,  2.57it/s] 28%|██▊       | 55/195 [00:30<01:01,  2.26it/s] 29%|██▊       | 56/195 [00:30<00:56,  2.45it/s] 29%|██▉       | 57/195 [00:30<01:02,  2.20it/s] 30%|██▉       | 58/195 [00:31<00:57,  2.39it/s] 30%|███       | 59/195 [00:31<01:02,  2.17it/s] 31%|███       | 60/195 [00:32<00:52,  2.58it/s] 31%|███▏      | 61/195 [00:32<00:54,  2.46it/s] 32%|███▏      | 63/195 [00:33<00:45,  2.93it/s] 33%|███▎      | 64/195 [00:33<00:37,  3.50it/s] 33%|███▎      | 65/195 [00:33<00:47,  2.72it/s] 34%|███▍      | 66/195 [00:33<00:41,  3.14it/s] 34%|███▍      | 67/195 [00:34<00:43,  2.98it/s] 35%|███▍      | 68/195 [00:34<00:38,  3.29it/s] 35%|███▌      | 69/195 [00:34<00:44,  2.82it/s] 36%|███▋      | 71/195 [00:35<00:40,  3.05it/s] 37%|███▋      | 73/195 [00:36<00:38,  3.13it/s] 38%|███▊      | 75/195 [00:36<00:37,  3.23it/s] 39%|███▉      | 76/195 [00:37<00:37,  3.14it/s] 39%|███▉      | 77/195 [00:37<00:33,  3.48it/s] 40%|████      | 78/195 [00:37<00:37,  3.11it/s] 41%|████      | 80/195 [00:38<00:37,  3.08it/s] 42%|████▏     | 82/195 [00:38<00:34,  3.26it/s] 43%|████▎     | 83/195 [00:39<00:35,  3.20it/s] 43%|████▎     | 84/195 [00:39<00:33,  3.36it/s] 44%|████▎     | 85/195 [00:39<00:35,  3.13it/s] 45%|████▍     | 87/195 [00:40<00:34,  3.09it/s] 45%|████▌     | 88/195 [00:40<00:31,  3.38it/s] 46%|████▌     | 89/195 [00:41<00:32,  3.24it/s] 46%|████▌     | 90/195 [00:41<00:33,  3.12it/s] 47%|████▋     | 91/195 [00:41<00:29,  3.49it/s] 47%|████▋     | 92/195 [00:42<00:32,  3.14it/s] 48%|████▊     | 94/195 [00:42<00:30,  3.26it/s] 49%|████▊     | 95/195 [00:42<00:30,  3.28it/s] 49%|████▉     | 96/195 [00:43<00:27,  3.59it/s] 50%|████▉     | 97/195 [00:43<00:30,  3.22it/s] 51%|█████     | 99/195 [00:44<00:28,  3.35it/s] 52%|█████▏    | 101/195 [00:45<00:34,  2.74it/s] 53%|█████▎    | 103/195 [00:45<00:36,  2.50it/s] 54%|█████▍    | 105/195 [00:46<00:36,  2.48it/s] 54%|█████▍    | 106/195 [00:47<00:34,  2.57it/s] 55%|█████▍    | 107/195 [00:47<00:37,  2.37it/s] 55%|█████▌    | 108/195 [00:48<00:35,  2.44it/s] 56%|█████▌    | 109/195 [00:48<00:37,  2.29it/s] 56%|█████▋    | 110/195 [00:48<00:36,  2.32it/s] 57%|█████▋    | 111/195 [00:49<00:35,  2.35it/s] 57%|█████▋    | 112/195 [00:49<00:36,  2.29it/s] 58%|█████▊    | 113/195 [00:50<00:35,  2.34it/s] 58%|█████▊    | 114/195 [00:50<00:36,  2.20it/s] 59%|█████▉    | 115/195 [00:51<00:35,  2.28it/s] 59%|█████▉    | 116/195 [00:51<00:36,  2.16it/s] 60%|██████    | 117/195 [00:52<00:35,  2.22it/s] 61%|██████    | 118/195 [00:52<00:37,  2.04it/s] 61%|██████    | 119/195 [00:53<00:35,  2.17it/s] 62%|██████▏   | 120/195 [00:53<00:36,  2.06it/s] 63%|██████▎   | 122/195 [00:54<00:29,  2.51it/s] 63%|██████▎   | 123/195 [00:54<00:27,  2.66it/s] 64%|██████▎   | 124/195 [00:54<00:26,  2.65it/s] 64%|██████▍   | 125/195 [00:55<00:24,  2.90it/s] 65%|██████▍   | 126/195 [00:55<00:23,  2.95it/s] 65%|██████▌   | 127/195 [00:55<00:22,  3.07it/s] 66%|██████▌   | 128/195 [00:56<00:20,  3.19it/s] 66%|██████▌   | 129/195 [00:56<00:20,  3.21it/s] 67%|██████▋   | 130/195 [00:56<00:21,  2.98it/s] 67%|██████▋   | 131/195 [00:57<00:20,  3.12it/s] 68%|██████▊   | 132/195 [00:57<00:22,  2.81it/s] 68%|██████▊   | 133/195 [00:57<00:20,  3.05it/s] 69%|██████▊   | 134/195 [00:58<00:22,  2.76it/s] 69%|██████▉   | 135/195 [00:58<00:21,  2.86it/s] 70%|██████▉   | 136/195 [00:58<00:20,  2.83it/s] 70%|███████   | 137/195 [00:59<00:20,  2.83it/s] 71%|███████   | 138/195 [00:59<00:18,  3.01it/s] 71%|███████▏  | 139/195 [00:59<00:20,  2.78it/s] 72%|███████▏  | 140/195 [01:00<00:17,  3.12it/s] 72%|███████▏  | 141/195 [01:00<00:18,  2.95it/s] 73%|███████▎  | 143/195 [01:01<00:16,  3.07it/s] 74%|███████▍  | 144/195 [01:01<00:15,  3.25it/s] 74%|███████▍  | 145/195 [01:01<00:15,  3.24it/s] 75%|███████▍  | 146/195 [01:02<00:16,  3.02it/s] 76%|███████▌  | 148/195 [01:02<00:15,  3.06it/s] 77%|███████▋  | 150/195 [01:03<00:15,  2.98it/s] 78%|███████▊  | 152/195 [01:04<00:14,  2.90it/s] 79%|███████▉  | 154/195 [01:04<00:14,  2.86it/s] 79%|███████▉  | 155/195 [01:05<00:13,  2.91it/s] 80%|████████  | 156/195 [01:05<00:12,  3.15it/s] 81%|████████  | 157/195 [01:05<00:12,  2.96it/s] 82%|████████▏ | 159/195 [01:06<00:11,  3.25it/s] 83%|████████▎ | 161/195 [01:07<00:10,  3.24it/s] 83%|████████▎ | 162/195 [01:07<00:09,  3.53it/s] 84%|████████▎ | 163/195 [01:07<00:09,  3.39it/s] 84%|████████▍ | 164/195 [01:07<00:09,  3.31it/s] 85%|████████▍ | 165/195 [01:08<00:08,  3.36it/s] 85%|████████▌ | 166/195 [01:08<00:09,  3.04it/s] 86%|████████▌ | 168/195 [01:09<00:09,  2.94it/s] 87%|████████▋ | 169/195 [01:09<00:08,  3.13it/s] 87%|████████▋ | 170/195 [01:09<00:08,  3.01it/s] 88%|████████▊ | 171/195 [01:10<00:07,  3.03it/s] 88%|████████▊ | 172/195 [01:10<00:06,  3.36it/s] 89%|████████▊ | 173/195 [01:10<00:06,  3.16it/s] 89%|████████▉ | 174/195 [01:10<00:05,  3.60it/s] 90%|████████▉ | 175/195 [01:11<00:06,  3.15it/s] 91%|█████████ | 177/195 [01:11<00:05,  3.31it/s] 91%|█████████▏| 178/195 [01:12<00:05,  3.25it/s] 92%|█████████▏| 179/195 [01:12<00:04,  3.21it/s] 92%|█████████▏| 180/195 [01:13<00:04,  3.01it/s] 93%|█████████▎| 182/195 [01:13<00:04,  3.12it/s] 94%|█████████▍| 184/195 [01:14<00:03,  3.21it/s] 95%|█████████▍| 185/195 [01:14<00:03,  3.24it/s] 95%|█████████▌| 186/195 [01:14<00:02,  3.10it/s] 96%|█████████▌| 187/195 [01:15<00:02,  3.34it/s] 96%|█████████▋| 188/195 [01:15<00:02,  3.11it/s] 97%|█████████▋| 190/195 [01:16<00:01,  3.16it/s] 98%|█████████▊| 192/195 [01:16<00:00,  3.22it/s] 99%|█████████▉| 194/195 [01:17<00:00,  3.34it/s]100%|██████████| 195/195 [01:19<00:00,  2.44it/s]
2025-08-20 21:20:45 [info     ] Validating outputs
2025-08-20 21:20:45 [info     ] Predict - end                  time=0:1:19
2025-08-20 21:20:45 [info     ] Evaluate - start               split=test
2025-08-20 21:20:45 [info     ] Evaluate - end                 correctness_llm=0.35 monotonicity=0.71
2025-08-20 21:20:45 [info     ] Evaluate question difficulty - start split=test
2025-08-20 21:20:45 [info     ] Augmenting questions for IRT estimation num_questions=16
2025-08-20 21:20:45 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 21:20:45 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1040.29it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3548.33it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 523.05it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5943.35it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 984.91it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3676.98it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 560.43it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5716.54it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 942.33it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3504.91it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 549.95it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 4665.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1106.22it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3424.57it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 636.75it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5944.55it/s]
2025-08-20 21:20:49 INFO: EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
2025-08-20 21:20:49 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 21:20:49 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 21:20:49 [info     ] Evaluate question difficulty - end rmse=2.5311566182179797 split=test
2025-08-20 21:20:49 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 3 finished: 0:1:34

 ========== Config: qwen3:14b~T_0.0~SO_teacher_kt~L_5~SP_teacher_marshmellow_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_miscon_studentlevel_random3 ==========
Config 8/8

 ********** Run: 1/3 **********
2025-08-20 21:21:16 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 21:21:16 [info     ] Reading train split questions  num_questions=92
2025-08-20 21:21:16 [info     ] Reading validation split questions num_questions=23
2025-08-20 21:21:16 [info     ] Reading test split questions   num_questions=39
2025-08-20 21:21:18 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 21:21:18 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 21:21:23 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 21:21:23 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 21:21:23 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 21:21:24 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 21:21:27 [info     ] Setting seed                   value=43
2025-08-20 21:21:27 [info     ] Building structured outputter  name=teacher_kt
2025-08-20 21:21:27 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_random native_structured_output=True num_examples=3 system_prompt=teacher_marshmellow_level_context
2025-08-20 21:21:27 [info     ] Building example selector
2025-08-20 21:21:27 [info     ] Building model                 name=qwen3:14b provider=ollama rate_limit=None temp=0.0
2025-08-20 21:21:27 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:13<43:41, 13.51s/it]  1%|          | 2/195 [00:14<19:37,  6.10s/it]  2%|▏         | 3/195 [00:16<13:30,  4.22s/it]  2%|▏         | 4/195 [00:17<09:46,  3.07s/it]  3%|▎         | 5/195 [00:18<06:57,  2.20s/it]  3%|▎         | 6/195 [00:18<05:01,  1.59s/it]  4%|▎         | 7/195 [00:20<04:49,  1.54s/it]  4%|▍         | 8/195 [00:20<03:29,  1.12s/it]  5%|▍         | 9/195 [00:20<02:54,  1.07it/s]  5%|▌         | 10/195 [00:21<02:27,  1.25it/s]  6%|▌         | 11/195 [00:21<01:57,  1.56it/s]  6%|▌         | 12/195 [00:22<01:41,  1.80it/s]  7%|▋         | 13/195 [00:22<01:22,  2.20it/s]  7%|▋         | 14/195 [00:22<01:19,  2.27it/s]  8%|▊         | 16/195 [00:23<01:07,  2.64it/s]  9%|▉         | 18/195 [00:23<01:02,  2.84it/s] 10%|█         | 20/195 [00:24<00:59,  2.92it/s] 11%|█▏        | 22/195 [00:25<00:57,  3.01it/s] 12%|█▏        | 24/195 [00:25<00:55,  3.05it/s] 13%|█▎        | 26/195 [00:26<00:57,  2.96it/s] 14%|█▍        | 27/195 [00:26<00:55,  3.04it/s] 14%|█▍        | 28/195 [00:27<00:58,  2.84it/s] 15%|█▍        | 29/195 [00:27<00:56,  2.95it/s] 15%|█▌        | 30/195 [00:28<01:01,  2.67it/s] 16%|█▌        | 31/195 [00:28<01:01,  2.66it/s] 16%|█▋        | 32/195 [00:28<01:04,  2.54it/s] 17%|█▋        | 33/195 [00:29<01:05,  2.47it/s] 17%|█▋        | 34/195 [00:29<01:03,  2.55it/s] 18%|█▊        | 35/195 [00:30<01:04,  2.47it/s] 18%|█▊        | 36/195 [00:30<01:00,  2.64it/s] 19%|█▉        | 37/195 [00:30<01:03,  2.49it/s] 19%|█▉        | 38/195 [00:31<00:58,  2.70it/s] 20%|██        | 39/195 [00:31<01:06,  2.33it/s] 21%|██        | 41/195 [00:32<01:03,  2.44it/s] 22%|██▏       | 43/195 [00:33<01:00,  2.50it/s] 23%|██▎       | 44/195 [00:33<00:57,  2.64it/s] 23%|██▎       | 45/195 [00:34<01:00,  2.49it/s] 24%|██▎       | 46/195 [00:34<00:55,  2.70it/s] 24%|██▍       | 47/195 [00:34<00:58,  2.54it/s] 25%|██▌       | 49/195 [00:35<00:53,  2.72it/s] 26%|██▌       | 51/195 [00:36<01:02,  2.32it/s] 27%|██▋       | 52/195 [00:37<01:01,  2.32it/s] 27%|██▋       | 53/195 [00:37<01:08,  2.07it/s] 28%|██▊       | 54/195 [00:38<01:07,  2.08it/s] 28%|██▊       | 55/195 [00:38<01:12,  1.94it/s] 29%|██▊       | 56/195 [00:39<01:10,  1.98it/s] 29%|██▉       | 57/195 [00:39<01:13,  1.88it/s] 30%|██▉       | 58/195 [00:40<01:11,  1.92it/s] 30%|███       | 59/195 [00:40<01:13,  1.84it/s] 31%|███       | 60/195 [00:41<01:04,  2.11it/s] 31%|███▏      | 61/195 [00:41<01:03,  2.11it/s] 32%|███▏      | 62/195 [00:42<00:57,  2.32it/s] 32%|███▏      | 63/195 [00:42<00:56,  2.33it/s] 33%|███▎      | 64/195 [00:42<00:54,  2.39it/s] 33%|███▎      | 65/195 [00:43<00:51,  2.55it/s] 34%|███▍      | 66/195 [00:43<00:52,  2.46it/s] 34%|███▍      | 67/195 [00:43<00:46,  2.76it/s] 35%|███▍      | 68/195 [00:44<00:50,  2.50it/s] 36%|███▌      | 70/195 [00:45<00:48,  2.56it/s] 36%|███▋      | 71/195 [00:45<00:40,  3.05it/s] 37%|███▋      | 72/195 [00:45<00:51,  2.40it/s] 38%|███▊      | 74/195 [00:46<00:48,  2.50it/s] 38%|███▊      | 75/195 [00:47<00:47,  2.54it/s] 39%|███▉      | 76/195 [00:47<00:42,  2.81it/s] 39%|███▉      | 77/195 [00:47<00:44,  2.65it/s] 41%|████      | 79/195 [00:48<00:42,  2.76it/s] 42%|████▏     | 81/195 [00:49<00:41,  2.77it/s] 43%|████▎     | 83/195 [00:49<00:39,  2.85it/s] 44%|████▎     | 85/195 [00:50<00:38,  2.87it/s] 44%|████▍     | 86/195 [00:50<00:36,  2.97it/s] 45%|████▍     | 87/195 [00:51<00:39,  2.74it/s] 45%|████▌     | 88/195 [00:51<00:40,  2.66it/s] 46%|████▌     | 89/195 [00:52<00:39,  2.67it/s] 46%|████▌     | 90/195 [00:52<00:39,  2.68it/s] 47%|████▋     | 91/195 [00:52<00:38,  2.71it/s] 47%|████▋     | 92/195 [00:53<00:39,  2.61it/s] 48%|████▊     | 93/195 [00:53<00:38,  2.67it/s] 48%|████▊     | 94/195 [00:53<00:40,  2.52it/s] 49%|████▊     | 95/195 [00:54<00:36,  2.73it/s] 49%|████▉     | 96/195 [00:54<00:38,  2.58it/s] 50%|████▉     | 97/195 [00:54<00:33,  2.90it/s] 50%|█████     | 98/195 [00:55<00:36,  2.64it/s] 51%|█████▏    | 100/195 [00:56<00:40,  2.34it/s] 52%|█████▏    | 101/195 [00:57<00:44,  2.12it/s] 52%|█████▏    | 102/195 [00:57<00:48,  1.91it/s] 53%|█████▎    | 103/195 [00:58<00:49,  1.84it/s] 53%|█████▎    | 104/195 [00:58<00:50,  1.80it/s] 54%|█████▍    | 105/195 [00:59<00:52,  1.73it/s] 54%|█████▍    | 106/195 [01:00<00:49,  1.78it/s] 55%|█████▍    | 107/195 [01:00<00:52,  1.67it/s] 55%|█████▌    | 108/195 [01:01<00:48,  1.80it/s] 56%|█████▌    | 109/195 [01:01<00:51,  1.66it/s] 56%|█████▋    | 110/195 [01:02<00:48,  1.74it/s] 57%|█████▋    | 111/195 [01:03<00:50,  1.66it/s] 58%|█████▊    | 113/195 [01:04<00:47,  1.72it/s] 59%|█████▉    | 115/195 [01:05<00:46,  1.70it/s] 60%|██████    | 117/195 [01:06<00:45,  1.70it/s] 61%|██████    | 119/195 [01:07<00:44,  1.70it/s] 62%|██████▏   | 121/195 [01:08<00:38,  1.92it/s] 63%|██████▎   | 123/195 [01:09<00:34,  2.08it/s] 64%|██████▎   | 124/195 [01:09<00:32,  2.21it/s] 64%|██████▍   | 125/195 [01:10<00:32,  2.15it/s] 65%|██████▌   | 127/195 [01:10<00:30,  2.24it/s] 66%|██████▌   | 129/195 [01:11<00:28,  2.32it/s] 67%|██████▋   | 131/195 [01:12<00:27,  2.36it/s] 68%|██████▊   | 133/195 [01:13<00:25,  2.40it/s] 69%|██████▊   | 134/195 [01:13<00:24,  2.51it/s] 69%|██████▉   | 135/195 [01:14<00:25,  2.34it/s] 70%|███████   | 137/195 [01:14<00:23,  2.42it/s] 71%|███████▏  | 139/195 [01:15<00:22,  2.44it/s] 72%|███████▏  | 141/195 [01:16<00:21,  2.52it/s] 73%|███████▎  | 143/195 [01:17<00:20,  2.54it/s] 74%|███████▍  | 145/195 [01:18<00:19,  2.62it/s] 75%|███████▌  | 147/195 [01:18<00:18,  2.62it/s] 76%|███████▋  | 149/195 [01:19<00:17,  2.66it/s] 77%|███████▋  | 151/195 [01:20<00:17,  2.55it/s] 78%|███████▊  | 153/195 [01:21<00:16,  2.47it/s] 79%|███████▉  | 155/195 [01:22<00:16,  2.47it/s] 81%|████████  | 157/195 [01:22<00:14,  2.63it/s] 82%|████████▏ | 159/195 [01:23<00:13,  2.77it/s] 83%|████████▎ | 161/195 [01:24<00:12,  2.79it/s] 83%|████████▎ | 162/195 [01:24<00:10,  3.18it/s] 84%|████████▎ | 163/195 [01:24<00:11,  2.69it/s] 84%|████████▍ | 164/195 [01:24<00:09,  3.18it/s] 85%|████████▍ | 165/195 [01:25<00:11,  2.60it/s] 86%|████████▌ | 167/195 [01:26<00:10,  2.58it/s] 87%|████████▋ | 169/195 [01:26<00:09,  2.61it/s] 88%|████████▊ | 171/195 [01:27<00:09,  2.63it/s] 89%|████████▊ | 173/195 [01:28<00:08,  2.65it/s] 90%|████████▉ | 175/195 [01:29<00:07,  2.66it/s] 90%|█████████ | 176/195 [01:29<00:06,  2.75it/s] 91%|█████████ | 177/195 [01:30<00:06,  2.60it/s] 91%|█████████▏| 178/195 [01:30<00:06,  2.56it/s] 92%|█████████▏| 179/195 [01:30<00:06,  2.61it/s] 92%|█████████▏| 180/195 [01:31<00:06,  2.40it/s] 93%|█████████▎| 181/195 [01:31<00:05,  2.60it/s] 93%|█████████▎| 182/195 [01:32<00:05,  2.44it/s] 94%|█████████▍| 184/195 [01:32<00:04,  2.56it/s] 95%|█████████▌| 186/195 [01:33<00:03,  2.62it/s] 96%|█████████▋| 188/195 [01:34<00:02,  2.61it/s] 97%|█████████▋| 190/195 [01:35<00:01,  2.56it/s] 98%|█████████▊| 191/195 [01:35<00:01,  2.65it/s] 98%|█████████▊| 192/195 [01:35<00:01,  2.43it/s] 99%|█████████▉| 194/195 [01:36<00:00,  2.44it/s]100%|██████████| 195/195 [01:38<00:00,  1.97it/s]
2025-08-20 21:23:06 [info     ] Validating outputs
2025-08-20 21:23:06 [info     ] Predict - end                  time=0:1:39
2025-08-20 21:23:06 [info     ] Evaluate - start               split=test
2025-08-20 21:23:06 [info     ] Evaluate - end                 correctness_llm=0.24 monotonicity=0.99
2025-08-20 21:23:06 [info     ] Evaluate question difficulty - start split=test
2025-08-20 21:23:06 [info     ] Augmenting questions for IRT estimation num_questions=2
2025-08-20 21:23:06 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 21:23:06 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1043.66it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3714.39it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 470.88it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6386.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1038.05it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3439.54it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 569.86it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6245.51it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1101.16it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3644.70it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 576.33it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7675.85it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1044.81it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3716.24it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 571.22it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6352.26it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1040.11it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3696.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 639.60it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6385.41it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1063.16it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3643.65it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 569.31it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6368.79it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1003.01it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3959.96it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 606.10it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7064.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1058.79it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3783.20it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 605.81it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5780.69it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 994.89it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 4037.46it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 618.10it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6356.38it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 993.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3701.11it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 653.08it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6248.17it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1005.79it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3539.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 649.70it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5955.40it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1006.31it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3690.50it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 566.83it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 4408.43it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1060.32it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3631.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 628.78it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 2241.74it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1223.49it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3676.98it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 633.46it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6209.84it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1119.50it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3997.41it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 600.48it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6183.68it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1084.24it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3612.74it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 652.75it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6549.21it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1082.00it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 4094.67it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 618.36it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6469.84it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1059.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3486.98it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 638.44it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7215.56it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1018.95it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3696.76it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 633.54it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7240.48it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1149.89it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3736.02it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 621.50it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6796.33it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1018.49it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3544.48it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 660.16it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6205.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1090.89it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3565.42it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 714.36it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6449.94it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1007.31it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3728.61it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 763.79it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6474.12it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1139.18it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3703.87it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 601.36it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6562.39it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1140.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3797.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 633.38it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7263.76it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1056.54it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3729.80it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 603.76it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6043.67it/s]
2025-08-20 21:23:25 INFO: EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
EM converged at iteration 26.
2025-08-20 21:23:25 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 21:23:25 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 21:23:25 [info     ] Evaluate question difficulty - end rmse=2.2505419607448163 split=test
2025-08-20 21:23:25 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 1 finished: 0:2:8

 ********** Run: 2/3 **********
2025-08-20 21:23:30 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 21:23:30 [info     ] Reading train split questions  num_questions=92
2025-08-20 21:23:30 [info     ] Reading validation split questions num_questions=23
2025-08-20 21:23:30 [info     ] Reading test split questions   num_questions=39
2025-08-20 21:23:32 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 21:23:32 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 21:23:36 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 21:23:36 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 21:23:36 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 21:23:37 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 21:23:40 [info     ] Setting seed                   value=44
2025-08-20 21:23:40 [info     ] Building structured outputter  name=teacher_kt
2025-08-20 21:23:40 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_random native_structured_output=True num_examples=3 system_prompt=teacher_marshmellow_level_context
2025-08-20 21:23:40 [info     ] Building example selector
2025-08-20 21:23:40 [info     ] Building model                 name=qwen3:14b provider=ollama rate_limit=None temp=0.0
2025-08-20 21:23:40 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:10<34:04, 10.54s/it]  2%|▏         | 3/195 [00:13<11:55,  3.73s/it]  3%|▎         | 5/195 [00:16<07:59,  2.53s/it]  4%|▎         | 7/195 [00:17<05:17,  1.69s/it]  4%|▍         | 8/195 [00:17<04:24,  1.41s/it]  5%|▍         | 9/195 [00:18<03:45,  1.21s/it]  5%|▌         | 10/195 [00:18<02:57,  1.04it/s]  6%|▌         | 11/195 [00:18<02:28,  1.24it/s]  6%|▌         | 12/195 [00:19<02:00,  1.52it/s]  7%|▋         | 13/195 [00:19<01:43,  1.75it/s]  7%|▋         | 14/195 [00:19<01:31,  1.97it/s]  8%|▊         | 15/195 [00:20<01:20,  2.24it/s]  8%|▊         | 16/195 [00:20<01:18,  2.28it/s]  9%|▊         | 17/195 [00:20<01:07,  2.63it/s]  9%|▉         | 18/195 [00:21<01:09,  2.54it/s] 10%|█         | 20/195 [00:21<01:03,  2.75it/s] 11%|█         | 21/195 [00:22<00:58,  2.96it/s] 11%|█▏        | 22/195 [00:22<01:02,  2.78it/s] 12%|█▏        | 24/195 [00:23<01:00,  2.81it/s] 13%|█▎        | 26/195 [00:24<01:04,  2.64it/s] 14%|█▍        | 28/195 [00:24<01:02,  2.65it/s] 15%|█▌        | 30/195 [00:25<01:03,  2.59it/s] 16%|█▋        | 32/195 [00:26<01:04,  2.54it/s] 17%|█▋        | 34/195 [00:27<01:04,  2.50it/s] 18%|█▊        | 35/195 [00:27<01:02,  2.57it/s] 18%|█▊        | 36/195 [00:28<01:03,  2.51it/s] 19%|█▉        | 37/195 [00:28<01:01,  2.55it/s] 19%|█▉        | 38/195 [00:28<01:00,  2.60it/s] 20%|██        | 39/195 [00:29<01:05,  2.39it/s] 21%|██        | 40/195 [00:29<00:58,  2.64it/s] 21%|██        | 41/195 [00:30<01:06,  2.31it/s] 22%|██▏       | 43/195 [00:30<01:00,  2.50it/s] 23%|██▎       | 44/195 [00:31<00:56,  2.68it/s] 23%|██▎       | 45/195 [00:31<00:59,  2.50it/s] 24%|██▎       | 46/195 [00:31<00:54,  2.72it/s] 24%|██▍       | 47/195 [00:32<00:57,  2.57it/s] 25%|██▌       | 49/195 [00:33<00:54,  2.70it/s] 26%|██▌       | 51/195 [00:34<01:02,  2.31it/s] 27%|██▋       | 53/195 [00:35<01:06,  2.12it/s] 28%|██▊       | 55/195 [00:36<01:09,  2.02it/s] 29%|██▉       | 57/195 [00:37<01:09,  1.99it/s] 30%|███       | 59/195 [00:38<01:09,  1.96it/s] 31%|███▏      | 61/195 [00:39<01:03,  2.11it/s] 32%|███▏      | 63/195 [00:39<00:58,  2.24it/s] 33%|███▎      | 65/195 [00:40<00:54,  2.37it/s] 34%|███▍      | 67/195 [00:41<00:51,  2.50it/s] 35%|███▌      | 69/195 [00:42<00:49,  2.57it/s] 36%|███▋      | 71/195 [00:42<00:47,  2.59it/s] 37%|███▋      | 73/195 [00:43<00:47,  2.60it/s] 38%|███▊      | 74/195 [00:43<00:40,  2.95it/s] 38%|███▊      | 75/195 [00:44<00:48,  2.47it/s] 39%|███▉      | 76/195 [00:44<00:44,  2.67it/s] 39%|███▉      | 77/195 [00:45<00:45,  2.59it/s] 40%|████      | 78/195 [00:45<00:42,  2.74it/s] 41%|████      | 79/195 [00:45<00:43,  2.67it/s] 41%|████      | 80/195 [00:46<00:41,  2.76it/s] 42%|████▏     | 81/195 [00:46<00:39,  2.92it/s] 42%|████▏     | 82/195 [00:46<00:40,  2.76it/s] 43%|████▎     | 83/195 [00:47<00:36,  3.07it/s] 43%|████▎     | 84/195 [00:47<00:39,  2.79it/s] 44%|████▍     | 86/195 [00:48<00:40,  2.70it/s] 45%|████▌     | 88/195 [00:49<00:39,  2.72it/s] 46%|████▌     | 90/195 [00:49<00:39,  2.67it/s] 47%|████▋     | 91/195 [00:50<00:37,  2.77it/s] 47%|████▋     | 92/195 [00:50<00:40,  2.55it/s] 48%|████▊     | 94/195 [00:51<00:38,  2.62it/s] 49%|████▉     | 96/195 [00:52<00:37,  2.65it/s] 50%|█████     | 98/195 [00:52<00:35,  2.75it/s] 51%|█████     | 99/195 [00:53<00:33,  2.91it/s] 51%|█████▏    | 100/195 [00:53<00:38,  2.45it/s] 52%|█████▏    | 101/195 [00:54<00:44,  2.13it/s] 52%|█████▏    | 102/195 [00:54<00:45,  2.06it/s] 53%|█████▎    | 103/195 [00:55<00:50,  1.81it/s] 53%|█████▎    | 104/195 [00:56<00:49,  1.83it/s] 54%|█████▍    | 105/195 [00:56<00:53,  1.70it/s] 55%|█████▍    | 107/195 [00:57<00:51,  1.72it/s] 56%|█████▌    | 109/195 [00:59<00:49,  1.74it/s] 56%|█████▋    | 110/195 [00:59<00:46,  1.81it/s] 57%|█████▋    | 111/195 [01:00<00:49,  1.70it/s] 57%|█████▋    | 112/195 [01:00<00:47,  1.75it/s] 58%|█████▊    | 113/195 [01:01<00:47,  1.71it/s] 58%|█████▊    | 114/195 [01:01<00:46,  1.75it/s] 59%|█████▉    | 115/195 [01:02<00:48,  1.66it/s] 59%|█████▉    | 116/195 [01:03<00:46,  1.69it/s] 60%|██████    | 117/195 [01:03<00:47,  1.64it/s] 61%|██████    | 118/195 [01:04<00:46,  1.66it/s] 61%|██████    | 119/195 [01:05<00:46,  1.64it/s] 62%|██████▏   | 120/195 [01:05<00:43,  1.74it/s] 62%|██████▏   | 121/195 [01:05<00:37,  1.97it/s] 63%|██████▎   | 122/195 [01:06<00:35,  2.06it/s] 63%|██████▎   | 123/195 [01:06<00:30,  2.33it/s] 64%|██████▎   | 124/195 [01:07<00:32,  2.17it/s] 65%|██████▍   | 126/195 [01:07<00:29,  2.34it/s] 66%|██████▌   | 128/195 [01:08<00:27,  2.40it/s] 67%|██████▋   | 130/195 [01:09<00:26,  2.42it/s] 67%|██████▋   | 131/195 [01:09<00:25,  2.54it/s] 68%|██████▊   | 132/195 [01:10<00:26,  2.36it/s] 68%|██████▊   | 133/195 [01:10<00:25,  2.48it/s] 69%|██████▊   | 134/195 [01:11<00:26,  2.28it/s] 69%|██████▉   | 135/195 [01:11<00:24,  2.42it/s] 70%|██████▉   | 136/195 [01:12<00:24,  2.42it/s] 70%|███████   | 137/195 [01:12<00:23,  2.45it/s] 71%|███████   | 138/195 [01:12<00:22,  2.54it/s] 71%|███████▏  | 139/195 [01:13<00:23,  2.39it/s] 72%|███████▏  | 140/195 [01:13<00:20,  2.71it/s] 72%|███████▏  | 141/195 [01:14<00:21,  2.46it/s] 73%|███████▎  | 143/195 [01:14<00:20,  2.53it/s] 74%|███████▍  | 145/195 [01:15<00:19,  2.58it/s] 75%|███████▌  | 147/195 [01:16<00:18,  2.65it/s] 76%|███████▋  | 149/195 [01:17<00:17,  2.63it/s] 77%|███████▋  | 151/195 [01:17<00:17,  2.51it/s] 78%|███████▊  | 153/195 [01:18<00:17,  2.35it/s] 79%|███████▉  | 155/195 [01:19<00:16,  2.42it/s] 81%|████████  | 157/195 [01:20<00:14,  2.63it/s] 82%|████████▏ | 159/195 [01:20<00:13,  2.72it/s] 82%|████████▏ | 160/195 [01:21<00:11,  3.11it/s] 83%|████████▎ | 161/195 [01:21<00:12,  2.64it/s] 84%|████████▎ | 163/195 [01:22<00:11,  2.77it/s] 84%|████████▍ | 164/195 [01:22<00:09,  3.23it/s] 85%|████████▍ | 165/195 [01:23<00:11,  2.63it/s] 86%|████████▌ | 167/195 [01:23<00:10,  2.62it/s] 86%|████████▌ | 168/195 [01:23<00:08,  3.09it/s] 87%|████████▋ | 169/195 [01:24<00:10,  2.43it/s] 87%|████████▋ | 170/195 [01:24<00:08,  2.98it/s] 88%|████████▊ | 171/195 [01:25<00:09,  2.43it/s] 89%|████████▊ | 173/195 [01:26<00:08,  2.53it/s] 89%|████████▉ | 174/195 [01:26<00:06,  3.04it/s] 90%|████████▉ | 175/195 [01:26<00:08,  2.36it/s] 90%|█████████ | 176/195 [01:27<00:07,  2.55it/s] 91%|█████████ | 177/195 [01:27<00:07,  2.48it/s] 91%|█████████▏| 178/195 [01:28<00:06,  2.51it/s] 92%|█████████▏| 179/195 [01:28<00:06,  2.39it/s] 92%|█████████▏| 180/195 [01:28<00:06,  2.40it/s] 93%|█████████▎| 181/195 [01:29<00:05,  2.40it/s] 93%|█████████▎| 182/195 [01:29<00:05,  2.32it/s] 94%|█████████▍| 183/195 [01:30<00:04,  2.57it/s] 94%|█████████▍| 184/195 [01:30<00:04,  2.32it/s] 95%|█████████▌| 186/195 [01:31<00:03,  2.54it/s] 96%|█████████▋| 188/195 [01:32<00:02,  2.54it/s] 97%|█████████▋| 190/195 [01:32<00:01,  2.53it/s] 98%|█████████▊| 191/195 [01:33<00:01,  2.64it/s] 98%|█████████▊| 192/195 [01:33<00:01,  2.56it/s] 99%|█████████▉| 193/195 [01:34<00:00,  2.60it/s] 99%|█████████▉| 194/195 [01:34<00:00,  2.59it/s]100%|██████████| 195/195 [01:34<00:00,  3.09it/s]100%|██████████| 195/195 [01:36<00:00,  2.02it/s]
2025-08-20 21:25:16 [info     ] Validating outputs
2025-08-20 21:25:16 [info     ] Predict - end                  time=0:1:36
2025-08-20 21:25:16 [info     ] Evaluate - start               split=test
2025-08-20 21:25:16 [info     ] Evaluate - end                 correctness_llm=0.27 monotonicity=0.93
2025-08-20 21:25:16 [info     ] Evaluate question difficulty - start split=test
2025-08-20 21:25:16 [info     ] Augmenting questions for IRT estimation num_questions=2
2025-08-20 21:25:16 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 21:25:16 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1003.11it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3514.02it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 601.42it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6297.75it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1070.21it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 4082.40it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 559.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6768.13it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1180.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3400.08it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 541.17it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6384.02it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 992.70it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3713.12it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 556.39it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6669.72it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1053.96it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3838.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 484.66it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6543.38it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 750.55it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3557.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 575.86it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6654.61it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1196.71it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3616.42it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 592.78it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6418.92it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 986.30it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3456.26it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 618.71it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6501.36it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1140.42it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3647.14it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 623.37it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6454.19it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1227.02it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3549.17it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 596.66it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6304.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 981.42it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3755.49it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 589.17it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6536.09it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1066.44it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3696.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 601.95it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7933.03it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1168.19it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3864.71it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 613.58it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6327.61it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1005.41it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3517.35it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 630.67it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6672.76it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1234.92it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3692.25it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 634.05it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7685.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1247.88it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3665.53it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 625.85it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6726.26it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1002.60it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3708.07it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 631.09it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6417.51it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 985.21it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 4025.74it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 667.21it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7412.30it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1020.23it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3724.45it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 656.58it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6678.83it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 775.47it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3693.84it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 648.25it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8934.91it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1067.41it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3658.97it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 638.88it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7436.71it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1014.69it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3689.92it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 683.85it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6553.60it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1068.07it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3722.08it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 663.13it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7576.81it/s]
2025-08-20 21:25:34 INFO: EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
EM converged at iteration 23.
2025-08-20 21:25:34 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 21:25:34 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 21:25:34 [info     ] Evaluate question difficulty - end rmse=2.559516077077279 split=test
2025-08-20 21:25:34 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 2 finished: 0:2:4

 ********** Run: 3/3 **********
2025-08-20 21:25:39 [info     ] Building roleplay dataset      name=dbe_kt22
2025-08-20 21:25:39 [info     ] Reading train split questions  num_questions=92
2025-08-20 21:25:39 [info     ] Reading validation split questions num_questions=23
2025-08-20 21:25:39 [info     ] Reading test split questions   num_questions=39
2025-08-20 21:25:41 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-08-20 21:25:41 [info     ] Misconceptions as context: bringing correct option forward
2025-08-20 21:25:45 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-08-20 21:25:45 [info     ] Student scale built            map={'1': 'Fundamental Awareness', '2': 'Novice', '3': 'Intermediate', '4': 'Advanced', '5': 'Expert'} string='(of levels 1. Fundamental Awareness, 2. Novice, 3. Intermediate, 4. Advanced, 5. Expert)'
2025-08-20 21:25:45 [info     ] Building example formatter     name=quotes splits=['train']
2025-08-20 21:25:46 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-08-20 21:25:49 [info     ] Setting seed                   value=45
2025-08-20 21:25:49 [info     ] Building structured outputter  name=teacher_kt
2025-08-20 21:25:49 [info     ] Building few-shot prompt       example_selector=miscon_studentlevel_random native_structured_output=True num_examples=3 system_prompt=teacher_marshmellow_level_context
2025-08-20 21:25:49 [info     ] Building example selector
2025-08-20 21:25:49 [info     ] Building model                 name=qwen3:14b provider=ollama rate_limit=None temp=0.0
2025-08-20 21:25:49 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:10<35:19, 10.92s/it]  1%|          | 2/195 [00:11<14:39,  4.56s/it]  2%|▏         | 3/195 [00:13<11:49,  3.69s/it]  3%|▎         | 5/195 [00:15<06:43,  2.12s/it]  3%|▎         | 6/195 [00:16<05:14,  1.67s/it]  4%|▎         | 7/195 [00:16<04:07,  1.31s/it]  4%|▍         | 8/195 [00:17<03:26,  1.10s/it]  5%|▌         | 10/195 [00:18<02:30,  1.23it/s]  6%|▌         | 12/195 [00:18<01:52,  1.63it/s]  7%|▋         | 14/195 [00:19<01:31,  1.99it/s]  8%|▊         | 16/195 [00:19<01:19,  2.24it/s]  9%|▉         | 18/195 [00:20<01:11,  2.48it/s] 10%|█         | 20/195 [00:21<01:06,  2.64it/s] 11%|█▏        | 22/195 [00:21<01:01,  2.79it/s] 12%|█▏        | 24/195 [00:22<00:59,  2.86it/s] 13%|█▎        | 26/195 [00:23<01:00,  2.81it/s] 14%|█▍        | 28/195 [00:23<00:59,  2.83it/s] 15%|█▍        | 29/195 [00:24<00:51,  3.24it/s] 15%|█▌        | 30/195 [00:24<01:03,  2.58it/s] 16%|█▋        | 32/195 [00:25<01:05,  2.47it/s] 17%|█▋        | 34/195 [00:26<01:05,  2.47it/s] 18%|█▊        | 36/195 [00:27<01:03,  2.49it/s] 19%|█▉        | 38/195 [00:28<01:02,  2.51it/s] 20%|██        | 39/195 [00:28<00:59,  2.62it/s] 21%|██        | 40/195 [00:28<01:02,  2.46it/s] 21%|██        | 41/195 [00:29<00:58,  2.61it/s] 22%|██▏       | 42/195 [00:29<01:02,  2.46it/s] 23%|██▎       | 44/195 [00:30<01:01,  2.45it/s] 24%|██▎       | 46/195 [00:31<01:00,  2.47it/s] 25%|██▍       | 48/195 [00:31<00:57,  2.58it/s] 26%|██▌       | 50/195 [00:32<00:58,  2.48it/s] 26%|██▌       | 51/195 [00:33<01:00,  2.38it/s] 27%|██▋       | 52/195 [00:33<01:05,  2.19it/s] 27%|██▋       | 53/195 [00:34<01:10,  2.02it/s] 28%|██▊       | 54/195 [00:34<01:09,  2.04it/s] 28%|██▊       | 55/195 [00:35<01:14,  1.87it/s] 29%|██▊       | 56/195 [00:36<01:11,  1.95it/s] 29%|██▉       | 57/195 [00:36<01:16,  1.80it/s] 30%|███       | 59/195 [00:37<01:15,  1.81it/s] 31%|███       | 60/195 [00:38<01:06,  2.04it/s] 31%|███▏      | 61/195 [00:38<01:04,  2.09it/s] 32%|███▏      | 62/195 [00:38<00:57,  2.30it/s] 32%|███▏      | 63/195 [00:39<00:54,  2.40it/s] 33%|███▎      | 64/195 [00:39<00:52,  2.49it/s] 33%|███▎      | 65/195 [00:39<00:48,  2.70it/s] 34%|███▍      | 66/195 [00:40<00:49,  2.62it/s] 34%|███▍      | 67/195 [00:40<00:43,  2.93it/s] 35%|███▍      | 68/195 [00:41<00:47,  2.66it/s] 36%|███▌      | 70/195 [00:41<00:46,  2.70it/s] 37%|███▋      | 72/195 [00:42<00:45,  2.71it/s] 38%|███▊      | 74/195 [00:43<00:43,  2.75it/s] 38%|███▊      | 75/195 [00:43<00:37,  3.21it/s] 39%|███▉      | 76/195 [00:43<00:44,  2.69it/s] 40%|████      | 78/195 [00:44<00:41,  2.80it/s] 41%|████      | 80/195 [00:45<00:40,  2.82it/s] 42%|████▏     | 81/195 [00:45<00:38,  2.94it/s] 42%|████▏     | 82/195 [00:45<00:40,  2.77it/s] 43%|████▎     | 83/195 [00:46<00:39,  2.84it/s] 43%|████▎     | 84/195 [00:46<00:39,  2.82it/s] 44%|████▎     | 85/195 [00:47<00:39,  2.80it/s] 44%|████▍     | 86/195 [00:47<00:39,  2.74it/s] 45%|████▍     | 87/195 [00:47<00:39,  2.75it/s] 45%|████▌     | 88/195 [00:48<00:38,  2.79it/s] 46%|████▌     | 89/195 [00:48<00:38,  2.77it/s] 46%|████▌     | 90/195 [00:48<00:36,  2.90it/s] 47%|████▋     | 91/195 [00:49<00:38,  2.71it/s] 48%|████▊     | 93/195 [00:49<00:37,  2.74it/s] 49%|████▊     | 95/195 [00:50<00:36,  2.76it/s] 50%|████▉     | 97/195 [00:51<00:34,  2.83it/s] 51%|█████     | 99/195 [00:52<00:34,  2.81it/s] 51%|█████▏    | 100/195 [00:52<00:35,  2.69it/s] 52%|█████▏    | 101/195 [00:53<00:43,  2.16it/s] 52%|█████▏    | 102/195 [00:53<00:45,  2.03it/s] 53%|█████▎    | 103/195 [00:54<00:47,  1.94it/s] 53%|█████▎    | 104/195 [00:55<00:50,  1.81it/s] 54%|█████▍    | 105/195 [00:55<00:50,  1.80it/s] 54%|█████▍    | 106/195 [00:56<00:51,  1.73it/s] 55%|█████▍    | 107/195 [00:56<00:49,  1.79it/s] 55%|█████▌    | 108/195 [00:57<00:50,  1.72it/s] 56%|█████▌    | 109/195 [00:57<00:47,  1.80it/s] 56%|█████▋    | 110/195 [00:58<00:49,  1.73it/s] 57%|█████▋    | 111/195 [00:59<00:46,  1.80it/s] 57%|█████▋    | 112/195 [00:59<00:48,  1.71it/s] 58%|█████▊    | 113/195 [01:00<00:44,  1.84it/s] 58%|█████▊    | 114/195 [01:00<00:47,  1.71it/s] 59%|█████▉    | 115/195 [01:01<00:44,  1.80it/s] 59%|█████▉    | 116/195 [01:02<00:49,  1.61it/s] 60%|██████    | 117/195 [01:02<00:44,  1.75it/s] 61%|██████    | 118/195 [01:03<00:47,  1.61it/s] 61%|██████    | 119/195 [01:03<00:44,  1.71it/s] 62%|██████▏   | 120/195 [01:04<00:43,  1.74it/s] 63%|██████▎   | 122/195 [01:05<00:35,  2.07it/s] 64%|██████▎   | 124/195 [01:05<00:32,  2.21it/s] 65%|██████▍   | 126/195 [01:06<00:29,  2.34it/s] 66%|██████▌   | 128/195 [01:07<00:27,  2.42it/s] 67%|██████▋   | 130/195 [01:08<00:26,  2.47it/s] 67%|██████▋   | 131/195 [01:08<00:24,  2.58it/s] 68%|██████▊   | 132/195 [01:09<00:26,  2.40it/s] 69%|██████▊   | 134/195 [01:09<00:25,  2.36it/s] 70%|██████▉   | 136/195 [01:10<00:24,  2.42it/s] 71%|███████   | 138/195 [01:11<00:23,  2.46it/s] 72%|███████▏  | 140/195 [01:12<00:21,  2.58it/s] 72%|███████▏  | 141/195 [01:12<00:19,  2.75it/s] 73%|███████▎  | 142/195 [01:12<00:19,  2.68it/s] 73%|███████▎  | 143/195 [01:13<00:18,  2.78it/s] 74%|███████▍  | 144/195 [01:13<00:18,  2.80it/s] 74%|███████▍  | 145/195 [01:13<00:17,  2.78it/s] 75%|███████▍  | 146/195 [01:14<00:16,  2.89it/s] 75%|███████▌  | 147/195 [01:14<00:17,  2.67it/s] 76%|███████▌  | 148/195 [01:14<00:16,  2.88it/s] 76%|███████▋  | 149/195 [01:15<00:18,  2.53it/s] 77%|███████▋  | 151/195 [01:16<00:19,  2.27it/s] 78%|███████▊  | 153/195 [01:17<00:18,  2.21it/s] 79%|███████▉  | 155/195 [01:18<00:17,  2.30it/s] 81%|████████  | 157/195 [01:18<00:14,  2.55it/s] 82%|████████▏ | 159/195 [01:19<00:13,  2.70it/s] 83%|████████▎ | 161/195 [01:20<00:12,  2.80it/s] 84%|████████▎ | 163/195 [01:20<00:11,  2.88it/s] 84%|████████▍ | 164/195 [01:21<00:10,  3.03it/s] 85%|████████▍ | 165/195 [01:21<00:10,  2.84it/s] 85%|████████▌ | 166/195 [01:21<00:09,  2.96it/s] 86%|████████▌ | 167/195 [01:22<00:10,  2.80it/s] 86%|████████▌ | 168/195 [01:22<00:09,  2.85it/s] 87%|████████▋ | 169/195 [01:22<00:09,  2.78it/s] 87%|████████▋ | 170/195 [01:23<00:09,  2.74it/s] 88%|████████▊ | 171/195 [01:23<00:08,  2.84it/s] 88%|████████▊ | 172/195 [01:24<00:08,  2.75it/s] 89%|████████▊ | 173/195 [01:24<00:07,  3.04it/s] 89%|████████▉ | 174/195 [01:24<00:07,  2.73it/s] 90%|█████████ | 176/195 [01:25<00:07,  2.62it/s] 91%|█████████▏| 178/195 [01:26<00:06,  2.64it/s] 92%|█████████▏| 179/195 [01:26<00:05,  2.76it/s] 92%|█████████▏| 180/195 [01:27<00:06,  2.49it/s] 93%|█████████▎| 181/195 [01:27<00:05,  2.64it/s] 93%|█████████▎| 182/195 [01:27<00:05,  2.45it/s] 94%|█████████▍| 184/195 [01:28<00:04,  2.51it/s] 95%|█████████▌| 186/195 [01:29<00:03,  2.52it/s] 96%|█████████▋| 188/195 [01:30<00:02,  2.53it/s] 97%|█████████▋| 190/195 [01:31<00:02,  2.49it/s] 98%|█████████▊| 191/195 [01:31<00:01,  2.59it/s] 98%|█████████▊| 192/195 [01:31<00:01,  2.47it/s] 99%|█████████▉| 193/195 [01:32<00:00,  2.57it/s] 99%|█████████▉| 194/195 [01:32<00:00,  2.51it/s]100%|██████████| 195/195 [01:32<00:00,  3.09it/s]100%|██████████| 195/195 [01:35<00:00,  2.05it/s]
2025-08-20 21:27:24 [info     ] Validating outputs
2025-08-20 21:27:24 [info     ] Predict - end                  time=0:1:35
2025-08-20 21:27:24 [info     ] Evaluate - start               split=test
2025-08-20 21:27:24 [info     ] Evaluate - end                 correctness_llm=0.24 monotonicity=0.75
2025-08-20 21:27:24 [info     ] Evaluate question difficulty - start split=test
2025-08-20 21:27:24 [info     ] Augmenting questions for IRT estimation num_questions=4
2025-08-20 21:27:24 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-08-20 21:27:24 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1331.71it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3332.75it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 514.47it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6681.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 932.33it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3658.56it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 583.07it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5918.19it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 952.05it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3590.78it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 528.47it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6268.17it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1057.03it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3628.37it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 520.26it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5856.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1016.62it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3668.65it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 528.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5888.51it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 980.40it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3555.50it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 503.83it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6274.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1025.47it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3744.83it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 589.43it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5680.04it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1050.98it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3025.13it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 619.70it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5820.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1009.01it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3997.50it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 555.83it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6016.42it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1006.24it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3551.33it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 564.08it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5789.81it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 982.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3221.11it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 714.51it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5824.27it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1058.67it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3635.71it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 614.99it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5786.39it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1170.52it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3821.91it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 703.96it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5930.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 990.46it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3800.25it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 720.57it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5974.79it/s]
2025-08-20 21:27:35 INFO: EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
EM converged at iteration 14.
2025-08-20 21:27:35 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-08-20 21:27:35 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-08-20 21:27:35 [info     ] Evaluate question difficulty - end rmse=3.0159661801542073 split=test
2025-08-20 21:27:35 [info     ] Saving data                    path=./output/roleplay_miscon_test_kt_20250820-204306
Run 3 finished: 0:1:56
2025-08-20 21:27:48 [info     ] All experiments completed successfully.
