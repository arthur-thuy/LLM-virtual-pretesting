2025-09-24 09:08:50 [info     ] Loaded environment variables from ../.env
2025-09-24 09:08:54 [info     ] Loading config from 'config/roleplay_dbekt22_test/qwen3:0.6b~T_1.0~SO_teacher_bool_nocontext~L_5~SP_teacher_dbe_miscons_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_dbe_studentlevel_kc_exact1.yaml'
2025-09-24 09:08:54 [info     ] Loading config from 'config/roleplay_dbekt22_test/qwen3:4b~T_1.0~SO_teacher_bool_nocontext~L_5~SP_teacher_dbe_miscons_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_dbe_studentlevel_kc_exact5.yaml'
2025-09-24 09:08:54 [info     ] Loading config from 'config/roleplay_dbekt22_test/llama3.2:3b~T_1.0~SO_teacher_bool_nocontext~L_5~SP_teacher_dbe_miscons_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_cfe_studentlevel_random0.yaml'
2025-09-24 09:08:54 [info     ] Loading config from 'config/roleplay_dbekt22_test/qwen3:1.7b~T_1.0~SO_student_bool_nocontext~L_5~SP_student_dbe_miscons_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_dbe_studentlevel_kc_exact5.yaml'
2025-09-24 09:08:54 [info     ] Loading config from 'config/roleplay_dbekt22_test/llama3.1:8b~T_1.0~SO_student_bool_nocontext~L_5~SP_student_dbe_miscons_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_dbe_studentlevel_random1.yaml'
2025-09-24 09:08:54 [info     ] Loading config from 'config/roleplay_dbekt22_test/llama3.2:3b~T_1.0~SO_teacher_bool_nocontext~L_5~SP_teacher_dbe_miscons_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_dbe_studentlevel_kc_exact3.yaml'
2025-09-24 09:08:54 [info     ] Loading config from 'config/roleplay_dbekt22_test/qwen3:8b~T_1.0~SO_student_bool_nocontext~L_5~SP_student_dbe_miscons_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_cfe_studentlevel_random0.yaml'
2025-09-24 09:08:54 [info     ] Loading config from 'config/roleplay_dbekt22_test/qwen3:14b~T_1.0~SO_teacher_bool_nocontext~L_5~SP_teacher_dbe_miscons_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_dbe_studentlevel_kc_exact3.yaml'
2025-09-24 09:08:54 [info     ] Loading config from 'config/roleplay_dbekt22_test/qwen3:8b~T_1.0~SO_teacher_bool_nocontext~L_5~SP_teacher_dbe_miscons_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_dbe_studentlevel_kc_exact3.yaml'
2025-09-24 09:08:54 [info     ] Loading config from 'config/roleplay_dbekt22_test/llama3.2:1b~T_0.0~SO_student_bool_nocontext~L_5~SP_student_dbe_miscons_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_dbe_studentlevel_random1.yaml'
2025-09-24 09:08:54 [info     ] Loading config from 'config/roleplay_dbekt22_test/qwen3:14b~T_1.0~SO_student_bool_nocontext~L_5~SP_student_dbe_miscons_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_cfe_studentlevel_random0.yaml'
2025-09-24 09:08:54 [info     ] Loading config from 'config/roleplay_dbekt22_test/qwen3:1.7b~T_0.0~SO_teacher_bool_nocontext~L_5~SP_teacher_dbe_miscons_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_cfe_studentlevel_random0.yaml'
2025-09-24 09:08:54 [info     ] Loading config from 'config/roleplay_dbekt22_test/llama3.2:1b~T_1.0~SO_teacher_bool_nocontext~L_5~SP_teacher_dbe_miscons_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_cfe_studentlevel_random0.yaml'
2025-09-24 09:08:54 [info     ] Loading config from 'config/roleplay_dbekt22_test/llama3.1:8b~T_1.0~SO_teacher_bool_nocontext~L_5~SP_teacher_dbe_miscons_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_cfe_studentlevel_random0.yaml'
2025-09-24 09:08:54 [info     ] Loading config from 'config/roleplay_dbekt22_test/qwen3:0.6b~T_1.0~SO_student_bool_nocontext~L_5~SP_student_dbe_miscons_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_cfe_studentlevel_random0.yaml'
2025-09-24 09:08:54 [info     ] Loading config from 'config/roleplay_dbekt22_test/qwen3:4b~T_1.0~SO_student_bool_nocontext~L_5~SP_student_dbe_miscons_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_cfe_studentlevel_random0.yaml'

 ========== Config: qwen3:0.6b~T_1.0~SO_teacher_bool_nocontext~L_5~SP_teacher_dbe_miscons_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_dbe_studentlevel_kc_exact1 ==========
Config 1/16

 ********** Run: 1/3 **********
2025-09-24 09:08:54 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:08:54 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:08:54 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:08:54 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:08:56 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:08:56 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:09:00 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:09:00 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:09:00 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:09:01 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:09:04 [info     ] Setting seed                   value=43
2025-09-24 09:09:04 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 09:09:04 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_kc_exact native_structured_output=True num_examples=1 system_prompt=teacher_dbe_miscons_level_context
2025-09-24 09:09:04 [info     ] Building example selector
2025-09-24 09:09:04 [info     ] Building model                 name=qwen3:0.6b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:09:04 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:11<38:10, 11.81s/it]  1%|          | 2/195 [00:12<16:08,  5.02s/it]  2%|▏         | 3/195 [00:12<09:18,  2.91s/it]  2%|▏         | 4/195 [00:12<06:01,  1.89s/it]  3%|▎         | 5/195 [00:13<04:25,  1.40s/it]  3%|▎         | 6/195 [00:13<03:04,  1.03it/s]  4%|▎         | 7/195 [00:13<02:31,  1.24it/s]  5%|▍         | 9/195 [00:14<01:38,  1.89it/s]  5%|▌         | 10/195 [00:14<01:28,  2.08it/s]  6%|▌         | 11/195 [00:15<01:18,  2.35it/s]  6%|▌         | 12/195 [00:15<01:13,  2.49it/s]  7%|▋         | 13/195 [00:15<01:06,  2.74it/s]  7%|▋         | 14/195 [00:15<01:02,  2.91it/s]  8%|▊         | 15/195 [00:16<00:58,  3.09it/s]  8%|▊         | 16/195 [00:16<00:55,  3.25it/s]  9%|▊         | 17/195 [00:16<01:03,  2.81it/s]  9%|▉         | 18/195 [00:17<01:10,  2.50it/s] 10%|█         | 20/195 [00:17<00:54,  3.18it/s] 11%|█         | 21/195 [00:18<00:50,  3.48it/s] 11%|█▏        | 22/195 [00:18<00:47,  3.67it/s] 12%|█▏        | 23/195 [00:18<00:45,  3.76it/s] 12%|█▏        | 24/195 [00:18<00:43,  3.91it/s] 13%|█▎        | 25/195 [00:19<00:42,  4.05it/s] 13%|█▎        | 26/195 [00:19<00:54,  3.08it/s] 14%|█▍        | 27/195 [00:19<00:49,  3.41it/s] 14%|█▍        | 28/195 [00:19<00:39,  4.20it/s] 15%|█▍        | 29/195 [00:20<00:39,  4.23it/s] 15%|█▌        | 30/195 [00:20<00:49,  3.34it/s] 16%|█▋        | 32/195 [00:21<00:44,  3.69it/s] 17%|█▋        | 34/195 [00:21<00:39,  4.06it/s] 18%|█▊        | 35/195 [00:21<00:34,  4.61it/s] 18%|█▊        | 36/195 [00:22<00:49,  3.23it/s] 19%|█▉        | 37/195 [00:22<00:42,  3.73it/s] 19%|█▉        | 38/195 [00:22<00:58,  2.71it/s] 20%|██        | 39/195 [00:23<00:49,  3.17it/s] 21%|██        | 40/195 [00:23<00:44,  3.45it/s] 21%|██        | 41/195 [00:23<00:42,  3.62it/s] 22%|██▏       | 42/195 [00:23<00:46,  3.29it/s] 22%|██▏       | 43/195 [00:24<00:37,  4.06it/s] 23%|██▎       | 44/195 [00:24<00:42,  3.51it/s] 24%|██▎       | 46/195 [00:24<00:39,  3.78it/s] 24%|██▍       | 47/195 [00:25<00:45,  3.22it/s] 25%|██▍       | 48/195 [00:25<00:40,  3.65it/s] 25%|██▌       | 49/195 [00:25<00:43,  3.37it/s] 26%|██▌       | 50/195 [00:26<00:47,  3.08it/s] 26%|██▌       | 51/195 [00:26<00:38,  3.79it/s] 27%|██▋       | 52/195 [00:26<00:48,  2.96it/s] 28%|██▊       | 54/195 [00:27<00:44,  3.17it/s] 28%|██▊       | 55/195 [00:27<00:48,  2.91it/s] 29%|██▉       | 57/195 [00:28<00:42,  3.25it/s] 30%|██▉       | 58/195 [00:28<00:35,  3.83it/s] 30%|███       | 59/195 [00:29<00:44,  3.08it/s] 31%|███       | 60/195 [00:29<00:36,  3.70it/s] 31%|███▏      | 61/195 [00:29<00:37,  3.58it/s] 32%|███▏      | 62/195 [00:30<00:50,  2.65it/s] 32%|███▏      | 63/195 [00:30<00:47,  2.77it/s] 33%|███▎      | 64/195 [00:30<00:44,  2.97it/s] 33%|███▎      | 65/195 [00:31<00:44,  2.95it/s] 34%|███▍      | 67/195 [00:31<00:43,  2.97it/s] 35%|███▍      | 68/195 [00:32<00:52,  2.43it/s] 36%|███▌      | 70/195 [00:32<00:43,  2.89it/s] 36%|███▋      | 71/195 [00:33<00:39,  3.14it/s] 37%|███▋      | 72/195 [00:33<00:38,  3.23it/s] 37%|███▋      | 73/195 [00:33<00:32,  3.75it/s] 38%|███▊      | 74/195 [00:34<00:42,  2.82it/s] 38%|███▊      | 75/195 [00:34<00:38,  3.14it/s] 39%|███▉      | 76/195 [00:34<00:39,  2.98it/s] 39%|███▉      | 77/195 [00:34<00:36,  3.24it/s] 40%|████      | 78/195 [00:35<00:33,  3.50it/s] 41%|████      | 79/195 [00:35<00:29,  3.87it/s] 41%|████      | 80/195 [00:35<00:34,  3.32it/s] 42%|████▏     | 81/195 [00:36<00:41,  2.76it/s] 42%|████▏     | 82/195 [00:36<00:34,  3.26it/s] 43%|████▎     | 83/195 [00:36<00:36,  3.04it/s] 43%|████▎     | 84/195 [00:37<00:32,  3.37it/s] 44%|████▎     | 85/195 [00:37<00:35,  3.14it/s] 44%|████▍     | 86/195 [00:37<00:31,  3.42it/s] 45%|████▍     | 87/195 [00:37<00:27,  3.95it/s] 45%|████▌     | 88/195 [00:38<00:27,  3.91it/s] 46%|████▌     | 89/195 [00:38<00:24,  4.38it/s] 46%|████▌     | 90/195 [00:38<00:27,  3.77it/s] 47%|████▋     | 91/195 [00:38<00:24,  4.28it/s] 47%|████▋     | 92/195 [00:39<00:26,  3.86it/s] 48%|████▊     | 94/195 [00:39<00:22,  4.41it/s] 49%|████▉     | 96/195 [00:39<00:23,  4.21it/s] 50%|████▉     | 97/195 [00:40<00:27,  3.57it/s] 51%|█████     | 99/195 [00:40<00:25,  3.83it/s] 51%|█████▏    | 100/195 [00:41<00:28,  3.32it/s] 52%|█████▏    | 101/195 [00:41<00:26,  3.60it/s] 52%|█████▏    | 102/195 [00:41<00:30,  3.08it/s] 53%|█████▎    | 103/195 [00:42<00:26,  3.50it/s] 53%|█████▎    | 104/195 [00:42<00:25,  3.50it/s] 54%|█████▍    | 105/195 [00:42<00:26,  3.46it/s] 54%|█████▍    | 106/195 [00:43<00:27,  3.27it/s] 55%|█████▍    | 107/195 [00:43<00:26,  3.29it/s] 55%|█████▌    | 108/195 [00:43<00:27,  3.16it/s] 56%|█████▌    | 109/195 [00:43<00:23,  3.62it/s] 56%|█████▋    | 110/195 [00:44<00:23,  3.66it/s] 57%|█████▋    | 111/195 [00:44<00:21,  3.91it/s] 57%|█████▋    | 112/195 [00:44<00:25,  3.31it/s] 58%|█████▊    | 113/195 [00:45<00:29,  2.77it/s] 58%|█████▊    | 114/195 [00:45<00:29,  2.78it/s] 59%|█████▉    | 115/195 [00:45<00:22,  3.55it/s] 59%|█████▉    | 116/195 [00:46<00:30,  2.58it/s] 60%|██████    | 117/195 [00:46<00:28,  2.76it/s] 61%|██████    | 118/195 [00:46<00:24,  3.16it/s] 61%|██████    | 119/195 [00:47<00:26,  2.82it/s] 62%|██████▏   | 120/195 [00:47<00:31,  2.37it/s] 63%|██████▎   | 122/195 [00:48<00:25,  2.87it/s] 63%|██████▎   | 123/195 [00:48<00:20,  3.44it/s] 64%|██████▎   | 124/195 [00:48<00:22,  3.11it/s] 64%|██████▍   | 125/195 [00:49<00:18,  3.74it/s] 65%|██████▍   | 126/195 [00:49<00:17,  3.89it/s] 65%|██████▌   | 127/195 [00:49<00:15,  4.38it/s] 66%|██████▌   | 128/195 [00:49<00:18,  3.53it/s] 66%|██████▌   | 129/195 [00:50<00:24,  2.70it/s] 67%|██████▋   | 131/195 [00:51<00:20,  3.11it/s] 68%|██████▊   | 132/195 [00:51<00:17,  3.51it/s] 68%|██████▊   | 133/195 [00:51<00:20,  2.99it/s] 69%|██████▉   | 135/195 [00:52<00:18,  3.29it/s] 70%|███████   | 137/195 [00:52<00:16,  3.55it/s] 71%|███████▏  | 139/195 [00:53<00:14,  3.88it/s] 72%|███████▏  | 140/195 [00:53<00:12,  4.24it/s] 72%|███████▏  | 141/195 [00:53<00:13,  3.96it/s] 73%|███████▎  | 142/195 [00:53<00:12,  4.23it/s] 73%|███████▎  | 143/195 [00:54<00:13,  3.80it/s] 74%|███████▍  | 144/195 [00:54<00:11,  4.49it/s] 74%|███████▍  | 145/195 [00:54<00:14,  3.52it/s] 75%|███████▍  | 146/195 [00:55<00:17,  2.80it/s] 75%|███████▌  | 147/195 [00:55<00:13,  3.44it/s] 76%|███████▌  | 148/195 [00:55<00:16,  2.93it/s] 77%|███████▋  | 150/195 [00:56<00:12,  3.65it/s] 77%|███████▋  | 151/195 [00:56<00:11,  3.86it/s] 78%|███████▊  | 152/195 [00:56<00:11,  3.81it/s] 78%|███████▊  | 153/195 [00:56<00:11,  3.81it/s] 79%|███████▉  | 154/195 [00:57<00:10,  3.80it/s] 79%|███████▉  | 155/195 [00:57<00:09,  4.36it/s] 80%|████████  | 156/195 [00:57<00:10,  3.64it/s] 81%|████████  | 157/195 [00:57<00:09,  4.06it/s] 81%|████████  | 158/195 [00:58<00:10,  3.47it/s] 82%|████████▏ | 159/195 [00:58<00:12,  2.86it/s] 83%|████████▎ | 161/195 [00:59<00:10,  3.27it/s] 83%|████████▎ | 162/195 [00:59<00:09,  3.54it/s] 84%|████████▎ | 163/195 [00:59<00:08,  3.78it/s] 84%|████████▍ | 164/195 [01:00<00:09,  3.35it/s] 85%|████████▍ | 165/195 [01:00<00:08,  3.53it/s] 85%|████████▌ | 166/195 [01:00<00:08,  3.25it/s] 86%|████████▌ | 167/195 [01:01<00:11,  2.35it/s] 86%|████████▌ | 168/195 [01:01<00:10,  2.54it/s] 87%|████████▋ | 170/195 [01:02<00:07,  3.17it/s] 88%|████████▊ | 171/195 [01:02<00:07,  3.23it/s] 88%|████████▊ | 172/195 [01:02<00:05,  3.91it/s] 89%|████████▊ | 173/195 [01:02<00:06,  3.66it/s] 89%|████████▉ | 174/195 [01:03<00:04,  4.34it/s] 90%|████████▉ | 175/195 [01:03<00:04,  4.04it/s] 90%|█████████ | 176/195 [01:03<00:06,  2.74it/s] 91%|█████████ | 177/195 [01:04<00:05,  3.16it/s] 91%|█████████▏| 178/195 [01:04<00:05,  2.84it/s] 92%|█████████▏| 179/195 [01:04<00:04,  3.43it/s] 92%|█████████▏| 180/195 [01:05<00:05,  2.64it/s] 93%|█████████▎| 181/195 [01:05<00:04,  3.20it/s] 93%|█████████▎| 182/195 [01:05<00:04,  3.13it/s] 94%|█████████▍| 183/195 [01:05<00:03,  3.65it/s] 94%|█████████▍| 184/195 [01:06<00:03,  3.56it/s] 95%|█████████▍| 185/195 [01:06<00:04,  2.44it/s] 96%|█████████▌| 187/195 [01:07<00:02,  2.86it/s] 96%|█████████▋| 188/195 [01:07<00:02,  2.68it/s] 97%|█████████▋| 189/195 [01:08<00:02,  2.80it/s] 97%|█████████▋| 190/195 [01:08<00:01,  2.61it/s] 98%|█████████▊| 191/195 [01:08<00:01,  3.12it/s] 98%|█████████▊| 192/195 [01:09<00:01,  2.34it/s] 99%|█████████▉| 194/195 [01:10<00:00,  3.07it/s]100%|██████████| 195/195 [01:12<00:00,  2.70it/s]
2025-09-24 09:10:16 [info     ] Validating outputs
2025-09-24 09:10:16 [info     ] Predict - end                  time=0:1:12
2025-09-24 09:10:16 [info     ] Evaluate - start               split=test
2025-09-24 09:10:16 [info     ] Evaluate - end                 answer_distr=[0.5, 0.18, 0.14, 0.12] correctness_llm=0.69 llm_group_correctness=[0.62, 0.69, 0.64, 0.74, 0.74] monotonicity=0.6
2025-09-24 09:10:16 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:10:16 [info     ] Augmenting questions for IRT estimation num_questions=11
2025-09-24 09:10:16 INFO: start loading data
start loading data
2025-09-24 09:10:16 INFO: data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1001.95it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3577.27it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 572.68it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5779.55it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 964.11it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3396.69it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 434.23it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5542.78it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1109.39it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3332.68it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 590.22it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5124.83it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 935.87it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3664.95it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 580.47it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5403.04it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 955.92it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3649.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 665.82it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5666.88it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 855.56it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3701.78it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 528.25it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5533.38it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 921.16it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3795.22it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 546.27it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5357.69it/s]
2025-09-24 09:10:21 INFO: EM converged at iteration 7.
EM converged at iteration 7.
2025-09-24 09:10:21 INFO: parameter estimated
parameter estimated
2025-09-24 09:10:21 INFO: parameter retrieved
parameter retrieved
2025-09-24 09:10:21 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:10:21 [info     ] Evaluate question difficulty - end mae=1.27 rmse=1.68 split=test
2025-09-24 09:10:21 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 1 finished: 0:1:27

 ********** Run: 2/3 **********
2025-09-24 09:10:39 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:10:39 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:10:39 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:10:39 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:10:41 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:10:41 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:10:46 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:10:46 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:10:46 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:10:46 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:10:49 [info     ] Setting seed                   value=44
2025-09-24 09:10:49 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 09:10:49 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_kc_exact native_structured_output=True num_examples=1 system_prompt=teacher_dbe_miscons_level_context
2025-09-24 09:10:49 [info     ] Building example selector
2025-09-24 09:10:49 [info     ] Building model                 name=qwen3:0.6b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:10:49 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:10<32:40, 10.11s/it]  1%|          | 2/195 [00:10<13:55,  4.33s/it]  2%|▏         | 3/195 [00:10<08:04,  2.52s/it]  2%|▏         | 4/195 [00:11<05:21,  1.68s/it]  3%|▎         | 5/195 [00:11<03:53,  1.23s/it]  3%|▎         | 6/195 [00:12<02:59,  1.05it/s]  4%|▎         | 7/195 [00:12<02:23,  1.31it/s]  4%|▍         | 8/195 [00:12<01:43,  1.80it/s]  5%|▍         | 9/195 [00:12<01:30,  2.04it/s]  5%|▌         | 10/195 [00:12<01:08,  2.69it/s]  6%|▌         | 11/195 [00:13<01:05,  2.83it/s]  6%|▌         | 12/195 [00:13<00:54,  3.38it/s]  7%|▋         | 13/195 [00:13<00:54,  3.34it/s]  8%|▊         | 15/195 [00:14<00:46,  3.84it/s]  8%|▊         | 16/195 [00:14<00:42,  4.16it/s]  9%|▊         | 17/195 [00:14<00:47,  3.76it/s]  9%|▉         | 18/195 [00:15<01:02,  2.83it/s] 10%|▉         | 19/195 [00:15<00:52,  3.36it/s] 10%|█         | 20/195 [00:15<00:58,  2.98it/s] 11%|█         | 21/195 [00:16<00:55,  3.12it/s] 11%|█▏        | 22/195 [00:16<00:53,  3.25it/s] 12%|█▏        | 23/195 [00:16<00:45,  3.80it/s] 12%|█▏        | 24/195 [00:16<00:49,  3.46it/s] 13%|█▎        | 25/195 [00:17<01:00,  2.83it/s] 13%|█▎        | 26/195 [00:17<00:55,  3.07it/s] 14%|█▍        | 28/195 [00:18<01:11,  2.35it/s] 15%|█▌        | 30/195 [00:19<00:59,  2.78it/s] 16%|█▌        | 31/195 [00:19<01:03,  2.58it/s] 16%|█▋        | 32/195 [00:19<00:54,  2.98it/s] 17%|█▋        | 33/195 [00:20<00:54,  2.95it/s] 17%|█▋        | 34/195 [00:20<00:46,  3.44it/s] 18%|█▊        | 35/195 [00:20<00:43,  3.65it/s] 18%|█▊        | 36/195 [00:20<00:45,  3.49it/s] 19%|█▉        | 37/195 [00:21<00:42,  3.72it/s] 19%|█▉        | 38/195 [00:21<00:40,  3.86it/s] 20%|██        | 39/195 [00:21<00:45,  3.40it/s] 21%|██        | 40/195 [00:22<00:52,  2.95it/s] 21%|██        | 41/195 [00:22<00:56,  2.74it/s] 22%|██▏       | 43/195 [00:23<00:40,  3.72it/s] 23%|██▎       | 44/195 [00:23<00:36,  4.18it/s] 23%|██▎       | 45/195 [00:23<00:39,  3.82it/s] 24%|██▎       | 46/195 [00:23<00:35,  4.20it/s] 24%|██▍       | 47/195 [00:24<00:40,  3.62it/s] 25%|██▍       | 48/195 [00:24<00:33,  4.35it/s] 25%|██▌       | 49/195 [00:24<00:34,  4.27it/s] 26%|██▌       | 50/195 [00:25<01:04,  2.25it/s] 26%|██▌       | 51/195 [00:25<00:55,  2.57it/s] 27%|██▋       | 52/195 [00:25<00:53,  2.65it/s] 27%|██▋       | 53/195 [00:26<00:45,  3.12it/s] 28%|██▊       | 54/195 [00:26<00:47,  2.99it/s] 28%|██▊       | 55/195 [00:26<00:37,  3.71it/s] 29%|██▊       | 56/195 [00:26<00:41,  3.34it/s] 29%|██▉       | 57/195 [00:27<00:33,  4.11it/s] 30%|██▉       | 58/195 [00:27<00:40,  3.42it/s] 30%|███       | 59/195 [00:27<00:32,  4.16it/s] 31%|███       | 60/195 [00:28<00:43,  3.11it/s] 31%|███▏      | 61/195 [00:28<00:34,  3.90it/s] 32%|███▏      | 62/195 [00:28<00:41,  3.19it/s] 33%|███▎      | 64/195 [00:29<00:36,  3.62it/s] 33%|███▎      | 65/195 [00:29<00:33,  3.84it/s] 34%|███▍      | 66/195 [00:29<00:38,  3.31it/s] 34%|███▍      | 67/195 [00:30<00:51,  2.46it/s] 35%|███▍      | 68/195 [00:30<00:50,  2.54it/s] 36%|███▌      | 70/195 [00:31<00:46,  2.72it/s] 36%|███▋      | 71/195 [00:31<00:43,  2.85it/s] 37%|███▋      | 72/195 [00:32<00:48,  2.55it/s] 37%|███▋      | 73/195 [00:32<00:40,  3.03it/s] 38%|███▊      | 74/195 [00:32<00:41,  2.91it/s] 38%|███▊      | 75/195 [00:33<00:35,  3.37it/s] 39%|███▉      | 76/195 [00:33<00:39,  3.04it/s] 39%|███▉      | 77/195 [00:33<00:34,  3.45it/s] 40%|████      | 78/195 [00:33<00:35,  3.31it/s] 41%|████      | 79/195 [00:34<00:28,  4.04it/s] 41%|████      | 80/195 [00:34<00:37,  3.09it/s] 42%|████▏     | 81/195 [00:35<00:43,  2.60it/s] 42%|████▏     | 82/195 [00:35<00:34,  3.25it/s] 43%|████▎     | 83/195 [00:35<00:31,  3.51it/s] 43%|████▎     | 84/195 [00:35<00:31,  3.56it/s] 44%|████▎     | 85/195 [00:36<00:36,  3.00it/s] 44%|████▍     | 86/195 [00:36<00:31,  3.46it/s] 45%|████▍     | 87/195 [00:36<00:28,  3.74it/s] 45%|████▌     | 88/195 [00:37<00:33,  3.23it/s] 46%|████▌     | 89/195 [00:37<00:27,  3.88it/s] 46%|████▌     | 90/195 [00:37<00:26,  3.92it/s] 47%|████▋     | 91/195 [00:37<00:31,  3.32it/s] 47%|████▋     | 92/195 [00:38<00:29,  3.54it/s] 48%|████▊     | 93/195 [00:38<00:27,  3.73it/s] 48%|████▊     | 94/195 [00:38<00:26,  3.80it/s] 49%|████▊     | 95/195 [00:38<00:22,  4.42it/s] 49%|████▉     | 96/195 [00:39<00:29,  3.36it/s] 50%|█████     | 98/195 [00:39<00:30,  3.19it/s] 51%|█████     | 99/195 [00:39<00:27,  3.52it/s] 51%|█████▏    | 100/195 [00:40<00:26,  3.64it/s] 52%|█████▏    | 101/195 [00:40<00:27,  3.45it/s] 52%|█████▏    | 102/195 [00:41<00:31,  2.99it/s] 53%|█████▎    | 103/195 [00:41<00:38,  2.40it/s] 54%|█████▍    | 105/195 [00:42<00:34,  2.62it/s] 54%|█████▍    | 106/195 [00:42<00:35,  2.52it/s] 55%|█████▍    | 107/195 [00:42<00:28,  3.05it/s] 55%|█████▌    | 108/195 [00:43<00:32,  2.64it/s] 56%|█████▌    | 109/195 [00:43<00:26,  3.29it/s] 56%|█████▋    | 110/195 [00:43<00:25,  3.28it/s] 57%|█████▋    | 111/195 [00:44<00:25,  3.27it/s] 57%|█████▋    | 112/195 [00:44<00:36,  2.28it/s] 58%|█████▊    | 113/195 [00:45<00:28,  2.92it/s] 58%|█████▊    | 114/195 [00:45<00:34,  2.38it/s] 59%|█████▉    | 115/195 [00:45<00:28,  2.83it/s] 59%|█████▉    | 116/195 [00:46<00:29,  2.64it/s] 60%|██████    | 117/195 [00:46<00:25,  3.08it/s] 61%|██████    | 118/195 [00:46<00:25,  3.02it/s] 61%|██████    | 119/195 [00:47<00:36,  2.09it/s] 62%|██████▏   | 121/195 [00:47<00:25,  2.95it/s] 63%|██████▎   | 122/195 [00:48<00:25,  2.83it/s] 63%|██████▎   | 123/195 [00:48<00:28,  2.50it/s] 64%|██████▎   | 124/195 [00:49<00:24,  2.90it/s] 64%|██████▍   | 125/195 [00:49<00:20,  3.41it/s] 65%|██████▍   | 126/195 [00:49<00:24,  2.86it/s] 65%|██████▌   | 127/195 [00:50<00:26,  2.54it/s] 66%|██████▌   | 129/195 [00:50<00:21,  3.04it/s] 67%|██████▋   | 130/195 [00:50<00:18,  3.48it/s] 67%|██████▋   | 131/195 [00:51<00:19,  3.24it/s] 68%|██████▊   | 132/195 [00:51<00:17,  3.69it/s] 68%|██████▊   | 133/195 [00:51<00:16,  3.77it/s] 69%|██████▊   | 134/195 [00:51<00:16,  3.76it/s] 69%|██████▉   | 135/195 [00:52<00:14,  4.12it/s] 70%|██████▉   | 136/195 [00:52<00:16,  3.51it/s] 70%|███████   | 137/195 [00:52<00:14,  4.00it/s] 71%|███████   | 138/195 [00:53<00:16,  3.37it/s] 72%|███████▏  | 140/195 [00:53<00:16,  3.34it/s] 73%|███████▎  | 142/195 [00:54<00:14,  3.54it/s] 73%|███████▎  | 143/195 [00:54<00:13,  3.78it/s] 74%|███████▍  | 144/195 [00:54<00:13,  3.88it/s] 74%|███████▍  | 145/195 [00:54<00:11,  4.32it/s] 75%|███████▍  | 146/195 [00:55<00:11,  4.22it/s] 75%|███████▌  | 147/195 [00:55<00:12,  3.79it/s] 76%|███████▌  | 148/195 [00:55<00:10,  4.39it/s] 76%|███████▋  | 149/195 [00:55<00:13,  3.51it/s] 77%|███████▋  | 150/195 [00:56<00:11,  3.84it/s] 77%|███████▋  | 151/195 [00:56<00:10,  4.29it/s] 78%|███████▊  | 152/195 [00:56<00:15,  2.85it/s] 78%|███████▊  | 153/195 [00:57<00:13,  3.16it/s] 79%|███████▉  | 154/195 [00:57<00:11,  3.69it/s] 79%|███████▉  | 155/195 [00:57<00:11,  3.43it/s] 80%|████████  | 156/195 [00:58<00:12,  3.03it/s] 81%|████████  | 158/195 [00:58<00:13,  2.72it/s] 82%|████████▏ | 159/195 [00:59<00:11,  3.13it/s] 82%|████████▏ | 160/195 [00:59<00:13,  2.54it/s] 83%|████████▎ | 162/195 [01:00<00:11,  2.96it/s] 84%|████████▎ | 163/195 [01:00<00:09,  3.50it/s] 84%|████████▍ | 164/195 [01:00<00:09,  3.22it/s] 85%|████████▍ | 165/195 [01:01<00:11,  2.68it/s] 86%|████████▌ | 167/195 [01:01<00:07,  3.62it/s] 86%|████████▌ | 168/195 [01:01<00:07,  3.42it/s] 87%|████████▋ | 169/195 [01:02<00:09,  2.69it/s] 88%|████████▊ | 171/195 [01:03<00:07,  3.11it/s] 89%|████████▊ | 173/195 [01:03<00:06,  3.50it/s] 89%|████████▉ | 174/195 [01:03<00:05,  3.98it/s] 90%|████████▉ | 175/195 [01:03<00:05,  3.83it/s] 90%|█████████ | 176/195 [01:04<00:04,  3.91it/s] 91%|█████████ | 177/195 [01:04<00:05,  3.20it/s] 91%|█████████▏| 178/195 [01:04<00:05,  3.11it/s] 92%|█████████▏| 179/195 [01:05<00:04,  3.45it/s] 92%|█████████▏| 180/195 [01:05<00:05,  2.84it/s] 93%|█████████▎| 181/195 [01:05<00:04,  3.04it/s] 93%|█████████▎| 182/195 [01:06<00:05,  2.32it/s] 94%|█████████▍| 183/195 [01:06<00:04,  2.92it/s] 94%|█████████▍| 184/195 [01:07<00:04,  2.70it/s] 95%|█████████▍| 185/195 [01:07<00:02,  3.41it/s] 95%|█████████▌| 186/195 [01:07<00:03,  2.96it/s] 96%|█████████▌| 187/195 [01:07<00:02,  3.62it/s] 96%|█████████▋| 188/195 [01:08<00:01,  3.69it/s] 97%|█████████▋| 189/195 [01:08<00:01,  3.21it/s] 97%|█████████▋| 190/195 [01:09<00:02,  2.42it/s] 98%|█████████▊| 191/195 [01:09<00:01,  2.88it/s] 98%|█████████▊| 192/195 [01:10<00:01,  2.27it/s] 99%|█████████▉| 194/195 [01:10<00:00,  2.87it/s]100%|██████████| 195/195 [01:10<00:00,  3.26it/s]100%|██████████| 195/195 [01:12<00:00,  2.68it/s]
2025-09-24 09:12:02 [info     ] Validating outputs
2025-09-24 09:12:02 [info     ] Predict - end                  time=0:1:12
2025-09-24 09:12:02 [info     ] Evaluate - start               split=test
2025-09-24 09:12:02 [info     ] Evaluate - end                 answer_distr=[0.51, 0.2, 0.12, 0.11] correctness_llm=0.69 llm_group_correctness=[0.64, 0.69, 0.62, 0.72, 0.77] monotonicity=0.39
2025-09-24 09:12:02 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:12:02 [info     ] Augmenting questions for IRT estimation num_questions=10
2025-09-24 09:12:02 INFO: start loading data
start loading data
start loading data
2025-09-24 09:12:02 INFO: data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1132.20it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3572.27it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 574.28it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7665.83it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1029.39it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3701.86it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 576.59it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6853.44it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 978.31it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3635.14it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 602.62it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6695.58it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 943.78it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3678.55it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 746.15it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6614.13it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1029.53it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3822.00it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 636.89it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6908.27it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1012.63it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3747.06it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 671.31it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6896.91it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 945.61it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3578.60it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 554.25it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8088.19it/s]
2025-09-24 09:12:07 INFO: EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
2025-09-24 09:12:07 INFO: parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:12:07 INFO: parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:12:07 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:12:07 [info     ] Evaluate question difficulty - end mae=1.42 rmse=1.77 split=test
2025-09-24 09:12:07 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 2 finished: 0:1:28

 ********** Run: 3/3 **********
2025-09-24 09:12:25 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:12:25 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:12:25 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:12:25 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:12:27 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:12:27 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:12:32 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:12:32 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:12:32 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:12:32 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:12:36 [info     ] Setting seed                   value=45
2025-09-24 09:12:36 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 09:12:36 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_kc_exact native_structured_output=True num_examples=1 system_prompt=teacher_dbe_miscons_level_context
2025-09-24 09:12:36 [info     ] Building example selector
2025-09-24 09:12:36 [info     ] Building model                 name=qwen3:0.6b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:12:36 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:10<33:12, 10.27s/it]  1%|          | 2/195 [00:10<14:27,  4.50s/it]  2%|▏         | 3/195 [00:11<08:26,  2.64s/it]  2%|▏         | 4/195 [00:11<05:40,  1.78s/it]  3%|▎         | 5/195 [00:11<03:44,  1.18s/it]  3%|▎         | 6/195 [00:12<03:03,  1.03it/s]  4%|▎         | 7/195 [00:12<02:38,  1.18it/s]  4%|▍         | 8/195 [00:13<01:59,  1.57it/s]  5%|▍         | 9/195 [00:13<01:41,  1.83it/s]  6%|▌         | 11/195 [00:13<01:16,  2.40it/s]  6%|▌         | 12/195 [00:14<01:01,  2.96it/s]  7%|▋         | 13/195 [00:14<00:59,  3.07it/s]  8%|▊         | 15/195 [00:14<00:51,  3.50it/s]  8%|▊         | 16/195 [00:15<00:51,  3.47it/s]  9%|▉         | 18/195 [00:15<00:49,  3.56it/s] 10%|█         | 20/195 [00:16<00:49,  3.56it/s] 11%|█         | 21/195 [00:16<00:56,  3.08it/s] 11%|█▏        | 22/195 [00:16<00:49,  3.48it/s] 12%|█▏        | 23/195 [00:17<00:45,  3.78it/s] 12%|█▏        | 24/195 [00:17<00:40,  4.22it/s] 13%|█▎        | 25/195 [00:18<01:06,  2.56it/s] 14%|█▍        | 27/195 [00:18<00:53,  3.11it/s] 14%|█▍        | 28/195 [00:18<00:56,  2.96it/s] 15%|█▍        | 29/195 [00:19<00:49,  3.38it/s] 15%|█▌        | 30/195 [00:19<00:43,  3.83it/s] 16%|█▌        | 31/195 [00:19<00:46,  3.51it/s] 16%|█▋        | 32/195 [00:19<00:40,  4.03it/s] 17%|█▋        | 33/195 [00:20<00:47,  3.38it/s] 18%|█▊        | 35/195 [00:20<00:49,  3.22it/s] 19%|█▉        | 37/195 [00:21<00:59,  2.67it/s] 19%|█▉        | 38/195 [00:22<00:55,  2.84it/s] 20%|██        | 39/195 [00:22<00:49,  3.17it/s] 21%|██        | 40/195 [00:22<00:47,  3.23it/s] 21%|██        | 41/195 [00:23<00:57,  2.66it/s] 22%|██▏       | 42/195 [00:23<00:49,  3.11it/s] 22%|██▏       | 43/195 [00:23<00:50,  3.00it/s] 23%|██▎       | 44/195 [00:24<01:00,  2.51it/s] 24%|██▎       | 46/195 [00:24<00:57,  2.58it/s] 24%|██▍       | 47/195 [00:25<00:49,  2.99it/s] 25%|██▍       | 48/195 [00:25<00:51,  2.85it/s] 25%|██▌       | 49/195 [00:25<00:44,  3.30it/s] 26%|██▌       | 50/195 [00:26<00:47,  3.05it/s] 26%|██▌       | 51/195 [00:26<00:38,  3.75it/s] 27%|██▋       | 52/195 [00:26<00:43,  3.26it/s] 27%|██▋       | 53/195 [00:26<00:38,  3.67it/s] 28%|██▊       | 54/195 [00:27<00:44,  3.16it/s] 28%|██▊       | 55/195 [00:27<00:36,  3.88it/s] 29%|██▊       | 56/195 [00:27<00:46,  3.00it/s] 30%|██▉       | 58/195 [00:28<00:42,  3.26it/s] 30%|███       | 59/195 [00:28<00:37,  3.60it/s] 31%|███       | 60/195 [00:28<00:41,  3.29it/s] 31%|███▏      | 61/195 [00:29<00:37,  3.57it/s] 32%|███▏      | 62/195 [00:29<00:34,  3.81it/s] 32%|███▏      | 63/195 [00:29<00:28,  4.56it/s] 33%|███▎      | 64/195 [00:30<00:41,  3.17it/s] 33%|███▎      | 65/195 [00:30<00:42,  3.05it/s] 34%|███▍      | 66/195 [00:30<00:40,  3.18it/s] 34%|███▍      | 67/195 [00:30<00:35,  3.61it/s] 35%|███▍      | 68/195 [00:31<00:42,  3.02it/s] 35%|███▌      | 69/195 [00:31<00:42,  2.94it/s] 36%|███▌      | 70/195 [00:31<00:35,  3.53it/s] 36%|███▋      | 71/195 [00:32<00:39,  3.11it/s] 37%|███▋      | 72/195 [00:32<00:50,  2.45it/s] 37%|███▋      | 73/195 [00:33<00:45,  2.69it/s] 38%|███▊      | 75/195 [00:33<00:34,  3.51it/s] 39%|███▉      | 76/195 [00:34<00:43,  2.73it/s] 39%|███▉      | 77/195 [00:34<00:38,  3.05it/s] 40%|████      | 78/195 [00:34<00:41,  2.82it/s] 41%|████      | 79/195 [00:35<00:41,  2.81it/s] 42%|████▏     | 81/195 [00:35<00:32,  3.49it/s] 42%|████▏     | 82/195 [00:35<00:28,  3.97it/s] 43%|████▎     | 83/195 [00:36<00:36,  3.05it/s] 43%|████▎     | 84/195 [00:36<00:31,  3.52it/s] 44%|████▎     | 85/195 [00:36<00:34,  3.17it/s] 44%|████▍     | 86/195 [00:36<00:29,  3.76it/s] 45%|████▍     | 87/195 [00:37<00:34,  3.15it/s] 46%|████▌     | 89/195 [00:37<00:32,  3.31it/s] 46%|████▌     | 90/195 [00:38<00:27,  3.82it/s] 47%|████▋     | 91/195 [00:38<00:33,  3.11it/s] 47%|████▋     | 92/195 [00:38<00:34,  3.01it/s] 48%|████▊     | 93/195 [00:39<00:28,  3.53it/s] 48%|████▊     | 94/195 [00:39<00:31,  3.22it/s] 49%|████▊     | 95/195 [00:39<00:25,  3.87it/s] 49%|████▉     | 96/195 [00:39<00:21,  4.51it/s] 50%|████▉     | 97/195 [00:40<00:24,  3.98it/s] 50%|█████     | 98/195 [00:40<00:30,  3.18it/s] 51%|█████▏    | 100/195 [00:41<00:28,  3.38it/s] 52%|█████▏    | 101/195 [00:41<00:28,  3.27it/s] 52%|█████▏    | 102/195 [00:41<00:27,  3.43it/s] 53%|█████▎    | 103/195 [00:42<00:38,  2.37it/s] 53%|█████▎    | 104/195 [00:43<00:43,  2.07it/s] 54%|█████▍    | 106/195 [00:43<00:32,  2.72it/s] 55%|█████▍    | 107/195 [00:44<00:36,  2.43it/s] 56%|█████▌    | 109/195 [00:44<00:29,  2.89it/s] 56%|█████▋    | 110/195 [00:44<00:24,  3.43it/s] 57%|█████▋    | 111/195 [00:45<00:27,  3.09it/s] 57%|█████▋    | 112/195 [00:45<00:25,  3.30it/s] 58%|█████▊    | 113/195 [00:45<00:26,  3.13it/s] 58%|█████▊    | 114/195 [00:46<00:28,  2.80it/s] 59%|█████▉    | 115/195 [00:46<00:29,  2.74it/s] 59%|█████▉    | 116/195 [00:46<00:29,  2.71it/s] 61%|██████    | 118/195 [00:47<00:25,  3.06it/s] 61%|██████    | 119/195 [00:47<00:20,  3.64it/s] 62%|██████▏   | 120/195 [00:47<00:22,  3.32it/s] 62%|██████▏   | 121/195 [00:48<00:23,  3.18it/s] 63%|██████▎   | 123/195 [00:48<00:19,  3.77it/s] 64%|██████▍   | 125/195 [00:49<00:16,  4.26it/s] 65%|██████▍   | 126/195 [00:49<00:14,  4.70it/s] 65%|██████▌   | 127/195 [00:49<00:17,  3.99it/s] 66%|██████▌   | 128/195 [00:49<00:15,  4.35it/s] 66%|██████▌   | 129/195 [00:50<00:16,  3.95it/s] 67%|██████▋   | 130/195 [00:50<00:14,  4.49it/s] 67%|██████▋   | 131/195 [00:50<00:15,  4.25it/s] 68%|██████▊   | 133/195 [00:50<00:13,  4.70it/s] 69%|██████▊   | 134/195 [00:50<00:12,  5.05it/s] 69%|██████▉   | 135/195 [00:51<00:14,  4.19it/s] 70%|██████▉   | 136/195 [00:51<00:14,  4.07it/s] 70%|███████   | 137/195 [00:51<00:15,  3.84it/s] 71%|███████   | 138/195 [00:52<00:12,  4.40it/s] 71%|███████▏  | 139/195 [00:52<00:12,  4.35it/s] 72%|███████▏  | 140/195 [00:52<00:14,  3.70it/s] 73%|███████▎  | 142/195 [00:53<00:13,  3.82it/s] 73%|███████▎  | 143/195 [00:53<00:12,  4.07it/s] 74%|███████▍  | 144/195 [00:53<00:12,  4.01it/s] 74%|███████▍  | 145/195 [00:53<00:13,  3.75it/s] 75%|███████▍  | 146/195 [00:54<00:12,  4.03it/s] 75%|███████▌  | 147/195 [00:54<00:10,  4.40it/s] 76%|███████▌  | 148/195 [00:54<00:12,  3.80it/s] 76%|███████▋  | 149/195 [00:54<00:11,  3.99it/s] 77%|███████▋  | 150/195 [00:55<00:11,  3.86it/s] 77%|███████▋  | 151/195 [00:55<00:13,  3.23it/s] 78%|███████▊  | 152/195 [00:55<00:12,  3.49it/s] 78%|███████▊  | 153/195 [00:56<00:12,  3.31it/s] 79%|███████▉  | 154/195 [00:56<00:10,  3.77it/s] 79%|███████▉  | 155/195 [00:56<00:09,  4.35it/s] 80%|████████  | 156/195 [00:57<00:14,  2.73it/s] 81%|████████  | 157/195 [00:57<00:17,  2.23it/s] 82%|████████▏ | 159/195 [00:58<00:11,  3.07it/s] 82%|████████▏ | 160/195 [00:58<00:13,  2.60it/s] 83%|████████▎ | 162/195 [00:59<00:10,  3.18it/s] 84%|████████▎ | 163/195 [00:59<00:10,  2.92it/s] 84%|████████▍ | 164/195 [00:59<00:09,  3.31it/s] 85%|████████▍ | 165/195 [01:00<00:10,  2.92it/s] 85%|████████▌ | 166/195 [01:00<00:09,  3.19it/s] 86%|████████▌ | 167/195 [01:00<00:09,  2.83it/s] 86%|████████▌ | 168/195 [01:01<00:08,  3.07it/s] 87%|████████▋ | 169/195 [01:01<00:10,  2.56it/s] 88%|████████▊ | 171/195 [01:02<00:07,  3.32it/s] 88%|████████▊ | 172/195 [01:02<00:06,  3.68it/s] 89%|████████▊ | 173/195 [01:02<00:07,  2.95it/s] 90%|████████▉ | 175/195 [01:03<00:05,  3.78it/s] 90%|█████████ | 176/195 [01:03<00:04,  4.15it/s] 91%|█████████ | 177/195 [01:04<00:07,  2.53it/s] 92%|█████████▏| 179/195 [01:04<00:05,  2.80it/s] 92%|█████████▏| 180/195 [01:05<00:05,  2.71it/s] 93%|█████████▎| 182/195 [01:05<00:04,  3.10it/s] 94%|█████████▍| 183/195 [01:05<00:03,  3.47it/s] 94%|█████████▍| 184/195 [01:06<00:03,  3.26it/s] 95%|█████████▍| 185/195 [01:06<00:03,  2.95it/s] 95%|█████████▌| 186/195 [01:07<00:03,  2.63it/s] 96%|█████████▌| 187/195 [01:07<00:02,  3.06it/s] 96%|█████████▋| 188/195 [01:08<00:03,  2.25it/s] 97%|█████████▋| 190/195 [01:08<00:01,  2.66it/s] 98%|█████████▊| 191/195 [01:09<00:01,  2.56it/s] 99%|█████████▉| 193/195 [01:09<00:00,  2.99it/s]100%|██████████| 195/195 [01:09<00:00,  3.86it/s]100%|██████████| 195/195 [01:12<00:00,  2.71it/s]
2025-09-24 09:13:48 [info     ] Validating outputs
2025-09-24 09:13:48 [info     ] Predict - end                  time=0:1:12
2025-09-24 09:13:48 [info     ] Evaluate - start               split=test
2025-09-24 09:13:48 [info     ] Evaluate - end                 answer_distr=[0.46, 0.19, 0.16, 0.09] correctness_llm=0.65 llm_group_correctness=[0.56, 0.59, 0.72, 0.64, 0.72] monotonicity=0.54
2025-09-24 09:13:48 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:13:48 [info     ] Augmenting questions for IRT estimation num_questions=8
2025-09-24 09:13:48 INFO: start loading data
start loading data
start loading data
start loading data
2025-09-24 09:13:48 INFO: data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1055.32it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3383.13it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 533.77it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5365.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 947.38it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3519.47it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 621.10it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5333.36it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 905.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3534.68it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 599.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5715.42it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1027.62it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3667.99it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 654.24it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5297.75it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 952.39it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3636.19it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 570.98it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 4972.92it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 915.30it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3422.35it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 589.95it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 4693.12it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 945.18it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3698.43it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 597.44it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5047.30it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1039.37it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3438.03it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 569.18it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5269.23it/s]
2025-09-24 09:13:53 INFO: EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
2025-09-24 09:13:53 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:13:53 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:13:53 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:13:53 [info     ] Evaluate question difficulty - end mae=1.32 rmse=1.64 split=test
2025-09-24 09:13:53 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 3 finished: 0:1:27

 ========== Config: qwen3:4b~T_1.0~SO_teacher_bool_nocontext~L_5~SP_teacher_dbe_miscons_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_dbe_studentlevel_kc_exact5 ==========
Config 2/16

 ********** Run: 1/3 **********
2025-09-24 09:14:10 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:14:10 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:14:10 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:14:10 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:14:12 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:14:12 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:14:17 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:14:17 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:14:17 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:14:18 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:14:21 [info     ] Setting seed                   value=43
2025-09-24 09:14:21 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 09:14:21 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_kc_exact native_structured_output=True num_examples=5 system_prompt=teacher_dbe_miscons_level_context
2025-09-24 09:14:21 [info     ] Building example selector
2025-09-24 09:14:21 [info     ] Building model                 name=qwen3:4b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:14:21 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:15<48:41, 15.06s/it]  1%|          | 2/195 [00:15<20:27,  6.36s/it]  2%|▏         | 3/195 [00:17<14:29,  4.53s/it]  3%|▎         | 5/195 [00:19<08:16,  2.61s/it]  3%|▎         | 6/195 [00:20<06:39,  2.12s/it]  4%|▎         | 7/195 [00:21<05:40,  1.81s/it]  4%|▍         | 8/195 [00:22<04:41,  1.50s/it]  5%|▍         | 9/195 [00:23<04:25,  1.43s/it]  5%|▌         | 10/195 [00:24<03:50,  1.25s/it]  6%|▌         | 11/195 [00:25<03:20,  1.09s/it]  6%|▌         | 12/195 [00:26<02:54,  1.05it/s]  7%|▋         | 13/195 [00:26<02:33,  1.18it/s]  7%|▋         | 14/195 [00:27<02:16,  1.32it/s]  8%|▊         | 15/195 [00:27<02:10,  1.37it/s]  8%|▊         | 16/195 [00:28<02:05,  1.43it/s]  9%|▊         | 17/195 [00:29<02:15,  1.31it/s]  9%|▉         | 18/195 [00:29<02:01,  1.46it/s] 10%|▉         | 19/195 [00:30<02:17,  1.28it/s] 11%|█         | 21/195 [00:32<02:05,  1.39it/s] 12%|█▏        | 23/195 [00:33<02:00,  1.42it/s] 13%|█▎        | 25/195 [00:34<01:50,  1.55it/s] 14%|█▍        | 27/195 [00:35<01:36,  1.74it/s] 15%|█▍        | 29/195 [00:36<01:29,  1.85it/s] 16%|█▌        | 31/195 [00:37<01:27,  1.88it/s] 17%|█▋        | 33/195 [00:38<01:22,  1.96it/s] 17%|█▋        | 34/195 [00:38<01:13,  2.18it/s] 18%|█▊        | 35/195 [00:39<01:20,  1.98it/s] 18%|█▊        | 36/195 [00:39<01:10,  2.26it/s] 19%|█▉        | 37/195 [00:40<01:16,  2.05it/s] 19%|█▉        | 38/195 [00:40<01:12,  2.17it/s] 20%|██        | 39/195 [00:41<01:11,  2.19it/s] 21%|██        | 40/195 [00:41<01:12,  2.14it/s] 21%|██        | 41/195 [00:41<01:10,  2.20it/s] 22%|██▏       | 42/195 [00:42<01:07,  2.28it/s] 22%|██▏       | 43/195 [00:42<01:04,  2.36it/s] 23%|██▎       | 44/195 [00:43<01:05,  2.31it/s] 23%|██▎       | 45/195 [00:43<01:02,  2.39it/s] 24%|██▎       | 46/195 [00:44<01:03,  2.34it/s] 24%|██▍       | 47/195 [00:44<01:02,  2.38it/s] 25%|██▍       | 48/195 [00:44<01:03,  2.30it/s] 25%|██▌       | 49/195 [00:45<01:00,  2.40it/s] 26%|██▌       | 50/195 [00:46<01:13,  1.98it/s] 26%|██▌       | 51/195 [00:46<01:20,  1.79it/s] 27%|██▋       | 52/195 [00:47<01:28,  1.61it/s] 27%|██▋       | 53/195 [00:48<01:36,  1.47it/s] 28%|██▊       | 54/195 [00:49<01:38,  1.43it/s] 28%|██▊       | 55/195 [00:49<01:41,  1.38it/s] 29%|██▊       | 56/195 [00:50<01:57,  1.18it/s] 29%|██▉       | 57/195 [00:51<01:51,  1.24it/s] 30%|██▉       | 58/195 [00:52<02:01,  1.13it/s] 30%|███       | 59/195 [00:53<01:53,  1.19it/s] 31%|███       | 60/195 [00:54<01:54,  1.18it/s] 31%|███▏      | 61/195 [00:54<01:44,  1.29it/s] 32%|███▏      | 62/195 [00:55<01:36,  1.38it/s] 32%|███▏      | 63/195 [00:56<01:33,  1.41it/s] 33%|███▎      | 64/195 [00:56<01:24,  1.56it/s] 33%|███▎      | 65/195 [00:57<01:30,  1.44it/s] 34%|███▍      | 66/195 [00:57<01:20,  1.61it/s] 34%|███▍      | 67/195 [00:58<01:26,  1.48it/s] 35%|███▍      | 68/195 [00:59<01:10,  1.81it/s] 35%|███▌      | 69/195 [00:59<01:19,  1.58it/s] 36%|███▌      | 70/195 [01:00<01:04,  1.94it/s] 36%|███▋      | 71/195 [01:01<01:21,  1.52it/s] 37%|███▋      | 72/195 [01:01<01:06,  1.85it/s] 37%|███▋      | 73/195 [01:02<01:25,  1.42it/s] 38%|███▊      | 75/195 [01:03<01:21,  1.48it/s] 39%|███▉      | 76/195 [01:04<01:26,  1.38it/s] 39%|███▉      | 77/195 [01:04<01:11,  1.64it/s] 40%|████      | 78/195 [01:05<01:22,  1.42it/s] 41%|████      | 79/195 [01:06<01:07,  1.72it/s] 41%|████      | 80/195 [01:06<01:16,  1.50it/s] 42%|████▏     | 82/195 [01:07<01:06,  1.69it/s] 43%|████▎     | 84/195 [01:08<01:00,  1.84it/s] 44%|████▎     | 85/195 [01:09<00:52,  2.10it/s] 44%|████▍     | 86/195 [01:10<01:01,  1.76it/s] 45%|████▍     | 87/195 [01:10<00:52,  2.06it/s] 45%|████▌     | 88/195 [01:10<00:58,  1.84it/s] 46%|████▌     | 89/195 [01:11<00:55,  1.91it/s] 46%|████▌     | 90/195 [01:11<00:53,  1.95it/s] 47%|████▋     | 91/195 [01:12<00:53,  1.94it/s] 47%|████▋     | 92/195 [01:12<00:53,  1.91it/s] 48%|████▊     | 93/195 [01:13<00:51,  1.96it/s] 48%|████▊     | 94/195 [01:14<00:52,  1.93it/s] 49%|████▊     | 95/195 [01:14<00:46,  2.13it/s] 49%|████▉     | 96/195 [01:14<00:47,  2.08it/s] 50%|████▉     | 97/195 [01:15<00:46,  2.11it/s] 50%|█████     | 98/195 [01:15<00:47,  2.04it/s] 51%|█████     | 99/195 [01:16<00:47,  2.02it/s] 51%|█████▏    | 100/195 [01:17<00:57,  1.65it/s] 52%|█████▏    | 101/195 [01:18<01:23,  1.12it/s] 52%|█████▏    | 102/195 [01:19<01:28,  1.05it/s] 53%|█████▎    | 103/195 [01:21<01:35,  1.04s/it] 53%|█████▎    | 104/195 [01:22<01:37,  1.07s/it] 54%|█████▍    | 105/195 [01:23<01:28,  1.02it/s] 54%|█████▍    | 106/195 [01:23<01:17,  1.14it/s] 55%|█████▍    | 107/195 [01:24<01:11,  1.23it/s] 55%|█████▌    | 108/195 [01:24<01:03,  1.37it/s] 56%|█████▌    | 109/195 [01:25<00:57,  1.51it/s] 56%|█████▋    | 110/195 [01:26<00:56,  1.50it/s] 57%|█████▋    | 111/195 [01:26<00:54,  1.54it/s] 57%|█████▋    | 112/195 [01:27<00:53,  1.56it/s] 58%|█████▊    | 113/195 [01:27<00:42,  1.93it/s] 58%|█████▊    | 114/195 [01:28<00:50,  1.61it/s] 59%|█████▉    | 116/195 [01:30<00:59,  1.33it/s] 61%|██████    | 118/195 [01:32<01:04,  1.20it/s] 62%|██████▏   | 120/195 [01:33<01:01,  1.23it/s] 63%|██████▎   | 122/195 [01:34<00:49,  1.46it/s] 63%|██████▎   | 123/195 [01:34<00:45,  1.57it/s] 64%|██████▎   | 124/195 [01:35<00:42,  1.66it/s] 64%|██████▍   | 125/195 [01:35<00:39,  1.77it/s] 65%|██████▍   | 126/195 [01:36<00:36,  1.88it/s] 65%|██████▌   | 127/195 [01:36<00:34,  1.96it/s] 66%|██████▌   | 128/195 [01:37<00:31,  2.12it/s] 66%|██████▌   | 129/195 [01:37<00:33,  2.00it/s] 67%|██████▋   | 130/195 [01:38<00:37,  1.73it/s] 68%|██████▊   | 132/195 [01:39<00:34,  1.84it/s] 69%|██████▊   | 134/195 [01:40<00:29,  2.05it/s] 70%|██████▉   | 136/195 [01:41<00:27,  2.13it/s] 71%|███████   | 138/195 [01:41<00:25,  2.27it/s] 71%|███████▏  | 139/195 [01:42<00:24,  2.33it/s] 72%|███████▏  | 140/195 [01:42<00:24,  2.25it/s] 72%|███████▏  | 141/195 [01:43<00:23,  2.33it/s] 73%|███████▎  | 142/195 [01:43<00:22,  2.36it/s] 73%|███████▎  | 143/195 [01:44<00:21,  2.40it/s] 74%|███████▍  | 144/195 [01:44<00:20,  2.46it/s] 74%|███████▍  | 145/195 [01:44<00:21,  2.31it/s] 75%|███████▍  | 146/195 [01:45<00:18,  2.66it/s] 75%|███████▌  | 147/195 [01:45<00:20,  2.29it/s] 76%|███████▌  | 148/195 [01:45<00:17,  2.65it/s] 76%|███████▋  | 149/195 [01:46<00:22,  2.08it/s] 77%|███████▋  | 150/195 [01:46<00:18,  2.40it/s] 77%|███████▋  | 151/195 [01:47<00:21,  2.03it/s] 78%|███████▊  | 152/195 [01:47<00:17,  2.40it/s] 78%|███████▊  | 153/195 [01:48<00:21,  1.92it/s] 79%|███████▉  | 154/195 [01:48<00:18,  2.27it/s] 79%|███████▉  | 155/195 [01:49<00:19,  2.01it/s] 80%|████████  | 156/195 [01:49<00:16,  2.38it/s] 81%|████████  | 157/195 [01:50<00:18,  2.04it/s] 81%|████████  | 158/195 [01:50<00:15,  2.42it/s] 82%|████████▏ | 159/195 [01:51<00:18,  1.98it/s] 83%|████████▎ | 161/195 [01:52<00:15,  2.20it/s] 83%|████████▎ | 162/195 [01:52<00:13,  2.51it/s] 84%|████████▎ | 163/195 [01:52<00:14,  2.23it/s] 84%|████████▍ | 164/195 [01:53<00:12,  2.57it/s] 85%|████████▍ | 165/195 [01:53<00:13,  2.22it/s] 85%|████████▌ | 166/195 [01:54<00:12,  2.32it/s] 86%|████████▌ | 167/195 [01:54<00:12,  2.30it/s] 86%|████████▌ | 168/195 [01:55<00:13,  1.98it/s] 87%|████████▋ | 169/195 [01:55<00:12,  2.07it/s] 87%|████████▋ | 170/195 [01:56<00:11,  2.14it/s] 88%|████████▊ | 171/195 [01:56<00:11,  2.15it/s] 88%|████████▊ | 172/195 [01:57<00:10,  2.18it/s] 89%|████████▊ | 173/195 [01:57<00:09,  2.33it/s] 89%|████████▉ | 174/195 [01:57<00:09,  2.14it/s] 90%|████████▉ | 175/195 [01:58<00:09,  2.18it/s] 90%|█████████ | 176/195 [01:58<00:09,  2.10it/s] 91%|█████████ | 177/195 [01:59<00:08,  2.14it/s] 91%|█████████▏| 178/195 [01:59<00:07,  2.18it/s] 92%|█████████▏| 179/195 [02:00<00:08,  1.97it/s] 92%|█████████▏| 180/195 [02:00<00:06,  2.31it/s] 93%|█████████▎| 181/195 [02:01<00:07,  1.97it/s] 93%|█████████▎| 182/195 [02:01<00:06,  2.06it/s] 94%|█████████▍| 183/195 [02:02<00:05,  2.09it/s] 94%|█████████▍| 184/195 [02:02<00:05,  2.19it/s] 95%|█████████▍| 185/195 [02:03<00:04,  2.18it/s] 95%|█████████▌| 186/195 [02:03<00:04,  2.05it/s] 96%|█████████▌| 187/195 [02:04<00:04,  1.96it/s] 96%|█████████▋| 188/195 [02:04<00:03,  2.00it/s] 97%|█████████▋| 189/195 [02:05<00:02,  2.11it/s] 97%|█████████▋| 190/195 [02:05<00:02,  2.05it/s] 98%|█████████▊| 191/195 [02:06<00:01,  2.05it/s] 98%|█████████▊| 192/195 [02:06<00:01,  2.07it/s] 99%|█████████▉| 193/195 [02:07<00:00,  2.12it/s] 99%|█████████▉| 194/195 [02:07<00:00,  2.03it/s]100%|██████████| 195/195 [02:07<00:00,  2.59it/s]100%|██████████| 195/195 [02:10<00:00,  1.50it/s]
2025-09-24 09:16:31 [info     ] Validating outputs
2025-09-24 09:16:31 [info     ] Predict - end                  time=0:2:10
2025-09-24 09:16:31 [info     ] Evaluate - start               split=test
2025-09-24 09:16:31 [info     ] Evaluate - end                 answer_distr=[0.38, 0.23, 0.13, 0.22] correctness_llm=0.59 llm_group_correctness=[0.49, 0.54, 0.62, 0.54, 0.79] monotonicity=0.49
2025-09-24 09:16:31 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:16:31 [info     ] Augmenting questions for IRT estimation num_questions=10
2025-09-24 09:16:31 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:16:31 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 952.73it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3727.76it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 598.98it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5436.05it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 934.20it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3299.20it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 609.66it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5554.32it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 946.15it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3675.00it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 588.75it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5360.62it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1100.25it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3391.27it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 727.35it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 2116.81it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 904.72it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3604.47it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 590.13it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7865.02it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1015.85it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3587.94it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 517.75it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5704.32it/s]
2025-09-24 09:16:35 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 09:16:35 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:16:35 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:16:35 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:16:35 [info     ] Evaluate question difficulty - end mae=1.43 rmse=1.75 split=test
2025-09-24 09:16:35 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 1 finished: 0:2:25

 ********** Run: 2/3 **********
2025-09-24 09:16:57 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:16:57 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:16:57 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:16:57 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:16:58 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:16:58 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:17:03 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:17:03 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:17:03 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:17:04 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:17:07 [info     ] Setting seed                   value=44
2025-09-24 09:17:07 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 09:17:07 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_kc_exact native_structured_output=True num_examples=5 system_prompt=teacher_dbe_miscons_level_context
2025-09-24 09:17:07 [info     ] Building example selector
2025-09-24 09:17:07 [info     ] Building model                 name=qwen3:4b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:17:07 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:14<45:46, 14.16s/it]  2%|▏         | 3/195 [00:16<14:32,  4.54s/it]  2%|▏         | 4/195 [00:16<09:50,  3.09s/it]  3%|▎         | 5/195 [00:18<08:42,  2.75s/it]  4%|▎         | 7/195 [00:20<05:33,  1.77s/it]  5%|▍         | 9/195 [00:21<04:15,  1.37s/it]  5%|▌         | 10/195 [00:22<03:29,  1.13s/it]  6%|▌         | 11/195 [00:23<03:18,  1.08s/it]  6%|▌         | 12/195 [00:23<02:58,  1.03it/s]  7%|▋         | 13/195 [00:24<02:57,  1.02it/s]  7%|▋         | 14/195 [00:25<02:21,  1.28it/s]  8%|▊         | 15/195 [00:25<02:19,  1.29it/s]  8%|▊         | 16/195 [00:26<02:09,  1.39it/s]  9%|▊         | 17/195 [00:27<02:10,  1.37it/s]  9%|▉         | 18/195 [00:28<02:13,  1.33it/s] 10%|▉         | 19/195 [00:28<02:04,  1.41it/s] 10%|█         | 20/195 [00:29<01:59,  1.46it/s] 11%|█         | 21/195 [00:29<01:55,  1.50it/s] 11%|█▏        | 22/195 [00:30<01:48,  1.60it/s] 12%|█▏        | 23/195 [00:30<01:42,  1.67it/s] 12%|█▏        | 24/195 [00:31<01:36,  1.77it/s] 13%|█▎        | 25/195 [00:31<01:33,  1.82it/s] 13%|█▎        | 26/195 [00:32<01:23,  2.04it/s] 14%|█▍        | 27/195 [00:32<01:26,  1.95it/s] 14%|█▍        | 28/195 [00:33<01:11,  2.35it/s] 15%|█▍        | 29/195 [00:33<01:21,  2.05it/s] 15%|█▌        | 30/195 [00:33<01:07,  2.45it/s] 16%|█▌        | 31/195 [00:34<01:19,  2.07it/s] 16%|█▋        | 32/195 [00:35<01:16,  2.14it/s] 17%|█▋        | 33/195 [00:35<01:14,  2.18it/s] 17%|█▋        | 34/195 [00:35<01:14,  2.17it/s] 18%|█▊        | 35/195 [00:36<01:15,  2.11it/s] 18%|█▊        | 36/195 [00:36<01:17,  2.05it/s] 19%|█▉        | 37/195 [00:37<01:14,  2.13it/s] 19%|█▉        | 38/195 [00:37<01:13,  2.13it/s] 20%|██        | 39/195 [00:38<01:10,  2.21it/s] 21%|██        | 40/195 [00:38<01:11,  2.17it/s] 21%|██        | 41/195 [00:39<01:07,  2.27it/s] 22%|██▏       | 42/195 [00:39<01:10,  2.18it/s] 22%|██▏       | 43/195 [00:40<01:05,  2.33it/s] 23%|██▎       | 44/195 [00:40<01:07,  2.22it/s] 23%|██▎       | 45/195 [00:40<00:57,  2.61it/s] 24%|██▎       | 46/195 [00:41<01:09,  2.16it/s] 24%|██▍       | 47/195 [00:41<00:57,  2.56it/s] 25%|██▍       | 48/195 [00:42<01:10,  2.08it/s] 25%|██▌       | 49/195 [00:42<00:59,  2.47it/s] 26%|██▌       | 50/195 [00:43<01:16,  1.90it/s] 26%|██▌       | 51/195 [00:43<01:04,  2.22it/s] 27%|██▋       | 52/195 [00:44<01:40,  1.43it/s] 27%|██▋       | 53/195 [00:45<01:20,  1.77it/s] 28%|██▊       | 54/195 [00:46<01:46,  1.32it/s] 28%|██▊       | 55/195 [00:47<01:41,  1.38it/s] 29%|██▊       | 56/195 [00:47<01:40,  1.39it/s] 29%|██▉       | 57/195 [00:48<01:29,  1.55it/s] 30%|██▉       | 58/195 [00:49<01:44,  1.31it/s] 30%|███       | 59/195 [00:50<01:45,  1.28it/s] 31%|███       | 60/195 [00:50<01:37,  1.38it/s] 31%|███▏      | 61/195 [00:51<01:33,  1.44it/s] 32%|███▏      | 62/195 [00:51<01:30,  1.47it/s] 32%|███▏      | 63/195 [00:52<01:30,  1.45it/s] 33%|███▎      | 64/195 [00:53<01:27,  1.50it/s] 33%|███▎      | 65/195 [00:53<01:29,  1.46it/s] 34%|███▍      | 66/195 [00:54<01:36,  1.34it/s] 34%|███▍      | 67/195 [00:55<01:33,  1.36it/s] 35%|███▍      | 68/195 [00:56<01:31,  1.40it/s] 35%|███▌      | 69/195 [00:57<01:34,  1.33it/s] 36%|███▌      | 70/195 [00:57<01:26,  1.45it/s] 36%|███▋      | 71/195 [00:58<01:28,  1.40it/s] 37%|███▋      | 72/195 [00:59<01:26,  1.42it/s] 37%|███▋      | 73/195 [00:59<01:21,  1.50it/s] 38%|███▊      | 74/195 [01:00<01:27,  1.38it/s] 38%|███▊      | 75/195 [01:01<01:19,  1.50it/s] 39%|███▉      | 76/195 [01:01<01:18,  1.51it/s] 39%|███▉      | 77/195 [01:02<01:20,  1.47it/s] 40%|████      | 78/195 [01:02<01:13,  1.59it/s] 41%|████      | 79/195 [01:03<01:19,  1.46it/s] 41%|████      | 80/195 [01:04<01:13,  1.57it/s] 42%|████▏     | 81/195 [01:04<01:12,  1.58it/s] 42%|████▏     | 82/195 [01:05<00:59,  1.90it/s] 43%|████▎     | 83/195 [01:05<01:05,  1.71it/s] 43%|████▎     | 84/195 [01:06<00:53,  2.09it/s] 44%|████▎     | 85/195 [01:06<01:02,  1.76it/s] 44%|████▍     | 86/195 [01:07<01:00,  1.79it/s] 45%|████▍     | 87/195 [01:08<01:01,  1.74it/s] 45%|████▌     | 88/195 [01:08<00:58,  1.83it/s] 46%|████▌     | 89/195 [01:09<01:00,  1.74it/s] 46%|████▌     | 90/195 [01:09<00:57,  1.84it/s] 47%|████▋     | 91/195 [01:10<00:57,  1.81it/s] 47%|████▋     | 92/195 [01:10<00:54,  1.89it/s] 48%|████▊     | 93/195 [01:11<00:54,  1.88it/s] 48%|████▊     | 94/195 [01:11<00:53,  1.90it/s] 49%|████▊     | 95/195 [01:12<00:52,  1.89it/s] 49%|████▉     | 96/195 [01:12<00:49,  2.00it/s] 50%|████▉     | 97/195 [01:13<00:47,  2.04it/s] 50%|█████     | 98/195 [01:13<00:40,  2.40it/s] 51%|█████     | 99/195 [01:13<00:44,  2.14it/s] 51%|█████▏    | 100/195 [01:14<00:48,  1.97it/s] 52%|█████▏    | 101/195 [01:15<01:10,  1.34it/s] 52%|█████▏    | 102/195 [01:16<01:10,  1.31it/s] 53%|█████▎    | 103/195 [01:18<01:31,  1.01it/s] 53%|█████▎    | 104/195 [01:18<01:12,  1.26it/s] 54%|█████▍    | 105/195 [01:19<01:24,  1.07it/s] 55%|█████▍    | 107/195 [01:20<01:05,  1.34it/s] 55%|█████▌    | 108/195 [01:21<00:54,  1.59it/s] 56%|█████▌    | 109/195 [01:22<01:01,  1.41it/s] 56%|█████▋    | 110/195 [01:22<00:54,  1.57it/s] 57%|█████▋    | 111/195 [01:23<00:52,  1.60it/s] 57%|█████▋    | 112/195 [01:23<00:48,  1.70it/s] 58%|█████▊    | 113/195 [01:24<00:47,  1.73it/s] 58%|█████▊    | 114/195 [01:24<00:48,  1.68it/s] 59%|█████▉    | 115/195 [01:25<00:40,  2.00it/s] 59%|█████▉    | 116/195 [01:26<01:07,  1.16it/s] 60%|██████    | 117/195 [01:27<00:54,  1.43it/s] 61%|██████    | 118/195 [01:28<01:20,  1.05s/it] 62%|██████▏   | 120/195 [01:30<01:09,  1.08it/s] 63%|██████▎   | 122/195 [01:31<00:54,  1.33it/s] 64%|██████▎   | 124/195 [01:32<00:45,  1.56it/s] 64%|██████▍   | 125/195 [01:32<00:39,  1.79it/s] 65%|██████▍   | 126/195 [01:33<00:39,  1.73it/s] 65%|██████▌   | 127/195 [01:33<00:35,  1.89it/s] 66%|██████▌   | 128/195 [01:34<00:34,  1.97it/s] 66%|██████▌   | 129/195 [01:34<00:31,  2.10it/s] 67%|██████▋   | 130/195 [01:35<00:34,  1.89it/s] 67%|██████▋   | 131/195 [01:35<00:36,  1.75it/s] 68%|██████▊   | 133/195 [01:36<00:32,  1.92it/s] 69%|██████▊   | 134/195 [01:37<00:27,  2.18it/s] 69%|██████▉   | 135/195 [01:37<00:31,  1.92it/s] 70%|███████   | 137/195 [01:38<00:27,  2.08it/s] 71%|███████   | 138/195 [01:38<00:24,  2.37it/s] 71%|███████▏  | 139/195 [01:39<00:26,  2.11it/s] 72%|███████▏  | 140/195 [01:39<00:24,  2.26it/s] 72%|███████▏  | 141/195 [01:40<00:24,  2.21it/s] 73%|███████▎  | 142/195 [01:40<00:23,  2.29it/s] 73%|███████▎  | 143/195 [01:41<00:22,  2.34it/s] 74%|███████▍  | 144/195 [01:41<00:21,  2.40it/s] 74%|███████▍  | 145/195 [01:41<00:21,  2.34it/s] 75%|███████▍  | 146/195 [01:42<00:19,  2.50it/s] 75%|███████▌  | 147/195 [01:42<00:20,  2.34it/s] 76%|███████▌  | 148/195 [01:43<00:21,  2.16it/s] 76%|███████▋  | 149/195 [01:43<00:20,  2.23it/s] 77%|███████▋  | 150/195 [01:44<00:20,  2.21it/s] 77%|███████▋  | 151/195 [01:44<00:19,  2.23it/s] 78%|███████▊  | 152/195 [01:45<00:19,  2.21it/s] 78%|███████▊  | 153/195 [01:45<00:19,  2.12it/s] 79%|███████▉  | 154/195 [01:46<00:19,  2.12it/s] 79%|███████▉  | 155/195 [01:46<00:18,  2.17it/s] 80%|████████  | 156/195 [01:46<00:17,  2.19it/s] 81%|████████  | 157/195 [01:47<00:17,  2.23it/s] 81%|████████  | 158/195 [01:47<00:16,  2.18it/s] 82%|████████▏ | 159/195 [01:48<00:16,  2.25it/s] 82%|████████▏ | 160/195 [01:48<00:16,  2.17it/s] 83%|████████▎ | 161/195 [01:49<00:15,  2.17it/s] 83%|████████▎ | 162/195 [01:49<00:15,  2.19it/s] 84%|████████▎ | 163/195 [01:50<00:14,  2.22it/s] 84%|████████▍ | 164/195 [01:50<00:14,  2.19it/s] 85%|████████▍ | 165/195 [01:51<00:13,  2.20it/s] 85%|████████▌ | 166/195 [01:51<00:13,  2.18it/s] 86%|████████▌ | 167/195 [01:51<00:12,  2.33it/s] 86%|████████▌ | 168/195 [01:52<00:13,  1.99it/s] 87%|████████▋ | 169/195 [01:52<00:11,  2.34it/s] 87%|████████▋ | 170/195 [01:53<00:13,  1.91it/s] 88%|████████▊ | 171/195 [01:53<00:10,  2.26it/s] 88%|████████▊ | 172/195 [01:54<00:11,  1.93it/s] 89%|████████▊ | 173/195 [01:54<00:10,  2.06it/s] 89%|████████▉ | 174/195 [01:55<00:09,  2.12it/s] 90%|████████▉ | 175/195 [01:55<00:08,  2.24it/s] 90%|█████████ | 176/195 [01:56<00:08,  2.13it/s] 91%|█████████ | 177/195 [01:56<00:08,  2.18it/s] 91%|█████████▏| 178/195 [01:57<00:07,  2.13it/s] 92%|█████████▏| 179/195 [01:57<00:07,  2.16it/s] 92%|█████████▏| 180/195 [01:58<00:07,  2.11it/s] 93%|█████████▎| 181/195 [01:58<00:06,  2.15it/s] 93%|█████████▎| 182/195 [01:59<00:06,  2.10it/s] 94%|█████████▍| 183/195 [01:59<00:05,  2.12it/s] 94%|█████████▍| 184/195 [02:00<00:05,  1.96it/s] 95%|█████████▍| 185/195 [02:00<00:04,  2.11it/s] 95%|█████████▌| 186/195 [02:01<00:04,  2.00it/s] 96%|█████████▌| 187/195 [02:01<00:03,  2.06it/s] 96%|█████████▋| 188/195 [02:02<00:03,  1.90it/s] 97%|█████████▋| 189/195 [02:02<00:03,  1.92it/s] 97%|█████████▋| 190/195 [02:03<00:02,  2.00it/s] 98%|█████████▊| 191/195 [02:03<00:01,  2.07it/s] 98%|█████████▊| 192/195 [02:04<00:01,  2.07it/s] 99%|█████████▉| 193/195 [02:04<00:00,  2.13it/s] 99%|█████████▉| 194/195 [02:04<00:00,  2.13it/s]100%|██████████| 195/195 [02:05<00:00,  2.61it/s]100%|██████████| 195/195 [02:07<00:00,  1.53it/s]
2025-09-24 09:19:15 [info     ] Validating outputs
2025-09-24 09:19:15 [info     ] Predict - end                  time=0:2:7
2025-09-24 09:19:15 [info     ] Evaluate - start               split=test
2025-09-24 09:19:15 [info     ] Evaluate - end                 answer_distr=[0.38, 0.22, 0.13, 0.21] correctness_llm=0.63 llm_group_correctness=[0.49, 0.41, 0.72, 0.69, 0.82] monotonicity=0.42
2025-09-24 09:19:15 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:19:15 [info     ] Augmenting questions for IRT estimation num_questions=6
2025-09-24 09:19:15 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:19:15 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1247.09it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3557.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 588.38it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6508.56it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 951.40it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3345.83it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 504.63it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6187.59it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 949.64it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3273.39it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 597.19it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6260.16it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1069.66it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3508.60it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 639.71it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6137.15it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 958.32it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3620.74it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 656.61it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6062.38it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1051.02it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3379.15it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 607.20it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7224.44it/s]
2025-09-24 09:19:19 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 09:19:19 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:19:19 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:19:19 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:19:19 [info     ] Evaluate question difficulty - end mae=1.32 rmse=1.63 split=test
2025-09-24 09:19:19 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 2 finished: 0:2:22

 ********** Run: 3/3 **********
2025-09-24 09:19:38 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:19:38 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:19:38 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:19:38 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:19:40 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:19:40 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:19:45 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:19:45 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:19:45 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:19:45 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:19:48 [info     ] Setting seed                   value=45
2025-09-24 09:19:48 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 09:19:48 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_kc_exact native_structured_output=True num_examples=5 system_prompt=teacher_dbe_miscons_level_context
2025-09-24 09:19:48 [info     ] Building example selector
2025-09-24 09:19:48 [info     ] Building model                 name=qwen3:4b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:19:48 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:14<47:13, 14.61s/it]  2%|▏         | 3/195 [00:16<14:36,  4.57s/it]  3%|▎         | 5/195 [00:19<09:02,  2.86s/it]  3%|▎         | 6/195 [00:19<06:51,  2.18s/it]  4%|▎         | 7/195 [00:20<06:04,  1.94s/it]  4%|▍         | 8/195 [00:21<04:33,  1.46s/it]  5%|▍         | 9/195 [00:22<04:07,  1.33s/it]  5%|▌         | 10/195 [00:23<03:44,  1.21s/it]  6%|▌         | 11/195 [00:23<03:20,  1.09s/it]  6%|▌         | 12/195 [00:24<02:51,  1.06it/s]  7%|▋         | 13/195 [00:25<02:33,  1.19it/s]  7%|▋         | 14/195 [00:25<02:23,  1.26it/s]  8%|▊         | 15/195 [00:26<02:14,  1.34it/s]  8%|▊         | 16/195 [00:26<02:00,  1.49it/s]  9%|▊         | 17/195 [00:27<02:01,  1.47it/s]  9%|▉         | 18/195 [00:28<01:58,  1.50it/s] 10%|▉         | 19/195 [00:28<02:04,  1.42it/s] 10%|█         | 20/195 [00:29<01:50,  1.58it/s] 11%|█         | 21/195 [00:30<02:04,  1.40it/s] 11%|█▏        | 22/195 [00:30<01:56,  1.48it/s] 12%|█▏        | 23/195 [00:31<02:00,  1.43it/s] 12%|█▏        | 24/195 [00:32<02:07,  1.34it/s] 13%|█▎        | 25/195 [00:33<01:57,  1.45it/s] 13%|█▎        | 26/195 [00:33<01:38,  1.71it/s] 14%|█▍        | 27/195 [00:33<01:32,  1.82it/s] 14%|█▍        | 28/195 [00:34<01:28,  1.89it/s] 15%|█▍        | 29/195 [00:34<01:21,  2.03it/s] 15%|█▌        | 30/195 [00:35<01:20,  2.05it/s] 16%|█▌        | 31/195 [00:35<01:15,  2.17it/s] 16%|█▋        | 32/195 [00:36<01:15,  2.15it/s] 17%|█▋        | 33/195 [00:36<01:11,  2.28it/s] 17%|█▋        | 34/195 [00:36<01:13,  2.18it/s] 18%|█▊        | 35/195 [00:37<01:02,  2.54it/s] 18%|█▊        | 36/195 [00:37<01:18,  2.03it/s] 19%|█▉        | 37/195 [00:38<01:05,  2.41it/s] 19%|█▉        | 38/195 [00:38<01:20,  1.96it/s] 21%|██        | 40/195 [00:39<01:13,  2.12it/s] 21%|██        | 41/195 [00:40<01:03,  2.44it/s] 22%|██▏       | 42/195 [00:40<01:14,  2.04it/s] 22%|██▏       | 43/195 [00:40<01:03,  2.38it/s] 23%|██▎       | 44/195 [00:41<01:15,  2.01it/s] 24%|██▎       | 46/195 [00:42<01:11,  2.09it/s] 25%|██▍       | 48/195 [00:43<01:06,  2.21it/s] 26%|██▌       | 50/195 [00:44<01:12,  2.01it/s] 26%|██▌       | 51/195 [00:45<01:15,  1.91it/s] 27%|██▋       | 52/195 [00:45<01:20,  1.77it/s] 27%|██▋       | 53/195 [00:46<01:29,  1.59it/s] 28%|██▊       | 54/195 [00:47<01:34,  1.50it/s] 28%|██▊       | 55/195 [00:48<01:38,  1.42it/s] 29%|██▊       | 56/195 [00:48<01:37,  1.42it/s] 29%|██▉       | 57/195 [00:49<01:42,  1.35it/s] 30%|██▉       | 58/195 [00:50<01:39,  1.38it/s] 30%|███       | 59/195 [00:51<01:47,  1.27it/s] 31%|███       | 60/195 [00:51<01:26,  1.57it/s] 31%|███▏      | 61/195 [00:52<01:35,  1.40it/s] 32%|███▏      | 62/195 [00:53<01:29,  1.49it/s] 32%|███▏      | 63/195 [00:54<01:35,  1.38it/s] 33%|███▎      | 65/195 [00:55<01:24,  1.54it/s] 34%|███▍      | 67/195 [00:56<01:21,  1.56it/s] 35%|███▍      | 68/195 [00:56<01:10,  1.81it/s] 35%|███▌      | 69/195 [00:57<01:25,  1.48it/s] 36%|███▌      | 70/195 [00:57<01:10,  1.77it/s] 36%|███▋      | 71/195 [00:59<01:29,  1.39it/s] 37%|███▋      | 72/195 [00:59<01:14,  1.66it/s] 37%|███▋      | 73/195 [01:00<01:25,  1.43it/s] 38%|███▊      | 74/195 [01:00<01:09,  1.74it/s] 38%|███▊      | 75/195 [01:01<01:21,  1.47it/s] 39%|███▉      | 76/195 [01:01<01:05,  1.81it/s] 39%|███▉      | 77/195 [01:03<01:30,  1.30it/s] 40%|████      | 78/195 [01:03<01:21,  1.44it/s] 41%|████      | 79/195 [01:04<01:28,  1.31it/s] 41%|████      | 80/195 [01:04<01:10,  1.63it/s] 42%|████▏     | 81/195 [01:05<01:16,  1.48it/s] 42%|████▏     | 82/195 [01:05<01:01,  1.85it/s] 43%|████▎     | 83/195 [01:06<01:10,  1.58it/s] 44%|████▎     | 85/195 [01:07<01:00,  1.81it/s] 44%|████▍     | 86/195 [01:08<00:57,  1.88it/s] 45%|████▍     | 87/195 [01:08<01:00,  1.77it/s] 45%|████▌     | 88/195 [01:09<00:57,  1.87it/s] 46%|████▌     | 89/195 [01:09<01:00,  1.75it/s] 47%|████▋     | 91/195 [01:10<00:59,  1.75it/s] 47%|████▋     | 92/195 [01:11<00:51,  2.02it/s] 48%|████▊     | 93/195 [01:12<01:01,  1.65it/s] 48%|████▊     | 94/195 [01:12<00:57,  1.77it/s] 49%|████▊     | 95/195 [01:13<00:52,  1.89it/s] 49%|████▉     | 96/195 [01:13<00:46,  2.13it/s] 50%|████▉     | 97/195 [01:13<00:44,  2.19it/s] 50%|█████     | 98/195 [01:14<00:43,  2.22it/s] 51%|█████     | 99/195 [01:14<00:47,  2.03it/s] 51%|█████▏    | 100/195 [01:15<00:52,  1.81it/s] 52%|█████▏    | 101/195 [01:16<01:15,  1.25it/s] 52%|█████▏    | 102/195 [01:17<01:01,  1.51it/s] 53%|█████▎    | 103/195 [01:19<01:31,  1.00it/s] 54%|█████▍    | 105/195 [01:20<01:21,  1.10it/s] 55%|█████▍    | 107/195 [01:21<01:05,  1.33it/s] 56%|█████▌    | 109/195 [01:22<01:00,  1.43it/s] 57%|█████▋    | 111/195 [01:24<00:58,  1.43it/s] 58%|█████▊    | 113/195 [01:25<00:55,  1.48it/s] 58%|█████▊    | 114/195 [01:25<00:48,  1.67it/s] 59%|█████▉    | 115/195 [01:26<00:56,  1.43it/s] 59%|█████▉    | 116/195 [01:27<01:00,  1.30it/s] 60%|██████    | 117/195 [01:29<01:07,  1.16it/s] 61%|██████    | 118/195 [01:30<01:13,  1.04it/s] 61%|██████    | 119/195 [01:31<01:16,  1.00s/it] 62%|██████▏   | 120/195 [01:32<01:10,  1.06it/s] 63%|██████▎   | 122/195 [01:33<00:55,  1.31it/s] 64%|██████▎   | 124/195 [01:34<00:47,  1.50it/s] 64%|██████▍   | 125/195 [01:34<00:43,  1.60it/s] 65%|██████▍   | 126/195 [01:35<00:40,  1.70it/s] 65%|██████▌   | 127/195 [01:35<00:38,  1.77it/s] 66%|██████▌   | 128/195 [01:36<00:36,  1.83it/s] 66%|██████▌   | 129/195 [01:36<00:39,  1.68it/s] 67%|██████▋   | 130/195 [01:37<00:36,  1.78it/s] 67%|██████▋   | 131/195 [01:37<00:34,  1.84it/s] 68%|██████▊   | 132/195 [01:38<00:32,  1.94it/s] 68%|██████▊   | 133/195 [01:38<00:30,  2.04it/s] 69%|██████▊   | 134/195 [01:39<00:29,  2.05it/s] 69%|██████▉   | 135/195 [01:39<00:29,  2.05it/s] 70%|██████▉   | 136/195 [01:40<00:27,  2.15it/s] 70%|███████   | 137/195 [01:40<00:29,  1.95it/s] 71%|███████▏  | 139/195 [01:41<00:28,  1.95it/s] 72%|███████▏  | 140/195 [01:42<00:24,  2.21it/s] 72%|███████▏  | 141/195 [01:42<00:26,  2.00it/s] 73%|███████▎  | 142/195 [01:42<00:22,  2.35it/s] 73%|███████▎  | 143/195 [01:43<00:25,  2.07it/s] 74%|███████▍  | 144/195 [01:43<00:20,  2.44it/s] 74%|███████▍  | 145/195 [01:44<00:22,  2.18it/s] 75%|███████▍  | 146/195 [01:44<00:18,  2.58it/s] 75%|███████▌  | 147/195 [01:45<00:21,  2.21it/s] 76%|███████▌  | 148/195 [01:45<00:18,  2.60it/s] 76%|███████▋  | 149/195 [01:46<00:20,  2.27it/s] 77%|███████▋  | 150/195 [01:46<00:16,  2.67it/s] 77%|███████▋  | 151/195 [01:46<00:19,  2.25it/s] 78%|███████▊  | 152/195 [01:47<00:16,  2.65it/s] 78%|███████▊  | 153/195 [01:47<00:21,  1.95it/s] 79%|███████▉  | 155/195 [01:48<00:18,  2.13it/s] 80%|████████  | 156/195 [01:49<00:20,  1.93it/s] 81%|████████  | 157/195 [01:49<00:16,  2.25it/s] 81%|████████  | 158/195 [01:50<00:18,  1.97it/s] 82%|████████▏ | 159/195 [01:50<00:15,  2.33it/s] 82%|████████▏ | 160/195 [01:51<00:16,  2.07it/s] 83%|████████▎ | 161/195 [01:51<00:15,  2.23it/s] 83%|████████▎ | 162/195 [01:51<00:14,  2.25it/s] 84%|████████▎ | 163/195 [01:52<00:14,  2.28it/s] 84%|████████▍ | 164/195 [01:52<00:13,  2.22it/s] 85%|████████▍ | 165/195 [01:53<00:13,  2.23it/s] 85%|████████▌ | 166/195 [01:53<00:13,  2.15it/s] 86%|████████▌ | 167/195 [01:54<00:15,  1.83it/s] 86%|████████▌ | 168/195 [01:55<00:14,  1.82it/s] 87%|████████▋ | 169/195 [01:55<00:13,  1.93it/s] 87%|████████▋ | 170/195 [01:55<00:12,  1.99it/s] 88%|████████▊ | 171/195 [01:56<00:11,  2.05it/s] 88%|████████▊ | 172/195 [01:56<00:10,  2.16it/s] 89%|████████▊ | 173/195 [01:57<00:09,  2.24it/s] 89%|████████▉ | 174/195 [01:57<00:09,  2.21it/s] 90%|████████▉ | 175/195 [01:58<00:08,  2.28it/s] 90%|█████████ | 176/195 [01:58<00:08,  2.32it/s] 91%|█████████ | 177/195 [01:58<00:07,  2.40it/s] 91%|█████████▏| 178/195 [01:59<00:07,  2.38it/s] 92%|█████████▏| 179/195 [01:59<00:06,  2.30it/s] 92%|█████████▏| 180/195 [02:00<00:07,  2.13it/s] 93%|█████████▎| 181/195 [02:00<00:05,  2.46it/s] 93%|█████████▎| 182/195 [02:01<00:07,  1.82it/s] 94%|█████████▍| 183/195 [02:01<00:05,  2.16it/s] 94%|█████████▍| 184/195 [02:02<00:06,  1.80it/s] 95%|█████████▍| 185/195 [02:02<00:05,  1.98it/s] 95%|█████████▌| 186/195 [02:03<00:04,  1.97it/s] 96%|█████████▌| 187/195 [02:03<00:03,  2.16it/s] 96%|█████████▋| 188/195 [02:04<00:03,  2.00it/s] 97%|█████████▋| 189/195 [02:04<00:02,  2.35it/s] 97%|█████████▋| 190/195 [02:05<00:02,  1.95it/s] 98%|█████████▊| 192/195 [02:06<00:01,  2.03it/s] 99%|█████████▉| 193/195 [02:06<00:00,  2.36it/s] 99%|█████████▉| 194/195 [02:07<00:00,  2.10it/s]100%|██████████| 195/195 [02:07<00:00,  2.64it/s]100%|██████████| 195/195 [02:09<00:00,  1.51it/s]
2025-09-24 09:21:58 [info     ] Validating outputs
2025-09-24 09:21:58 [info     ] Predict - end                  time=0:2:9
2025-09-24 09:21:58 [info     ] Evaluate - start               split=test
2025-09-24 09:21:58 [info     ] Evaluate - end                 answer_distr=[0.35, 0.2, 0.18, 0.24] correctness_llm=0.59 llm_group_correctness=[0.36, 0.49, 0.59, 0.62, 0.92] monotonicity=0.92
2025-09-24 09:21:58 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:21:58 [info     ] Augmenting questions for IRT estimation num_questions=5
2025-09-24 09:21:58 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:21:58 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1111.92it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3653.57it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 573.11it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7129.71it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 989.82it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3629.74it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 574.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6972.25it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1125.17it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3228.81it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 571.08it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6571.20it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1015.50it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3657.58it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 604.72it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6813.68it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1110.53it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3455.09it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 626.67it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6896.91it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1067.33it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3790.30it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 620.68it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6812.09it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1045.55it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3573.75it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 598.34it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8039.47it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1099.14it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3451.74it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 518.36it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6665.18it/s]
2025-09-24 09:22:04 INFO: EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
2025-09-24 09:22:04 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:22:04 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:22:04 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:22:04 [info     ] Evaluate question difficulty - end mae=1.42 rmse=1.77 split=test
2025-09-24 09:22:04 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 3 finished: 0:2:25

 ========== Config: llama3.2:3b~T_1.0~SO_teacher_bool_nocontext~L_5~SP_teacher_dbe_miscons_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_cfe_studentlevel_random0 ==========
Config 3/16

 ********** Run: 1/3 **********
2025-09-24 09:22:21 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:22:21 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:22:21 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:22:21 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:22:23 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:22:23 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:22:27 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:22:27 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:22:27 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:22:28 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:22:31 [info     ] Setting seed                   value=43
2025-09-24 09:22:31 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 09:22:31 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_dbe_miscons_level_nocontext
2025-09-24 09:22:31 [info     ] Building model                 name=llama3.2:3b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:22:31 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:03<10:35,  3.28s/it]  1%|          | 2/195 [00:03<05:02,  1.57s/it]  2%|▏         | 3/195 [00:04<03:19,  1.04s/it]  2%|▏         | 4/195 [00:04<02:16,  1.39it/s]  3%|▎         | 5/195 [00:04<02:15,  1.40it/s]  4%|▎         | 7/195 [00:05<01:28,  2.13it/s]  4%|▍         | 8/195 [00:05<01:25,  2.18it/s]  5%|▌         | 10/195 [00:06<01:06,  2.80it/s]  6%|▌         | 12/195 [00:06<00:55,  3.28it/s]  7%|▋         | 14/195 [00:07<00:52,  3.44it/s]  8%|▊         | 16/195 [00:07<00:45,  3.96it/s]  9%|▊         | 17/195 [00:07<00:43,  4.14it/s]  9%|▉         | 18/195 [00:08<00:44,  3.99it/s] 10%|▉         | 19/195 [00:08<00:44,  3.99it/s] 11%|█         | 21/195 [00:08<00:43,  4.03it/s] 11%|█▏        | 22/195 [00:09<00:40,  4.25it/s] 12%|█▏        | 23/195 [00:09<00:52,  3.28it/s] 13%|█▎        | 25/195 [00:10<00:48,  3.47it/s] 13%|█▎        | 26/195 [00:10<00:54,  3.08it/s] 14%|█▍        | 28/195 [00:10<00:43,  3.84it/s] 15%|█▍        | 29/195 [00:11<00:45,  3.67it/s] 15%|█▌        | 30/195 [00:11<00:50,  3.28it/s] 16%|█▋        | 32/195 [00:12<00:43,  3.76it/s] 17%|█▋        | 33/195 [00:12<00:43,  3.69it/s] 17%|█▋        | 34/195 [00:12<00:39,  4.08it/s] 18%|█▊        | 35/195 [00:12<00:41,  3.84it/s] 18%|█▊        | 36/195 [00:13<00:43,  3.68it/s] 19%|█▉        | 37/195 [00:13<00:53,  2.98it/s] 19%|█▉        | 38/195 [00:13<00:47,  3.31it/s] 20%|██        | 39/195 [00:14<00:51,  3.03it/s] 21%|██        | 40/195 [00:14<00:43,  3.53it/s] 21%|██        | 41/195 [00:15<01:03,  2.43it/s] 22%|██▏       | 43/195 [00:15<00:53,  2.84it/s] 23%|██▎       | 44/195 [00:15<00:47,  3.18it/s] 23%|██▎       | 45/195 [00:16<00:50,  2.94it/s] 24%|██▎       | 46/195 [00:16<00:45,  3.30it/s] 24%|██▍       | 47/195 [00:16<00:45,  3.24it/s] 25%|██▍       | 48/195 [00:17<00:41,  3.56it/s] 25%|██▌       | 49/195 [00:17<00:46,  3.12it/s] 26%|██▌       | 50/195 [00:17<00:44,  3.26it/s] 26%|██▌       | 51/195 [00:17<00:43,  3.34it/s] 27%|██▋       | 52/195 [00:18<00:37,  3.79it/s] 27%|██▋       | 53/195 [00:18<00:36,  3.90it/s] 28%|██▊       | 54/195 [00:18<00:31,  4.49it/s] 28%|██▊       | 55/195 [00:18<00:35,  3.93it/s] 29%|██▊       | 56/195 [00:18<00:29,  4.71it/s] 29%|██▉       | 57/195 [00:19<00:37,  3.69it/s] 30%|███       | 59/195 [00:19<00:35,  3.83it/s] 31%|███▏      | 61/195 [00:20<00:30,  4.38it/s] 32%|███▏      | 62/195 [00:20<00:32,  4.08it/s] 32%|███▏      | 63/195 [00:20<00:35,  3.70it/s] 33%|███▎      | 64/195 [00:21<00:32,  4.07it/s] 33%|███▎      | 65/195 [00:21<00:37,  3.45it/s] 34%|███▍      | 66/195 [00:21<00:31,  4.11it/s] 34%|███▍      | 67/195 [00:22<00:37,  3.45it/s] 35%|███▍      | 68/195 [00:22<00:41,  3.08it/s] 35%|███▌      | 69/195 [00:22<00:34,  3.63it/s] 36%|███▌      | 70/195 [00:23<00:44,  2.78it/s] 36%|███▋      | 71/195 [00:23<00:37,  3.32it/s] 37%|███▋      | 72/195 [00:23<00:47,  2.58it/s] 37%|███▋      | 73/195 [00:24<00:40,  3.02it/s] 38%|███▊      | 74/195 [00:24<00:42,  2.82it/s] 38%|███▊      | 75/195 [00:24<00:36,  3.26it/s] 39%|███▉      | 76/195 [00:25<00:45,  2.63it/s] 40%|████      | 78/195 [00:25<00:31,  3.67it/s] 41%|████      | 79/195 [00:26<00:37,  3.12it/s] 41%|████      | 80/195 [00:26<00:32,  3.59it/s] 42%|████▏     | 81/195 [00:26<00:32,  3.54it/s] 42%|████▏     | 82/195 [00:26<00:27,  4.17it/s] 43%|████▎     | 83/195 [00:26<00:31,  3.54it/s] 44%|████▎     | 85/195 [00:27<00:26,  4.21it/s] 45%|████▍     | 87/195 [00:27<00:24,  4.38it/s] 45%|████▌     | 88/195 [00:27<00:23,  4.49it/s] 46%|████▌     | 89/195 [00:28<00:27,  3.91it/s] 47%|████▋     | 91/195 [00:28<00:27,  3.84it/s] 48%|████▊     | 93/195 [00:29<00:25,  3.98it/s] 48%|████▊     | 94/195 [00:29<00:23,  4.38it/s] 49%|████▊     | 95/195 [00:29<00:27,  3.58it/s] 50%|████▉     | 97/195 [00:30<00:27,  3.54it/s] 50%|█████     | 98/195 [00:30<00:24,  4.00it/s] 51%|█████     | 99/195 [00:31<00:28,  3.36it/s] 51%|█████▏    | 100/195 [00:31<00:27,  3.44it/s] 52%|█████▏    | 101/195 [00:31<00:24,  3.81it/s] 52%|█████▏    | 102/195 [00:31<00:28,  3.23it/s] 53%|█████▎    | 103/195 [00:32<00:28,  3.18it/s] 54%|█████▍    | 105/195 [00:32<00:29,  3.09it/s] 55%|█████▍    | 107/195 [00:33<00:26,  3.35it/s] 55%|█████▌    | 108/195 [00:33<00:26,  3.29it/s] 56%|█████▌    | 109/195 [00:34<00:27,  3.11it/s] 56%|█████▋    | 110/195 [00:34<00:23,  3.62it/s] 57%|█████▋    | 111/195 [00:34<00:21,  3.87it/s] 57%|█████▋    | 112/195 [00:34<00:23,  3.51it/s] 58%|█████▊    | 114/195 [00:35<00:22,  3.65it/s] 59%|█████▉    | 115/195 [00:35<00:19,  4.20it/s] 59%|█████▉    | 116/195 [00:35<00:19,  3.99it/s] 60%|██████    | 117/195 [00:36<00:19,  4.04it/s] 61%|██████    | 118/195 [00:36<00:18,  4.19it/s] 61%|██████    | 119/195 [00:36<00:21,  3.57it/s] 62%|██████▏   | 121/195 [00:37<00:18,  4.01it/s] 63%|██████▎   | 123/195 [00:37<00:17,  4.19it/s] 64%|██████▍   | 125/195 [00:38<00:18,  3.70it/s] 65%|██████▌   | 127/195 [00:38<00:18,  3.67it/s] 66%|██████▌   | 128/195 [00:38<00:17,  3.87it/s] 66%|██████▌   | 129/195 [00:39<00:16,  4.12it/s] 67%|██████▋   | 130/195 [00:39<00:15,  4.29it/s] 67%|██████▋   | 131/195 [00:39<00:17,  3.63it/s] 68%|██████▊   | 132/195 [00:40<00:18,  3.34it/s] 68%|██████▊   | 133/195 [00:40<00:18,  3.32it/s] 69%|██████▊   | 134/195 [00:40<00:18,  3.33it/s] 70%|██████▉   | 136/195 [00:41<00:17,  3.33it/s] 70%|███████   | 137/195 [00:41<00:15,  3.79it/s] 71%|███████   | 138/195 [00:41<00:15,  3.69it/s] 71%|███████▏  | 139/195 [00:42<00:14,  3.77it/s] 72%|███████▏  | 140/195 [00:42<00:12,  4.27it/s] 72%|███████▏  | 141/195 [00:42<00:15,  3.59it/s] 73%|███████▎  | 142/195 [00:42<00:12,  4.40it/s] 73%|███████▎  | 143/195 [00:43<00:19,  2.66it/s] 74%|███████▍  | 145/195 [00:43<00:14,  3.43it/s] 75%|███████▌  | 147/195 [00:44<00:14,  3.35it/s] 76%|███████▌  | 148/195 [00:44<00:13,  3.42it/s] 76%|███████▋  | 149/195 [00:44<00:12,  3.81it/s] 77%|███████▋  | 150/195 [00:45<00:12,  3.62it/s] 77%|███████▋  | 151/195 [00:45<00:11,  3.94it/s] 78%|███████▊  | 152/195 [00:45<00:11,  3.86it/s] 78%|███████▊  | 153/195 [00:45<00:10,  4.14it/s] 79%|███████▉  | 154/195 [00:46<00:11,  3.52it/s] 79%|███████▉  | 155/195 [00:46<00:09,  4.08it/s] 80%|████████  | 156/195 [00:46<00:08,  4.39it/s] 81%|████████  | 157/195 [00:46<00:11,  3.39it/s] 81%|████████  | 158/195 [00:47<00:09,  3.86it/s] 82%|████████▏ | 159/195 [00:47<00:11,  3.27it/s] 82%|████████▏ | 160/195 [00:47<00:08,  3.96it/s] 83%|████████▎ | 161/195 [00:48<00:11,  2.89it/s] 84%|████████▎ | 163/195 [00:48<00:09,  3.45it/s] 85%|████████▍ | 165/195 [00:49<00:07,  3.79it/s] 85%|████████▌ | 166/195 [00:49<00:07,  4.10it/s] 86%|████████▌ | 167/195 [00:49<00:08,  3.29it/s] 86%|████████▌ | 168/195 [00:50<00:08,  3.19it/s] 87%|████████▋ | 169/195 [00:50<00:06,  3.74it/s] 87%|████████▋ | 170/195 [00:50<00:07,  3.31it/s] 88%|████████▊ | 171/195 [00:50<00:06,  3.56it/s] 88%|████████▊ | 172/195 [00:51<00:07,  3.27it/s] 89%|████████▊ | 173/195 [00:51<00:05,  3.89it/s] 89%|████████▉ | 174/195 [00:51<00:05,  3.77it/s] 90%|████████▉ | 175/195 [00:52<00:06,  3.25it/s] 90%|█████████ | 176/195 [00:52<00:05,  3.48it/s] 91%|█████████ | 177/195 [00:52<00:04,  4.30it/s] 91%|█████████▏| 178/195 [00:52<00:04,  3.55it/s] 92%|█████████▏| 179/195 [00:53<00:04,  3.59it/s] 92%|█████████▏| 180/195 [00:53<00:05,  2.57it/s] 93%|█████████▎| 181/195 [00:53<00:04,  3.27it/s] 93%|█████████▎| 182/195 [00:54<00:04,  2.83it/s] 94%|█████████▍| 183/195 [00:54<00:03,  3.60it/s] 94%|█████████▍| 184/195 [00:54<00:03,  2.99it/s] 95%|█████████▍| 185/195 [00:55<00:03,  3.24it/s] 95%|█████████▌| 186/195 [00:55<00:03,  2.97it/s] 96%|█████████▌| 187/195 [00:55<00:02,  3.63it/s] 96%|█████████▋| 188/195 [00:56<00:02,  3.20it/s] 97%|█████████▋| 190/195 [00:56<00:01,  3.14it/s] 98%|█████████▊| 192/195 [00:57<00:00,  3.31it/s] 99%|█████████▉| 193/195 [00:57<00:00,  3.60it/s] 99%|█████████▉| 194/195 [00:58<00:00,  2.83it/s]100%|██████████| 195/195 [01:00<00:00,  3.22it/s]
2025-09-24 09:23:31 [info     ] Validating outputs
2025-09-24 09:23:31 [info     ] Predict - end                  time=0:1:0
2025-09-24 09:23:31 [info     ] Evaluate - start               split=test
2025-09-24 09:23:31 [info     ] Evaluate - end                 answer_distr=[0.33, 0.21, 0.15, 0.29] correctness_llm=0.61 llm_group_correctness=[0.41, 0.36, 0.67, 0.74, 0.85] monotonicity=0.69
2025-09-24 09:23:31 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:23:31 [info     ] Augmenting questions for IRT estimation num_questions=6
2025-09-24 09:23:31 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:23:31 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 959.92it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3583.93it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 599.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6056.13it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1181.02it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3393.10it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 546.12it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6044.91it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 968.89it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3603.91it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 658.46it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6121.79it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 960.61it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3389.37it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 624.41it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6166.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 957.29it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3487.65it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 620.12it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6102.71it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1079.61it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3503.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 674.43it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6034.97it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1067.41it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3637.97it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 635.34it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6072.42it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1212.63it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3670.87it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 673.51it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6232.25it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 968.69it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3643.48it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 641.24it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5765.93it/s]
2025-09-24 09:23:38 INFO: EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
2025-09-24 09:23:38 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:23:38 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:23:38 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:23:38 [info     ] Evaluate question difficulty - end mae=1.68 rmse=2.14 split=test
2025-09-24 09:23:38 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 1 finished: 0:1:16

 ********** Run: 2/3 **********
2025-09-24 09:23:54 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:23:54 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:23:54 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:23:54 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:23:55 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:23:55 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:24:00 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:24:00 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:24:00 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:24:01 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:24:04 [info     ] Setting seed                   value=44
2025-09-24 09:24:04 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 09:24:04 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_dbe_miscons_level_nocontext
2025-09-24 09:24:04 [info     ] Building model                 name=llama3.2:3b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:24:04 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<04:30,  1.39s/it]  1%|          | 2/195 [00:01<02:35,  1.24it/s]  2%|▏         | 3/195 [00:02<01:47,  1.78it/s]  2%|▏         | 4/195 [00:02<01:15,  2.53it/s]  3%|▎         | 5/195 [00:02<01:09,  2.75it/s]  3%|▎         | 6/195 [00:02<00:55,  3.39it/s]  4%|▎         | 7/195 [00:03<01:07,  2.79it/s]  4%|▍         | 8/195 [00:03<00:57,  3.27it/s]  5%|▍         | 9/195 [00:03<01:05,  2.86it/s]  6%|▌         | 11/195 [00:04<00:50,  3.67it/s]  7%|▋         | 13/195 [00:04<00:58,  3.12it/s]  8%|▊         | 15/195 [00:05<00:56,  3.21it/s]  8%|▊         | 16/195 [00:05<00:50,  3.54it/s]  9%|▊         | 17/195 [00:06<00:58,  3.02it/s] 10%|▉         | 19/195 [00:06<00:46,  3.79it/s] 10%|█         | 20/195 [00:06<00:45,  3.86it/s] 11%|█         | 21/195 [00:07<00:44,  3.91it/s] 11%|█▏        | 22/195 [00:07<00:54,  3.17it/s] 12%|█▏        | 24/195 [00:08<00:50,  3.36it/s] 13%|█▎        | 26/195 [00:08<00:46,  3.61it/s] 14%|█▍        | 27/195 [00:08<00:44,  3.80it/s] 14%|█▍        | 28/195 [00:08<00:39,  4.23it/s] 15%|█▍        | 29/195 [00:09<00:49,  3.38it/s] 15%|█▌        | 30/195 [00:09<00:43,  3.76it/s] 16%|█▌        | 31/195 [00:09<00:48,  3.39it/s] 16%|█▋        | 32/195 [00:10<00:40,  4.07it/s] 17%|█▋        | 33/195 [00:10<00:44,  3.60it/s] 17%|█▋        | 34/195 [00:10<00:36,  4.39it/s] 18%|█▊        | 35/195 [00:10<00:41,  3.82it/s] 18%|█▊        | 36/195 [00:11<00:42,  3.78it/s] 19%|█▉        | 37/195 [00:11<00:45,  3.46it/s] 20%|██        | 39/195 [00:12<00:45,  3.44it/s] 21%|██        | 40/195 [00:12<00:40,  3.82it/s] 21%|██        | 41/195 [00:12<00:47,  3.21it/s] 22%|██▏       | 43/195 [00:13<00:44,  3.39it/s] 23%|██▎       | 45/195 [00:13<00:44,  3.40it/s] 24%|██▎       | 46/195 [00:14<00:51,  2.91it/s] 25%|██▍       | 48/195 [00:14<00:47,  3.13it/s] 26%|██▌       | 50/195 [00:15<00:44,  3.22it/s] 26%|██▌       | 51/195 [00:15<00:40,  3.56it/s] 27%|██▋       | 52/195 [00:15<00:40,  3.56it/s] 27%|██▋       | 53/195 [00:16<00:34,  4.11it/s] 28%|██▊       | 54/195 [00:16<00:38,  3.66it/s] 28%|██▊       | 55/195 [00:16<00:40,  3.43it/s] 29%|██▊       | 56/195 [00:17<00:47,  2.90it/s] 30%|██▉       | 58/195 [00:17<00:39,  3.51it/s] 30%|███       | 59/195 [00:18<00:42,  3.21it/s] 31%|███       | 60/195 [00:18<00:36,  3.69it/s] 31%|███▏      | 61/195 [00:18<00:39,  3.37it/s] 32%|███▏      | 62/195 [00:18<00:36,  3.60it/s] 32%|███▏      | 63/195 [00:19<00:36,  3.64it/s] 33%|███▎      | 64/195 [00:19<00:35,  3.65it/s] 33%|███▎      | 65/195 [00:19<00:36,  3.51it/s] 34%|███▍      | 66/195 [00:19<00:35,  3.64it/s] 35%|███▍      | 68/195 [00:20<00:28,  4.43it/s] 35%|███▌      | 69/195 [00:20<00:26,  4.76it/s] 36%|███▌      | 70/195 [00:20<00:29,  4.24it/s] 37%|███▋      | 72/195 [00:21<00:35,  3.42it/s] 38%|███▊      | 74/195 [00:22<00:38,  3.12it/s] 38%|███▊      | 75/195 [00:22<00:33,  3.57it/s] 39%|███▉      | 76/195 [00:22<00:38,  3.07it/s] 39%|███▉      | 77/195 [00:23<00:36,  3.25it/s] 40%|████      | 78/195 [00:23<00:30,  3.84it/s] 41%|████      | 79/195 [00:23<00:26,  4.30it/s] 41%|████      | 80/195 [00:23<00:23,  4.89it/s] 42%|████▏     | 81/195 [00:23<00:26,  4.23it/s] 42%|████▏     | 82/195 [00:24<00:29,  3.77it/s] 43%|████▎     | 84/195 [00:24<00:30,  3.65it/s] 44%|████▎     | 85/195 [00:25<00:32,  3.41it/s] 44%|████▍     | 86/195 [00:25<00:34,  3.16it/s] 45%|████▍     | 87/195 [00:25<00:35,  3.05it/s] 46%|████▌     | 89/195 [00:26<00:31,  3.33it/s] 46%|████▌     | 90/195 [00:26<00:29,  3.52it/s] 47%|████▋     | 91/195 [00:26<00:27,  3.73it/s] 47%|████▋     | 92/195 [00:26<00:24,  4.17it/s] 48%|████▊     | 93/195 [00:27<00:26,  3.81it/s] 48%|████▊     | 94/195 [00:27<00:28,  3.51it/s] 49%|████▊     | 95/195 [00:27<00:23,  4.26it/s] 49%|████▉     | 96/195 [00:28<00:26,  3.70it/s] 50%|█████     | 98/195 [00:28<00:27,  3.58it/s] 51%|█████     | 99/195 [00:28<00:24,  3.97it/s] 51%|█████▏    | 100/195 [00:29<00:28,  3.37it/s] 52%|█████▏    | 102/195 [00:29<00:25,  3.61it/s] 53%|█████▎    | 103/195 [00:29<00:22,  4.03it/s] 53%|█████▎    | 104/195 [00:30<00:29,  3.09it/s] 54%|█████▍    | 105/195 [00:30<00:24,  3.63it/s] 54%|█████▍    | 106/195 [00:30<00:27,  3.23it/s] 55%|█████▍    | 107/195 [00:31<00:25,  3.45it/s] 55%|█████▌    | 108/195 [00:31<00:23,  3.76it/s] 56%|█████▌    | 109/195 [00:31<00:26,  3.30it/s] 56%|█████▋    | 110/195 [00:32<00:27,  3.12it/s] 57%|█████▋    | 112/195 [00:32<00:22,  3.73it/s] 58%|█████▊    | 113/195 [00:32<00:20,  3.92it/s] 58%|█████▊    | 114/195 [00:33<00:21,  3.84it/s] 59%|█████▉    | 115/195 [00:33<00:22,  3.49it/s] 60%|██████    | 117/195 [00:33<00:21,  3.58it/s] 61%|██████    | 118/195 [00:34<00:21,  3.54it/s] 61%|██████    | 119/195 [00:34<00:19,  3.80it/s] 62%|██████▏   | 120/195 [00:35<00:26,  2.84it/s] 62%|██████▏   | 121/195 [00:35<00:21,  3.39it/s] 63%|██████▎   | 122/195 [00:35<00:20,  3.61it/s] 63%|██████▎   | 123/195 [00:35<00:20,  3.50it/s] 64%|██████▎   | 124/195 [00:35<00:17,  4.05it/s] 64%|██████▍   | 125/195 [00:36<00:23,  2.92it/s] 65%|██████▍   | 126/195 [00:36<00:19,  3.62it/s] 65%|██████▌   | 127/195 [00:36<00:19,  3.41it/s] 66%|██████▌   | 128/195 [00:37<00:20,  3.22it/s] 66%|██████▌   | 129/195 [00:37<00:17,  3.74it/s] 67%|██████▋   | 130/195 [00:37<00:20,  3.16it/s] 67%|██████▋   | 131/195 [00:37<00:16,  3.91it/s] 68%|██████▊   | 132/195 [00:38<00:23,  2.69it/s] 69%|██████▊   | 134/195 [00:39<00:18,  3.21it/s] 69%|██████▉   | 135/195 [00:39<00:17,  3.48it/s] 70%|██████▉   | 136/195 [00:39<00:15,  3.84it/s] 70%|███████   | 137/195 [00:39<00:18,  3.14it/s] 71%|███████   | 138/195 [00:40<00:16,  3.42it/s] 71%|███████▏  | 139/195 [00:40<00:15,  3.53it/s] 72%|███████▏  | 140/195 [00:40<00:13,  4.02it/s] 72%|███████▏  | 141/195 [00:40<00:13,  4.00it/s] 73%|███████▎  | 142/195 [00:41<00:12,  4.09it/s] 73%|███████▎  | 143/195 [00:41<00:14,  3.55it/s] 74%|███████▍  | 144/195 [00:41<00:13,  3.81it/s] 74%|███████▍  | 145/195 [00:42<00:15,  3.26it/s] 75%|███████▌  | 147/195 [00:42<00:13,  3.55it/s] 76%|███████▌  | 148/195 [00:42<00:11,  3.94it/s] 76%|███████▋  | 149/195 [00:43<00:11,  4.07it/s] 77%|███████▋  | 150/195 [00:43<00:10,  4.49it/s] 77%|███████▋  | 151/195 [00:43<00:13,  3.22it/s] 78%|███████▊  | 152/195 [00:43<00:11,  3.88it/s] 78%|███████▊  | 153/195 [00:44<00:14,  2.92it/s] 79%|███████▉  | 154/195 [00:44<00:12,  3.39it/s] 79%|███████▉  | 155/195 [00:45<00:14,  2.74it/s] 81%|████████  | 157/195 [00:45<00:10,  3.72it/s] 82%|████████▏ | 159/195 [00:45<00:09,  3.94it/s] 82%|████████▏ | 160/195 [00:45<00:07,  4.43it/s] 83%|████████▎ | 161/195 [00:46<00:09,  3.76it/s] 83%|████████▎ | 162/195 [00:46<00:09,  3.60it/s] 84%|████████▎ | 163/195 [00:46<00:08,  3.63it/s] 84%|████████▍ | 164/195 [00:47<00:08,  3.56it/s] 85%|████████▍ | 165/195 [00:47<00:07,  3.95it/s] 85%|████████▌ | 166/195 [00:47<00:07,  3.87it/s] 86%|████████▌ | 168/195 [00:48<00:06,  4.04it/s] 87%|████████▋ | 170/195 [00:48<00:05,  4.58it/s] 88%|████████▊ | 172/195 [00:48<00:04,  4.78it/s] 89%|████████▊ | 173/195 [00:49<00:04,  4.92it/s] 89%|████████▉ | 174/195 [00:49<00:04,  5.02it/s] 90%|████████▉ | 175/195 [00:49<00:04,  4.45it/s] 91%|█████████ | 177/195 [00:50<00:04,  4.03it/s] 91%|█████████▏| 178/195 [00:50<00:04,  4.08it/s] 92%|█████████▏| 179/195 [00:50<00:04,  3.52it/s] 93%|█████████▎| 181/195 [00:51<00:03,  3.59it/s] 94%|█████████▍| 183/195 [00:51<00:03,  3.85it/s] 94%|█████████▍| 184/195 [00:52<00:03,  3.52it/s] 95%|█████████▍| 185/195 [00:52<00:02,  3.86it/s] 95%|█████████▌| 186/195 [00:52<00:02,  3.31it/s] 96%|█████████▋| 188/195 [00:53<00:01,  3.84it/s] 97%|█████████▋| 189/195 [00:53<00:01,  4.06it/s] 97%|█████████▋| 190/195 [00:53<00:01,  3.46it/s] 98%|█████████▊| 191/195 [00:54<00:01,  3.49it/s] 98%|█████████▊| 192/195 [00:54<00:01,  2.81it/s] 99%|█████████▉| 194/195 [00:55<00:00,  3.12it/s]100%|██████████| 195/195 [00:55<00:00,  3.41it/s]100%|██████████| 195/195 [00:57<00:00,  3.38it/s]
2025-09-24 09:25:02 [info     ] Validating outputs
2025-09-24 09:25:02 [info     ] Predict - end                  time=0:0:57
2025-09-24 09:25:02 [info     ] Evaluate - start               split=test
2025-09-24 09:25:02 [info     ] Evaluate - end                 answer_distr=[0.35, 0.16, 0.19, 0.26] correctness_llm=0.6 llm_group_correctness=[0.44, 0.51, 0.64, 0.67, 0.74] monotonicity=0.99
2025-09-24 09:25:02 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:25:02 [info     ] Augmenting questions for IRT estimation num_questions=4
2025-09-24 09:25:02 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:25:02 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1116.10it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3811.67it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 572.91it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7222.66it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1022.93it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3278.90it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 622.47it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7253.00it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1186.80it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3753.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 601.99it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6970.59it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1167.40it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3914.75it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 597.85it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7088.39it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 816.44it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3649.82it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 635.11it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7122.79it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1079.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3591.41it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 520.11it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7438.59it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 957.01it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3484.90it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 581.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7901.00it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 979.19it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3618.66it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 605.00it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7941.61it/s]
2025-09-24 09:25:07 INFO: EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
2025-09-24 09:25:07 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:25:07 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:25:07 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:25:07 [info     ] Evaluate question difficulty - end mae=1.48 rmse=1.86 split=test
2025-09-24 09:25:07 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 2 finished: 0:1:13

 ********** Run: 3/3 **********
2025-09-24 09:25:27 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:25:27 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:25:27 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:25:27 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:25:28 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:25:28 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:25:33 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:25:33 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:25:33 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:25:33 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:25:36 [info     ] Setting seed                   value=45
2025-09-24 09:25:36 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 09:25:36 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_dbe_miscons_level_nocontext
2025-09-24 09:25:36 [info     ] Building model                 name=llama3.2:3b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:25:36 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<04:03,  1.26s/it]  2%|▏         | 3/195 [00:01<01:44,  1.84it/s]  2%|▏         | 4/195 [00:01<01:18,  2.45it/s]  3%|▎         | 5/195 [00:02<01:10,  2.71it/s]  3%|▎         | 6/195 [00:02<00:58,  3.24it/s]  4%|▎         | 7/195 [00:02<01:03,  2.97it/s]  4%|▍         | 8/195 [00:03<01:02,  3.01it/s]  5%|▌         | 10/195 [00:03<00:52,  3.54it/s]  6%|▌         | 11/195 [00:03<00:45,  4.01it/s]  6%|▌         | 12/195 [00:04<00:55,  3.27it/s]  7%|▋         | 13/195 [00:04<00:49,  3.68it/s]  7%|▋         | 14/195 [00:04<00:50,  3.59it/s]  8%|▊         | 15/195 [00:05<01:02,  2.88it/s]  9%|▊         | 17/195 [00:05<00:51,  3.43it/s] 10%|▉         | 19/195 [00:06<00:45,  3.88it/s] 10%|█         | 20/195 [00:06<00:45,  3.84it/s] 11%|█         | 21/195 [00:06<00:39,  4.39it/s] 11%|█▏        | 22/195 [00:06<00:49,  3.52it/s] 12%|█▏        | 23/195 [00:07<00:42,  4.00it/s] 12%|█▏        | 24/195 [00:07<00:47,  3.59it/s] 13%|█▎        | 26/195 [00:08<00:47,  3.52it/s] 14%|█▍        | 28/195 [00:08<00:40,  4.11it/s] 15%|█▍        | 29/195 [00:08<00:37,  4.47it/s] 15%|█▌        | 30/195 [00:08<00:38,  4.34it/s] 16%|█▌        | 31/195 [00:09<00:37,  4.35it/s] 16%|█▋        | 32/195 [00:09<00:36,  4.42it/s] 17%|█▋        | 33/195 [00:09<00:42,  3.86it/s] 17%|█▋        | 34/195 [00:09<00:35,  4.56it/s] 18%|█▊        | 35/195 [00:10<00:38,  4.16it/s] 18%|█▊        | 36/195 [00:10<00:45,  3.48it/s] 19%|█▉        | 38/195 [00:10<00:40,  3.86it/s] 20%|██        | 39/195 [00:11<00:36,  4.27it/s] 21%|██        | 40/195 [00:11<00:35,  4.39it/s] 21%|██        | 41/195 [00:11<00:39,  3.93it/s] 22%|██▏       | 43/195 [00:11<00:31,  4.85it/s] 23%|██▎       | 44/195 [00:12<00:33,  4.54it/s] 23%|██▎       | 45/195 [00:12<00:33,  4.49it/s] 24%|██▎       | 46/195 [00:12<00:36,  4.06it/s] 24%|██▍       | 47/195 [00:12<00:37,  3.97it/s] 25%|██▍       | 48/195 [00:13<00:42,  3.49it/s] 26%|██▌       | 50/195 [00:13<00:44,  3.28it/s] 26%|██▌       | 51/195 [00:14<00:39,  3.66it/s] 27%|██▋       | 52/195 [00:14<00:39,  3.63it/s] 27%|██▋       | 53/195 [00:14<00:37,  3.77it/s] 28%|██▊       | 54/195 [00:15<00:44,  3.16it/s] 29%|██▊       | 56/195 [00:15<00:38,  3.61it/s] 29%|██▉       | 57/195 [00:15<00:40,  3.38it/s] 30%|██▉       | 58/195 [00:16<00:40,  3.41it/s] 30%|███       | 59/195 [00:16<00:35,  3.88it/s] 31%|███       | 60/195 [00:16<00:38,  3.50it/s] 31%|███▏      | 61/195 [00:17<00:40,  3.34it/s] 32%|███▏      | 62/195 [00:17<00:44,  2.96it/s] 33%|███▎      | 64/195 [00:17<00:35,  3.65it/s] 33%|███▎      | 65/195 [00:18<00:32,  3.95it/s] 34%|███▍      | 66/195 [00:18<00:31,  4.12it/s] 34%|███▍      | 67/195 [00:18<00:34,  3.72it/s] 35%|███▍      | 68/195 [00:18<00:33,  3.83it/s] 35%|███▌      | 69/195 [00:19<00:36,  3.48it/s] 36%|███▌      | 70/195 [00:19<00:34,  3.59it/s] 36%|███▋      | 71/195 [00:19<00:41,  2.99it/s] 37%|███▋      | 73/195 [00:20<00:33,  3.60it/s] 38%|███▊      | 75/195 [00:20<00:32,  3.72it/s] 39%|███▉      | 76/195 [00:21<00:29,  3.97it/s] 39%|███▉      | 77/195 [00:21<00:28,  4.15it/s] 41%|████      | 79/195 [00:21<00:24,  4.81it/s] 41%|████      | 80/195 [00:21<00:25,  4.50it/s] 42%|████▏     | 81/195 [00:22<00:28,  4.02it/s] 43%|████▎     | 83/195 [00:22<00:25,  4.41it/s] 43%|████▎     | 84/195 [00:22<00:22,  4.96it/s] 44%|████▎     | 85/195 [00:22<00:23,  4.62it/s] 44%|████▍     | 86/195 [00:23<00:27,  4.03it/s] 45%|████▌     | 88/195 [00:23<00:25,  4.17it/s] 46%|████▌     | 89/195 [00:23<00:22,  4.78it/s] 46%|████▌     | 90/195 [00:24<00:31,  3.29it/s] 47%|████▋     | 91/195 [00:24<00:26,  3.87it/s] 47%|████▋     | 92/195 [00:24<00:27,  3.68it/s] 48%|████▊     | 93/195 [00:24<00:23,  4.31it/s] 48%|████▊     | 94/195 [00:25<00:32,  3.15it/s] 49%|████▉     | 96/195 [00:25<00:26,  3.69it/s] 50%|████▉     | 97/195 [00:26<00:24,  3.93it/s] 50%|█████     | 98/195 [00:26<00:23,  4.18it/s] 51%|█████     | 99/195 [00:26<00:26,  3.64it/s] 52%|█████▏    | 101/195 [00:27<00:31,  3.03it/s] 53%|█████▎    | 103/195 [00:28<00:27,  3.30it/s] 53%|█████▎    | 104/195 [00:28<00:23,  3.82it/s] 54%|█████▍    | 105/195 [00:28<00:23,  3.85it/s] 54%|█████▍    | 106/195 [00:28<00:22,  4.04it/s] 55%|█████▍    | 107/195 [00:29<00:25,  3.40it/s] 56%|█████▌    | 109/195 [00:29<00:20,  4.12it/s] 56%|█████▋    | 110/195 [00:29<00:22,  3.70it/s] 57%|█████▋    | 112/195 [00:30<00:20,  4.14it/s] 58%|█████▊    | 114/195 [00:30<00:19,  4.24it/s] 59%|█████▉    | 115/195 [00:30<00:17,  4.49it/s] 59%|█████▉    | 116/195 [00:31<00:20,  3.90it/s] 60%|██████    | 117/195 [00:31<00:18,  4.19it/s] 61%|██████    | 118/195 [00:31<00:25,  3.07it/s] 62%|██████▏   | 120/195 [00:32<00:18,  3.99it/s] 62%|██████▏   | 121/195 [00:32<00:16,  4.39it/s] 63%|██████▎   | 122/195 [00:32<00:20,  3.57it/s] 64%|██████▎   | 124/195 [00:33<00:15,  4.59it/s] 64%|██████▍   | 125/195 [00:33<00:19,  3.55it/s] 65%|██████▍   | 126/195 [00:33<00:17,  3.93it/s] 65%|██████▌   | 127/195 [00:34<00:23,  2.89it/s] 66%|██████▌   | 129/195 [00:34<00:19,  3.31it/s] 67%|██████▋   | 130/195 [00:35<00:19,  3.41it/s] 67%|██████▋   | 131/195 [00:35<00:16,  3.80it/s] 68%|██████▊   | 132/195 [00:35<00:21,  2.98it/s] 68%|██████▊   | 133/195 [00:35<00:17,  3.54it/s] 69%|██████▊   | 134/195 [00:36<00:17,  3.39it/s] 69%|██████▉   | 135/195 [00:36<00:14,  4.18it/s] 70%|██████▉   | 136/195 [00:36<00:16,  3.62it/s] 71%|███████   | 138/195 [00:37<00:16,  3.54it/s] 72%|███████▏  | 140/195 [00:37<00:16,  3.37it/s] 73%|███████▎  | 142/195 [00:38<00:15,  3.43it/s] 74%|███████▍  | 144/195 [00:38<00:12,  4.08it/s] 74%|███████▍  | 145/195 [00:39<00:12,  3.93it/s] 75%|███████▌  | 147/195 [00:39<00:13,  3.58it/s] 76%|███████▌  | 148/195 [00:39<00:11,  3.96it/s] 76%|███████▋  | 149/195 [00:40<00:12,  3.65it/s] 77%|███████▋  | 150/195 [00:40<00:12,  3.71it/s] 77%|███████▋  | 151/195 [00:41<00:14,  2.95it/s] 78%|███████▊  | 153/195 [00:41<00:13,  3.10it/s] 79%|███████▉  | 154/195 [00:41<00:11,  3.46it/s] 79%|███████▉  | 155/195 [00:42<00:10,  3.80it/s] 80%|████████  | 156/195 [00:42<00:09,  4.13it/s] 81%|████████  | 157/195 [00:42<00:10,  3.78it/s] 81%|████████  | 158/195 [00:42<00:09,  3.89it/s] 82%|████████▏ | 159/195 [00:43<00:10,  3.32it/s] 83%|████████▎ | 161/195 [00:43<00:08,  4.19it/s] 83%|████████▎ | 162/195 [00:43<00:08,  4.12it/s] 84%|████████▎ | 163/195 [00:44<00:07,  4.06it/s] 84%|████████▍ | 164/195 [00:44<00:08,  3.74it/s] 85%|████████▍ | 165/195 [00:44<00:09,  3.04it/s] 85%|████████▌ | 166/195 [00:45<00:09,  3.04it/s] 86%|████████▌ | 168/195 [00:45<00:07,  3.44it/s] 87%|████████▋ | 169/195 [00:45<00:07,  3.29it/s] 88%|████████▊ | 171/195 [00:46<00:06,  3.75it/s] 89%|████████▊ | 173/195 [00:46<00:05,  3.78it/s] 89%|████████▉ | 174/195 [00:47<00:05,  3.83it/s] 90%|████████▉ | 175/195 [00:47<00:05,  3.45it/s] 90%|█████████ | 176/195 [00:47<00:05,  3.31it/s] 91%|█████████ | 177/195 [00:48<00:05,  3.03it/s] 92%|█████████▏| 179/195 [00:49<00:05,  2.74it/s] 92%|█████████▏| 180/195 [00:49<00:05,  3.00it/s] 93%|█████████▎| 181/195 [00:49<00:05,  2.52it/s] 93%|█████████▎| 182/195 [00:50<00:04,  3.11it/s] 94%|█████████▍| 183/195 [00:50<00:04,  2.87it/s] 95%|█████████▍| 185/195 [00:50<00:03,  3.28it/s] 96%|█████████▌| 187/195 [00:51<00:02,  3.41it/s] 97%|█████████▋| 189/195 [00:52<00:02,  2.92it/s] 98%|█████████▊| 191/195 [00:53<00:01,  2.80it/s] 98%|█████████▊| 192/195 [00:53<00:00,  3.08it/s] 99%|█████████▉| 193/195 [00:53<00:00,  2.77it/s]100%|██████████| 195/195 [00:54<00:00,  3.33it/s]100%|██████████| 195/195 [00:56<00:00,  3.46it/s]
2025-09-24 09:26:33 [info     ] Validating outputs
2025-09-24 09:26:33 [info     ] Predict - end                  time=0:0:56
2025-09-24 09:26:33 [info     ] Evaluate - start               split=test
2025-09-24 09:26:33 [info     ] Evaluate - end                 answer_distr=[0.38, 0.2, 0.15, 0.25] correctness_llm=0.65 llm_group_correctness=[0.51, 0.44, 0.72, 0.82, 0.74] monotonicity=0.26
2025-09-24 09:26:33 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:26:33 [info     ] Augmenting questions for IRT estimation num_questions=8
2025-09-24 09:26:33 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:26:33 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1018.39it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3457.36it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 564.28it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8133.00it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 849.54it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3518.79it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 626.59it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7933.03it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1011.48it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3504.69it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 560.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8155.59it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1115.00it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3488.84it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 621.21it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8466.01it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 964.02it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3559.91it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 644.77it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8032.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1129.67it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3684.77it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 606.96it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7655.84it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 975.58it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3549.79it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 610.28it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8021.89it/s]
2025-09-24 09:26:38 INFO: EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
2025-09-24 09:26:38 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:26:38 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:26:38 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:26:38 [info     ] Evaluate question difficulty - end mae=1.53 rmse=1.94 split=test
2025-09-24 09:26:38 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 3 finished: 0:1:11

 ========== Config: qwen3:1.7b~T_1.0~SO_student_bool_nocontext~L_5~SP_student_dbe_miscons_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_dbe_studentlevel_kc_exact5 ==========
Config 4/16

 ********** Run: 1/3 **********
2025-09-24 09:26:56 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:26:56 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:26:56 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:26:56 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:26:58 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:26:58 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:27:03 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:27:03 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:27:03 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:27:03 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:27:06 [info     ] Setting seed                   value=43
2025-09-24 09:27:06 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 09:27:06 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_kc_exact native_structured_output=True num_examples=5 system_prompt=student_dbe_miscons_level_context
2025-09-24 09:27:06 [info     ] Building example selector
2025-09-24 09:27:06 [info     ] Building model                 name=qwen3:1.7b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:27:06 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:14<47:43, 14.76s/it]  2%|▏         | 3/195 [00:15<13:39,  4.27s/it]  3%|▎         | 5/195 [00:17<07:28,  2.36s/it]  4%|▎         | 7/195 [00:17<04:50,  1.55s/it]  5%|▍         | 9/195 [00:18<03:26,  1.11s/it]  6%|▌         | 11/195 [00:19<02:37,  1.17it/s]  6%|▌         | 12/195 [00:19<02:15,  1.35it/s]  7%|▋         | 13/195 [00:20<02:02,  1.49it/s]  7%|▋         | 14/195 [00:20<01:44,  1.74it/s]  8%|▊         | 15/195 [00:20<01:39,  1.81it/s]  8%|▊         | 16/195 [00:21<01:25,  2.11it/s]  9%|▊         | 17/195 [00:21<01:23,  2.13it/s]  9%|▉         | 18/195 [00:21<01:13,  2.41it/s] 10%|▉         | 19/195 [00:22<01:24,  2.10it/s] 10%|█         | 20/195 [00:22<01:13,  2.37it/s] 11%|█         | 21/195 [00:23<01:17,  2.25it/s] 11%|█▏        | 22/195 [00:23<01:13,  2.37it/s] 12%|█▏        | 23/195 [00:24<01:18,  2.20it/s] 12%|█▏        | 24/195 [00:24<01:07,  2.53it/s] 13%|█▎        | 25/195 [00:24<01:09,  2.46it/s] 13%|█▎        | 26/195 [00:25<00:55,  3.05it/s] 14%|█▍        | 27/195 [00:25<00:55,  3.05it/s] 14%|█▍        | 28/195 [00:25<00:48,  3.42it/s] 15%|█▍        | 29/195 [00:25<00:48,  3.44it/s] 15%|█▌        | 30/195 [00:26<00:45,  3.63it/s] 16%|█▌        | 31/195 [00:26<00:46,  3.55it/s] 16%|█▋        | 32/195 [00:26<00:42,  3.81it/s] 17%|█▋        | 33/195 [00:26<00:44,  3.67it/s] 17%|█▋        | 34/195 [00:27<00:43,  3.69it/s] 18%|█▊        | 35/195 [00:27<00:45,  3.52it/s] 18%|█▊        | 36/195 [00:27<00:42,  3.73it/s] 19%|█▉        | 37/195 [00:28<00:43,  3.67it/s] 19%|█▉        | 38/195 [00:28<00:40,  3.84it/s] 20%|██        | 39/195 [00:28<00:42,  3.68it/s] 21%|██        | 40/195 [00:28<00:39,  3.88it/s] 21%|██        | 41/195 [00:29<00:42,  3.66it/s] 22%|██▏       | 42/195 [00:29<00:40,  3.82it/s] 22%|██▏       | 43/195 [00:29<00:42,  3.53it/s] 23%|██▎       | 44/195 [00:29<00:40,  3.74it/s] 23%|██▎       | 45/195 [00:30<00:42,  3.56it/s] 24%|██▎       | 46/195 [00:30<00:40,  3.68it/s] 24%|██▍       | 47/195 [00:30<00:41,  3.59it/s] 25%|██▍       | 48/195 [00:31<00:38,  3.81it/s] 25%|██▌       | 49/195 [00:31<00:41,  3.54it/s] 26%|██▌       | 50/195 [00:31<00:38,  3.74it/s] 26%|██▌       | 51/195 [00:32<00:47,  3.04it/s] 27%|██▋       | 52/195 [00:32<00:43,  3.27it/s] 27%|██▋       | 53/195 [00:32<00:50,  2.79it/s] 28%|██▊       | 54/195 [00:33<00:46,  3.01it/s] 28%|██▊       | 55/195 [00:33<00:55,  2.51it/s] 29%|██▊       | 56/195 [00:33<00:49,  2.80it/s] 29%|██▉       | 57/195 [00:34<00:55,  2.49it/s] 30%|██▉       | 58/195 [00:34<00:57,  2.37it/s] 30%|███       | 59/195 [00:35<00:59,  2.30it/s] 31%|███       | 60/195 [00:35<00:52,  2.55it/s] 31%|███▏      | 61/195 [00:36<00:57,  2.31it/s] 32%|███▏      | 62/195 [00:36<00:51,  2.57it/s] 32%|███▏      | 63/195 [00:36<00:53,  2.48it/s] 33%|███▎      | 64/195 [00:37<00:46,  2.81it/s] 33%|███▎      | 65/195 [00:37<00:48,  2.69it/s] 34%|███▍      | 66/195 [00:37<00:42,  3.01it/s] 34%|███▍      | 67/195 [00:38<00:45,  2.80it/s] 35%|███▍      | 68/195 [00:38<00:41,  3.09it/s] 35%|███▌      | 69/195 [00:38<00:43,  2.90it/s] 36%|███▌      | 70/195 [00:39<00:38,  3.21it/s] 36%|███▋      | 71/195 [00:39<00:41,  2.99it/s] 37%|███▋      | 72/195 [00:39<00:37,  3.28it/s] 37%|███▋      | 73/195 [00:40<00:40,  2.98it/s] 38%|███▊      | 74/195 [00:40<00:36,  3.28it/s] 38%|███▊      | 75/195 [00:40<00:36,  3.25it/s] 39%|███▉      | 76/195 [00:41<00:40,  2.96it/s] 39%|███▉      | 77/195 [00:41<00:37,  3.18it/s] 40%|████      | 78/195 [00:41<00:42,  2.77it/s] 41%|████      | 79/195 [00:42<00:37,  3.06it/s] 41%|████      | 80/195 [00:42<00:43,  2.66it/s] 42%|████▏     | 82/195 [00:43<00:37,  3.00it/s] 43%|████▎     | 83/195 [00:43<00:34,  3.27it/s] 43%|████▎     | 84/195 [00:43<00:33,  3.27it/s] 44%|████▎     | 85/195 [00:43<00:33,  3.32it/s] 44%|████▍     | 86/195 [00:44<00:34,  3.21it/s] 45%|████▍     | 87/195 [00:44<00:30,  3.50it/s] 45%|████▌     | 88/195 [00:44<00:32,  3.33it/s] 46%|████▌     | 89/195 [00:45<00:30,  3.50it/s] 46%|████▌     | 90/195 [00:45<00:31,  3.35it/s] 47%|████▋     | 91/195 [00:45<00:29,  3.56it/s] 47%|████▋     | 92/195 [00:45<00:29,  3.53it/s] 48%|████▊     | 93/195 [00:46<00:26,  3.79it/s] 48%|████▊     | 94/195 [00:46<00:28,  3.51it/s] 49%|████▊     | 95/195 [00:46<00:27,  3.64it/s] 49%|████▉     | 96/195 [00:47<00:30,  3.25it/s] 50%|████▉     | 97/195 [00:47<00:27,  3.61it/s] 50%|█████     | 98/195 [00:47<00:26,  3.62it/s] 51%|█████     | 99/195 [00:47<00:24,  3.93it/s] 51%|█████▏    | 100/195 [00:48<00:28,  3.30it/s] 52%|█████▏    | 101/195 [00:48<00:36,  2.60it/s] 52%|█████▏    | 102/195 [00:49<00:33,  2.82it/s] 53%|█████▎    | 103/195 [00:49<00:47,  1.94it/s] 53%|█████▎    | 104/195 [00:50<00:40,  2.22it/s] 54%|█████▍    | 105/195 [00:50<00:44,  2.00it/s] 55%|█████▍    | 107/195 [00:51<00:36,  2.43it/s] 55%|█████▌    | 108/195 [00:51<00:31,  2.74it/s] 56%|█████▌    | 109/195 [00:52<00:31,  2.73it/s] 56%|█████▋    | 110/195 [00:52<00:28,  3.02it/s] 57%|█████▋    | 111/195 [00:52<00:26,  3.14it/s] 57%|█████▋    | 112/195 [00:52<00:24,  3.45it/s] 58%|█████▊    | 113/195 [00:53<00:25,  3.26it/s] 58%|█████▊    | 114/195 [00:53<00:22,  3.57it/s] 59%|█████▉    | 115/195 [00:53<00:24,  3.33it/s] 59%|█████▉    | 116/195 [00:54<00:33,  2.35it/s] 60%|██████    | 117/195 [00:54<00:31,  2.49it/s] 61%|██████    | 118/195 [00:55<00:38,  2.01it/s] 61%|██████    | 119/195 [00:55<00:33,  2.29it/s] 62%|██████▏   | 120/195 [00:56<00:37,  2.00it/s] 63%|██████▎   | 122/195 [00:57<00:29,  2.49it/s] 64%|██████▎   | 124/195 [00:57<00:24,  2.92it/s] 64%|██████▍   | 125/195 [00:57<00:21,  3.20it/s] 65%|██████▍   | 126/195 [00:57<00:20,  3.31it/s] 65%|██████▌   | 127/195 [00:58<00:19,  3.54it/s] 66%|██████▌   | 128/195 [00:58<00:18,  3.58it/s] 66%|██████▌   | 129/195 [00:58<00:17,  3.80it/s] 67%|██████▋   | 130/195 [00:59<00:18,  3.49it/s] 67%|██████▋   | 131/195 [00:59<00:17,  3.76it/s] 68%|██████▊   | 132/195 [00:59<00:17,  3.64it/s] 68%|██████▊   | 133/195 [00:59<00:15,  3.93it/s] 69%|██████▊   | 134/195 [01:00<00:17,  3.55it/s] 69%|██████▉   | 135/195 [01:00<00:16,  3.60it/s] 70%|██████▉   | 136/195 [01:00<00:16,  3.54it/s] 70%|███████   | 137/195 [01:00<00:15,  3.79it/s] 71%|███████   | 138/195 [01:01<00:15,  3.59it/s] 71%|███████▏  | 139/195 [01:01<00:14,  3.83it/s] 72%|███████▏  | 140/195 [01:01<00:15,  3.67it/s] 72%|███████▏  | 141/195 [01:01<00:14,  3.85it/s] 73%|███████▎  | 142/195 [01:02<00:14,  3.73it/s] 73%|███████▎  | 143/195 [01:02<00:13,  3.95it/s] 74%|███████▍  | 144/195 [01:02<00:13,  3.68it/s] 74%|███████▍  | 145/195 [01:03<00:12,  3.88it/s] 75%|███████▍  | 146/195 [01:03<00:13,  3.76it/s] 75%|███████▌  | 147/195 [01:03<00:12,  3.97it/s] 76%|███████▌  | 148/195 [01:03<00:12,  3.84it/s] 76%|███████▋  | 149/195 [01:04<00:11,  3.85it/s] 77%|███████▋  | 150/195 [01:04<00:11,  4.07it/s] 77%|███████▋  | 151/195 [01:04<00:11,  3.82it/s] 78%|███████▊  | 152/195 [01:04<00:11,  3.80it/s] 78%|███████▊  | 153/195 [01:05<00:12,  3.35it/s] 79%|███████▉  | 155/195 [01:05<00:10,  3.67it/s] 80%|████████  | 156/195 [01:05<00:10,  3.83it/s] 81%|████████  | 157/195 [01:06<00:09,  3.97it/s] 81%|████████  | 158/195 [01:06<00:09,  3.90it/s] 82%|████████▏ | 159/195 [01:06<00:08,  4.12it/s] 82%|████████▏ | 160/195 [01:06<00:09,  3.79it/s] 83%|████████▎ | 161/195 [01:07<00:08,  4.07it/s] 83%|████████▎ | 162/195 [01:07<00:08,  3.89it/s] 84%|████████▎ | 163/195 [01:07<00:07,  4.22it/s] 84%|████████▍ | 164/195 [01:07<00:08,  3.85it/s] 85%|████████▍ | 165/195 [01:08<00:07,  4.11it/s] 85%|████████▌ | 166/195 [01:08<00:07,  3.92it/s] 86%|████████▌ | 167/195 [01:08<00:06,  4.19it/s] 86%|████████▌ | 168/195 [01:08<00:06,  3.98it/s] 87%|████████▋ | 169/195 [01:09<00:06,  4.29it/s] 87%|████████▋ | 170/195 [01:09<00:06,  4.16it/s] 88%|████████▊ | 171/195 [01:09<00:05,  4.33it/s] 88%|████████▊ | 172/195 [01:09<00:05,  3.91it/s] 89%|████████▉ | 174/195 [01:10<00:05,  3.95it/s] 90%|████████▉ | 175/195 [01:10<00:04,  4.06it/s] 90%|█████████ | 176/195 [01:10<00:04,  3.90it/s] 91%|█████████ | 177/195 [01:11<00:04,  3.94it/s] 91%|█████████▏| 178/195 [01:11<00:04,  3.88it/s] 92%|█████████▏| 179/195 [01:11<00:03,  4.02it/s] 92%|█████████▏| 180/195 [01:11<00:04,  3.72it/s] 93%|█████████▎| 181/195 [01:12<00:03,  3.81it/s] 93%|█████████▎| 182/195 [01:12<00:03,  3.61it/s] 94%|█████████▍| 183/195 [01:12<00:03,  3.74it/s] 94%|█████████▍| 184/195 [01:13<00:03,  3.58it/s] 95%|█████████▍| 185/195 [01:13<00:02,  3.77it/s] 95%|█████████▌| 186/195 [01:13<00:02,  3.61it/s] 96%|█████████▌| 187/195 [01:13<00:02,  3.79it/s] 96%|█████████▋| 188/195 [01:14<00:01,  3.76it/s] 97%|█████████▋| 189/195 [01:14<00:01,  3.98it/s] 97%|█████████▋| 190/195 [01:14<00:01,  3.56it/s] 98%|█████████▊| 191/195 [01:14<00:01,  3.83it/s] 98%|█████████▊| 192/195 [01:15<00:00,  3.79it/s] 99%|█████████▉| 193/195 [01:15<00:00,  3.73it/s] 99%|█████████▉| 194/195 [01:15<00:00,  3.76it/s]100%|██████████| 195/195 [01:17<00:00,  2.50it/s]
2025-09-24 09:28:24 [info     ] Validating outputs
2025-09-24 09:28:24 [info     ] Predict - end                  time=0:1:17
2025-09-24 09:28:24 [info     ] Evaluate - start               split=test
2025-09-24 09:28:24 [info     ] Evaluate - end                 answer_distr=[0.32, 0.26, 0.23, 0.19] correctness_llm=0.81 llm_group_correctness=[0.74, 0.79, 0.79, 0.82, 0.87] monotonicity=0.94
2025-09-24 09:28:24 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:28:24 [info     ] Augmenting questions for IRT estimation num_questions=23
2025-09-24 09:28:24 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:28:24 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 989.09it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3432.62it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 546.43it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5477.64it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 962.31it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 2424.74it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 484.73it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5073.46it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 900.95it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3609.40it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 697.81it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5207.54it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1022.79it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3643.73it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 600.69it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 4971.24it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1034.94it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3437.38it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 608.59it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 4946.11it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 889.62it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3562.39it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 588.28it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5142.78it/s]
2025-09-24 09:28:29 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 09:28:29 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:28:29 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:28:29 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:28:29 [info     ] Evaluate question difficulty - end mae=1.54 rmse=2.01 split=test
2025-09-24 09:28:29 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 1 finished: 0:1:32

 ********** Run: 2/3 **********
2025-09-24 09:28:46 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:28:46 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:28:46 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:28:46 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:28:48 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:28:48 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:28:52 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:28:52 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:28:52 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:28:53 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:28:56 [info     ] Setting seed                   value=44
2025-09-24 09:28:56 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 09:28:56 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_kc_exact native_structured_output=True num_examples=5 system_prompt=student_dbe_miscons_level_context
2025-09-24 09:28:56 [info     ] Building example selector
2025-09-24 09:28:56 [info     ] Building model                 name=qwen3:1.7b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:28:56 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:12<42:00, 12.99s/it]  1%|          | 2/195 [00:13<17:36,  5.47s/it]  2%|▏         | 3/195 [00:13<10:36,  3.31s/it]  3%|▎         | 5/195 [00:15<05:32,  1.75s/it]  3%|▎         | 6/195 [00:15<04:11,  1.33s/it]  4%|▎         | 7/195 [00:15<03:28,  1.11s/it]  4%|▍         | 8/195 [00:16<02:42,  1.15it/s]  5%|▍         | 9/195 [00:16<02:07,  1.46it/s]  5%|▌         | 10/195 [00:17<02:00,  1.53it/s]  6%|▌         | 11/195 [00:17<01:42,  1.79it/s]  6%|▌         | 12/195 [00:17<01:30,  2.02it/s]  7%|▋         | 13/195 [00:17<01:16,  2.38it/s]  7%|▋         | 14/195 [00:18<01:14,  2.44it/s]  8%|▊         | 15/195 [00:18<01:03,  2.82it/s]  8%|▊         | 16/195 [00:19<01:17,  2.32it/s]  9%|▉         | 18/195 [00:19<01:07,  2.63it/s] 10%|▉         | 19/195 [00:19<00:54,  3.21it/s] 10%|█         | 20/195 [00:20<01:07,  2.58it/s] 11%|█▏        | 22/195 [00:21<01:04,  2.69it/s] 12%|█▏        | 23/195 [00:21<00:59,  2.88it/s] 12%|█▏        | 24/195 [00:21<00:58,  2.90it/s] 13%|█▎        | 25/195 [00:22<00:57,  2.95it/s] 13%|█▎        | 26/195 [00:22<00:51,  3.29it/s] 14%|█▍        | 27/195 [00:22<00:51,  3.28it/s] 15%|█▍        | 29/195 [00:23<00:48,  3.42it/s] 16%|█▌        | 31/195 [00:23<00:45,  3.62it/s] 16%|█▋        | 32/195 [00:23<00:43,  3.72it/s] 17%|█▋        | 33/195 [00:24<00:45,  3.54it/s] 17%|█▋        | 34/195 [00:24<00:44,  3.64it/s] 18%|█▊        | 35/195 [00:24<00:43,  3.66it/s] 18%|█▊        | 36/195 [00:25<00:40,  3.89it/s] 19%|█▉        | 37/195 [00:25<00:41,  3.85it/s] 19%|█▉        | 38/195 [00:25<00:39,  3.96it/s] 20%|██        | 39/195 [00:25<00:37,  4.16it/s] 21%|██        | 40/195 [00:26<00:40,  3.84it/s] 21%|██        | 41/195 [00:26<00:36,  4.17it/s] 22%|██▏       | 42/195 [00:26<00:39,  3.91it/s] 22%|██▏       | 43/195 [00:26<00:36,  4.15it/s] 23%|██▎       | 44/195 [00:27<00:41,  3.65it/s] 23%|██▎       | 45/195 [00:27<00:37,  4.01it/s] 24%|██▎       | 46/195 [00:27<00:39,  3.73it/s] 24%|██▍       | 47/195 [00:27<00:36,  4.05it/s] 25%|██▍       | 48/195 [00:28<00:39,  3.76it/s] 25%|██▌       | 49/195 [00:28<00:36,  4.04it/s] 26%|██▌       | 50/195 [00:28<00:42,  3.43it/s] 26%|██▌       | 51/195 [00:29<00:43,  3.31it/s] 27%|██▋       | 52/195 [00:29<00:47,  3.02it/s] 27%|██▋       | 53/195 [00:29<00:46,  3.07it/s] 28%|██▊       | 54/195 [00:30<00:52,  2.70it/s] 28%|██▊       | 55/195 [00:30<00:47,  2.94it/s] 29%|██▊       | 56/195 [00:30<00:52,  2.66it/s] 29%|██▉       | 57/195 [00:31<00:46,  2.95it/s] 30%|██▉       | 58/195 [00:31<00:54,  2.52it/s] 30%|███       | 59/195 [00:32<00:52,  2.60it/s] 31%|███       | 60/195 [00:32<00:52,  2.59it/s] 31%|███▏      | 61/195 [00:32<00:46,  2.89it/s] 32%|███▏      | 62/195 [00:33<00:47,  2.78it/s] 32%|███▏      | 63/195 [00:33<00:42,  3.08it/s] 33%|███▎      | 64/195 [00:33<00:48,  2.71it/s] 33%|███▎      | 65/195 [00:34<00:46,  2.79it/s] 34%|███▍      | 66/195 [00:34<00:42,  3.00it/s] 34%|███▍      | 67/195 [00:34<00:44,  2.89it/s] 35%|███▍      | 68/195 [00:35<00:40,  3.17it/s] 35%|███▌      | 69/195 [00:35<00:43,  2.90it/s] 36%|███▌      | 70/195 [00:35<00:39,  3.17it/s] 36%|███▋      | 71/195 [00:36<00:43,  2.84it/s] 37%|███▋      | 72/195 [00:36<00:40,  3.07it/s] 37%|███▋      | 73/195 [00:36<00:42,  2.89it/s] 38%|███▊      | 74/195 [00:37<00:37,  3.22it/s] 38%|███▊      | 75/195 [00:37<00:37,  3.18it/s] 39%|███▉      | 76/195 [00:37<00:40,  2.94it/s] 39%|███▉      | 77/195 [00:38<00:37,  3.16it/s] 40%|████      | 78/195 [00:38<00:41,  2.83it/s] 41%|████      | 79/195 [00:38<00:38,  3.03it/s] 41%|████      | 80/195 [00:39<00:45,  2.53it/s] 42%|████▏     | 82/195 [00:39<00:40,  2.82it/s] 43%|████▎     | 84/195 [00:40<00:36,  3.05it/s] 44%|████▍     | 86/195 [00:41<00:33,  3.26it/s] 45%|████▍     | 87/195 [00:41<00:31,  3.38it/s] 45%|████▌     | 88/195 [00:41<00:33,  3.24it/s] 46%|████▌     | 89/195 [00:41<00:31,  3.37it/s] 46%|████▌     | 90/195 [00:42<00:32,  3.26it/s] 47%|████▋     | 91/195 [00:42<00:29,  3.49it/s] 47%|████▋     | 92/195 [00:42<00:30,  3.37it/s] 48%|████▊     | 93/195 [00:42<00:28,  3.61it/s] 48%|████▊     | 94/195 [00:43<00:30,  3.29it/s] 49%|████▊     | 95/195 [00:43<00:27,  3.61it/s] 49%|████▉     | 96/195 [00:43<00:28,  3.49it/s] 50%|████▉     | 97/195 [00:44<00:26,  3.65it/s] 50%|█████     | 98/195 [00:44<00:27,  3.52it/s] 51%|█████     | 99/195 [00:44<00:25,  3.80it/s] 51%|█████▏    | 100/195 [00:45<00:29,  3.24it/s] 52%|█████▏    | 101/195 [00:45<00:37,  2.48it/s] 52%|█████▏    | 102/195 [00:46<00:37,  2.49it/s] 53%|█████▎    | 103/195 [00:46<00:45,  2.02it/s] 53%|█████▎    | 104/195 [00:47<00:39,  2.28it/s] 54%|█████▍    | 105/195 [00:47<00:44,  2.00it/s] 55%|█████▍    | 107/195 [00:48<00:34,  2.53it/s] 55%|█████▌    | 108/195 [00:48<00:30,  2.83it/s] 56%|█████▌    | 109/195 [00:48<00:32,  2.65it/s] 56%|█████▋    | 110/195 [00:49<00:29,  2.89it/s] 57%|█████▋    | 111/195 [00:49<00:27,  3.02it/s] 57%|█████▋    | 112/195 [00:49<00:25,  3.31it/s] 58%|█████▊    | 113/195 [00:50<00:25,  3.17it/s] 58%|█████▊    | 114/195 [00:50<00:21,  3.76it/s] 59%|█████▉    | 115/195 [00:50<00:27,  2.95it/s] 59%|█████▉    | 116/195 [00:51<00:24,  3.19it/s] 60%|██████    | 117/195 [00:51<00:35,  2.18it/s] 61%|██████    | 118/195 [00:52<00:30,  2.51it/s] 61%|██████    | 119/195 [00:52<00:38,  1.95it/s] 62%|██████▏   | 120/195 [00:53<00:32,  2.27it/s] 62%|██████▏   | 121/195 [00:53<00:31,  2.38it/s] 63%|██████▎   | 123/195 [00:54<00:25,  2.83it/s] 64%|██████▎   | 124/195 [00:54<00:23,  3.08it/s] 64%|██████▍   | 125/195 [00:54<00:23,  2.95it/s] 65%|██████▍   | 126/195 [00:54<00:21,  3.25it/s] 65%|██████▌   | 127/195 [00:55<00:21,  3.23it/s] 66%|██████▌   | 128/195 [00:55<00:19,  3.43it/s] 66%|██████▌   | 129/195 [00:55<00:19,  3.43it/s] 67%|██████▋   | 130/195 [00:56<00:18,  3.50it/s] 67%|██████▋   | 131/195 [00:56<00:18,  3.54it/s] 68%|██████▊   | 132/195 [00:56<00:16,  3.71it/s] 68%|██████▊   | 133/195 [00:56<00:17,  3.58it/s] 69%|██████▊   | 134/195 [00:57<00:15,  3.84it/s] 69%|██████▉   | 135/195 [00:57<00:15,  3.85it/s] 70%|██████▉   | 136/195 [00:57<00:14,  4.03it/s] 70%|███████   | 137/195 [00:57<00:14,  3.88it/s] 71%|███████   | 138/195 [00:58<00:13,  4.10it/s] 71%|███████▏  | 139/195 [00:58<00:14,  3.99it/s] 72%|███████▏  | 140/195 [00:58<00:13,  4.17it/s] 72%|███████▏  | 141/195 [00:58<00:13,  4.01it/s] 73%|███████▎  | 142/195 [00:58<00:12,  4.16it/s] 73%|███████▎  | 143/195 [00:59<00:12,  4.12it/s] 74%|███████▍  | 144/195 [00:59<00:11,  4.34it/s] 74%|███████▍  | 145/195 [00:59<00:12,  4.13it/s] 75%|███████▍  | 146/195 [00:59<00:11,  4.28it/s] 75%|███████▌  | 147/195 [01:00<00:11,  4.16it/s] 76%|███████▌  | 148/195 [01:00<00:10,  4.28it/s] 76%|███████▋  | 149/195 [01:00<00:11,  4.07it/s] 77%|███████▋  | 150/195 [01:00<00:10,  4.22it/s] 77%|███████▋  | 151/195 [01:01<00:12,  3.57it/s] 78%|███████▊  | 152/195 [01:01<00:10,  3.91it/s] 78%|███████▊  | 153/195 [01:01<00:11,  3.67it/s] 79%|███████▉  | 154/195 [01:02<00:11,  3.71it/s] 79%|███████▉  | 155/195 [01:02<00:09,  4.03it/s] 80%|████████  | 156/195 [01:02<00:09,  3.92it/s] 81%|████████  | 157/195 [01:02<00:09,  4.20it/s] 81%|████████  | 158/195 [01:03<00:09,  3.83it/s] 82%|████████▏ | 159/195 [01:03<00:08,  4.06it/s] 82%|████████▏ | 160/195 [01:03<00:09,  3.66it/s] 83%|████████▎ | 162/195 [01:04<00:08,  3.79it/s] 84%|████████▎ | 163/195 [01:04<00:08,  3.97it/s] 84%|████████▍ | 164/195 [01:04<00:08,  3.69it/s] 85%|████████▍ | 165/195 [01:04<00:07,  3.81it/s] 85%|████████▌ | 166/195 [01:05<00:08,  3.60it/s] 86%|████████▌ | 167/195 [01:05<00:07,  3.72it/s] 86%|████████▌ | 168/195 [01:05<00:07,  3.60it/s] 87%|████████▋ | 169/195 [01:05<00:06,  3.77it/s] 87%|████████▋ | 170/195 [01:06<00:06,  3.58it/s] 88%|████████▊ | 171/195 [01:06<00:06,  3.64it/s] 88%|████████▊ | 172/195 [01:06<00:06,  3.42it/s] 89%|████████▊ | 173/195 [01:07<00:06,  3.63it/s] 89%|████████▉ | 174/195 [01:07<00:05,  3.57it/s] 90%|████████▉ | 175/195 [01:07<00:05,  3.76it/s] 90%|█████████ | 176/195 [01:07<00:05,  3.74it/s] 91%|█████████ | 177/195 [01:08<00:04,  3.97it/s] 91%|█████████▏| 178/195 [01:08<00:04,  3.88it/s] 92%|█████████▏| 179/195 [01:08<00:03,  4.10it/s] 92%|█████████▏| 180/195 [01:08<00:03,  3.95it/s] 93%|█████████▎| 181/195 [01:09<00:03,  4.09it/s] 93%|█████████▎| 182/195 [01:09<00:03,  3.77it/s] 94%|█████████▍| 183/195 [01:09<00:03,  3.93it/s] 94%|█████████▍| 184/195 [01:09<00:03,  3.60it/s] 95%|█████████▍| 185/195 [01:10<00:02,  4.00it/s] 95%|█████████▌| 186/195 [01:10<00:02,  3.95it/s] 96%|█████████▌| 187/195 [01:10<00:01,  4.27it/s] 96%|█████████▋| 188/195 [01:10<00:01,  4.24it/s] 97%|█████████▋| 189/195 [01:11<00:01,  4.44it/s] 97%|█████████▋| 190/195 [01:11<00:01,  4.05it/s] 98%|█████████▊| 191/195 [01:11<00:00,  4.11it/s] 98%|█████████▊| 192/195 [01:11<00:00,  3.74it/s] 99%|█████████▉| 193/195 [01:12<00:00,  3.99it/s] 99%|█████████▉| 194/195 [01:12<00:00,  3.72it/s]100%|██████████| 195/195 [01:14<00:00,  2.61it/s]
2025-09-24 09:30:10 [info     ] Validating outputs
2025-09-24 09:30:10 [info     ] Predict - end                  time=0:1:14
2025-09-24 09:30:10 [info     ] Evaluate - start               split=test
2025-09-24 09:30:10 [info     ] Evaluate - end                 answer_distr=[0.3, 0.27, 0.22, 0.21] correctness_llm=0.81 llm_group_correctness=[0.79, 0.74, 0.79, 0.82, 0.87] monotonicity=0.47
2025-09-24 09:30:10 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:30:10 [info     ] Augmenting questions for IRT estimation num_questions=26
2025-09-24 09:30:10 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:30:10 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 970.68it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3581.89it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 532.59it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5485.82it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 942.54it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3455.38it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 580.99it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7012.21it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 963.13it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3578.37it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 575.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6858.24it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 979.00it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3559.37it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 541.98it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6002.89it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 915.16it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 4069.61it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 614.89it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6264.16it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1099.47it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3627.73it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 609.75it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6081.22it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 711.48it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3857.79it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 537.48it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6954.08it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1004.14it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3544.56it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 588.09it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7010.54it/s]
2025-09-24 09:30:16 INFO: EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
2025-09-24 09:30:16 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:30:16 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:30:16 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:30:16 [info     ] Evaluate question difficulty - end mae=1.66 rmse=2.15 split=test
2025-09-24 09:30:16 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 2 finished: 0:1:30

 ********** Run: 3/3 **********
2025-09-24 09:30:32 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:30:32 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:30:32 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:30:32 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:30:34 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:30:34 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:30:39 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:30:39 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:30:39 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:30:40 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:30:43 [info     ] Setting seed                   value=45
2025-09-24 09:30:43 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 09:30:43 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_kc_exact native_structured_output=True num_examples=5 system_prompt=student_dbe_miscons_level_context
2025-09-24 09:30:43 [info     ] Building example selector
2025-09-24 09:30:43 [info     ] Building model                 name=qwen3:1.7b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:30:43 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:12<41:49, 12.93s/it]  1%|          | 2/195 [00:13<17:20,  5.39s/it]  2%|▏         | 3/195 [00:13<10:42,  3.34s/it]  3%|▎         | 5/195 [00:15<05:43,  1.81s/it]  3%|▎         | 6/195 [00:15<04:13,  1.34s/it]  4%|▎         | 7/195 [00:16<03:42,  1.19s/it]  4%|▍         | 8/195 [00:16<02:51,  1.09it/s]  5%|▍         | 9/195 [00:17<02:30,  1.23it/s]  5%|▌         | 10/195 [00:17<02:08,  1.44it/s]  6%|▌         | 11/195 [00:17<01:43,  1.77it/s]  6%|▌         | 12/195 [00:18<01:38,  1.86it/s]  7%|▋         | 13/195 [00:18<01:22,  2.22it/s]  7%|▋         | 14/195 [00:18<01:22,  2.20it/s]  8%|▊         | 15/195 [00:19<01:11,  2.50it/s]  8%|▊         | 16/195 [00:19<01:18,  2.27it/s]  9%|▊         | 17/195 [00:19<01:09,  2.57it/s]  9%|▉         | 18/195 [00:20<01:20,  2.19it/s] 10%|█         | 20/195 [00:21<01:13,  2.37it/s] 11%|█         | 21/195 [00:21<01:06,  2.61it/s] 11%|█▏        | 22/195 [00:22<01:11,  2.42it/s] 12%|█▏        | 23/195 [00:22<01:03,  2.70it/s] 12%|█▏        | 24/195 [00:22<01:09,  2.46it/s] 13%|█▎        | 25/195 [00:23<01:01,  2.75it/s] 13%|█▎        | 26/195 [00:23<00:57,  2.96it/s] 14%|█▍        | 27/195 [00:23<00:50,  3.32it/s] 14%|█▍        | 28/195 [00:23<00:51,  3.25it/s] 15%|█▍        | 29/195 [00:24<00:48,  3.42it/s] 15%|█▌        | 30/195 [00:24<00:50,  3.29it/s] 16%|█▌        | 31/195 [00:24<00:49,  3.31it/s] 16%|█▋        | 32/195 [00:25<00:46,  3.53it/s] 17%|█▋        | 33/195 [00:25<00:49,  3.27it/s] 18%|█▊        | 35/195 [00:25<00:45,  3.49it/s] 18%|█▊        | 36/195 [00:26<00:43,  3.67it/s] 19%|█▉        | 37/195 [00:26<00:44,  3.58it/s] 19%|█▉        | 38/195 [00:26<00:42,  3.72it/s] 20%|██        | 39/195 [00:27<00:44,  3.53it/s] 21%|██        | 40/195 [00:27<00:41,  3.78it/s] 21%|██        | 41/195 [00:27<00:42,  3.65it/s] 22%|██▏       | 42/195 [00:27<00:39,  3.84it/s] 22%|██▏       | 43/195 [00:28<00:43,  3.50it/s] 23%|██▎       | 44/195 [00:28<00:40,  3.70it/s] 23%|██▎       | 45/195 [00:28<00:41,  3.60it/s] 24%|██▎       | 46/195 [00:28<00:39,  3.79it/s] 24%|██▍       | 47/195 [00:29<00:40,  3.65it/s] 25%|██▍       | 48/195 [00:29<00:38,  3.86it/s] 25%|██▌       | 49/195 [00:29<00:39,  3.70it/s] 26%|██▌       | 50/195 [00:29<00:37,  3.85it/s] 26%|██▌       | 51/195 [00:30<00:48,  2.98it/s] 27%|██▋       | 52/195 [00:30<00:44,  3.21it/s] 27%|██▋       | 53/195 [00:31<00:53,  2.66it/s] 28%|██▊       | 54/195 [00:31<00:48,  2.92it/s] 28%|██▊       | 55/195 [00:32<00:56,  2.48it/s] 29%|██▊       | 56/195 [00:32<00:50,  2.76it/s] 29%|██▉       | 57/195 [00:32<00:58,  2.37it/s] 30%|██▉       | 58/195 [00:33<00:51,  2.65it/s] 30%|███       | 59/195 [00:33<01:01,  2.21it/s] 31%|███       | 60/195 [00:33<00:49,  2.72it/s] 31%|███▏      | 61/195 [00:34<00:57,  2.35it/s] 32%|███▏      | 62/195 [00:34<00:49,  2.68it/s] 32%|███▏      | 63/195 [00:35<00:52,  2.52it/s] 33%|███▎      | 64/195 [00:35<00:45,  2.86it/s] 33%|███▎      | 65/195 [00:35<00:48,  2.68it/s] 34%|███▍      | 66/195 [00:36<00:42,  3.02it/s] 34%|███▍      | 67/195 [00:36<00:45,  2.79it/s] 35%|███▍      | 68/195 [00:36<00:40,  3.12it/s] 35%|███▌      | 69/195 [00:37<00:44,  2.84it/s] 36%|███▌      | 70/195 [00:37<00:39,  3.13it/s] 36%|███▋      | 71/195 [00:37<00:42,  2.91it/s] 37%|███▋      | 72/195 [00:38<00:38,  3.21it/s] 37%|███▋      | 73/195 [00:38<00:42,  2.90it/s] 38%|███▊      | 74/195 [00:38<00:37,  3.20it/s] 38%|███▊      | 75/195 [00:39<00:43,  2.74it/s] 39%|███▉      | 76/195 [00:39<00:39,  3.00it/s] 39%|███▉      | 77/195 [00:39<00:43,  2.73it/s] 40%|████      | 78/195 [00:40<00:38,  3.02it/s] 41%|████      | 79/195 [00:40<00:39,  2.95it/s] 41%|████      | 80/195 [00:40<00:35,  3.25it/s] 42%|████▏     | 81/195 [00:41<00:36,  3.16it/s] 42%|████▏     | 82/195 [00:41<00:30,  3.75it/s] 43%|████▎     | 83/195 [00:41<00:33,  3.34it/s] 43%|████▎     | 84/195 [00:41<00:31,  3.57it/s] 44%|████▎     | 85/195 [00:42<00:32,  3.37it/s] 44%|████▍     | 86/195 [00:42<00:29,  3.65it/s] 45%|████▍     | 87/195 [00:42<00:31,  3.39it/s] 45%|████▌     | 88/195 [00:43<00:30,  3.52it/s] 46%|████▌     | 89/195 [00:43<00:30,  3.44it/s] 46%|████▌     | 90/195 [00:43<00:31,  3.37it/s] 47%|████▋     | 91/195 [00:43<00:29,  3.51it/s] 47%|████▋     | 92/195 [00:44<00:30,  3.34it/s] 48%|████▊     | 93/195 [00:44<00:29,  3.45it/s] 48%|████▊     | 94/195 [00:44<00:31,  3.16it/s] 49%|████▊     | 95/195 [00:45<00:28,  3.56it/s] 49%|████▉     | 96/195 [00:45<00:28,  3.49it/s] 50%|████▉     | 97/195 [00:45<00:25,  3.89it/s] 50%|█████     | 98/195 [00:45<00:26,  3.70it/s] 51%|█████▏    | 100/195 [00:46<00:27,  3.42it/s] 52%|█████▏    | 101/195 [00:46<00:29,  3.20it/s] 52%|█████▏    | 102/195 [00:47<00:37,  2.47it/s] 53%|█████▎    | 103/195 [00:47<00:36,  2.50it/s] 53%|█████▎    | 104/195 [00:48<00:43,  2.07it/s] 54%|█████▍    | 105/195 [00:49<00:42,  2.14it/s] 54%|█████▍    | 106/195 [00:49<00:35,  2.51it/s] 55%|█████▍    | 107/195 [00:49<00:36,  2.41it/s] 55%|█████▌    | 108/195 [00:49<00:32,  2.69it/s] 56%|█████▌    | 109/195 [00:50<00:34,  2.49it/s] 57%|█████▋    | 111/195 [00:51<00:30,  2.74it/s] 58%|█████▊    | 113/195 [00:51<00:28,  2.93it/s] 59%|█████▉    | 115/195 [00:52<00:28,  2.82it/s] 59%|█████▉    | 116/195 [00:52<00:26,  2.96it/s] 60%|██████    | 117/195 [00:53<00:33,  2.32it/s] 61%|██████    | 118/195 [00:53<00:30,  2.54it/s] 61%|██████    | 119/195 [00:54<00:38,  1.99it/s] 62%|██████▏   | 120/195 [00:54<00:32,  2.29it/s] 62%|██████▏   | 121/195 [00:55<00:30,  2.43it/s] 63%|██████▎   | 122/195 [00:55<00:27,  2.68it/s] 63%|██████▎   | 123/195 [00:55<00:26,  2.72it/s] 64%|██████▎   | 124/195 [00:56<00:23,  2.99it/s] 64%|██████▍   | 125/195 [00:56<00:23,  2.93it/s] 65%|██████▍   | 126/195 [00:56<00:21,  3.25it/s] 65%|██████▌   | 127/195 [00:56<00:21,  3.20it/s] 66%|██████▌   | 128/195 [00:57<00:19,  3.43it/s] 66%|██████▌   | 129/195 [00:57<00:20,  3.17it/s] 67%|██████▋   | 131/195 [00:58<00:18,  3.46it/s] 68%|██████▊   | 133/195 [00:58<00:16,  3.74it/s] 69%|██████▊   | 134/195 [00:58<00:15,  3.92it/s] 69%|██████▉   | 135/195 [00:59<00:16,  3.58it/s] 70%|███████   | 137/195 [00:59<00:14,  3.90it/s] 71%|███████   | 138/195 [00:59<00:14,  4.02it/s] 71%|███████▏  | 139/195 [01:00<00:15,  3.69it/s] 72%|███████▏  | 140/195 [01:00<00:14,  3.91it/s] 72%|███████▏  | 141/195 [01:00<00:14,  3.73it/s] 73%|███████▎  | 142/195 [01:00<00:13,  3.86it/s] 73%|███████▎  | 143/195 [01:01<00:14,  3.68it/s] 74%|███████▍  | 144/195 [01:01<00:13,  3.87it/s] 74%|███████▍  | 145/195 [01:01<00:13,  3.74it/s] 75%|███████▍  | 146/195 [01:01<00:12,  3.94it/s] 75%|███████▌  | 147/195 [01:02<00:12,  3.83it/s] 76%|███████▌  | 148/195 [01:02<00:11,  4.10it/s] 76%|███████▋  | 149/195 [01:02<00:12,  3.71it/s] 77%|███████▋  | 150/195 [01:03<00:11,  3.83it/s] 77%|███████▋  | 151/195 [01:03<00:13,  3.37it/s] 78%|███████▊  | 152/195 [01:03<00:11,  3.61it/s] 78%|███████▊  | 153/195 [01:03<00:12,  3.39it/s] 79%|███████▉  | 154/195 [01:04<00:11,  3.53it/s] 79%|███████▉  | 155/195 [01:04<00:11,  3.38it/s] 80%|████████  | 156/195 [01:04<00:10,  3.57it/s] 81%|████████  | 157/195 [01:05<00:10,  3.80it/s] 81%|████████  | 158/195 [01:05<00:10,  3.69it/s] 82%|████████▏ | 159/195 [01:05<00:09,  3.99it/s] 82%|████████▏ | 160/195 [01:05<00:09,  3.69it/s] 83%|████████▎ | 161/195 [01:06<00:08,  4.04it/s] 83%|████████▎ | 162/195 [01:06<00:08,  3.76it/s] 84%|████████▎ | 163/195 [01:06<00:07,  4.07it/s] 84%|████████▍ | 164/195 [01:06<00:07,  3.89it/s] 85%|████████▍ | 165/195 [01:06<00:07,  4.27it/s] 85%|████████▌ | 166/195 [01:07<00:07,  3.97it/s] 86%|████████▌ | 167/195 [01:07<00:06,  4.02it/s] 86%|████████▌ | 168/195 [01:07<00:07,  3.70it/s] 87%|████████▋ | 169/195 [01:08<00:06,  3.86it/s] 87%|████████▋ | 170/195 [01:08<00:06,  3.66it/s] 88%|████████▊ | 171/195 [01:08<00:06,  3.90it/s] 88%|████████▊ | 172/195 [01:08<00:06,  3.63it/s] 89%|████████▊ | 173/195 [01:09<00:05,  3.84it/s] 89%|████████▉ | 174/195 [01:09<00:05,  3.52it/s] 90%|█████████ | 176/195 [01:09<00:05,  3.67it/s] 91%|█████████ | 177/195 [01:10<00:04,  3.88it/s] 91%|█████████▏| 178/195 [01:10<00:04,  3.72it/s] 92%|█████████▏| 179/195 [01:10<00:04,  3.70it/s] 92%|█████████▏| 180/195 [01:11<00:04,  3.65it/s] 93%|█████████▎| 181/195 [01:11<00:03,  3.79it/s] 93%|█████████▎| 182/195 [01:11<00:03,  3.64it/s] 94%|█████████▍| 183/195 [01:11<00:03,  3.65it/s] 94%|█████████▍| 184/195 [01:12<00:03,  3.54it/s] 95%|█████████▍| 185/195 [01:12<00:02,  3.71it/s] 95%|█████████▌| 186/195 [01:12<00:02,  3.60it/s] 96%|█████████▌| 187/195 [01:12<00:02,  3.77it/s] 96%|█████████▋| 188/195 [01:13<00:02,  3.45it/s] 97%|█████████▋| 189/195 [01:13<00:01,  3.69it/s] 97%|█████████▋| 190/195 [01:13<00:01,  3.44it/s] 98%|█████████▊| 191/195 [01:14<00:01,  3.69it/s] 98%|█████████▊| 192/195 [01:14<00:00,  3.44it/s] 99%|█████████▉| 193/195 [01:14<00:00,  3.78it/s] 99%|█████████▉| 194/195 [01:14<00:00,  3.71it/s]100%|██████████| 195/195 [01:17<00:00,  2.53it/s]
2025-09-24 09:32:00 [info     ] Validating outputs
2025-09-24 09:32:00 [info     ] Predict - end                  time=0:1:17
2025-09-24 09:32:00 [info     ] Evaluate - start               split=test
2025-09-24 09:32:00 [info     ] Evaluate - end                 answer_distr=[0.27, 0.28, 0.24, 0.21] correctness_llm=0.76 llm_group_correctness=[0.74, 0.67, 0.74, 0.87, 0.77] monotonicity=-0.08
2025-09-24 09:32:00 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:32:00 [info     ] Augmenting questions for IRT estimation num_questions=24
2025-09-24 09:32:00 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:32:00 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 915.70it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3470.04it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 566.84it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5629.94it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 863.00it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 1172.79it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 598.93it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5147.29it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 922.58it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3591.57it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 583.88it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5297.75it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 893.57it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3262.42it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 690.47it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5187.30it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1070.60it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3596.38it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 600.32it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5566.96it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 940.04it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3516.90it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 623.08it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5269.23it/s]
2025-09-24 09:32:04 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 09:32:04 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:32:04 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:32:04 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:32:04 [info     ] Evaluate question difficulty - end mae=1.7 rmse=2.2 split=test
2025-09-24 09:32:04 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 3 finished: 0:1:31

 ========== Config: llama3.1:8b~T_1.0~SO_student_bool_nocontext~L_5~SP_student_dbe_miscons_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_dbe_studentlevel_random1 ==========
Config 5/16

 ********** Run: 1/3 **********
2025-09-24 09:32:24 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:32:24 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:32:24 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:32:24 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:32:26 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:32:26 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:32:31 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:32:31 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:32:31 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:32:31 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:32:34 [info     ] Setting seed                   value=43
2025-09-24 09:32:34 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 09:32:34 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_random native_structured_output=True num_examples=1 system_prompt=student_dbe_miscons_level_context
2025-09-24 09:32:34 [info     ] Building example selector
2025-09-24 09:32:34 [info     ] Building model                 name=llama3.1:8b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:32:34 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:10<35:25, 10.95s/it]  1%|          | 2/195 [00:12<16:55,  5.26s/it]  2%|▏         | 3/195 [00:12<09:35,  3.00s/it]  2%|▏         | 4/195 [00:14<08:04,  2.54s/it]  3%|▎         | 5/195 [00:15<06:30,  2.06s/it]  4%|▎         | 7/195 [00:16<03:59,  1.27s/it]  4%|▍         | 8/195 [00:16<03:14,  1.04s/it]  5%|▍         | 9/195 [00:17<02:53,  1.07it/s]  6%|▌         | 11/195 [00:18<02:04,  1.48it/s]  6%|▌         | 12/195 [00:18<01:43,  1.77it/s]  7%|▋         | 13/195 [00:19<01:39,  1.82it/s]  7%|▋         | 14/195 [00:19<01:38,  1.84it/s]  8%|▊         | 15/195 [00:19<01:29,  2.02it/s]  8%|▊         | 16/195 [00:20<01:38,  1.81it/s]  9%|▉         | 18/195 [00:21<01:35,  1.84it/s] 10%|█         | 20/195 [00:22<01:20,  2.16it/s] 11%|█         | 21/195 [00:22<01:12,  2.40it/s] 11%|█▏        | 22/195 [00:22<01:07,  2.57it/s] 12%|█▏        | 23/195 [00:23<01:09,  2.48it/s] 12%|█▏        | 24/195 [00:23<01:05,  2.61it/s] 13%|█▎        | 25/195 [00:24<01:15,  2.25it/s] 14%|█▍        | 27/195 [00:25<01:14,  2.25it/s] 14%|█▍        | 28/195 [00:25<01:10,  2.37it/s] 15%|█▍        | 29/195 [00:26<01:16,  2.17it/s] 15%|█▌        | 30/195 [00:26<01:07,  2.45it/s] 16%|█▌        | 31/195 [00:27<01:22,  1.98it/s] 16%|█▋        | 32/195 [00:27<01:11,  2.27it/s] 17%|█▋        | 33/195 [00:28<01:25,  1.89it/s] 17%|█▋        | 34/195 [00:28<01:20,  1.99it/s] 18%|█▊        | 35/195 [00:29<01:35,  1.67it/s] 18%|█▊        | 36/195 [00:29<01:21,  1.96it/s] 19%|█▉        | 37/195 [00:30<01:23,  1.90it/s] 20%|██        | 39/195 [00:31<01:18,  1.98it/s] 21%|██        | 41/195 [00:31<01:06,  2.33it/s] 22%|██▏       | 42/195 [00:32<01:00,  2.54it/s] 22%|██▏       | 43/195 [00:32<01:12,  2.10it/s] 23%|██▎       | 44/195 [00:33<01:09,  2.17it/s] 23%|██▎       | 45/195 [00:33<01:08,  2.20it/s] 24%|██▍       | 47/195 [00:34<00:57,  2.59it/s] 25%|██▍       | 48/195 [00:34<00:54,  2.69it/s] 25%|██▌       | 49/195 [00:35<01:01,  2.37it/s] 26%|██▌       | 50/195 [00:35<01:13,  1.98it/s] 26%|██▌       | 51/195 [00:36<01:03,  2.26it/s] 27%|██▋       | 52/195 [00:36<01:10,  2.04it/s] 27%|██▋       | 53/195 [00:37<01:10,  2.02it/s] 28%|██▊       | 54/195 [00:37<01:10,  2.00it/s] 28%|██▊       | 55/195 [00:38<01:08,  2.04it/s] 29%|██▊       | 56/195 [00:39<01:16,  1.83it/s] 29%|██▉       | 57/195 [00:39<01:04,  2.15it/s] 30%|██▉       | 58/195 [00:40<01:14,  1.84it/s] 31%|███       | 60/195 [00:40<01:04,  2.10it/s] 31%|███▏      | 61/195 [00:41<01:01,  2.18it/s] 32%|███▏      | 62/195 [00:41<01:01,  2.17it/s] 32%|███▏      | 63/195 [00:42<00:56,  2.32it/s] 33%|███▎      | 64/195 [00:42<01:02,  2.09it/s] 33%|███▎      | 65/195 [00:43<01:01,  2.12it/s] 34%|███▍      | 66/195 [00:43<00:57,  2.25it/s] 34%|███▍      | 67/195 [00:43<00:49,  2.60it/s] 35%|███▍      | 68/195 [00:44<00:52,  2.42it/s] 35%|███▌      | 69/195 [00:44<00:45,  2.77it/s] 36%|███▌      | 70/195 [00:45<00:55,  2.26it/s] 37%|███▋      | 72/195 [00:45<00:54,  2.27it/s] 37%|███▋      | 73/195 [00:46<00:52,  2.31it/s] 38%|███▊      | 74/195 [00:46<00:55,  2.17it/s] 39%|███▉      | 76/195 [00:47<00:46,  2.57it/s] 39%|███▉      | 77/195 [00:47<00:42,  2.79it/s] 40%|████      | 78/195 [00:48<00:44,  2.64it/s] 41%|████      | 80/195 [00:48<00:43,  2.62it/s] 42%|████▏     | 81/195 [00:49<00:43,  2.63it/s] 42%|████▏     | 82/195 [00:49<00:48,  2.31it/s] 43%|████▎     | 84/195 [00:50<00:50,  2.20it/s] 44%|████▍     | 86/195 [00:51<00:44,  2.47it/s] 45%|████▍     | 87/195 [00:51<00:40,  2.70it/s] 45%|████▌     | 88/195 [00:52<00:39,  2.71it/s] 46%|████▌     | 89/195 [00:52<00:43,  2.42it/s] 47%|████▋     | 91/195 [00:53<00:41,  2.49it/s] 47%|████▋     | 92/195 [00:53<00:42,  2.43it/s] 48%|████▊     | 93/195 [00:54<00:39,  2.61it/s] 48%|████▊     | 94/195 [00:54<00:41,  2.44it/s] 49%|████▊     | 95/195 [00:55<00:39,  2.50it/s] 49%|████▉     | 96/195 [00:55<00:35,  2.76it/s] 50%|████▉     | 97/195 [00:55<00:37,  2.64it/s] 50%|█████     | 98/195 [00:55<00:31,  3.09it/s] 51%|█████     | 99/195 [00:56<00:37,  2.57it/s] 52%|█████▏    | 101/195 [00:57<00:39,  2.37it/s] 52%|█████▏    | 102/195 [00:57<00:42,  2.21it/s] 53%|█████▎    | 103/195 [00:58<00:43,  2.11it/s] 53%|█████▎    | 104/195 [00:59<00:50,  1.80it/s] 54%|█████▍    | 105/195 [00:59<00:48,  1.85it/s] 54%|█████▍    | 106/195 [01:00<00:59,  1.51it/s] 55%|█████▌    | 108/195 [01:01<00:52,  1.65it/s] 56%|█████▌    | 109/195 [01:02<00:47,  1.80it/s] 56%|█████▋    | 110/195 [01:02<00:47,  1.79it/s] 57%|█████▋    | 111/195 [01:03<00:40,  2.07it/s] 57%|█████▋    | 112/195 [01:03<00:45,  1.84it/s] 58%|█████▊    | 113/195 [01:04<00:37,  2.17it/s] 58%|█████▊    | 114/195 [01:04<00:42,  1.90it/s] 59%|█████▉    | 115/195 [01:05<00:44,  1.80it/s] 59%|█████▉    | 116/195 [01:05<00:46,  1.70it/s] 60%|██████    | 117/195 [01:06<00:45,  1.71it/s] 61%|██████    | 118/195 [01:07<00:43,  1.76it/s] 61%|██████    | 119/195 [01:07<00:41,  1.85it/s] 62%|██████▏   | 120/195 [01:08<00:41,  1.80it/s] 63%|██████▎   | 122/195 [01:08<00:34,  2.13it/s] 64%|██████▎   | 124/195 [01:09<00:29,  2.40it/s] 64%|██████▍   | 125/195 [01:09<00:27,  2.51it/s] 65%|██████▍   | 126/195 [01:10<00:31,  2.21it/s] 65%|██████▌   | 127/195 [01:10<00:28,  2.37it/s] 66%|██████▌   | 128/195 [01:11<00:25,  2.63it/s] 66%|██████▌   | 129/195 [01:11<00:26,  2.48it/s] 67%|██████▋   | 131/195 [01:12<00:23,  2.74it/s] 68%|██████▊   | 132/195 [01:12<00:23,  2.66it/s] 68%|██████▊   | 133/195 [01:13<00:25,  2.39it/s] 69%|██████▊   | 134/195 [01:13<00:25,  2.35it/s] 70%|██████▉   | 136/195 [01:14<00:24,  2.44it/s] 71%|███████   | 138/195 [01:15<00:21,  2.61it/s] 71%|███████▏  | 139/195 [01:15<00:21,  2.62it/s] 72%|███████▏  | 140/195 [01:16<00:24,  2.26it/s] 73%|███████▎  | 142/195 [01:16<00:21,  2.47it/s] 74%|███████▍  | 144/195 [01:17<00:20,  2.53it/s] 74%|███████▍  | 145/195 [01:17<00:19,  2.62it/s] 75%|███████▍  | 146/195 [01:18<00:17,  2.83it/s] 75%|███████▌  | 147/195 [01:18<00:18,  2.62it/s] 76%|███████▌  | 148/195 [01:18<00:17,  2.69it/s] 76%|███████▋  | 149/195 [01:19<00:16,  2.78it/s] 77%|███████▋  | 150/195 [01:19<00:18,  2.44it/s] 78%|███████▊  | 152/195 [01:20<00:16,  2.59it/s] 78%|███████▊  | 153/195 [01:20<00:15,  2.73it/s] 79%|███████▉  | 154/195 [01:21<00:21,  1.90it/s] 80%|████████  | 156/195 [01:22<00:17,  2.25it/s] 81%|████████  | 157/195 [01:22<00:16,  2.35it/s] 81%|████████  | 158/195 [01:23<00:16,  2.30it/s] 82%|████████▏ | 159/195 [01:23<00:15,  2.36it/s] 82%|████████▏ | 160/195 [01:24<00:17,  2.01it/s] 83%|████████▎ | 162/195 [01:25<00:15,  2.17it/s] 84%|████████▎ | 163/195 [01:25<00:13,  2.39it/s] 84%|████████▍ | 164/195 [01:26<00:13,  2.24it/s] 85%|████████▍ | 165/195 [01:26<00:11,  2.53it/s] 85%|████████▌ | 166/195 [01:26<00:11,  2.58it/s] 86%|████████▌ | 167/195 [01:26<00:10,  2.69it/s] 86%|████████▌ | 168/195 [01:27<00:10,  2.54it/s] 87%|████████▋ | 169/195 [01:27<00:09,  2.65it/s] 87%|████████▋ | 170/195 [01:28<00:12,  2.04it/s] 88%|████████▊ | 172/195 [01:29<00:10,  2.13it/s] 89%|████████▊ | 173/195 [01:29<00:09,  2.35it/s] 89%|████████▉ | 174/195 [01:30<00:08,  2.42it/s] 90%|████████▉ | 175/195 [01:30<00:07,  2.54it/s] 90%|█████████ | 176/195 [01:30<00:08,  2.30it/s] 91%|█████████▏| 178/195 [01:31<00:07,  2.17it/s] 92%|█████████▏| 179/195 [01:32<00:07,  2.01it/s] 92%|█████████▏| 180/195 [01:33<00:08,  1.84it/s] 93%|█████████▎| 181/195 [01:33<00:07,  1.96it/s] 93%|█████████▎| 182/195 [01:34<00:06,  2.15it/s] 94%|█████████▍| 183/195 [01:34<00:05,  2.06it/s] 94%|█████████▍| 184/195 [01:35<00:05,  2.11it/s] 95%|█████████▍| 185/195 [01:35<00:04,  2.06it/s] 95%|█████████▌| 186/195 [01:35<00:03,  2.28it/s] 96%|█████████▌| 187/195 [01:36<00:03,  2.03it/s] 97%|█████████▋| 189/195 [01:37<00:02,  2.54it/s] 97%|█████████▋| 190/195 [01:37<00:01,  2.56it/s] 98%|█████████▊| 191/195 [01:37<00:01,  2.67it/s] 98%|█████████▊| 192/195 [01:38<00:01,  2.55it/s] 99%|█████████▉| 193/195 [01:38<00:00,  2.68it/s] 99%|█████████▉| 194/195 [01:39<00:00,  2.11it/s]100%|██████████| 195/195 [01:39<00:00,  2.59it/s]100%|██████████| 195/195 [01:41<00:00,  1.92it/s]
2025-09-24 09:34:16 [info     ] Validating outputs
2025-09-24 09:34:16 [info     ] Predict - end                  time=0:1:41
2025-09-24 09:34:16 [info     ] Evaluate - start               split=test
2025-09-24 09:34:16 [info     ] Evaluate - end                 answer_distr=[0.19, 0.16, 0.3, 0.33] correctness_llm=0.39 llm_group_correctness=[0.33, 0.36, 0.36, 0.49, 0.44] monotonicity=0.58
2025-09-24 09:34:16 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:34:16 [info     ] Augmenting questions for IRT estimation num_questions=5
2025-09-24 09:34:16 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:34:16 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1323.36it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3548.17it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 510.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7777.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1084.04it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3644.38it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 594.85it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7547.59it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1006.41it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3409.01it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 624.72it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7922.32it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1056.99it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3546.10it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 608.18it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7675.85it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1008.73it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3656.92it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 614.07it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7767.23it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1079.26it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3311.36it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 593.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8816.86it/s]
2025-09-24 09:34:20 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 09:34:20 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:34:20 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:34:20 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:34:20 [info     ] Evaluate question difficulty - end mae=1.53 rmse=1.97 split=test
2025-09-24 09:34:20 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 1 finished: 0:1:56

 ********** Run: 2/3 **********
2025-09-24 09:34:38 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:34:38 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:34:38 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:34:38 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:34:40 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:34:40 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:34:44 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:34:44 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:34:44 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:34:45 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:34:48 [info     ] Setting seed                   value=44
2025-09-24 09:34:48 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 09:34:48 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_random native_structured_output=True num_examples=1 system_prompt=student_dbe_miscons_level_context
2025-09-24 09:34:48 [info     ] Building example selector
2025-09-24 09:34:48 [info     ] Building model                 name=llama3.1:8b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:34:48 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:08<26:09,  8.09s/it]  2%|▏         | 3/195 [00:09<08:09,  2.55s/it]  2%|▏         | 4/195 [00:09<05:58,  1.88s/it]  3%|▎         | 6/195 [00:10<03:27,  1.10s/it]  4%|▎         | 7/195 [00:10<02:54,  1.08it/s]  4%|▍         | 8/195 [00:11<02:49,  1.11it/s]  5%|▍         | 9/195 [00:12<02:32,  1.22it/s]  5%|▌         | 10/195 [00:12<02:12,  1.40it/s]  6%|▌         | 11/195 [00:13<01:47,  1.72it/s]  6%|▌         | 12/195 [00:13<01:45,  1.73it/s]  7%|▋         | 14/195 [00:14<01:45,  1.71it/s]  8%|▊         | 15/195 [00:15<01:37,  1.84it/s]  8%|▊         | 16/195 [00:15<01:30,  1.97it/s]  9%|▊         | 17/195 [00:15<01:13,  2.43it/s]  9%|▉         | 18/195 [00:16<01:12,  2.43it/s] 10%|▉         | 19/195 [00:16<01:03,  2.77it/s] 10%|█         | 20/195 [00:17<01:27,  2.00it/s] 11%|█         | 21/195 [00:17<01:16,  2.28it/s] 11%|█▏        | 22/195 [00:18<01:45,  1.64it/s] 12%|█▏        | 23/195 [00:19<01:36,  1.78it/s] 12%|█▏        | 24/195 [00:19<01:30,  1.89it/s] 13%|█▎        | 26/195 [00:20<01:15,  2.23it/s] 14%|█▍        | 28/195 [00:20<01:07,  2.48it/s] 15%|█▍        | 29/195 [00:21<01:11,  2.33it/s] 15%|█▌        | 30/195 [00:21<01:12,  2.28it/s] 16%|█▌        | 31/195 [00:22<01:11,  2.31it/s] 16%|█▋        | 32/195 [00:22<01:03,  2.58it/s] 17%|█▋        | 33/195 [00:23<01:09,  2.32it/s] 18%|█▊        | 35/195 [00:23<01:08,  2.34it/s] 18%|█▊        | 36/195 [00:24<01:03,  2.52it/s] 19%|█▉        | 37/195 [00:24<01:06,  2.39it/s] 19%|█▉        | 38/195 [00:25<01:09,  2.25it/s] 20%|██        | 39/195 [00:25<01:12,  2.15it/s] 21%|██        | 41/195 [00:26<01:10,  2.20it/s] 22%|██▏       | 42/195 [00:27<01:06,  2.31it/s] 22%|██▏       | 43/195 [00:27<01:06,  2.27it/s] 23%|██▎       | 44/195 [00:28<01:08,  2.20it/s] 23%|██▎       | 45/195 [00:28<01:12,  2.07it/s] 24%|██▍       | 47/195 [00:29<00:59,  2.48it/s] 25%|██▌       | 49/195 [00:29<00:57,  2.54it/s] 26%|██▌       | 50/195 [00:30<00:53,  2.72it/s] 26%|██▌       | 51/195 [00:30<01:03,  2.28it/s] 27%|██▋       | 52/195 [00:31<01:04,  2.23it/s] 27%|██▋       | 53/195 [00:31<01:08,  2.08it/s] 28%|██▊       | 54/195 [00:32<01:05,  2.16it/s] 28%|██▊       | 55/195 [00:32<01:06,  2.10it/s] 29%|██▊       | 56/195 [00:33<01:11,  1.93it/s] 29%|██▉       | 57/195 [00:33<01:01,  2.26it/s] 30%|██▉       | 58/195 [00:34<01:20,  1.71it/s] 31%|███       | 60/195 [00:35<01:04,  2.08it/s] 32%|███▏      | 62/195 [00:35<00:52,  2.53it/s] 32%|███▏      | 63/195 [00:36<00:48,  2.70it/s] 33%|███▎      | 64/195 [00:36<00:55,  2.36it/s] 33%|███▎      | 65/195 [00:37<00:49,  2.64it/s] 34%|███▍      | 66/195 [00:37<00:55,  2.32it/s] 35%|███▍      | 68/195 [00:38<00:49,  2.55it/s] 36%|███▌      | 70/195 [00:39<00:52,  2.40it/s] 36%|███▋      | 71/195 [00:39<00:49,  2.53it/s] 37%|███▋      | 72/195 [00:40<00:56,  2.16it/s] 38%|███▊      | 74/195 [00:41<00:55,  2.16it/s] 39%|███▉      | 76/195 [00:42<00:57,  2.09it/s] 39%|███▉      | 77/195 [00:42<00:50,  2.31it/s] 40%|████      | 78/195 [00:43<00:59,  1.98it/s] 41%|████      | 80/195 [00:43<00:50,  2.26it/s] 42%|████▏     | 81/195 [00:44<00:45,  2.48it/s] 42%|████▏     | 82/195 [00:44<00:52,  2.15it/s] 43%|████▎     | 84/195 [00:45<00:42,  2.60it/s] 44%|████▎     | 85/195 [00:45<00:42,  2.58it/s] 44%|████▍     | 86/195 [00:46<00:44,  2.47it/s] 45%|████▍     | 87/195 [00:46<00:38,  2.81it/s] 45%|████▌     | 88/195 [00:46<00:42,  2.53it/s] 46%|████▌     | 89/195 [00:47<00:44,  2.39it/s] 46%|████▌     | 90/195 [00:47<00:49,  2.10it/s] 47%|████▋     | 92/195 [00:48<00:43,  2.38it/s] 48%|████▊     | 93/195 [00:49<00:42,  2.38it/s] 48%|████▊     | 94/195 [00:49<00:49,  2.04it/s] 49%|████▊     | 95/195 [00:50<00:44,  2.24it/s] 49%|████▉     | 96/195 [00:50<00:40,  2.44it/s] 50%|████▉     | 97/195 [00:51<00:47,  2.07it/s] 50%|█████     | 98/195 [00:51<00:40,  2.37it/s] 51%|█████     | 99/195 [00:51<00:42,  2.27it/s] 52%|█████▏    | 101/195 [00:52<00:46,  2.03it/s] 52%|█████▏    | 102/195 [00:53<00:49,  1.87it/s] 53%|█████▎    | 103/195 [00:54<00:50,  1.84it/s] 53%|█████▎    | 104/195 [00:55<00:56,  1.60it/s] 54%|█████▍    | 106/195 [00:56<00:50,  1.76it/s] 55%|█████▍    | 107/195 [00:56<00:46,  1.90it/s] 55%|█████▌    | 108/195 [00:56<00:45,  1.92it/s] 56%|█████▌    | 109/195 [00:57<00:46,  1.85it/s] 56%|█████▋    | 110/195 [00:58<00:54,  1.55it/s] 57%|█████▋    | 111/195 [00:58<00:49,  1.70it/s] 57%|█████▋    | 112/195 [00:59<00:50,  1.63it/s] 58%|█████▊    | 114/195 [01:00<00:45,  1.79it/s] 59%|█████▉    | 115/195 [01:00<00:38,  2.08it/s] 59%|█████▉    | 116/195 [01:01<00:41,  1.89it/s] 60%|██████    | 117/195 [01:02<00:42,  1.85it/s] 61%|██████    | 118/195 [01:02<00:36,  2.13it/s] 61%|██████    | 119/195 [01:03<00:43,  1.75it/s] 62%|██████▏   | 120/195 [01:03<00:35,  2.09it/s] 62%|██████▏   | 121/195 [01:03<00:36,  2.04it/s] 63%|██████▎   | 122/195 [01:04<00:32,  2.25it/s] 63%|██████▎   | 123/195 [01:04<00:31,  2.26it/s] 64%|██████▎   | 124/195 [01:04<00:29,  2.45it/s] 64%|██████▍   | 125/195 [01:05<00:29,  2.37it/s] 65%|██████▍   | 126/195 [01:05<00:30,  2.26it/s] 65%|██████▌   | 127/195 [01:06<00:29,  2.34it/s] 66%|██████▌   | 128/195 [01:06<00:29,  2.29it/s] 66%|██████▌   | 129/195 [01:07<00:27,  2.44it/s] 67%|██████▋   | 130/195 [01:07<00:24,  2.64it/s] 67%|██████▋   | 131/195 [01:07<00:24,  2.65it/s] 68%|██████▊   | 132/195 [01:08<00:24,  2.58it/s] 68%|██████▊   | 133/195 [01:09<00:31,  1.97it/s] 69%|██████▊   | 134/195 [01:09<00:27,  2.20it/s] 69%|██████▉   | 135/195 [01:09<00:28,  2.08it/s] 70%|███████   | 137/195 [01:10<00:28,  2.04it/s] 71%|███████▏  | 139/195 [01:11<00:24,  2.29it/s] 72%|███████▏  | 141/195 [01:12<00:20,  2.58it/s] 73%|███████▎  | 142/195 [01:12<00:20,  2.59it/s] 73%|███████▎  | 143/195 [01:12<00:20,  2.58it/s] 74%|███████▍  | 144/195 [01:13<00:20,  2.51it/s] 74%|███████▍  | 145/195 [01:14<00:22,  2.22it/s] 75%|███████▌  | 147/195 [01:14<00:20,  2.30it/s] 76%|███████▋  | 149/195 [01:15<00:18,  2.54it/s] 77%|███████▋  | 150/195 [01:15<00:17,  2.61it/s] 77%|███████▋  | 151/195 [01:16<00:18,  2.41it/s] 78%|███████▊  | 152/195 [01:16<00:16,  2.67it/s] 78%|███████▊  | 153/195 [01:17<00:20,  2.03it/s] 79%|███████▉  | 155/195 [01:18<00:18,  2.20it/s] 80%|████████  | 156/195 [01:18<00:18,  2.11it/s] 81%|████████  | 157/195 [01:19<00:15,  2.39it/s] 81%|████████  | 158/195 [01:19<00:14,  2.47it/s] 82%|████████▏ | 159/195 [01:19<00:14,  2.41it/s] 83%|████████▎ | 161/195 [01:20<00:12,  2.70it/s] 83%|████████▎ | 162/195 [01:20<00:12,  2.64it/s] 84%|████████▎ | 163/195 [01:21<00:10,  3.05it/s] 84%|████████▍ | 164/195 [01:21<00:11,  2.66it/s] 85%|████████▌ | 166/195 [01:22<00:10,  2.82it/s] 86%|████████▌ | 167/195 [01:22<00:09,  2.84it/s] 86%|████████▌ | 168/195 [01:22<00:09,  2.91it/s] 87%|████████▋ | 169/195 [01:23<00:09,  2.73it/s] 87%|████████▋ | 170/195 [01:23<00:10,  2.33it/s] 88%|████████▊ | 172/195 [01:24<00:08,  2.57it/s] 89%|████████▊ | 173/195 [01:24<00:08,  2.67it/s] 89%|████████▉ | 174/195 [01:25<00:08,  2.47it/s] 90%|████████▉ | 175/195 [01:25<00:07,  2.64it/s] 90%|█████████ | 176/195 [01:26<00:07,  2.48it/s] 91%|█████████ | 177/195 [01:26<00:06,  2.76it/s] 91%|█████████▏| 178/195 [01:27<00:07,  2.22it/s] 92%|█████████▏| 179/195 [01:27<00:06,  2.36it/s] 92%|█████████▏| 180/195 [01:27<00:06,  2.34it/s] 93%|█████████▎| 181/195 [01:28<00:06,  2.27it/s] 93%|█████████▎| 182/195 [01:28<00:05,  2.46it/s] 94%|█████████▍| 183/195 [01:28<00:04,  2.67it/s] 94%|█████████▍| 184/195 [01:29<00:04,  2.20it/s] 95%|█████████▍| 185/195 [01:29<00:04,  2.40it/s] 95%|█████████▌| 186/195 [01:30<00:03,  2.58it/s] 96%|█████████▌| 187/195 [01:30<00:03,  2.22it/s] 96%|█████████▋| 188/195 [01:31<00:03,  2.33it/s] 97%|█████████▋| 189/195 [01:32<00:03,  1.73it/s] 98%|█████████▊| 191/195 [01:33<00:02,  1.91it/s] 98%|█████████▊| 192/195 [01:33<00:01,  2.09it/s] 99%|█████████▉| 193/195 [01:33<00:00,  2.16it/s] 99%|█████████▉| 194/195 [01:34<00:00,  2.42it/s]100%|██████████| 195/195 [01:34<00:00,  2.32it/s]100%|██████████| 195/195 [01:36<00:00,  2.02it/s]
2025-09-24 09:36:25 [info     ] Validating outputs
2025-09-24 09:36:25 [info     ] Predict - end                  time=0:1:36
2025-09-24 09:36:25 [info     ] Evaluate - start               split=test
2025-09-24 09:36:25 [info     ] Evaluate - end                 answer_distr=[0.14, 0.19, 0.31, 0.33] correctness_llm=0.36 llm_group_correctness=[0.23, 0.28, 0.46, 0.41, 0.44] monotonicity=0.66
2025-09-24 09:36:25 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:36:25 [info     ] Augmenting questions for IRT estimation num_questions=6
2025-09-24 09:36:25 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:36:25 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1052.98it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3426.14it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 566.98it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6459.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1061.81it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3302.60it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 575.76it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6242.85it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 993.71it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3456.19it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 601.78it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6245.51it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 971.96it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3703.12it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 623.72it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5979.66it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 983.26it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3524.55it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 617.62it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6057.38it/s]
2025-09-24 09:36:28 INFO: EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
2025-09-24 09:36:28 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:36:28 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:36:28 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:36:28 [info     ] Evaluate question difficulty - end mae=1.56 rmse=1.95 split=test
2025-09-24 09:36:28 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 2 finished: 0:1:50

 ********** Run: 3/3 **********
2025-09-24 09:36:48 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:36:48 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:36:48 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:36:48 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:36:50 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:36:50 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:36:54 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:36:54 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:36:54 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:36:55 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:36:58 [info     ] Setting seed                   value=45
2025-09-24 09:36:58 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 09:36:58 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_random native_structured_output=True num_examples=1 system_prompt=student_dbe_miscons_level_context
2025-09-24 09:36:58 [info     ] Building example selector
2025-09-24 09:36:58 [info     ] Building model                 name=llama3.1:8b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:36:58 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:08<26:41,  8.26s/it]  1%|          | 2/195 [00:08<12:11,  3.79s/it]  2%|▏         | 3/195 [00:09<07:21,  2.30s/it]  3%|▎         | 5/195 [00:10<04:19,  1.37s/it]  3%|▎         | 6/195 [00:11<03:23,  1.08s/it]  4%|▎         | 7/195 [00:11<02:45,  1.13it/s]  4%|▍         | 8/195 [00:12<02:59,  1.04it/s]  5%|▍         | 9/195 [00:12<02:22,  1.30it/s]  5%|▌         | 10/195 [00:13<02:19,  1.33it/s]  6%|▌         | 11/195 [00:14<01:54,  1.61it/s]  6%|▌         | 12/195 [00:14<01:43,  1.76it/s]  7%|▋         | 13/195 [00:15<02:09,  1.40it/s]  7%|▋         | 14/195 [00:15<01:48,  1.67it/s]  8%|▊         | 15/195 [00:16<01:36,  1.86it/s]  8%|▊         | 16/195 [00:16<01:40,  1.78it/s]  9%|▉         | 18/195 [00:17<01:30,  1.96it/s] 10%|█         | 20/195 [00:18<01:20,  2.18it/s] 11%|█         | 21/195 [00:18<01:20,  2.17it/s] 11%|█▏        | 22/195 [00:19<01:34,  1.83it/s] 12%|█▏        | 23/195 [00:20<01:19,  2.17it/s] 12%|█▏        | 24/195 [00:20<01:33,  1.83it/s] 13%|█▎        | 26/195 [00:21<01:25,  1.97it/s] 14%|█▍        | 28/195 [00:22<01:24,  1.97it/s] 15%|█▍        | 29/195 [00:23<01:26,  1.93it/s] 16%|█▌        | 31/195 [00:24<01:26,  1.90it/s] 17%|█▋        | 33/195 [00:25<01:22,  1.96it/s] 17%|█▋        | 34/195 [00:25<01:22,  1.96it/s] 18%|█▊        | 35/195 [00:26<01:15,  2.12it/s] 18%|█▊        | 36/195 [00:26<01:10,  2.26it/s] 19%|█▉        | 37/195 [00:26<01:09,  2.28it/s] 19%|█▉        | 38/195 [00:27<01:08,  2.30it/s] 20%|██        | 39/195 [00:27<01:08,  2.28it/s] 21%|██        | 40/195 [00:28<01:03,  2.43it/s] 21%|██        | 41/195 [00:28<01:09,  2.22it/s] 22%|██▏       | 42/195 [00:28<00:59,  2.58it/s] 22%|██▏       | 43/195 [00:29<01:02,  2.42it/s] 23%|██▎       | 44/195 [00:29<00:54,  2.78it/s] 23%|██▎       | 45/195 [00:30<01:02,  2.41it/s] 24%|██▍       | 47/195 [00:30<00:55,  2.66it/s] 25%|██▌       | 49/195 [00:31<00:54,  2.66it/s] 26%|██▌       | 51/195 [00:32<00:53,  2.68it/s] 27%|██▋       | 52/195 [00:32<00:58,  2.43it/s] 28%|██▊       | 54/195 [00:33<01:05,  2.16it/s] 28%|██▊       | 55/195 [00:34<01:03,  2.21it/s] 29%|██▊       | 56/195 [00:34<01:03,  2.18it/s] 29%|██▉       | 57/195 [00:35<00:58,  2.36it/s] 30%|██▉       | 58/195 [00:35<01:09,  1.97it/s] 31%|███       | 60/195 [00:37<01:09,  1.94it/s] 31%|███▏      | 61/195 [00:37<01:00,  2.21it/s] 32%|███▏      | 62/195 [00:37<00:58,  2.27it/s] 32%|███▏      | 63/195 [00:38<01:02,  2.13it/s] 33%|███▎      | 64/195 [00:38<01:03,  2.05it/s] 34%|███▍      | 66/195 [00:39<00:52,  2.44it/s] 35%|███▍      | 68/195 [00:40<00:47,  2.65it/s] 36%|███▌      | 70/195 [00:40<00:43,  2.88it/s] 36%|███▋      | 71/195 [00:40<00:40,  3.06it/s] 37%|███▋      | 72/195 [00:41<00:43,  2.81it/s] 37%|███▋      | 73/195 [00:41<00:47,  2.56it/s] 38%|███▊      | 74/195 [00:42<00:50,  2.40it/s] 38%|███▊      | 75/195 [00:42<00:54,  2.21it/s] 39%|███▉      | 77/195 [00:43<00:47,  2.49it/s] 40%|████      | 78/195 [00:43<00:43,  2.71it/s] 41%|████      | 79/195 [00:44<00:46,  2.49it/s] 42%|████▏     | 81/195 [00:44<00:42,  2.69it/s] 43%|████▎     | 83/195 [00:45<00:38,  2.95it/s] 43%|████▎     | 84/195 [00:46<00:44,  2.52it/s] 44%|████▎     | 85/195 [00:46<00:43,  2.50it/s] 44%|████▍     | 86/195 [00:46<00:42,  2.56it/s] 45%|████▍     | 87/195 [00:47<00:45,  2.39it/s] 46%|████▌     | 89/195 [00:48<00:41,  2.53it/s] 46%|████▌     | 90/195 [00:48<00:38,  2.70it/s] 47%|████▋     | 91/195 [00:48<00:39,  2.67it/s] 47%|████▋     | 92/195 [00:49<00:40,  2.56it/s] 48%|████▊     | 93/195 [00:49<00:39,  2.57it/s] 48%|████▊     | 94/195 [00:50<00:40,  2.50it/s] 49%|████▊     | 95/195 [00:50<00:47,  2.11it/s] 50%|████▉     | 97/195 [00:51<00:38,  2.53it/s] 50%|█████     | 98/195 [00:51<00:35,  2.72it/s] 51%|█████     | 99/195 [00:52<00:42,  2.25it/s] 51%|█████▏    | 100/195 [00:52<00:45,  2.11it/s] 52%|█████▏    | 101/195 [00:53<00:50,  1.86it/s] 52%|█████▏    | 102/195 [00:53<00:48,  1.90it/s] 53%|█████▎    | 103/195 [00:54<00:51,  1.80it/s] 54%|█████▍    | 105/195 [00:55<00:50,  1.79it/s] 54%|█████▍    | 106/195 [00:56<00:47,  1.86it/s] 55%|█████▍    | 107/195 [00:56<00:51,  1.70it/s] 55%|█████▌    | 108/195 [00:57<00:47,  1.84it/s] 56%|█████▌    | 109/195 [00:57<00:47,  1.82it/s] 56%|█████▋    | 110/195 [00:58<00:42,  1.99it/s] 57%|█████▋    | 111/195 [00:58<00:41,  2.03it/s] 57%|█████▋    | 112/195 [00:59<00:47,  1.74it/s] 58%|█████▊    | 114/195 [01:00<00:40,  1.99it/s] 59%|█████▉    | 115/195 [01:01<00:43,  1.86it/s] 59%|█████▉    | 116/195 [01:01<00:41,  1.89it/s] 60%|██████    | 117/195 [01:02<00:40,  1.91it/s] 61%|██████    | 118/195 [01:02<00:40,  1.91it/s] 61%|██████    | 119/195 [01:03<00:44,  1.70it/s] 62%|██████▏   | 120/195 [01:03<00:39,  1.92it/s] 62%|██████▏   | 121/195 [01:04<00:35,  2.07it/s] 63%|██████▎   | 123/195 [01:04<00:30,  2.39it/s] 64%|██████▎   | 124/195 [01:05<00:28,  2.52it/s] 64%|██████▍   | 125/195 [01:05<00:31,  2.21it/s] 65%|██████▌   | 127/195 [01:06<00:28,  2.41it/s] 66%|██████▌   | 128/195 [01:06<00:25,  2.64it/s] 66%|██████▌   | 129/195 [01:07<00:27,  2.37it/s] 67%|██████▋   | 130/195 [01:07<00:27,  2.39it/s] 67%|██████▋   | 131/195 [01:07<00:24,  2.59it/s] 68%|██████▊   | 132/195 [01:08<00:28,  2.22it/s] 68%|██████▊   | 133/195 [01:08<00:25,  2.39it/s] 69%|██████▊   | 134/195 [01:09<00:24,  2.50it/s] 69%|██████▉   | 135/195 [01:09<00:28,  2.13it/s] 70%|███████   | 137/195 [01:10<00:23,  2.48it/s] 71%|███████   | 138/195 [01:10<00:22,  2.57it/s] 71%|███████▏  | 139/195 [01:11<00:25,  2.20it/s] 72%|███████▏  | 140/195 [01:11<00:21,  2.53it/s] 72%|███████▏  | 141/195 [01:12<00:23,  2.33it/s] 73%|███████▎  | 142/195 [01:12<00:23,  2.27it/s] 73%|███████▎  | 143/195 [01:13<00:27,  1.88it/s] 74%|███████▍  | 145/195 [01:14<00:21,  2.31it/s] 75%|███████▍  | 146/195 [01:14<00:22,  2.22it/s] 75%|███████▌  | 147/195 [01:14<00:19,  2.50it/s] 76%|███████▌  | 148/195 [01:15<00:21,  2.17it/s] 76%|███████▋  | 149/195 [01:15<00:20,  2.27it/s] 77%|███████▋  | 150/195 [01:16<00:18,  2.41it/s] 77%|███████▋  | 151/195 [01:16<00:21,  2.05it/s] 78%|███████▊  | 152/195 [01:17<00:20,  2.08it/s] 78%|███████▊  | 153/195 [01:17<00:20,  2.05it/s] 79%|███████▉  | 154/195 [01:18<00:20,  2.01it/s] 79%|███████▉  | 155/195 [01:18<00:17,  2.31it/s] 80%|████████  | 156/195 [01:19<00:16,  2.31it/s] 81%|████████  | 158/195 [01:19<00:14,  2.58it/s] 82%|████████▏ | 159/195 [01:20<00:13,  2.61it/s] 82%|████████▏ | 160/195 [01:20<00:11,  2.93it/s] 83%|████████▎ | 161/195 [01:20<00:11,  2.96it/s] 83%|████████▎ | 162/195 [01:21<00:11,  2.97it/s] 84%|████████▎ | 163/195 [01:21<00:10,  2.95it/s] 84%|████████▍ | 164/195 [01:21<00:09,  3.23it/s] 85%|████████▍ | 165/195 [01:22<00:10,  2.92it/s] 85%|████████▌ | 166/195 [01:22<00:12,  2.27it/s] 86%|████████▌ | 167/195 [01:23<00:12,  2.31it/s] 86%|████████▌ | 168/195 [01:23<00:13,  2.06it/s] 87%|████████▋ | 169/195 [01:24<00:13,  1.91it/s] 88%|████████▊ | 171/195 [01:25<00:10,  2.24it/s] 89%|████████▊ | 173/195 [01:25<00:09,  2.42it/s] 89%|████████▉ | 174/195 [01:26<00:08,  2.53it/s] 90%|████████▉ | 175/195 [01:26<00:09,  2.12it/s] 90%|█████████ | 176/195 [01:27<00:07,  2.45it/s] 91%|█████████ | 177/195 [01:28<00:10,  1.72it/s] 91%|█████████▏| 178/195 [01:28<00:08,  2.03it/s] 92%|█████████▏| 179/195 [01:28<00:08,  1.95it/s] 92%|█████████▏| 180/195 [01:29<00:07,  1.93it/s] 93%|█████████▎| 181/195 [01:29<00:06,  2.16it/s] 93%|█████████▎| 182/195 [01:30<00:06,  1.97it/s] 94%|█████████▍| 184/195 [01:31<00:04,  2.29it/s] 95%|█████████▍| 185/195 [01:31<00:04,  2.34it/s] 95%|█████████▌| 186/195 [01:31<00:03,  2.46it/s] 96%|█████████▌| 187/195 [01:32<00:03,  2.05it/s] 97%|█████████▋| 189/195 [01:33<00:02,  2.23it/s] 98%|█████████▊| 191/195 [01:34<00:01,  2.40it/s] 98%|█████████▊| 192/195 [01:34<00:01,  2.59it/s] 99%|█████████▉| 193/195 [01:34<00:00,  2.34it/s] 99%|█████████▉| 194/195 [01:35<00:00,  2.40it/s]100%|██████████| 195/195 [01:35<00:00,  2.54it/s]100%|██████████| 195/195 [01:37<00:00,  1.99it/s]
2025-09-24 09:38:36 [info     ] Validating outputs
2025-09-24 09:38:36 [info     ] Predict - end                  time=0:1:37
2025-09-24 09:38:36 [info     ] Evaluate - start               split=test
2025-09-24 09:38:36 [info     ] Evaluate - end                 answer_distr=[0.18, 0.21, 0.28, 0.31] correctness_llm=0.35 llm_group_correctness=[0.26, 0.26, 0.49, 0.31, 0.44] monotonicity=0.21
2025-09-24 09:38:36 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:38:36 [info     ] Augmenting questions for IRT estimation num_questions=4
2025-09-24 09:38:36 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:38:36 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1120.19it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3890.17it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 587.77it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6918.03it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 995.53it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3551.72it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 610.82it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6253.49it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1062.89it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3800.69it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 599.12it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6724.72it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1122.97it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3709.16it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 637.33it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5800.10it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 977.63it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3449.19it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 655.51it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6229.60it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1134.78it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3633.53it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 705.03it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5931.34it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1235.38it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3888.97it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 638.10it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5629.94it/s]
2025-09-24 09:38:41 INFO: EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
2025-09-24 09:38:41 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:38:41 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:38:41 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:38:41 [info     ] Evaluate question difficulty - end mae=1.35 rmse=1.61 split=test
2025-09-24 09:38:41 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 3 finished: 0:1:53

 ========== Config: llama3.2:3b~T_1.0~SO_teacher_bool_nocontext~L_5~SP_teacher_dbe_miscons_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_dbe_studentlevel_kc_exact3 ==========
Config 6/16

 ********** Run: 1/3 **********
2025-09-24 09:38:58 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:38:58 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:38:58 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:38:58 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:39:00 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:39:00 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:39:04 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:39:04 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:39:04 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:39:05 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:39:08 [info     ] Setting seed                   value=43
2025-09-24 09:39:08 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 09:39:08 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_kc_exact native_structured_output=True num_examples=3 system_prompt=teacher_dbe_miscons_level_context
2025-09-24 09:39:08 [info     ] Building example selector
2025-09-24 09:39:08 [info     ] Building model                 name=llama3.2:3b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:39:08 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:13<43:47, 13.55s/it]  1%|          | 2/195 [00:14<19:58,  6.21s/it]  2%|▏         | 3/195 [00:15<11:22,  3.56s/it]  2%|▏         | 4/195 [00:16<08:10,  2.57s/it]  3%|▎         | 5/195 [00:16<05:24,  1.71s/it]  3%|▎         | 6/195 [00:17<04:23,  1.39s/it]  4%|▎         | 7/195 [00:17<03:05,  1.01it/s]  4%|▍         | 8/195 [00:17<02:39,  1.17it/s]  5%|▍         | 9/195 [00:17<01:57,  1.58it/s]  5%|▌         | 10/195 [00:18<02:03,  1.50it/s]  6%|▌         | 11/195 [00:18<01:35,  1.93it/s]  6%|▌         | 12/195 [00:19<01:34,  1.93it/s]  7%|▋         | 13/195 [00:19<01:14,  2.46it/s]  7%|▋         | 14/195 [00:19<01:15,  2.38it/s]  8%|▊         | 15/195 [00:20<01:04,  2.80it/s]  8%|▊         | 16/195 [00:20<01:04,  2.77it/s]  9%|▊         | 17/195 [00:21<01:23,  2.13it/s]  9%|▉         | 18/195 [00:21<01:18,  2.24it/s] 10%|▉         | 19/195 [00:21<01:09,  2.53it/s] 10%|█         | 20/195 [00:22<01:08,  2.56it/s] 11%|█         | 21/195 [00:22<01:05,  2.65it/s] 11%|█▏        | 22/195 [00:22<01:03,  2.71it/s] 12%|█▏        | 23/195 [00:23<01:12,  2.36it/s] 13%|█▎        | 25/195 [00:24<01:03,  2.67it/s] 13%|█▎        | 26/195 [00:24<01:07,  2.49it/s] 14%|█▍        | 27/195 [00:24<00:57,  2.93it/s] 14%|█▍        | 28/195 [00:25<01:11,  2.35it/s] 15%|█▍        | 29/195 [00:25<01:07,  2.46it/s] 15%|█▌        | 30/195 [00:26<01:01,  2.69it/s] 16%|█▌        | 31/195 [00:26<01:03,  2.59it/s] 16%|█▋        | 32/195 [00:26<00:58,  2.77it/s] 17%|█▋        | 33/195 [00:27<00:55,  2.94it/s] 17%|█▋        | 34/195 [00:27<01:02,  2.56it/s] 18%|█▊        | 36/195 [00:28<00:51,  3.10it/s] 19%|█▉        | 37/195 [00:28<01:00,  2.62it/s] 20%|██        | 39/195 [00:29<00:58,  2.68it/s] 21%|██        | 41/195 [00:29<00:50,  3.07it/s] 22%|██▏       | 42/195 [00:30<00:44,  3.46it/s] 22%|██▏       | 43/195 [00:30<00:46,  3.26it/s] 23%|██▎       | 44/195 [00:30<00:47,  3.17it/s] 23%|██▎       | 45/195 [00:31<00:48,  3.10it/s] 24%|██▎       | 46/195 [00:31<00:40,  3.66it/s] 24%|██▍       | 47/195 [00:31<00:41,  3.54it/s] 25%|██▍       | 48/195 [00:31<00:43,  3.39it/s] 25%|██▌       | 49/195 [00:32<00:45,  3.18it/s] 26%|██▌       | 51/195 [00:32<00:49,  2.94it/s] 27%|██▋       | 52/195 [00:33<00:48,  2.95it/s] 27%|██▋       | 53/195 [00:33<00:57,  2.45it/s] 28%|██▊       | 54/195 [00:34<00:59,  2.37it/s] 28%|██▊       | 55/195 [00:34<01:01,  2.29it/s] 29%|██▊       | 56/195 [00:35<00:50,  2.74it/s] 29%|██▉       | 57/195 [00:35<01:06,  2.09it/s] 30%|██▉       | 58/195 [00:36<01:02,  2.19it/s] 30%|███       | 59/195 [00:36<01:00,  2.23it/s] 31%|███       | 60/195 [00:37<00:57,  2.34it/s] 31%|███▏      | 61/195 [00:37<00:57,  2.34it/s] 32%|███▏      | 62/195 [00:37<00:59,  2.23it/s] 32%|███▏      | 63/195 [00:38<00:58,  2.26it/s] 33%|███▎      | 64/195 [00:38<00:56,  2.33it/s] 33%|███▎      | 65/195 [00:39<01:03,  2.05it/s] 34%|███▍      | 67/195 [00:39<00:50,  2.52it/s] 35%|███▍      | 68/195 [00:40<00:44,  2.84it/s] 35%|███▌      | 69/195 [00:40<00:47,  2.68it/s] 36%|███▌      | 70/195 [00:40<00:45,  2.76it/s] 36%|███▋      | 71/195 [00:41<01:00,  2.04it/s] 37%|███▋      | 73/195 [00:42<00:50,  2.41it/s] 38%|███▊      | 74/195 [00:42<00:45,  2.65it/s] 38%|███▊      | 75/195 [00:43<00:53,  2.23it/s] 39%|███▉      | 76/195 [00:43<00:48,  2.44it/s] 39%|███▉      | 77/195 [00:44<00:47,  2.51it/s] 40%|████      | 78/195 [00:44<00:51,  2.28it/s] 41%|████      | 79/195 [00:44<00:41,  2.78it/s] 41%|████      | 80/195 [00:45<00:45,  2.55it/s] 42%|████▏     | 81/195 [00:45<00:38,  2.95it/s] 42%|████▏     | 82/195 [00:45<00:39,  2.85it/s] 43%|████▎     | 83/195 [00:46<00:35,  3.16it/s] 43%|████▎     | 84/195 [00:46<00:36,  3.05it/s] 44%|████▎     | 85/195 [00:46<00:41,  2.67it/s] 45%|████▍     | 87/195 [00:47<00:34,  3.14it/s] 46%|████▌     | 89/195 [00:47<00:32,  3.28it/s] 46%|████▌     | 90/195 [00:48<00:35,  2.93it/s] 47%|████▋     | 92/195 [00:48<00:30,  3.34it/s] 48%|████▊     | 94/195 [00:49<00:30,  3.34it/s] 49%|████▊     | 95/195 [00:49<00:28,  3.52it/s] 49%|████▉     | 96/195 [00:50<00:32,  3.03it/s] 50%|█████     | 98/195 [00:50<00:34,  2.78it/s] 51%|█████▏    | 100/195 [00:51<00:37,  2.52it/s] 52%|█████▏    | 102/195 [00:53<00:45,  2.05it/s] 53%|█████▎    | 104/195 [00:54<00:46,  1.94it/s] 54%|█████▍    | 105/195 [00:54<00:44,  2.02it/s] 54%|█████▍    | 106/195 [00:54<00:38,  2.30it/s] 55%|█████▍    | 107/195 [00:55<00:39,  2.24it/s] 55%|█████▌    | 108/195 [00:55<00:38,  2.23it/s] 56%|█████▌    | 109/195 [00:56<00:35,  2.39it/s] 56%|█████▋    | 110/195 [00:56<00:33,  2.50it/s] 57%|█████▋    | 111/195 [00:57<00:37,  2.26it/s] 57%|█████▋    | 112/195 [00:57<00:36,  2.30it/s] 58%|█████▊    | 113/195 [00:57<00:32,  2.49it/s] 58%|█████▊    | 114/195 [00:58<00:35,  2.31it/s] 59%|█████▉    | 115/195 [00:59<00:39,  2.03it/s] 59%|█████▉    | 116/195 [00:59<00:36,  2.16it/s] 60%|██████    | 117/195 [01:00<00:49,  1.59it/s] 61%|██████    | 118/195 [01:01<00:48,  1.57it/s] 61%|██████    | 119/195 [01:01<00:44,  1.72it/s] 62%|██████▏   | 120/195 [01:01<00:39,  1.88it/s] 62%|██████▏   | 121/195 [01:02<00:35,  2.09it/s] 63%|██████▎   | 122/195 [01:02<00:30,  2.43it/s] 63%|██████▎   | 123/195 [01:02<00:26,  2.76it/s] 64%|██████▎   | 124/195 [01:03<00:25,  2.80it/s] 64%|██████▍   | 125/195 [01:03<00:22,  3.11it/s] 65%|██████▍   | 126/195 [01:03<00:22,  3.13it/s] 65%|██████▌   | 127/195 [01:04<00:22,  3.06it/s] 66%|██████▌   | 128/195 [01:04<00:24,  2.79it/s] 67%|██████▋   | 130/195 [01:05<00:20,  3.13it/s] 68%|██████▊   | 132/195 [01:05<00:20,  3.01it/s] 68%|██████▊   | 133/195 [01:06<00:19,  3.17it/s] 69%|██████▊   | 134/195 [01:06<00:21,  2.83it/s] 69%|██████▉   | 135/195 [01:07<00:24,  2.45it/s] 70%|███████   | 137/195 [01:07<00:22,  2.63it/s] 71%|███████   | 138/195 [01:08<00:20,  2.81it/s] 71%|███████▏  | 139/195 [01:08<00:18,  2.99it/s] 72%|███████▏  | 140/195 [01:08<00:20,  2.71it/s] 73%|███████▎  | 142/195 [01:09<00:16,  3.14it/s] 73%|███████▎  | 143/195 [01:09<00:15,  3.32it/s] 74%|███████▍  | 144/195 [01:10<00:17,  2.87it/s] 74%|███████▍  | 145/195 [01:10<00:19,  2.62it/s] 75%|███████▍  | 146/195 [01:10<00:16,  3.03it/s] 75%|███████▌  | 147/195 [01:11<00:16,  2.93it/s] 76%|███████▌  | 148/195 [01:11<00:16,  2.89it/s] 76%|███████▋  | 149/195 [01:11<00:14,  3.11it/s] 77%|███████▋  | 150/195 [01:12<00:18,  2.41it/s] 78%|███████▊  | 152/195 [01:12<00:14,  3.00it/s] 78%|███████▊  | 153/195 [01:12<00:12,  3.43it/s] 79%|███████▉  | 154/195 [01:13<00:16,  2.49it/s] 79%|███████▉  | 155/195 [01:13<00:14,  2.85it/s] 80%|████████  | 156/195 [01:14<00:12,  3.06it/s] 81%|████████  | 157/195 [01:14<00:13,  2.90it/s] 82%|████████▏ | 159/195 [01:15<00:12,  2.94it/s] 83%|████████▎ | 161/195 [01:15<00:10,  3.22it/s] 83%|████████▎ | 162/195 [01:16<00:11,  2.92it/s] 84%|████████▎ | 163/195 [01:16<00:09,  3.43it/s] 84%|████████▍ | 164/195 [01:16<00:09,  3.12it/s] 85%|████████▍ | 165/195 [01:16<00:08,  3.36it/s] 85%|████████▌ | 166/195 [01:17<00:10,  2.86it/s] 86%|████████▌ | 167/195 [01:17<00:08,  3.41it/s] 86%|████████▌ | 168/195 [01:18<00:09,  2.94it/s] 87%|████████▋ | 170/195 [01:18<00:09,  2.76it/s] 88%|████████▊ | 172/195 [01:19<00:08,  2.72it/s] 89%|████████▊ | 173/195 [01:19<00:07,  2.93it/s] 89%|████████▉ | 174/195 [01:20<00:08,  2.45it/s] 90%|████████▉ | 175/195 [01:20<00:07,  2.63it/s] 90%|█████████ | 176/195 [01:21<00:07,  2.48it/s] 91%|█████████ | 177/195 [01:21<00:06,  2.71it/s] 91%|█████████▏| 178/195 [01:22<00:07,  2.30it/s] 92%|█████████▏| 179/195 [01:22<00:06,  2.54it/s] 92%|█████████▏| 180/195 [01:22<00:06,  2.46it/s] 93%|█████████▎| 181/195 [01:23<00:04,  2.82it/s] 93%|█████████▎| 182/195 [01:23<00:04,  2.62it/s] 94%|█████████▍| 184/195 [01:24<00:03,  2.75it/s] 95%|█████████▌| 186/195 [01:24<00:02,  3.13it/s] 96%|█████████▌| 187/195 [01:25<00:02,  2.82it/s] 97%|█████████▋| 189/195 [01:25<00:01,  3.11it/s] 97%|█████████▋| 190/195 [01:25<00:01,  3.35it/s] 98%|█████████▊| 191/195 [01:26<00:01,  2.58it/s] 98%|█████████▊| 192/195 [01:26<00:01,  2.67it/s] 99%|█████████▉| 193/195 [01:27<00:00,  2.65it/s] 99%|█████████▉| 194/195 [01:27<00:00,  2.31it/s]100%|██████████| 195/195 [01:30<00:00,  2.17it/s]
2025-09-24 09:40:38 [info     ] Validating outputs
2025-09-24 09:40:38 [info     ] Predict - end                  time=0:1:30
2025-09-24 09:40:38 [info     ] Evaluate - start               split=test
2025-09-24 09:40:38 [info     ] Evaluate - end                 answer_distr=[0.33, 0.26, 0.16, 0.25] correctness_llm=0.57 llm_group_correctness=[0.44, 0.62, 0.64, 0.62, 0.56] monotonicity=0.23
2025-09-24 09:40:38 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:40:38 [info     ] Augmenting questions for IRT estimation num_questions=8
2025-09-24 09:40:38 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:40:38 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 985.97it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3171.40it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 569.23it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5982.10it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 949.12it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3542.33it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 594.56it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6254.82it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1035.63it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3609.95it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 642.72it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5568.01it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1006.66it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3725.81it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 581.84it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5749.00it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 998.58it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3713.37it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 614.08it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6277.56it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1011.65it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3563.94it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 537.28it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7316.25it/s]
2025-09-24 09:40:43 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 09:40:43 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:40:43 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:40:43 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:40:43 [info     ] Evaluate question difficulty - end mae=1.52 rmse=1.97 split=test
2025-09-24 09:40:43 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 1 finished: 0:1:44

 ********** Run: 2/3 **********
2025-09-24 09:41:01 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:41:01 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:41:01 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:41:01 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:41:03 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:41:03 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:41:08 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:41:08 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:41:08 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:41:08 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:41:11 [info     ] Setting seed                   value=44
2025-09-24 09:41:11 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 09:41:11 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_kc_exact native_structured_output=True num_examples=3 system_prompt=teacher_dbe_miscons_level_context
2025-09-24 09:41:11 [info     ] Building example selector
2025-09-24 09:41:11 [info     ] Building model                 name=llama3.2:3b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:41:11 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:11<36:46, 11.37s/it]  1%|          | 2/195 [00:11<16:08,  5.02s/it]  2%|▏         | 3/195 [00:12<10:13,  3.20s/it]  2%|▏         | 4/195 [00:13<06:44,  2.12s/it]  3%|▎         | 5/195 [00:13<04:44,  1.50s/it]  3%|▎         | 6/195 [00:14<04:18,  1.37s/it]  4%|▎         | 7/195 [00:15<03:12,  1.02s/it]  4%|▍         | 8/195 [00:15<02:36,  1.20it/s]  5%|▍         | 9/195 [00:16<02:24,  1.29it/s]  6%|▌         | 11/195 [00:17<01:56,  1.59it/s]  6%|▌         | 12/195 [00:17<01:45,  1.73it/s]  7%|▋         | 13/195 [00:18<01:33,  1.96it/s]  7%|▋         | 14/195 [00:18<01:37,  1.86it/s]  8%|▊         | 15/195 [00:19<01:30,  1.98it/s]  8%|▊         | 16/195 [00:19<01:27,  2.05it/s]  9%|▊         | 17/195 [00:19<01:16,  2.32it/s]  9%|▉         | 18/195 [00:20<01:08,  2.57it/s] 10%|▉         | 19/195 [00:20<01:03,  2.79it/s] 10%|█         | 20/195 [00:20<00:57,  3.05it/s] 11%|█         | 21/195 [00:21<01:03,  2.73it/s] 11%|█▏        | 22/195 [00:21<01:01,  2.79it/s] 12%|█▏        | 23/195 [00:21<01:13,  2.35it/s] 13%|█▎        | 25/195 [00:22<01:03,  2.66it/s] 14%|█▍        | 27/195 [00:23<01:07,  2.48it/s] 15%|█▍        | 29/195 [00:24<00:58,  2.82it/s] 15%|█▌        | 30/195 [00:24<00:52,  3.12it/s] 16%|█▌        | 31/195 [00:24<00:58,  2.79it/s] 16%|█▋        | 32/195 [00:24<00:50,  3.22it/s] 17%|█▋        | 33/195 [00:25<01:00,  2.68it/s] 18%|█▊        | 35/195 [00:25<00:52,  3.02it/s] 19%|█▉        | 37/195 [00:26<00:53,  2.96it/s] 19%|█▉        | 38/195 [00:26<00:47,  3.29it/s] 20%|██        | 39/195 [00:27<00:52,  2.95it/s] 21%|██        | 40/195 [00:27<00:53,  2.89it/s] 21%|██        | 41/195 [00:28<00:53,  2.87it/s] 22%|██▏       | 42/195 [00:28<00:54,  2.80it/s] 22%|██▏       | 43/195 [00:28<00:53,  2.87it/s] 23%|██▎       | 44/195 [00:29<00:49,  3.07it/s] 23%|██▎       | 45/195 [00:29<00:47,  3.13it/s] 24%|██▎       | 46/195 [00:29<00:43,  3.39it/s] 24%|██▍       | 47/195 [00:29<00:39,  3.72it/s] 25%|██▍       | 48/195 [00:30<00:46,  3.15it/s] 25%|██▌       | 49/195 [00:30<00:43,  3.35it/s] 26%|██▌       | 50/195 [00:31<00:59,  2.45it/s] 26%|██▌       | 51/195 [00:31<00:48,  2.97it/s] 27%|██▋       | 52/195 [00:31<01:01,  2.33it/s] 28%|██▊       | 54/195 [00:32<00:53,  2.62it/s] 28%|██▊       | 55/195 [00:33<01:05,  2.15it/s] 29%|██▉       | 57/195 [00:33<00:57,  2.41it/s] 30%|██▉       | 58/195 [00:34<00:59,  2.30it/s] 30%|███       | 59/195 [00:34<00:55,  2.46it/s] 31%|███       | 60/195 [00:35<01:06,  2.04it/s] 32%|███▏      | 62/195 [00:36<00:55,  2.41it/s] 33%|███▎      | 64/195 [00:36<00:47,  2.77it/s] 33%|███▎      | 65/195 [00:36<00:43,  2.98it/s] 34%|███▍      | 66/195 [00:37<00:44,  2.93it/s] 34%|███▍      | 67/195 [00:37<00:40,  3.17it/s] 35%|███▍      | 68/195 [00:37<00:38,  3.26it/s] 35%|███▌      | 69/195 [00:38<00:39,  3.23it/s] 36%|███▌      | 70/195 [00:38<00:48,  2.59it/s] 37%|███▋      | 72/195 [00:39<00:42,  2.92it/s] 38%|███▊      | 74/195 [00:39<00:38,  3.13it/s] 38%|███▊      | 75/195 [00:40<00:33,  3.55it/s] 39%|███▉      | 76/195 [00:40<00:36,  3.26it/s] 39%|███▉      | 77/195 [00:40<00:34,  3.46it/s] 40%|████      | 78/195 [00:41<00:36,  3.23it/s] 41%|████      | 79/195 [00:41<00:45,  2.54it/s] 42%|████▏     | 81/195 [00:42<00:37,  3.04it/s] 42%|████▏     | 82/195 [00:42<00:34,  3.27it/s] 43%|████▎     | 83/195 [00:42<00:35,  3.16it/s] 43%|████▎     | 84/195 [00:42<00:33,  3.27it/s] 44%|████▎     | 85/195 [00:43<00:33,  3.26it/s] 44%|████▍     | 86/195 [00:43<00:31,  3.50it/s] 45%|████▍     | 87/195 [00:43<00:33,  3.21it/s] 45%|████▌     | 88/195 [00:44<00:40,  2.66it/s] 46%|████▌     | 89/195 [00:44<00:42,  2.51it/s] 46%|████▌     | 90/195 [00:45<00:42,  2.46it/s] 47%|████▋     | 91/195 [00:45<00:35,  2.93it/s] 47%|████▋     | 92/195 [00:45<00:39,  2.58it/s] 48%|████▊     | 93/195 [00:46<00:36,  2.79it/s] 48%|████▊     | 94/195 [00:46<00:35,  2.83it/s] 49%|████▊     | 95/195 [00:46<00:32,  3.11it/s] 49%|████▉     | 96/195 [00:47<00:39,  2.50it/s] 50%|████▉     | 97/195 [00:47<00:42,  2.32it/s] 50%|█████     | 98/195 [00:48<00:43,  2.22it/s] 51%|█████▏    | 100/195 [00:49<00:36,  2.62it/s] 52%|█████▏    | 101/195 [00:49<00:46,  2.03it/s] 53%|█████▎    | 103/195 [00:51<00:47,  1.92it/s] 53%|█████▎    | 104/195 [00:51<00:40,  2.22it/s] 54%|█████▍    | 105/195 [00:52<00:51,  1.76it/s] 55%|█████▍    | 107/195 [00:52<00:42,  2.05it/s] 56%|█████▌    | 109/195 [00:53<00:37,  2.28it/s] 56%|█████▋    | 110/195 [00:53<00:35,  2.37it/s] 57%|█████▋    | 111/195 [00:54<00:36,  2.32it/s] 57%|█████▋    | 112/195 [00:54<00:34,  2.42it/s] 58%|█████▊    | 113/195 [00:55<00:32,  2.53it/s] 58%|█████▊    | 114/195 [00:55<00:35,  2.31it/s] 59%|█████▉    | 116/195 [00:56<00:35,  2.22it/s] 60%|██████    | 117/195 [00:57<00:38,  2.02it/s] 61%|██████    | 118/195 [00:57<00:41,  1.85it/s] 61%|██████    | 119/195 [00:58<00:33,  2.25it/s] 62%|██████▏   | 120/195 [00:58<00:36,  2.08it/s] 62%|██████▏   | 121/195 [00:59<00:34,  2.15it/s] 63%|██████▎   | 123/195 [00:59<00:27,  2.65it/s] 64%|██████▎   | 124/195 [01:00<00:26,  2.68it/s] 65%|██████▍   | 126/195 [01:00<00:23,  2.95it/s] 65%|██████▌   | 127/195 [01:00<00:23,  2.90it/s] 66%|██████▌   | 128/195 [01:01<00:26,  2.55it/s] 67%|██████▋   | 130/195 [01:01<00:21,  3.02it/s] 68%|██████▊   | 132/195 [01:02<00:19,  3.21it/s] 68%|██████▊   | 133/195 [01:02<00:19,  3.23it/s] 69%|██████▊   | 134/195 [01:03<00:18,  3.32it/s] 69%|██████▉   | 135/195 [01:03<00:17,  3.44it/s] 70%|██████▉   | 136/195 [01:03<00:19,  2.95it/s] 71%|███████   | 138/195 [01:04<00:18,  3.05it/s] 71%|███████▏  | 139/195 [01:04<00:17,  3.26it/s] 72%|███████▏  | 140/195 [01:05<00:18,  3.00it/s] 73%|███████▎  | 142/195 [01:05<00:15,  3.32it/s] 73%|███████▎  | 143/195 [01:05<00:14,  3.52it/s] 74%|███████▍  | 144/195 [01:06<00:16,  3.12it/s] 74%|███████▍  | 145/195 [01:06<00:13,  3.62it/s] 75%|███████▍  | 146/195 [01:06<00:15,  3.19it/s] 75%|███████▌  | 147/195 [01:07<00:14,  3.25it/s] 76%|███████▌  | 148/195 [01:07<00:20,  2.28it/s] 76%|███████▋  | 149/195 [01:08<00:16,  2.75it/s] 77%|███████▋  | 150/195 [01:08<00:16,  2.72it/s] 77%|███████▋  | 151/195 [01:08<00:15,  2.85it/s] 78%|███████▊  | 152/195 [01:09<00:14,  2.97it/s] 78%|███████▊  | 153/195 [01:09<00:14,  2.97it/s] 79%|███████▉  | 154/195 [01:09<00:14,  2.79it/s] 79%|███████▉  | 155/195 [01:10<00:13,  3.01it/s] 80%|████████  | 156/195 [01:10<00:11,  3.32it/s] 81%|████████  | 157/195 [01:10<00:11,  3.39it/s] 81%|████████  | 158/195 [01:11<00:13,  2.79it/s] 82%|████████▏ | 160/195 [01:11<00:10,  3.31it/s] 83%|████████▎ | 161/195 [01:11<00:11,  3.05it/s] 83%|████████▎ | 162/195 [01:12<00:10,  3.08it/s] 84%|████████▎ | 163/195 [01:12<00:09,  3.36it/s] 84%|████████▍ | 164/195 [01:12<00:09,  3.41it/s] 85%|████████▍ | 165/195 [01:13<00:09,  3.22it/s] 85%|████████▌ | 166/195 [01:13<00:09,  3.05it/s] 86%|████████▌ | 167/195 [01:14<00:11,  2.49it/s] 87%|████████▋ | 169/195 [01:15<00:10,  2.36it/s] 88%|████████▊ | 171/195 [01:15<00:09,  2.43it/s] 89%|████████▊ | 173/195 [01:16<00:08,  2.53it/s] 89%|████████▉ | 174/195 [01:16<00:08,  2.61it/s] 90%|████████▉ | 175/195 [01:17<00:08,  2.36it/s] 90%|█████████ | 176/195 [01:17<00:06,  2.78it/s] 91%|█████████ | 177/195 [01:18<00:08,  2.20it/s] 91%|█████████▏| 178/195 [01:18<00:06,  2.54it/s] 92%|█████████▏| 179/195 [01:19<00:06,  2.31it/s] 92%|█████████▏| 180/195 [01:19<00:05,  2.51it/s] 93%|█████████▎| 181/195 [01:19<00:05,  2.60it/s] 93%|█████████▎| 182/195 [01:20<00:04,  2.84it/s] 94%|█████████▍| 183/195 [01:20<00:04,  2.65it/s] 95%|█████████▍| 185/195 [01:21<00:03,  2.93it/s] 95%|█████████▌| 186/195 [01:21<00:02,  3.33it/s] 96%|█████████▌| 187/195 [01:21<00:02,  3.05it/s] 96%|█████████▋| 188/195 [01:21<00:01,  3.60it/s] 97%|█████████▋| 189/195 [01:22<00:01,  3.13it/s] 97%|█████████▋| 190/195 [01:22<00:01,  3.11it/s] 98%|█████████▊| 191/195 [01:22<00:01,  3.10it/s] 98%|█████████▊| 192/195 [01:23<00:01,  2.91it/s] 99%|█████████▉| 193/195 [01:23<00:00,  2.59it/s] 99%|█████████▉| 194/195 [01:24<00:00,  2.55it/s]100%|██████████| 195/195 [01:26<00:00,  2.26it/s]
2025-09-24 09:42:37 [info     ] Validating outputs
2025-09-24 09:42:38 [info     ] Predict - end                  time=0:1:26
2025-09-24 09:42:38 [info     ] Evaluate - start               split=test
2025-09-24 09:42:38 [info     ] Evaluate - end                 answer_distr=[0.36, 0.23, 0.15, 0.25] correctness_llm=0.54 llm_group_correctness=[0.46, 0.44, 0.62, 0.54, 0.67] monotonicity=0.37
2025-09-24 09:42:38 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:42:38 [info     ] Augmenting questions for IRT estimation num_questions=7
2025-09-24 09:42:38 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:42:38 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1081.13it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3445.41it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 583.94it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5848.63it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 987.33it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3017.26it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 547.54it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7124.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1095.53it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 4451.58it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 653.19it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6757.22it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1006.45it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3492.64it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 591.26it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7806.47it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 990.36it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3412.85it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 626.92it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6687.96it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1149.44it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3520.98it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 693.39it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6997.17it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 997.63it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3851.97it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 636.83it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6700.17it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 999.56it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3552.03it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 599.10it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7446.14it/s]
2025-09-24 09:42:44 INFO: EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
2025-09-24 09:42:44 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:42:44 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:42:44 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:42:44 [info     ] Evaluate question difficulty - end mae=1.38 rmse=1.73 split=test
2025-09-24 09:42:44 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 2 finished: 0:1:42

 ********** Run: 3/3 **********
2025-09-24 09:43:00 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:43:00 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:43:00 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:43:00 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:43:02 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:43:02 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:43:06 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:43:06 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:43:06 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:43:07 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:43:10 [info     ] Setting seed                   value=45
2025-09-24 09:43:10 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 09:43:10 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_kc_exact native_structured_output=True num_examples=3 system_prompt=teacher_dbe_miscons_level_context
2025-09-24 09:43:10 [info     ] Building example selector
2025-09-24 09:43:10 [info     ] Building model                 name=llama3.2:3b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:43:10 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:11<36:56, 11.42s/it]  1%|          | 2/195 [00:11<15:51,  4.93s/it]  2%|▏         | 3/195 [00:13<10:34,  3.31s/it]  3%|▎         | 5/195 [00:14<05:49,  1.84s/it]  3%|▎         | 6/195 [00:14<04:18,  1.37s/it]  4%|▎         | 7/195 [00:15<03:52,  1.24s/it]  4%|▍         | 8/195 [00:16<03:03,  1.02it/s]  5%|▍         | 9/195 [00:16<02:36,  1.19it/s]  5%|▌         | 10/195 [00:16<02:10,  1.42it/s]  6%|▌         | 11/195 [00:17<01:47,  1.72it/s]  6%|▌         | 12/195 [00:17<01:47,  1.69it/s]  7%|▋         | 14/195 [00:18<01:24,  2.14it/s]  8%|▊         | 15/195 [00:18<01:17,  2.33it/s]  8%|▊         | 16/195 [00:19<01:18,  2.27it/s]  9%|▉         | 18/195 [00:20<01:09,  2.53it/s] 10%|█         | 20/195 [00:20<01:05,  2.69it/s] 11%|█         | 21/195 [00:20<01:02,  2.78it/s] 11%|█▏        | 22/195 [00:21<01:05,  2.64it/s] 12%|█▏        | 23/195 [00:21<01:03,  2.71it/s] 12%|█▏        | 24/195 [00:22<01:00,  2.83it/s] 13%|█▎        | 25/195 [00:22<01:00,  2.80it/s] 14%|█▍        | 27/195 [00:23<00:58,  2.89it/s] 14%|█▍        | 28/195 [00:23<00:55,  3.02it/s] 15%|█▍        | 29/195 [00:24<01:09,  2.38it/s] 15%|█▌        | 30/195 [00:24<01:06,  2.49it/s] 16%|█▌        | 31/195 [00:24<00:58,  2.82it/s] 16%|█▋        | 32/195 [00:25<01:01,  2.63it/s] 17%|█▋        | 33/195 [00:25<00:57,  2.81it/s] 17%|█▋        | 34/195 [00:25<00:56,  2.83it/s] 18%|█▊        | 35/195 [00:25<00:49,  3.25it/s] 18%|█▊        | 36/195 [00:26<00:47,  3.34it/s] 19%|█▉        | 37/195 [00:26<00:42,  3.69it/s] 19%|█▉        | 38/195 [00:26<00:44,  3.54it/s] 20%|██        | 39/195 [00:26<00:39,  3.94it/s] 21%|██        | 40/195 [00:27<00:44,  3.50it/s] 21%|██        | 41/195 [00:27<00:40,  3.82it/s] 22%|██▏       | 42/195 [00:27<00:50,  3.05it/s] 23%|██▎       | 44/195 [00:28<00:44,  3.38it/s] 23%|██▎       | 45/195 [00:28<00:47,  3.15it/s] 24%|██▎       | 46/195 [00:29<00:52,  2.82it/s] 24%|██▍       | 47/195 [00:29<00:58,  2.55it/s] 25%|██▌       | 49/195 [00:30<00:51,  2.85it/s] 26%|██▌       | 51/195 [00:31<00:53,  2.70it/s] 27%|██▋       | 53/195 [00:31<00:50,  2.79it/s] 28%|██▊       | 54/195 [00:32<00:48,  2.93it/s] 28%|██▊       | 55/195 [00:32<00:57,  2.43it/s] 29%|██▊       | 56/195 [00:33<00:54,  2.56it/s] 29%|██▉       | 57/195 [00:33<00:57,  2.41it/s] 30%|██▉       | 58/195 [00:34<00:55,  2.46it/s] 30%|███       | 59/195 [00:34<01:09,  1.95it/s] 31%|███▏      | 61/195 [00:35<00:59,  2.24it/s] 32%|███▏      | 62/195 [00:35<00:54,  2.45it/s] 32%|███▏      | 63/195 [00:36<01:00,  2.19it/s] 33%|███▎      | 65/195 [00:37<00:51,  2.55it/s] 34%|███▍      | 67/195 [00:37<00:43,  2.95it/s] 35%|███▍      | 68/195 [00:37<00:44,  2.88it/s] 35%|███▌      | 69/195 [00:38<00:42,  2.96it/s] 36%|███▌      | 70/195 [00:38<00:39,  3.16it/s] 36%|███▋      | 71/195 [00:38<00:44,  2.79it/s] 37%|███▋      | 73/195 [00:39<00:38,  3.13it/s] 38%|███▊      | 74/195 [00:39<00:40,  3.00it/s] 38%|███▊      | 75/195 [00:40<00:42,  2.81it/s] 39%|███▉      | 76/195 [00:40<00:41,  2.88it/s] 39%|███▉      | 77/195 [00:40<00:37,  3.14it/s] 40%|████      | 78/195 [00:41<00:45,  2.58it/s] 41%|████      | 79/195 [00:41<00:37,  3.07it/s] 41%|████      | 80/195 [00:41<00:38,  2.99it/s] 42%|████▏     | 81/195 [00:42<00:33,  3.45it/s] 42%|████▏     | 82/195 [00:42<00:38,  2.93it/s] 43%|████▎     | 83/195 [00:42<00:37,  3.00it/s] 43%|████▎     | 84/195 [00:43<00:34,  3.18it/s] 44%|████▎     | 85/195 [00:43<00:36,  3.04it/s] 44%|████▍     | 86/195 [00:43<00:32,  3.38it/s] 45%|████▍     | 87/195 [00:44<00:37,  2.91it/s] 46%|████▌     | 89/195 [00:44<00:33,  3.18it/s] 47%|████▋     | 91/195 [00:45<00:32,  3.18it/s] 47%|████▋     | 92/195 [00:45<00:30,  3.39it/s] 48%|████▊     | 93/195 [00:46<00:34,  2.95it/s] 48%|████▊     | 94/195 [00:46<00:34,  2.95it/s] 49%|████▊     | 95/195 [00:46<00:33,  2.98it/s] 49%|████▉     | 96/195 [00:47<00:34,  2.86it/s] 50%|█████     | 98/195 [00:47<00:30,  3.22it/s] 51%|█████▏    | 100/195 [00:48<00:30,  3.14it/s] 52%|█████▏    | 101/195 [00:48<00:33,  2.82it/s] 52%|█████▏    | 102/195 [00:49<00:43,  2.14it/s] 53%|█████▎    | 104/195 [00:50<00:44,  2.04it/s] 54%|█████▍    | 105/195 [00:51<00:45,  1.97it/s] 54%|█████▍    | 106/195 [00:51<00:48,  1.82it/s] 55%|█████▌    | 108/195 [00:52<00:43,  2.01it/s] 56%|█████▌    | 109/195 [00:53<00:39,  2.18it/s] 56%|█████▋    | 110/195 [00:53<00:38,  2.20it/s] 57%|█████▋    | 111/195 [00:54<00:38,  2.20it/s] 57%|█████▋    | 112/195 [00:54<00:39,  2.09it/s] 58%|█████▊    | 113/195 [00:54<00:31,  2.58it/s] 58%|█████▊    | 114/195 [00:55<00:35,  2.26it/s] 59%|█████▉    | 115/195 [00:55<00:36,  2.20it/s] 59%|█████▉    | 116/195 [00:56<00:42,  1.85it/s] 60%|██████    | 117/195 [00:57<00:44,  1.74it/s] 61%|██████    | 118/195 [00:57<00:48,  1.59it/s] 61%|██████    | 119/195 [00:58<00:47,  1.61it/s] 62%|██████▏   | 120/195 [00:59<00:45,  1.66it/s] 62%|██████▏   | 121/195 [00:59<00:39,  1.87it/s] 63%|██████▎   | 122/195 [01:00<00:41,  1.76it/s] 63%|██████▎   | 123/195 [01:00<00:34,  2.08it/s] 64%|██████▎   | 124/195 [01:00<00:31,  2.24it/s] 64%|██████▍   | 125/195 [01:01<00:31,  2.20it/s] 65%|██████▌   | 127/195 [01:01<00:25,  2.72it/s] 66%|██████▌   | 128/195 [01:02<00:25,  2.62it/s] 66%|██████▌   | 129/195 [01:02<00:23,  2.83it/s] 67%|██████▋   | 130/195 [01:02<00:22,  2.92it/s] 67%|██████▋   | 131/195 [01:03<00:21,  2.99it/s] 68%|██████▊   | 132/195 [01:03<00:23,  2.70it/s] 68%|██████▊   | 133/195 [01:03<00:23,  2.61it/s] 69%|██████▉   | 135/195 [01:04<00:19,  3.12it/s] 70%|██████▉   | 136/195 [01:04<00:16,  3.56it/s] 70%|███████   | 137/195 [01:05<00:17,  3.22it/s] 71%|███████   | 138/195 [01:05<00:16,  3.53it/s] 71%|███████▏  | 139/195 [01:05<00:15,  3.50it/s] 72%|███████▏  | 140/195 [01:05<00:14,  3.72it/s] 72%|███████▏  | 141/195 [01:05<00:14,  3.78it/s] 73%|███████▎  | 142/195 [01:06<00:13,  3.85it/s] 73%|███████▎  | 143/195 [01:06<00:14,  3.49it/s] 74%|███████▍  | 144/195 [01:07<00:17,  2.88it/s] 74%|███████▍  | 145/195 [01:07<00:16,  3.01it/s] 75%|███████▍  | 146/195 [01:07<00:19,  2.49it/s] 75%|███████▌  | 147/195 [01:08<00:17,  2.74it/s] 76%|███████▌  | 148/195 [01:08<00:15,  2.94it/s] 76%|███████▋  | 149/195 [01:08<00:15,  2.93it/s] 77%|███████▋  | 150/195 [01:09<00:14,  3.15it/s] 77%|███████▋  | 151/195 [01:09<00:17,  2.54it/s] 78%|███████▊  | 153/195 [01:10<00:14,  2.92it/s] 79%|███████▉  | 154/195 [01:10<00:14,  2.91it/s] 79%|███████▉  | 155/195 [01:10<00:11,  3.35it/s] 80%|████████  | 156/195 [01:11<00:13,  2.97it/s] 81%|████████  | 157/195 [01:11<00:11,  3.19it/s] 81%|████████  | 158/195 [01:11<00:11,  3.27it/s] 82%|████████▏ | 159/195 [01:11<00:09,  3.75it/s] 82%|████████▏ | 160/195 [01:12<00:10,  3.39it/s] 83%|████████▎ | 161/195 [01:12<00:09,  3.62it/s] 83%|████████▎ | 162/195 [01:12<00:09,  3.50it/s] 84%|████████▎ | 163/195 [01:13<00:08,  3.77it/s] 84%|████████▍ | 164/195 [01:13<00:08,  3.59it/s] 85%|████████▍ | 165/195 [01:13<00:09,  3.10it/s] 86%|████████▌ | 167/195 [01:14<00:09,  3.10it/s] 86%|████████▌ | 168/195 [01:14<00:08,  3.27it/s] 87%|████████▋ | 169/195 [01:14<00:07,  3.27it/s] 87%|████████▋ | 170/195 [01:15<00:07,  3.36it/s] 88%|████████▊ | 171/195 [01:15<00:08,  2.81it/s] 89%|████████▊ | 173/195 [01:16<00:07,  3.09it/s] 89%|████████▉ | 174/195 [01:16<00:07,  2.97it/s] 90%|████████▉ | 175/195 [01:17<00:07,  2.85it/s] 90%|█████████ | 176/195 [01:17<00:05,  3.18it/s] 91%|█████████ | 177/195 [01:18<00:07,  2.28it/s] 91%|█████████▏| 178/195 [01:18<00:06,  2.63it/s] 92%|█████████▏| 179/195 [01:18<00:07,  2.19it/s] 93%|█████████▎| 181/195 [01:19<00:05,  2.66it/s] 93%|█████████▎| 182/195 [01:20<00:05,  2.44it/s] 94%|█████████▍| 184/195 [01:20<00:04,  2.67it/s] 95%|█████████▍| 185/195 [01:20<00:03,  3.03it/s] 95%|█████████▌| 186/195 [01:21<00:03,  2.87it/s] 96%|█████████▌| 187/195 [01:21<00:02,  2.77it/s] 96%|█████████▋| 188/195 [01:21<00:02,  2.87it/s] 97%|█████████▋| 189/195 [01:22<00:02,  2.85it/s] 97%|█████████▋| 190/195 [01:22<00:01,  2.63it/s] 98%|█████████▊| 191/195 [01:23<00:01,  2.55it/s] 98%|█████████▊| 192/195 [01:23<00:01,  2.83it/s] 99%|█████████▉| 193/195 [01:23<00:00,  2.82it/s] 99%|█████████▉| 194/195 [01:24<00:00,  3.08it/s]100%|██████████| 195/195 [01:24<00:00,  3.60it/s]100%|██████████| 195/195 [01:26<00:00,  2.26it/s]
2025-09-24 09:44:36 [info     ] Validating outputs
2025-09-24 09:44:36 [info     ] Predict - end                  time=0:1:26
2025-09-24 09:44:36 [info     ] Evaluate - start               split=test
2025-09-24 09:44:36 [info     ] Evaluate - end                 answer_distr=[0.35, 0.24, 0.16, 0.24] correctness_llm=0.55 llm_group_correctness=[0.44, 0.41, 0.62, 0.59, 0.69] monotonicity=0.57
2025-09-24 09:44:36 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:44:36 [info     ] Augmenting questions for IRT estimation num_questions=7
2025-09-24 09:44:36 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:44:36 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 998.44it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3543.56it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 508.15it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5179.98it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1099.18it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3518.11it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 623.55it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5345.98it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 943.42it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3524.85it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 601.07it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5317.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1218.01it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3578.76it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 678.59it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5135.58it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 971.80it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3622.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 558.75it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5396.09it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 998.13it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3685.43it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 659.07it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5631.02it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 995.76it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3468.13it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 620.21it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5295.84it/s]
2025-09-24 09:44:42 INFO: EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
2025-09-24 09:44:42 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:44:42 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:44:42 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:44:42 [info     ] Evaluate question difficulty - end mae=1.35 rmse=1.69 split=test
2025-09-24 09:44:42 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 3 finished: 0:1:42

 ========== Config: qwen3:8b~T_1.0~SO_student_bool_nocontext~L_5~SP_student_dbe_miscons_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_cfe_studentlevel_random0 ==========
Config 7/16

 ********** Run: 1/3 **********
2025-09-24 09:45:00 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:45:00 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:45:00 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:45:00 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:45:02 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:45:02 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:45:06 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:45:06 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:45:06 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:45:07 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:45:10 [info     ] Setting seed                   value=43
2025-09-24 09:45:10 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 09:45:10 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_dbe_miscons_level_nocontext
2025-09-24 09:45:10 [info     ] Building model                 name=qwen3:8b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:45:10 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:04<13:07,  4.06s/it]  1%|          | 2/195 [00:04<06:00,  1.87s/it]  2%|▏         | 3/195 [00:06<05:36,  1.75s/it]  3%|▎         | 5/195 [00:07<03:28,  1.10s/it]  4%|▎         | 7/195 [00:07<02:26,  1.29it/s]  4%|▍         | 8/195 [00:08<02:02,  1.53it/s]  5%|▍         | 9/195 [00:08<01:47,  1.73it/s]  5%|▌         | 10/195 [00:08<01:32,  2.01it/s]  6%|▌         | 11/195 [00:09<01:21,  2.25it/s]  6%|▌         | 12/195 [00:09<01:12,  2.52it/s]  7%|▋         | 13/195 [00:09<01:04,  2.84it/s]  7%|▋         | 14/195 [00:09<01:00,  2.98it/s]  8%|▊         | 16/195 [00:10<00:50,  3.54it/s]  9%|▊         | 17/195 [00:10<00:47,  3.76it/s]  9%|▉         | 18/195 [00:10<00:50,  3.51it/s] 10%|▉         | 19/195 [00:11<00:41,  4.20it/s] 10%|█         | 20/195 [00:11<00:50,  3.49it/s] 11%|█         | 21/195 [00:11<00:46,  3.78it/s] 11%|█▏        | 22/195 [00:12<00:48,  3.58it/s] 12%|█▏        | 23/195 [00:12<00:45,  3.75it/s] 12%|█▏        | 24/195 [00:12<00:48,  3.52it/s] 13%|█▎        | 25/195 [00:12<00:46,  3.69it/s] 13%|█▎        | 26/195 [00:13<00:49,  3.42it/s] 14%|█▍        | 27/195 [00:13<00:46,  3.60it/s] 14%|█▍        | 28/195 [00:13<00:50,  3.34it/s] 15%|█▍        | 29/195 [00:14<00:48,  3.45it/s] 15%|█▌        | 30/195 [00:14<00:46,  3.53it/s] 16%|█▌        | 31/195 [00:14<00:52,  3.13it/s] 17%|█▋        | 33/195 [00:15<00:47,  3.39it/s] 17%|█▋        | 34/195 [00:15<00:39,  4.04it/s] 18%|█▊        | 35/195 [00:15<00:50,  3.20it/s] 18%|█▊        | 36/195 [00:16<00:48,  3.30it/s] 19%|█▉        | 37/195 [00:16<00:46,  3.43it/s] 19%|█▉        | 38/195 [00:16<00:52,  2.97it/s] 21%|██        | 40/195 [00:17<00:47,  3.23it/s] 21%|██        | 41/195 [00:17<00:46,  3.29it/s] 22%|██▏       | 42/195 [00:17<00:43,  3.49it/s] 22%|██▏       | 43/195 [00:18<00:48,  3.15it/s] 23%|██▎       | 44/195 [00:18<00:43,  3.47it/s] 23%|██▎       | 45/195 [00:18<00:47,  3.15it/s] 24%|██▎       | 46/195 [00:19<00:43,  3.46it/s] 24%|██▍       | 47/195 [00:19<00:47,  3.13it/s] 25%|██▍       | 48/195 [00:19<00:41,  3.53it/s] 25%|██▌       | 49/195 [00:20<00:45,  3.19it/s] 26%|██▌       | 51/195 [00:20<00:48,  2.96it/s] 27%|██▋       | 52/195 [00:21<00:45,  3.11it/s] 27%|██▋       | 53/195 [00:21<00:51,  2.75it/s] 28%|██▊       | 54/195 [00:21<00:48,  2.93it/s] 28%|██▊       | 55/195 [00:22<00:54,  2.57it/s] 29%|██▉       | 57/195 [00:23<00:50,  2.72it/s] 30%|██▉       | 58/195 [00:23<00:46,  2.94it/s] 30%|███       | 59/195 [00:23<00:50,  2.71it/s] 31%|███       | 60/195 [00:23<00:43,  3.08it/s] 31%|███▏      | 61/195 [00:24<00:53,  2.50it/s] 32%|███▏      | 62/195 [00:24<00:53,  2.46it/s] 33%|███▎      | 64/195 [00:25<00:47,  2.77it/s] 34%|███▍      | 66/195 [00:26<00:45,  2.85it/s] 34%|███▍      | 67/195 [00:26<00:45,  2.84it/s] 35%|███▍      | 68/195 [00:26<00:38,  3.29it/s] 35%|███▌      | 69/195 [00:27<00:38,  3.25it/s] 36%|███▋      | 71/195 [00:27<00:36,  3.43it/s] 37%|███▋      | 73/195 [00:28<00:34,  3.53it/s] 38%|███▊      | 74/195 [00:28<00:31,  3.83it/s] 38%|███▊      | 75/195 [00:28<00:32,  3.75it/s] 39%|███▉      | 76/195 [00:28<00:30,  3.97it/s] 39%|███▉      | 77/195 [00:29<00:33,  3.53it/s] 40%|████      | 78/195 [00:29<00:32,  3.59it/s] 41%|████      | 79/195 [00:29<00:31,  3.66it/s] 41%|████      | 80/195 [00:30<00:31,  3.69it/s] 42%|████▏     | 81/195 [00:30<00:32,  3.54it/s] 42%|████▏     | 82/195 [00:30<00:29,  3.82it/s] 43%|████▎     | 83/195 [00:30<00:33,  3.38it/s] 44%|████▎     | 85/195 [00:31<00:30,  3.58it/s] 44%|████▍     | 86/195 [00:31<00:30,  3.58it/s] 45%|████▍     | 87/195 [00:31<00:30,  3.55it/s] 45%|████▌     | 88/195 [00:32<00:29,  3.69it/s] 46%|████▌     | 89/195 [00:32<00:31,  3.39it/s] 47%|████▋     | 91/195 [00:33<00:29,  3.55it/s] 47%|████▋     | 92/195 [00:33<00:29,  3.44it/s] 48%|████▊     | 93/195 [00:33<00:28,  3.55it/s] 48%|████▊     | 94/195 [00:33<00:27,  3.63it/s] 49%|████▊     | 95/195 [00:34<00:26,  3.71it/s] 49%|████▉     | 96/195 [00:34<00:30,  3.30it/s] 50%|█████     | 98/195 [00:35<00:28,  3.42it/s] 51%|█████     | 99/195 [00:35<00:24,  3.84it/s] 51%|█████▏    | 100/195 [00:35<00:31,  3.03it/s] 52%|█████▏    | 101/195 [00:36<00:33,  2.80it/s] 52%|█████▏    | 102/195 [00:36<00:34,  2.73it/s] 53%|█████▎    | 103/195 [00:37<00:38,  2.40it/s] 54%|█████▍    | 105/195 [00:38<00:37,  2.41it/s] 55%|█████▍    | 107/195 [00:38<00:35,  2.46it/s] 56%|█████▌    | 109/195 [00:39<00:33,  2.54it/s] 56%|█████▋    | 110/195 [00:39<00:32,  2.59it/s] 57%|█████▋    | 111/195 [00:40<00:33,  2.47it/s] 58%|█████▊    | 113/195 [00:41<00:32,  2.49it/s] 59%|█████▉    | 115/195 [00:41<00:30,  2.63it/s] 59%|█████▉    | 116/195 [00:42<00:30,  2.62it/s] 60%|██████    | 117/195 [00:42<00:31,  2.50it/s] 61%|██████    | 118/195 [00:43<00:29,  2.62it/s] 61%|██████    | 119/195 [00:43<00:30,  2.52it/s] 62%|██████▏   | 120/195 [00:43<00:26,  2.84it/s] 62%|██████▏   | 121/195 [00:44<00:27,  2.69it/s] 63%|██████▎   | 122/195 [00:44<00:23,  3.07it/s] 63%|██████▎   | 123/195 [00:44<00:22,  3.15it/s] 64%|██████▎   | 124/195 [00:45<00:23,  2.98it/s] 65%|██████▍   | 126/195 [00:45<00:23,  2.98it/s] 66%|██████▌   | 128/195 [00:46<00:22,  3.02it/s] 66%|██████▌   | 129/195 [00:46<00:19,  3.31it/s] 67%|██████▋   | 130/195 [00:46<00:21,  2.98it/s] 68%|██████▊   | 132/195 [00:47<00:19,  3.16it/s] 68%|██████▊   | 133/195 [00:47<00:17,  3.48it/s] 69%|██████▊   | 134/195 [00:48<00:19,  3.17it/s] 69%|██████▉   | 135/195 [00:48<00:16,  3.58it/s] 70%|██████▉   | 136/195 [00:48<00:17,  3.42it/s] 70%|███████   | 137/195 [00:48<00:15,  3.70it/s] 71%|███████   | 138/195 [00:49<00:18,  3.12it/s] 72%|███████▏  | 140/195 [00:49<00:17,  3.20it/s] 72%|███████▏  | 141/195 [00:50<00:15,  3.59it/s] 73%|███████▎  | 142/195 [00:50<00:14,  3.59it/s] 73%|███████▎  | 143/195 [00:50<00:14,  3.48it/s] 74%|███████▍  | 144/195 [00:50<00:14,  3.58it/s] 74%|███████▍  | 145/195 [00:51<00:14,  3.41it/s] 75%|███████▍  | 146/195 [00:51<00:14,  3.46it/s] 75%|███████▌  | 147/195 [00:51<00:13,  3.53it/s] 76%|███████▌  | 148/195 [00:52<00:14,  3.30it/s] 76%|███████▋  | 149/195 [00:52<00:16,  2.79it/s] 77%|███████▋  | 150/195 [00:53<00:16,  2.71it/s] 77%|███████▋  | 151/195 [00:53<00:14,  3.13it/s] 78%|███████▊  | 152/195 [00:53<00:15,  2.77it/s] 79%|███████▉  | 154/195 [00:54<00:13,  2.94it/s] 79%|███████▉  | 155/195 [00:54<00:11,  3.43it/s] 80%|████████  | 156/195 [00:54<00:11,  3.27it/s] 81%|████████  | 157/195 [00:55<00:10,  3.70it/s] 81%|████████  | 158/195 [00:55<00:10,  3.43it/s] 82%|████████▏ | 160/195 [00:55<00:09,  3.63it/s] 83%|████████▎ | 161/195 [00:56<00:08,  3.89it/s] 83%|████████▎ | 162/195 [00:56<00:09,  3.39it/s] 84%|████████▎ | 163/195 [00:56<00:08,  3.80it/s] 84%|████████▍ | 164/195 [00:57<00:09,  3.39it/s] 85%|████████▍ | 165/195 [00:57<00:07,  3.79it/s] 85%|████████▌ | 166/195 [00:57<00:07,  3.66it/s] 86%|████████▌ | 167/195 [00:57<00:08,  3.43it/s] 86%|████████▌ | 168/195 [00:58<00:07,  3.79it/s] 87%|████████▋ | 169/195 [00:58<00:07,  3.44it/s] 87%|████████▋ | 170/195 [00:58<00:06,  3.78it/s] 88%|████████▊ | 171/195 [00:58<00:06,  3.51it/s] 89%|████████▊ | 173/195 [00:59<00:06,  3.58it/s] 89%|████████▉ | 174/195 [00:59<00:05,  4.00it/s] 90%|████████▉ | 175/195 [01:00<00:05,  3.46it/s] 91%|█████████ | 177/195 [01:00<00:04,  3.74it/s] 91%|█████████▏| 178/195 [01:00<00:04,  4.08it/s] 92%|█████████▏| 179/195 [01:01<00:04,  3.55it/s] 93%|█████████▎| 181/195 [01:01<00:03,  3.70it/s] 94%|█████████▍| 183/195 [01:02<00:03,  3.75it/s] 95%|█████████▍| 185/195 [01:02<00:02,  3.76it/s] 96%|█████████▌| 187/195 [01:03<00:02,  3.75it/s] 97%|█████████▋| 189/195 [01:03<00:01,  3.93it/s] 97%|█████████▋| 190/195 [01:03<00:01,  3.92it/s] 98%|█████████▊| 191/195 [01:04<00:01,  3.66it/s] 98%|█████████▊| 192/195 [01:04<00:00,  3.60it/s] 99%|█████████▉| 193/195 [01:04<00:00,  3.64it/s] 99%|█████████▉| 194/195 [01:05<00:00,  3.32it/s]100%|██████████| 195/195 [01:05<00:00,  3.86it/s]100%|██████████| 195/195 [01:07<00:00,  2.89it/s]
2025-09-24 09:46:17 [info     ] Validating outputs
2025-09-24 09:46:17 [info     ] Predict - end                  time=0:1:7
2025-09-24 09:46:17 [info     ] Evaluate - start               split=test
2025-09-24 09:46:17 [info     ] Evaluate - end                 answer_distr=[0.36, 0.19, 0.14, 0.27] correctness_llm=0.64 llm_group_correctness=[0.44, 0.56, 0.67, 0.72, 0.82] monotonicity=1.0
2025-09-24 09:46:17 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:46:17 [info     ] Augmenting questions for IRT estimation num_questions=13
2025-09-24 09:46:17 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:46:17 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1006.17it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3489.21it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 548.81it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7312.61it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1130.28it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3549.33it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 588.34it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7451.81it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 256.92it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3846.90it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 646.13it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8261.15it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1117.20it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3596.30it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 535.85it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7233.34it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1125.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3612.27it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 583.38it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6859.84it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1016.20it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3751.18it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 612.94it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7258.38it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1169.03it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3565.65it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 652.53it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7206.71it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 994.55it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3627.41it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 691.19it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7081.56it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1083.12it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3656.76it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 657.85it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7208.48it/s]
2025-09-24 09:46:24 INFO: EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
EM converged at iteration 9.
2025-09-24 09:46:24 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:46:24 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:46:24 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:46:24 [info     ] Evaluate question difficulty - end mae=1.48 rmse=1.83 split=test
2025-09-24 09:46:24 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 1 finished: 0:1:23

 ********** Run: 2/3 **********
2025-09-24 09:46:40 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:46:40 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:46:40 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:46:40 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:46:42 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:46:42 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:46:46 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:46:46 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:46:46 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:46:47 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:46:50 [info     ] Setting seed                   value=44
2025-09-24 09:46:50 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 09:46:50 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_dbe_miscons_level_nocontext
2025-09-24 09:46:50 [info     ] Building model                 name=qwen3:8b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:46:50 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<05:13,  1.62s/it]  1%|          | 2/195 [00:01<02:51,  1.12it/s]  2%|▏         | 3/195 [00:02<01:50,  1.74it/s]  2%|▏         | 4/195 [00:02<01:31,  2.08it/s]  3%|▎         | 5/195 [00:02<01:10,  2.69it/s]  3%|▎         | 6/195 [00:03<01:13,  2.59it/s]  4%|▍         | 8/195 [00:04<01:33,  1.99it/s]  5%|▌         | 10/195 [00:04<01:09,  2.64it/s]  6%|▌         | 11/195 [00:05<01:24,  2.18it/s]  6%|▌         | 12/195 [00:06<01:42,  1.79it/s]  7%|▋         | 13/195 [00:06<01:30,  2.02it/s]  7%|▋         | 14/195 [00:06<01:14,  2.42it/s]  8%|▊         | 15/195 [00:07<01:15,  2.38it/s]  9%|▊         | 17/195 [00:07<01:05,  2.71it/s] 10%|▉         | 19/195 [00:08<01:15,  2.34it/s] 11%|█         | 21/195 [00:09<01:02,  2.80it/s] 11%|█▏        | 22/195 [00:09<00:54,  3.19it/s] 12%|█▏        | 23/195 [00:09<00:51,  3.34it/s] 12%|█▏        | 24/195 [00:10<00:50,  3.36it/s] 13%|█▎        | 25/195 [00:10<00:50,  3.35it/s] 13%|█▎        | 26/195 [00:10<00:50,  3.37it/s] 14%|█▍        | 27/195 [00:11<00:49,  3.37it/s] 14%|█▍        | 28/195 [00:11<00:48,  3.42it/s] 15%|█▍        | 29/195 [00:11<00:48,  3.44it/s] 15%|█▌        | 30/195 [00:11<00:50,  3.25it/s] 16%|█▌        | 31/195 [00:12<00:51,  3.21it/s] 16%|█▋        | 32/195 [00:12<00:49,  3.26it/s] 17%|█▋        | 33/195 [00:12<00:50,  3.19it/s] 17%|█▋        | 34/195 [00:13<00:47,  3.38it/s] 18%|█▊        | 35/195 [00:13<00:53,  3.01it/s] 19%|█▉        | 37/195 [00:14<00:52,  3.02it/s] 19%|█▉        | 38/195 [00:14<00:46,  3.36it/s] 20%|██        | 39/195 [00:14<00:51,  3.02it/s] 21%|██        | 40/195 [00:15<00:45,  3.41it/s] 21%|██        | 41/195 [00:15<00:49,  3.08it/s] 22%|██▏       | 43/195 [00:15<00:45,  3.32it/s] 23%|██▎       | 45/195 [00:16<00:45,  3.32it/s] 24%|██▎       | 46/195 [00:16<00:41,  3.56it/s] 24%|██▍       | 47/195 [00:17<00:43,  3.42it/s] 25%|██▍       | 48/195 [00:17<00:40,  3.65it/s] 25%|██▌       | 49/195 [00:17<00:43,  3.35it/s] 26%|██▌       | 51/195 [00:18<00:49,  2.91it/s] 27%|██▋       | 52/195 [00:18<00:47,  3.00it/s] 27%|██▋       | 53/195 [00:19<00:54,  2.62it/s] 28%|██▊       | 54/195 [00:19<00:50,  2.81it/s] 28%|██▊       | 55/195 [00:19<00:51,  2.74it/s] 29%|██▊       | 56/195 [00:20<00:55,  2.52it/s] 29%|██▉       | 57/195 [00:20<00:52,  2.63it/s] 30%|██▉       | 58/195 [00:21<00:53,  2.56it/s] 30%|███       | 59/195 [00:21<00:52,  2.60it/s] 31%|███       | 60/195 [00:21<00:48,  2.77it/s] 31%|███▏      | 61/195 [00:22<00:50,  2.68it/s] 32%|███▏      | 62/195 [00:22<00:44,  3.00it/s] 32%|███▏      | 63/195 [00:22<00:44,  2.95it/s] 33%|███▎      | 64/195 [00:23<00:43,  3.02it/s] 33%|███▎      | 65/195 [00:23<00:42,  3.09it/s] 34%|███▍      | 66/195 [00:23<00:37,  3.40it/s] 34%|███▍      | 67/195 [00:23<00:35,  3.56it/s] 35%|███▍      | 68/195 [00:24<00:37,  3.37it/s] 35%|███▌      | 69/195 [00:24<00:35,  3.57it/s] 36%|███▌      | 70/195 [00:24<00:39,  3.15it/s] 37%|███▋      | 72/195 [00:25<00:39,  3.12it/s] 38%|███▊      | 74/195 [00:26<00:36,  3.35it/s] 38%|███▊      | 75/195 [00:26<00:32,  3.68it/s] 39%|███▉      | 76/195 [00:26<00:36,  3.27it/s] 39%|███▉      | 77/195 [00:26<00:32,  3.65it/s] 40%|████      | 78/195 [00:27<00:32,  3.63it/s] 41%|████      | 79/195 [00:27<00:34,  3.39it/s] 42%|████▏     | 81/195 [00:28<00:31,  3.59it/s] 43%|████▎     | 83/195 [00:28<00:29,  3.79it/s] 43%|████▎     | 84/195 [00:28<00:30,  3.68it/s] 44%|████▎     | 85/195 [00:29<00:28,  3.81it/s] 44%|████▍     | 86/195 [00:29<00:31,  3.42it/s] 45%|████▍     | 87/195 [00:29<00:28,  3.75it/s] 45%|████▌     | 88/195 [00:30<00:33,  3.24it/s] 46%|████▌     | 90/195 [00:30<00:27,  3.75it/s] 47%|████▋     | 91/195 [00:30<00:26,  3.89it/s] 47%|████▋     | 92/195 [00:31<00:28,  3.62it/s] 48%|████▊     | 94/195 [00:31<00:27,  3.63it/s] 49%|████▊     | 95/195 [00:31<00:23,  4.19it/s] 49%|████▉     | 96/195 [00:32<00:28,  3.52it/s] 50%|████▉     | 97/195 [00:32<00:26,  3.69it/s] 50%|█████     | 98/195 [00:32<00:28,  3.39it/s] 51%|█████     | 99/195 [00:32<00:26,  3.60it/s] 51%|█████▏    | 100/195 [00:33<00:31,  3.00it/s] 52%|█████▏    | 101/195 [00:33<00:32,  2.93it/s] 52%|█████▏    | 102/195 [00:34<00:33,  2.76it/s] 53%|█████▎    | 103/195 [00:34<00:35,  2.58it/s] 54%|█████▍    | 105/195 [00:35<00:35,  2.51it/s] 55%|█████▍    | 107/195 [00:36<00:34,  2.55it/s] 55%|█████▌    | 108/195 [00:36<00:31,  2.74it/s] 56%|█████▌    | 109/195 [00:37<00:34,  2.47it/s] 56%|█████▋    | 110/195 [00:37<00:31,  2.68it/s] 57%|█████▋    | 111/195 [00:37<00:33,  2.50it/s] 57%|█████▋    | 112/195 [00:38<00:30,  2.69it/s] 58%|█████▊    | 113/195 [00:38<00:30,  2.65it/s] 58%|█████▊    | 114/195 [00:38<00:28,  2.80it/s] 59%|█████▉    | 115/195 [00:39<00:30,  2.65it/s] 59%|█████▉    | 116/195 [00:39<00:30,  2.59it/s] 60%|██████    | 117/195 [00:40<00:30,  2.56it/s] 61%|██████    | 118/195 [00:40<00:31,  2.45it/s] 61%|██████    | 119/195 [00:40<00:30,  2.52it/s] 62%|██████▏   | 120/195 [00:41<00:29,  2.56it/s] 63%|██████▎   | 122/195 [00:41<00:23,  3.05it/s] 63%|██████▎   | 123/195 [00:41<00:22,  3.24it/s] 64%|██████▎   | 124/195 [00:42<00:20,  3.39it/s] 64%|██████▍   | 125/195 [00:42<00:21,  3.19it/s] 65%|██████▌   | 127/195 [00:43<00:21,  3.10it/s] 66%|██████▌   | 129/195 [00:43<00:20,  3.19it/s] 67%|██████▋   | 130/195 [00:44<00:18,  3.46it/s] 67%|██████▋   | 131/195 [00:44<00:18,  3.45it/s] 68%|██████▊   | 132/195 [00:44<00:19,  3.28it/s] 68%|██████▊   | 133/195 [00:45<00:18,  3.32it/s] 69%|██████▊   | 134/195 [00:45<00:18,  3.31it/s] 69%|██████▉   | 135/195 [00:45<00:18,  3.31it/s] 70%|██████▉   | 136/195 [00:45<00:17,  3.34it/s] 70%|███████   | 137/195 [00:46<00:17,  3.30it/s] 71%|███████   | 138/195 [00:46<00:17,  3.33it/s] 71%|███████▏  | 139/195 [00:46<00:15,  3.59it/s] 72%|███████▏  | 140/195 [00:47<00:16,  3.41it/s] 72%|███████▏  | 141/195 [00:47<00:14,  3.80it/s] 73%|███████▎  | 142/195 [00:47<00:14,  3.57it/s] 73%|███████▎  | 143/195 [00:47<00:13,  3.95it/s] 74%|███████▍  | 144/195 [00:48<00:14,  3.50it/s] 75%|███████▍  | 146/195 [00:48<00:14,  3.36it/s] 76%|███████▌  | 148/195 [00:49<00:12,  3.67it/s] 77%|███████▋  | 150/195 [00:49<00:12,  3.65it/s] 78%|███████▊  | 152/195 [00:50<00:12,  3.48it/s] 78%|███████▊  | 153/195 [00:50<00:11,  3.67it/s] 79%|███████▉  | 154/195 [00:51<00:12,  3.27it/s] 80%|████████  | 156/195 [00:51<00:11,  3.51it/s] 81%|████████  | 157/195 [00:51<00:09,  3.88it/s] 81%|████████  | 158/195 [00:51<00:09,  3.86it/s] 82%|████████▏ | 159/195 [00:52<00:08,  4.10it/s] 82%|████████▏ | 160/195 [00:52<00:10,  3.39it/s] 83%|████████▎ | 161/195 [00:52<00:08,  3.78it/s] 83%|████████▎ | 162/195 [00:53<00:10,  3.20it/s] 84%|████████▎ | 163/195 [00:53<00:08,  3.64it/s] 84%|████████▍ | 164/195 [00:53<00:09,  3.26it/s] 85%|████████▍ | 165/195 [00:53<00:08,  3.67it/s] 85%|████████▌ | 166/195 [00:54<00:10,  2.86it/s] 86%|████████▌ | 167/195 [00:54<00:10,  2.64it/s] 86%|████████▌ | 168/195 [00:55<00:08,  3.12it/s] 87%|████████▋ | 169/195 [00:55<00:09,  2.65it/s] 87%|████████▋ | 170/195 [00:56<00:09,  2.52it/s] 88%|████████▊ | 172/195 [00:56<00:07,  3.06it/s] 89%|████████▉ | 174/195 [00:57<00:06,  3.28it/s] 90%|█████████ | 176/195 [00:57<00:05,  3.40it/s] 91%|█████████▏| 178/195 [00:58<00:04,  3.58it/s] 92%|█████████▏| 180/195 [00:58<00:04,  3.67it/s] 93%|█████████▎| 182/195 [00:59<00:03,  3.64it/s] 94%|█████████▍| 184/195 [00:59<00:02,  3.69it/s] 95%|█████████▌| 186/195 [01:00<00:02,  3.95it/s] 96%|█████████▌| 187/195 [01:00<00:02,  3.95it/s] 96%|█████████▋| 188/195 [01:00<00:01,  4.01it/s] 97%|█████████▋| 189/195 [01:01<00:01,  3.72it/s] 97%|█████████▋| 190/195 [01:01<00:01,  3.65it/s] 98%|█████████▊| 191/195 [01:01<00:01,  3.37it/s] 98%|█████████▊| 192/195 [01:01<00:00,  3.42it/s] 99%|█████████▉| 193/195 [01:02<00:00,  3.47it/s] 99%|█████████▉| 194/195 [01:02<00:00,  3.48it/s]100%|██████████| 195/195 [01:02<00:00,  4.12it/s]100%|██████████| 195/195 [01:04<00:00,  3.01it/s]
2025-09-24 09:47:55 [info     ] Validating outputs
2025-09-24 09:47:55 [info     ] Predict - end                  time=0:1:4
2025-09-24 09:47:55 [info     ] Evaluate - start               split=test
2025-09-24 09:47:55 [info     ] Evaluate - end                 answer_distr=[0.33, 0.23, 0.13, 0.29] correctness_llm=0.66 llm_group_correctness=[0.49, 0.59, 0.67, 0.77, 0.77] monotonicity=0.99
2025-09-24 09:47:55 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:47:55 [info     ] Augmenting questions for IRT estimation num_questions=8
2025-09-24 09:47:55 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:47:55 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1068.65it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3362.48it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 701.34it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6348.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1061.89it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3746.80it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 603.69it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6281.58it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1092.43it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3972.46it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 563.84it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6356.38it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 975.84it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3383.69it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 582.72it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6307.22it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1181.40it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3610.27it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 605.76it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6821.59it/s]
2025-09-24 09:47:59 INFO: EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
2025-09-24 09:47:59 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:47:59 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:47:59 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:47:59 [info     ] Evaluate question difficulty - end mae=1.29 rmse=1.59 split=test
2025-09-24 09:47:59 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 2 finished: 0:1:18

 ********** Run: 3/3 **********
2025-09-24 09:48:17 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:48:17 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:48:17 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:48:17 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:48:19 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:48:19 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:48:24 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:48:24 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:48:24 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:48:25 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:48:27 [info     ] Setting seed                   value=45
2025-09-24 09:48:27 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 09:48:27 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_dbe_miscons_level_nocontext
2025-09-24 09:48:27 [info     ] Building model                 name=qwen3:8b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:48:27 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:00<02:38,  1.23it/s]  2%|▏         | 3/195 [00:01<01:26,  2.23it/s]  3%|▎         | 5/195 [00:02<01:12,  2.62it/s]  4%|▎         | 7/195 [00:03<01:24,  2.22it/s]  5%|▍         | 9/195 [00:04<01:29,  2.07it/s]  5%|▌         | 10/195 [00:04<01:25,  2.18it/s]  6%|▌         | 12/195 [00:05<01:37,  1.89it/s]  7%|▋         | 14/195 [00:06<01:20,  2.24it/s]  8%|▊         | 15/195 [00:06<01:09,  2.59it/s]  8%|▊         | 16/195 [00:07<01:09,  2.56it/s]  9%|▊         | 17/195 [00:07<01:00,  2.96it/s]  9%|▉         | 18/195 [00:07<00:57,  3.06it/s] 10%|▉         | 19/195 [00:08<01:16,  2.29it/s] 10%|█         | 20/195 [00:09<01:41,  1.72it/s] 11%|█         | 21/195 [00:09<01:30,  1.92it/s] 11%|█▏        | 22/195 [00:09<01:19,  2.19it/s] 12%|█▏        | 23/195 [00:10<01:06,  2.57it/s] 12%|█▏        | 24/195 [00:10<01:02,  2.72it/s] 13%|█▎        | 25/195 [00:10<00:56,  3.02it/s] 13%|█▎        | 26/195 [00:11<00:57,  2.94it/s] 14%|█▍        | 27/195 [00:11<00:52,  3.19it/s] 14%|█▍        | 28/195 [00:11<00:49,  3.41it/s] 15%|█▍        | 29/195 [00:11<00:52,  3.18it/s] 16%|█▌        | 31/195 [00:12<00:54,  3.03it/s] 16%|█▋        | 32/195 [00:12<00:48,  3.33it/s] 17%|█▋        | 33/195 [00:13<00:54,  2.98it/s] 18%|█▊        | 35/195 [00:13<00:47,  3.39it/s] 18%|█▊        | 36/195 [00:14<00:47,  3.32it/s] 19%|█▉        | 37/195 [00:14<00:47,  3.34it/s] 19%|█▉        | 38/195 [00:14<00:45,  3.41it/s] 20%|██        | 39/195 [00:14<00:46,  3.38it/s] 21%|██        | 40/195 [00:15<00:48,  3.17it/s] 21%|██        | 41/195 [00:15<00:46,  3.30it/s] 22%|██▏       | 42/195 [00:15<00:44,  3.45it/s] 22%|██▏       | 43/195 [00:16<00:41,  3.64it/s] 23%|██▎       | 44/195 [00:16<00:45,  3.34it/s] 24%|██▎       | 46/195 [00:16<00:39,  3.75it/s] 24%|██▍       | 47/195 [00:17<00:37,  3.93it/s] 25%|██▍       | 48/195 [00:17<00:38,  3.79it/s] 25%|██▌       | 49/195 [00:17<00:36,  3.95it/s] 26%|██▌       | 50/195 [00:17<00:39,  3.64it/s] 26%|██▌       | 51/195 [00:18<00:42,  3.40it/s] 27%|██▋       | 52/195 [00:18<00:45,  3.15it/s] 27%|██▋       | 53/195 [00:18<00:43,  3.29it/s] 28%|██▊       | 54/195 [00:19<00:45,  3.07it/s] 28%|██▊       | 55/195 [00:19<00:46,  3.00it/s] 29%|██▊       | 56/195 [00:20<00:48,  2.86it/s] 29%|██▉       | 57/195 [00:20<00:48,  2.85it/s] 30%|██▉       | 58/195 [00:20<00:49,  2.77it/s] 30%|███       | 59/195 [00:21<00:49,  2.73it/s] 31%|███       | 60/195 [00:21<00:44,  3.04it/s] 31%|███▏      | 61/195 [00:21<00:42,  3.12it/s] 32%|███▏      | 62/195 [00:21<00:39,  3.39it/s] 32%|███▏      | 63/195 [00:22<00:38,  3.45it/s] 33%|███▎      | 64/195 [00:22<00:48,  2.68it/s] 33%|███▎      | 65/195 [00:23<00:47,  2.76it/s] 34%|███▍      | 67/195 [00:23<00:38,  3.35it/s] 35%|███▍      | 68/195 [00:23<00:36,  3.47it/s] 35%|███▌      | 69/195 [00:24<00:35,  3.58it/s] 36%|███▌      | 70/195 [00:24<00:38,  3.24it/s] 36%|███▋      | 71/195 [00:24<00:34,  3.62it/s] 37%|███▋      | 72/195 [00:24<00:33,  3.70it/s] 37%|███▋      | 73/195 [00:25<00:33,  3.63it/s] 38%|███▊      | 74/195 [00:25<00:30,  4.01it/s] 38%|███▊      | 75/195 [00:25<00:34,  3.44it/s] 39%|███▉      | 77/195 [00:26<00:31,  3.71it/s] 41%|████      | 79/195 [00:26<00:31,  3.74it/s] 41%|████      | 80/195 [00:26<00:28,  4.10it/s] 42%|████▏     | 81/195 [00:27<00:29,  3.91it/s] 42%|████▏     | 82/195 [00:27<00:28,  3.96it/s] 43%|████▎     | 83/195 [00:27<00:27,  4.02it/s] 43%|████▎     | 84/195 [00:28<00:30,  3.63it/s] 44%|████▍     | 86/195 [00:28<00:27,  4.00it/s] 45%|████▍     | 87/195 [00:28<00:26,  4.02it/s] 45%|████▌     | 88/195 [00:28<00:26,  4.04it/s] 46%|████▌     | 89/195 [00:29<00:25,  4.13it/s] 46%|████▌     | 90/195 [00:29<00:28,  3.68it/s] 47%|████▋     | 91/195 [00:29<00:27,  3.82it/s] 47%|████▋     | 92/195 [00:30<00:29,  3.51it/s] 48%|████▊     | 94/195 [00:30<00:28,  3.58it/s] 49%|████▉     | 96/195 [00:31<00:26,  3.74it/s] 50%|█████     | 98/195 [00:31<00:24,  3.95it/s] 51%|█████▏    | 100/195 [00:32<00:27,  3.45it/s] 52%|█████▏    | 101/195 [00:32<00:27,  3.44it/s] 52%|█████▏    | 102/195 [00:33<00:33,  2.78it/s] 53%|█████▎    | 103/195 [00:33<00:31,  2.91it/s] 53%|█████▎    | 104/195 [00:34<00:36,  2.50it/s] 54%|█████▍    | 105/195 [00:34<00:33,  2.71it/s] 54%|█████▍    | 106/195 [00:34<00:35,  2.50it/s] 55%|█████▍    | 107/195 [00:35<00:35,  2.51it/s] 55%|█████▌    | 108/195 [00:35<00:33,  2.59it/s] 56%|█████▌    | 109/195 [00:36<00:33,  2.53it/s] 56%|█████▋    | 110/195 [00:36<00:32,  2.60it/s] 57%|█████▋    | 111/195 [00:36<00:31,  2.67it/s] 57%|█████▋    | 112/195 [00:37<00:29,  2.82it/s] 58%|█████▊    | 113/195 [00:37<00:31,  2.63it/s] 59%|█████▉    | 115/195 [00:38<00:30,  2.64it/s] 60%|██████    | 117/195 [00:38<00:28,  2.69it/s] 61%|██████    | 119/195 [00:39<00:29,  2.60it/s] 62%|██████▏   | 121/195 [00:40<00:26,  2.81it/s] 63%|██████▎   | 122/195 [00:40<00:28,  2.56it/s] 63%|██████▎   | 123/195 [00:41<00:26,  2.73it/s] 64%|██████▎   | 124/195 [00:41<00:24,  2.88it/s] 64%|██████▍   | 125/195 [00:41<00:22,  3.11it/s] 65%|██████▍   | 126/195 [00:42<00:23,  2.97it/s] 65%|██████▌   | 127/195 [00:42<00:21,  3.21it/s] 66%|██████▌   | 128/195 [00:42<00:22,  3.02it/s] 67%|██████▋   | 130/195 [00:43<00:20,  3.10it/s] 68%|██████▊   | 132/195 [00:43<00:19,  3.18it/s] 69%|██████▊   | 134/195 [00:44<00:19,  3.18it/s] 69%|██████▉   | 135/195 [00:44<00:17,  3.50it/s] 70%|██████▉   | 136/195 [00:45<00:18,  3.22it/s] 71%|███████   | 138/195 [00:45<00:17,  3.34it/s] 72%|███████▏  | 140/195 [00:46<00:15,  3.44it/s] 72%|███████▏  | 141/195 [00:46<00:14,  3.66it/s] 73%|███████▎  | 142/195 [00:46<00:14,  3.63it/s] 73%|███████▎  | 143/195 [00:47<00:14,  3.50it/s] 74%|███████▍  | 144/195 [00:47<00:14,  3.59it/s] 74%|███████▍  | 145/195 [00:47<00:14,  3.38it/s] 75%|███████▍  | 146/195 [00:47<00:13,  3.61it/s] 75%|███████▌  | 147/195 [00:48<00:13,  3.53it/s] 76%|███████▌  | 148/195 [00:48<00:12,  3.75it/s] 76%|███████▋  | 149/195 [00:48<00:13,  3.53it/s] 77%|███████▋  | 150/195 [00:49<00:12,  3.53it/s] 77%|███████▋  | 151/195 [00:49<00:13,  3.27it/s] 78%|███████▊  | 152/195 [00:49<00:13,  3.22it/s] 78%|███████▊  | 153/195 [00:50<00:12,  3.29it/s] 79%|███████▉  | 154/195 [00:50<00:14,  2.92it/s] 80%|████████  | 156/195 [00:51<00:12,  3.10it/s] 81%|████████  | 158/195 [00:51<00:11,  3.34it/s] 82%|████████▏ | 159/195 [00:51<00:09,  3.74it/s] 82%|████████▏ | 160/195 [00:52<00:09,  3.73it/s] 83%|████████▎ | 161/195 [00:52<00:09,  3.55it/s] 83%|████████▎ | 162/195 [00:52<00:09,  3.52it/s] 84%|████████▎ | 163/195 [00:52<00:08,  3.56it/s] 84%|████████▍ | 164/195 [00:53<00:08,  3.64it/s] 85%|████████▍ | 165/195 [00:53<00:09,  3.27it/s] 85%|████████▌ | 166/195 [00:53<00:08,  3.43it/s] 86%|████████▌ | 167/195 [00:54<00:08,  3.45it/s] 86%|████████▌ | 168/195 [00:54<00:09,  2.92it/s] 87%|████████▋ | 169/195 [00:55<00:10,  2.40it/s] 88%|████████▊ | 171/195 [00:55<00:08,  2.83it/s] 88%|████████▊ | 172/195 [00:55<00:07,  3.25it/s] 89%|████████▊ | 173/195 [00:56<00:07,  2.94it/s] 90%|████████▉ | 175/195 [00:56<00:06,  3.25it/s] 90%|█████████ | 176/195 [00:56<00:05,  3.63it/s] 91%|█████████ | 177/195 [00:57<00:05,  3.56it/s] 91%|█████████▏| 178/195 [00:57<00:04,  3.46it/s] 92%|█████████▏| 179/195 [00:57<00:04,  3.93it/s] 92%|█████████▏| 180/195 [00:58<00:04,  3.29it/s] 93%|█████████▎| 182/195 [00:58<00:03,  3.37it/s] 94%|█████████▍| 183/195 [00:58<00:03,  3.69it/s] 94%|█████████▍| 184/195 [00:59<00:03,  3.24it/s] 95%|█████████▌| 186/195 [00:59<00:02,  3.55it/s] 96%|█████████▌| 187/195 [01:00<00:02,  3.35it/s] 96%|█████████▋| 188/195 [01:00<00:02,  3.32it/s] 97%|█████████▋| 189/195 [01:00<00:01,  3.35it/s] 97%|█████████▋| 190/195 [01:01<00:01,  3.36it/s] 98%|█████████▊| 191/195 [01:01<00:01,  3.44it/s] 98%|█████████▊| 192/195 [01:01<00:00,  3.13it/s] 99%|█████████▉| 194/195 [01:02<00:00,  3.32it/s]100%|██████████| 195/195 [01:02<00:00,  3.93it/s]100%|██████████| 195/195 [01:04<00:00,  3.02it/s]
2025-09-24 09:49:32 [info     ] Validating outputs
2025-09-24 09:49:32 [info     ] Predict - end                  time=0:1:4
2025-09-24 09:49:32 [info     ] Evaluate - start               split=test
2025-09-24 09:49:32 [info     ] Evaluate - end                 answer_distr=[0.35, 0.22, 0.12, 0.28] correctness_llm=0.64 llm_group_correctness=[0.51, 0.49, 0.72, 0.69, 0.77] monotonicity=0.56
2025-09-24 09:49:32 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:49:32 [info     ] Augmenting questions for IRT estimation num_questions=11
2025-09-24 09:49:32 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:49:32 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1129.11it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3609.24it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 526.29it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7501.31it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1096.80it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3453.27it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 601.26it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8041.67it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 926.36it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3585.58it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 474.57it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 10478.28it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1039.19it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3763.87it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 608.83it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 9311.81it/s]
2025-09-24 09:49:35 INFO: EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
EM converged at iteration 4.
2025-09-24 09:49:35 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:49:35 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:49:35 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:49:35 [info     ] Evaluate question difficulty - end mae=1.32 rmse=1.63 split=test
2025-09-24 09:49:35 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 3 finished: 0:1:18

 ========== Config: qwen3:14b~T_1.0~SO_teacher_bool_nocontext~L_5~SP_teacher_dbe_miscons_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_dbe_studentlevel_kc_exact3 ==========
Config 8/16

 ********** Run: 1/3 **********
2025-09-24 09:49:55 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:49:55 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:49:55 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:49:55 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:49:57 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:49:57 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:50:02 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:50:02 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:50:02 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:50:02 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:50:05 [info     ] Setting seed                   value=43
2025-09-24 09:50:05 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 09:50:05 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_kc_exact native_structured_output=True num_examples=3 system_prompt=teacher_dbe_miscons_level_context
2025-09-24 09:50:05 [info     ] Building example selector
2025-09-24 09:50:05 [info     ] Building model                 name=qwen3:14b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:50:05 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:17<57:23, 17.75s/it]  2%|▏         | 3/195 [00:21<19:16,  6.02s/it]  2%|▏         | 4/195 [00:22<13:09,  4.13s/it]  3%|▎         | 5/195 [00:24<11:17,  3.57s/it]  4%|▎         | 7/195 [00:26<07:00,  2.24s/it]  4%|▍         | 8/195 [00:26<05:33,  1.78s/it]  5%|▍         | 9/195 [00:28<05:32,  1.79s/it]  5%|▌         | 10/195 [00:29<04:33,  1.48s/it]  6%|▌         | 11/195 [00:30<04:05,  1.34s/it]  6%|▌         | 12/195 [00:31<03:45,  1.23s/it]  7%|▋         | 13/195 [00:31<03:03,  1.01s/it]  7%|▋         | 14/195 [00:32<03:00,  1.00it/s]  8%|▊         | 15/195 [00:33<02:45,  1.09it/s]  8%|▊         | 16/195 [00:34<02:44,  1.09it/s]  9%|▊         | 17/195 [00:34<02:31,  1.18it/s]  9%|▉         | 18/195 [00:35<02:31,  1.17it/s] 10%|▉         | 19/195 [00:36<02:11,  1.34it/s] 10%|█         | 20/195 [00:38<03:13,  1.11s/it] 11%|█▏        | 22/195 [00:39<02:45,  1.05it/s] 12%|█▏        | 24/195 [00:41<02:38,  1.08it/s] 13%|█▎        | 26/195 [00:42<02:18,  1.22it/s] 14%|█▍        | 28/195 [00:44<02:05,  1.33it/s] 15%|█▍        | 29/195 [00:44<02:01,  1.37it/s] 15%|█▌        | 30/195 [00:45<02:01,  1.36it/s] 16%|█▌        | 31/195 [00:46<01:56,  1.41it/s] 16%|█▋        | 32/195 [00:46<01:58,  1.37it/s] 17%|█▋        | 33/195 [00:47<01:58,  1.36it/s] 17%|█▋        | 34/195 [00:48<01:58,  1.36it/s] 18%|█▊        | 35/195 [00:48<01:53,  1.41it/s] 18%|█▊        | 36/195 [00:49<01:52,  1.41it/s] 19%|█▉        | 37/195 [00:50<01:49,  1.44it/s] 19%|█▉        | 38/195 [00:51<01:56,  1.35it/s] 21%|██        | 40/195 [00:52<01:49,  1.41it/s] 22%|██▏       | 42/195 [00:53<01:42,  1.49it/s] 22%|██▏       | 43/195 [00:54<01:38,  1.55it/s] 23%|██▎       | 44/195 [00:54<01:37,  1.56it/s] 23%|██▎       | 45/195 [00:55<01:33,  1.60it/s] 24%|██▎       | 46/195 [00:56<01:35,  1.56it/s] 24%|██▍       | 47/195 [00:56<01:33,  1.59it/s] 25%|██▍       | 48/195 [00:57<01:29,  1.64it/s] 25%|██▌       | 49/195 [00:58<01:30,  1.61it/s] 26%|██▌       | 50/195 [00:58<01:41,  1.43it/s] 26%|██▌       | 51/195 [00:59<01:56,  1.23it/s] 27%|██▋       | 53/195 [01:02<02:15,  1.05it/s] 28%|██▊       | 55/195 [01:04<02:30,  1.07s/it] 29%|██▉       | 57/195 [01:07<02:35,  1.13s/it] 30%|███       | 59/195 [01:09<02:24,  1.06s/it] 31%|███▏      | 61/195 [01:10<02:12,  1.01it/s] 32%|███▏      | 63/195 [01:12<02:09,  1.02it/s] 33%|███▎      | 65/195 [01:14<02:00,  1.08it/s] 34%|███▍      | 67/195 [01:15<01:52,  1.13it/s] 35%|███▌      | 69/195 [01:17<01:50,  1.14it/s] 36%|███▌      | 70/195 [01:18<01:49,  1.15it/s] 36%|███▋      | 71/195 [01:19<01:44,  1.18it/s] 37%|███▋      | 72/195 [01:19<01:41,  1.22it/s] 37%|███▋      | 73/195 [01:20<01:36,  1.26it/s] 38%|███▊      | 74/195 [01:21<01:34,  1.28it/s] 38%|███▊      | 75/195 [01:22<01:43,  1.16it/s] 39%|███▉      | 76/195 [01:23<01:47,  1.11it/s] 39%|███▉      | 77/195 [01:24<01:52,  1.05it/s] 40%|████      | 78/195 [01:25<01:45,  1.11it/s] 41%|████      | 79/195 [01:26<01:50,  1.05it/s] 41%|████      | 80/195 [01:26<01:33,  1.23it/s] 42%|████▏     | 81/195 [01:27<01:36,  1.18it/s] 42%|████▏     | 82/195 [01:28<01:30,  1.25it/s] 43%|████▎     | 83/195 [01:29<01:28,  1.26it/s] 43%|████▎     | 84/195 [01:29<01:23,  1.33it/s] 44%|████▎     | 85/195 [01:30<01:23,  1.31it/s] 44%|████▍     | 86/195 [01:31<01:21,  1.34it/s] 45%|████▍     | 87/195 [01:32<01:19,  1.36it/s] 45%|████▌     | 88/195 [01:32<01:18,  1.37it/s] 46%|████▌     | 89/195 [01:33<01:16,  1.39it/s] 46%|████▌     | 90/195 [01:34<01:16,  1.38it/s] 47%|████▋     | 91/195 [01:34<01:13,  1.42it/s] 47%|████▋     | 92/195 [01:35<01:13,  1.40it/s] 48%|████▊     | 93/195 [01:36<01:11,  1.42it/s] 48%|████▊     | 94/195 [01:37<01:12,  1.40it/s] 49%|████▊     | 95/195 [01:37<01:12,  1.37it/s] 49%|████▉     | 96/195 [01:38<01:11,  1.39it/s] 50%|████▉     | 97/195 [01:38<00:52,  1.86it/s] 50%|█████     | 98/195 [01:39<01:05,  1.48it/s] 51%|█████     | 99/195 [01:40<00:58,  1.64it/s] 51%|█████▏    | 100/195 [01:41<01:15,  1.25it/s] 52%|█████▏    | 101/195 [01:42<01:33,  1.01it/s] 52%|█████▏    | 102/195 [01:43<01:32,  1.01it/s] 53%|█████▎    | 103/195 [01:45<01:54,  1.25s/it] 53%|█████▎    | 104/195 [01:47<01:57,  1.29s/it] 54%|█████▍    | 105/195 [01:48<01:52,  1.25s/it] 54%|█████▍    | 106/195 [01:49<01:40,  1.13s/it] 55%|█████▍    | 107/195 [01:49<01:29,  1.02s/it] 55%|█████▌    | 108/195 [01:50<01:21,  1.07it/s] 56%|█████▌    | 109/195 [01:51<01:16,  1.12it/s] 56%|█████▋    | 110/195 [01:52<01:18,  1.08it/s] 57%|█████▋    | 111/195 [01:53<01:22,  1.02it/s] 57%|█████▋    | 112/195 [01:54<01:16,  1.08it/s] 58%|█████▊    | 113/195 [01:55<01:12,  1.13it/s] 58%|█████▊    | 114/195 [01:55<01:11,  1.13it/s] 59%|█████▉    | 115/195 [01:57<01:24,  1.05s/it] 59%|█████▉    | 116/195 [01:58<01:20,  1.02s/it] 60%|██████    | 117/195 [02:00<01:38,  1.26s/it] 61%|██████    | 118/195 [02:01<01:32,  1.20s/it] 61%|██████    | 119/195 [02:03<01:47,  1.42s/it] 62%|██████▏   | 121/195 [02:04<01:20,  1.09s/it] 63%|██████▎   | 122/195 [02:05<01:12,  1.00it/s] 63%|██████▎   | 123/195 [02:05<01:05,  1.09it/s] 64%|██████▎   | 124/195 [02:06<01:03,  1.12it/s] 64%|██████▍   | 125/195 [02:07<00:59,  1.17it/s] 65%|██████▍   | 126/195 [02:08<00:54,  1.26it/s] 65%|██████▌   | 127/195 [02:08<00:53,  1.27it/s] 66%|██████▌   | 128/195 [02:09<00:50,  1.32it/s] 66%|██████▌   | 129/195 [02:10<00:49,  1.34it/s] 67%|██████▋   | 130/195 [02:11<00:47,  1.36it/s] 67%|██████▋   | 131/195 [02:11<00:46,  1.37it/s] 68%|██████▊   | 132/195 [02:12<00:46,  1.35it/s] 68%|██████▊   | 133/195 [02:13<00:44,  1.38it/s] 69%|██████▊   | 134/195 [02:13<00:43,  1.41it/s] 69%|██████▉   | 135/195 [02:14<00:41,  1.45it/s] 70%|██████▉   | 136/195 [02:15<00:41,  1.41it/s] 70%|███████   | 137/195 [02:15<00:41,  1.39it/s] 71%|███████   | 138/195 [02:16<00:39,  1.45it/s] 71%|███████▏  | 139/195 [02:17<00:37,  1.50it/s] 72%|███████▏  | 140/195 [02:17<00:35,  1.55it/s] 72%|███████▏  | 141/195 [02:18<00:35,  1.50it/s] 73%|███████▎  | 142/195 [02:19<00:33,  1.60it/s] 73%|███████▎  | 143/195 [02:19<00:35,  1.48it/s] 74%|███████▍  | 144/195 [02:20<00:34,  1.47it/s] 74%|███████▍  | 145/195 [02:21<00:34,  1.46it/s] 75%|███████▍  | 146/195 [02:21<00:32,  1.53it/s] 75%|███████▌  | 147/195 [02:22<00:32,  1.48it/s] 76%|███████▌  | 148/195 [02:23<00:30,  1.53it/s] 76%|███████▋  | 149/195 [02:23<00:28,  1.62it/s] 77%|███████▋  | 150/195 [02:24<00:32,  1.39it/s] 77%|███████▋  | 151/195 [02:25<00:30,  1.44it/s] 78%|███████▊  | 152/195 [02:26<00:30,  1.42it/s] 78%|███████▊  | 153/195 [02:26<00:29,  1.43it/s] 79%|███████▉  | 154/195 [02:27<00:29,  1.38it/s] 79%|███████▉  | 155/195 [02:28<00:27,  1.43it/s] 80%|████████  | 156/195 [02:28<00:27,  1.40it/s] 81%|████████  | 157/195 [02:29<00:25,  1.50it/s] 81%|████████  | 158/195 [02:30<00:23,  1.56it/s] 82%|████████▏ | 159/195 [02:30<00:24,  1.49it/s] 82%|████████▏ | 160/195 [02:31<00:21,  1.62it/s] 83%|████████▎ | 161/195 [02:32<00:22,  1.49it/s] 83%|████████▎ | 162/195 [02:32<00:20,  1.60it/s] 84%|████████▎ | 163/195 [02:33<00:19,  1.62it/s] 84%|████████▍ | 164/195 [02:33<00:18,  1.65it/s] 85%|████████▍ | 165/195 [02:34<00:19,  1.54it/s] 85%|████████▌ | 166/195 [02:35<00:18,  1.53it/s] 86%|████████▌ | 167/195 [02:35<00:18,  1.53it/s] 86%|████████▌ | 168/195 [02:36<00:16,  1.61it/s] 87%|████████▋ | 169/195 [02:37<00:16,  1.56it/s] 87%|████████▋ | 170/195 [02:37<00:15,  1.64it/s] 88%|████████▊ | 171/195 [02:38<00:15,  1.55it/s] 88%|████████▊ | 172/195 [02:38<00:14,  1.56it/s] 89%|████████▊ | 173/195 [02:39<00:14,  1.56it/s] 89%|████████▉ | 174/195 [02:40<00:13,  1.53it/s] 90%|████████▉ | 175/195 [02:40<00:13,  1.50it/s] 90%|█████████ | 176/195 [02:41<00:12,  1.48it/s] 91%|█████████ | 177/195 [02:42<00:12,  1.49it/s] 91%|█████████▏| 178/195 [02:42<00:11,  1.51it/s] 92%|█████████▏| 179/195 [02:43<00:10,  1.46it/s] 92%|█████████▏| 180/195 [02:44<00:09,  1.52it/s] 93%|█████████▎| 181/195 [02:45<00:09,  1.47it/s] 93%|█████████▎| 182/195 [02:45<00:08,  1.54it/s] 94%|█████████▍| 183/195 [02:46<00:08,  1.40it/s] 94%|█████████▍| 184/195 [02:47<00:07,  1.43it/s] 95%|█████████▍| 185/195 [02:47<00:06,  1.43it/s] 95%|█████████▌| 186/195 [02:48<00:06,  1.49it/s] 96%|█████████▌| 187/195 [02:49<00:05,  1.42it/s] 96%|█████████▋| 188/195 [02:49<00:04,  1.47it/s] 97%|█████████▋| 189/195 [02:50<00:04,  1.48it/s] 97%|█████████▋| 190/195 [02:51<00:03,  1.39it/s] 98%|█████████▊| 191/195 [02:51<00:02,  1.53it/s] 98%|█████████▊| 192/195 [02:52<00:02,  1.43it/s] 99%|█████████▉| 193/195 [02:53<00:01,  1.40it/s] 99%|█████████▉| 194/195 [02:54<00:00,  1.36it/s]100%|██████████| 195/195 [02:54<00:00,  1.75it/s]100%|██████████| 195/195 [02:56<00:00,  1.10it/s]
2025-09-24 09:53:02 [info     ] Validating outputs
2025-09-24 09:53:02 [info     ] Predict - end                  time=0:2:56
2025-09-24 09:53:02 [info     ] Evaluate - start               split=test
2025-09-24 09:53:02 [info     ] Evaluate - end                 answer_distr=[0.32, 0.29, 0.22, 0.16] correctness_llm=0.59 llm_group_correctness=[0.33, 0.33, 0.62, 0.79, 0.87] monotonicity=0.95
2025-09-24 09:53:02 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:53:02 [info     ] Augmenting questions for IRT estimation num_questions=7
2025-09-24 09:53:02 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:53:02 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1067.10it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3519.85it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 609.81it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5605.22it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 982.54it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3589.28it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 649.39it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5934.94it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 966.14it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3833.11it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 614.13it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5518.82it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1056.92it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3786.96it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 617.42it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5532.34it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 981.65it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3772.55it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 649.32it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6230.93it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1046.45it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3503.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 622.06it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5986.98it/s]
2025-09-24 09:53:07 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 09:53:07 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:53:07 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:53:07 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:53:07 [info     ] Evaluate question difficulty - end mae=1.39 rmse=1.73 split=test
2025-09-24 09:53:07 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 1 finished: 0:3:11

 ********** Run: 2/3 **********
2025-09-24 09:53:25 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:53:25 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:53:25 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:53:25 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:53:27 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:53:27 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:53:32 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:53:32 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:53:32 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:53:32 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:53:35 [info     ] Setting seed                   value=44
2025-09-24 09:53:35 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 09:53:35 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_kc_exact native_structured_output=True num_examples=3 system_prompt=teacher_dbe_miscons_level_context
2025-09-24 09:53:35 [info     ] Building example selector
2025-09-24 09:53:35 [info     ] Building model                 name=qwen3:14b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:53:35 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:15<48:48, 15.10s/it]  2%|▏         | 3/195 [00:18<16:01,  5.01s/it]  3%|▎         | 5/195 [00:22<11:03,  3.49s/it]  3%|▎         | 6/195 [00:22<08:29,  2.70s/it]  4%|▎         | 7/195 [00:24<07:33,  2.41s/it]  5%|▍         | 9/195 [00:25<05:15,  1.70s/it]  6%|▌         | 11/195 [00:28<04:27,  1.46s/it]  7%|▋         | 13/195 [00:29<03:40,  1.21s/it]  8%|▊         | 15/195 [00:30<02:59,  1.00it/s]  9%|▊         | 17/195 [00:32<02:41,  1.10it/s] 10%|▉         | 19/195 [00:33<02:35,  1.13it/s] 11%|█         | 21/195 [00:35<02:41,  1.07it/s] 11%|█▏        | 22/195 [00:36<02:15,  1.28it/s] 12%|█▏        | 23/195 [00:37<02:30,  1.14it/s] 13%|█▎        | 25/195 [00:38<02:23,  1.19it/s] 14%|█▍        | 27/195 [00:40<02:10,  1.29it/s] 15%|█▍        | 29/195 [00:41<02:01,  1.37it/s] 16%|█▌        | 31/195 [00:42<01:57,  1.39it/s] 17%|█▋        | 33/195 [00:44<01:52,  1.44it/s] 18%|█▊        | 35/195 [00:45<01:52,  1.42it/s] 19%|█▉        | 37/195 [00:46<01:49,  1.45it/s] 20%|██        | 39/195 [00:48<01:45,  1.48it/s] 21%|██        | 41/195 [00:49<01:41,  1.52it/s] 22%|██▏       | 43/195 [00:50<01:39,  1.53it/s] 23%|██▎       | 44/195 [00:51<01:33,  1.61it/s] 23%|██▎       | 45/195 [00:51<01:38,  1.53it/s] 24%|██▎       | 46/195 [00:52<01:33,  1.60it/s] 24%|██▍       | 47/195 [00:53<01:35,  1.55it/s] 25%|██▍       | 48/195 [00:53<01:31,  1.61it/s] 25%|██▌       | 49/195 [00:54<01:33,  1.57it/s] 26%|██▌       | 50/195 [00:55<01:42,  1.42it/s] 26%|██▌       | 51/195 [00:56<02:01,  1.18it/s] 27%|██▋       | 52/195 [00:57<02:10,  1.09it/s] 27%|██▋       | 53/195 [00:58<02:07,  1.11it/s] 28%|██▊       | 54/195 [00:59<02:02,  1.15it/s] 28%|██▊       | 55/195 [01:00<01:59,  1.17it/s] 29%|██▊       | 56/195 [01:01<02:16,  1.02it/s] 29%|██▉       | 57/195 [01:02<02:08,  1.07it/s] 30%|██▉       | 58/195 [01:03<02:11,  1.04it/s] 30%|███       | 59/195 [01:04<02:12,  1.03it/s] 31%|███       | 60/195 [01:05<02:06,  1.07it/s] 31%|███▏      | 61/195 [01:05<01:59,  1.12it/s] 32%|███▏      | 62/195 [01:06<01:56,  1.14it/s] 32%|███▏      | 63/195 [01:07<01:43,  1.28it/s] 33%|███▎      | 64/195 [01:08<01:42,  1.28it/s] 33%|███▎      | 65/195 [01:08<01:28,  1.46it/s] 34%|███▍      | 66/195 [01:09<01:46,  1.21it/s] 34%|███▍      | 67/195 [01:10<01:31,  1.40it/s] 35%|███▍      | 68/195 [01:11<01:38,  1.29it/s] 35%|███▌      | 69/195 [01:11<01:27,  1.44it/s] 36%|███▌      | 70/195 [01:12<01:31,  1.37it/s] 36%|███▋      | 71/195 [01:12<01:20,  1.54it/s] 37%|███▋      | 72/195 [01:13<01:38,  1.24it/s] 37%|███▋      | 73/195 [01:14<01:25,  1.43it/s] 38%|███▊      | 74/195 [01:15<01:51,  1.09it/s] 38%|███▊      | 75/195 [01:16<01:45,  1.14it/s] 39%|███▉      | 76/195 [01:17<01:54,  1.04it/s] 39%|███▉      | 77/195 [01:18<01:45,  1.12it/s] 40%|████      | 78/195 [01:19<01:45,  1.11it/s] 41%|████      | 79/195 [01:19<01:28,  1.31it/s] 41%|████      | 80/195 [01:20<01:37,  1.18it/s] 42%|████▏     | 81/195 [01:21<01:30,  1.26it/s] 42%|████▏     | 82/195 [01:22<01:26,  1.31it/s] 43%|████▎     | 83/195 [01:22<01:22,  1.35it/s] 43%|████▎     | 84/195 [01:23<01:22,  1.35it/s] 44%|████▎     | 85/195 [01:24<01:21,  1.36it/s] 44%|████▍     | 86/195 [01:25<01:21,  1.34it/s] 45%|████▍     | 87/195 [01:26<01:23,  1.30it/s] 45%|████▌     | 88/195 [01:26<01:18,  1.37it/s] 46%|████▌     | 89/195 [01:27<01:22,  1.29it/s] 46%|████▌     | 90/195 [01:28<01:18,  1.34it/s] 47%|████▋     | 91/195 [01:29<01:18,  1.33it/s] 47%|████▋     | 92/195 [01:29<01:15,  1.37it/s] 48%|████▊     | 93/195 [01:30<01:15,  1.35it/s] 48%|████▊     | 94/195 [01:31<01:12,  1.39it/s] 49%|████▊     | 95/195 [01:31<01:11,  1.40it/s] 50%|████▉     | 97/195 [01:32<01:04,  1.53it/s] 51%|█████     | 99/195 [01:34<01:00,  1.59it/s] 52%|█████▏    | 101/195 [01:36<01:22,  1.14it/s] 52%|█████▏    | 102/195 [01:37<01:23,  1.12it/s] 53%|█████▎    | 103/195 [01:39<01:42,  1.12s/it] 53%|█████▎    | 104/195 [01:40<01:38,  1.08s/it] 54%|█████▍    | 105/195 [01:42<01:45,  1.17s/it] 55%|█████▍    | 107/195 [01:43<01:32,  1.05s/it] 55%|█████▌    | 108/195 [01:44<01:25,  1.02it/s] 56%|█████▌    | 109/195 [01:45<01:21,  1.05it/s] 56%|█████▋    | 110/195 [01:46<01:14,  1.13it/s] 57%|█████▋    | 111/195 [01:46<01:12,  1.15it/s] 57%|█████▋    | 112/195 [01:47<01:09,  1.20it/s] 58%|█████▊    | 113/195 [01:48<01:14,  1.10it/s] 58%|█████▊    | 114/195 [01:49<01:11,  1.13it/s] 59%|█████▉    | 115/195 [01:50<01:21,  1.02s/it] 59%|█████▉    | 116/195 [01:51<01:18,  1.01it/s] 60%|██████    | 117/195 [01:53<01:36,  1.24s/it] 61%|██████    | 118/195 [01:54<01:29,  1.16s/it] 61%|██████    | 119/195 [01:56<01:45,  1.39s/it] 62%|██████▏   | 120/195 [01:57<01:30,  1.21s/it] 62%|██████▏   | 121/195 [01:58<01:20,  1.08s/it] 63%|██████▎   | 122/195 [01:58<01:11,  1.03it/s] 63%|██████▎   | 123/195 [01:59<01:01,  1.16it/s] 64%|██████▎   | 124/195 [02:00<00:57,  1.23it/s] 64%|██████▍   | 125/195 [02:00<00:54,  1.29it/s] 65%|██████▍   | 126/195 [02:01<00:51,  1.35it/s] 65%|██████▌   | 127/195 [02:02<00:47,  1.45it/s] 66%|██████▌   | 128/195 [02:02<00:46,  1.44it/s] 66%|██████▌   | 129/195 [02:03<00:41,  1.60it/s] 67%|██████▋   | 130/195 [02:04<00:46,  1.41it/s] 67%|██████▋   | 131/195 [02:04<00:40,  1.58it/s] 68%|██████▊   | 132/195 [02:05<00:44,  1.42it/s] 68%|██████▊   | 133/195 [02:05<00:39,  1.59it/s] 69%|██████▊   | 134/195 [02:06<00:41,  1.46it/s] 69%|██████▉   | 135/195 [02:07<00:37,  1.62it/s] 70%|██████▉   | 136/195 [02:08<00:40,  1.44it/s] 70%|███████   | 137/195 [02:08<00:29,  1.94it/s] 71%|███████   | 138/195 [02:09<00:41,  1.38it/s] 71%|███████▏  | 139/195 [02:10<00:37,  1.47it/s] 72%|███████▏  | 140/195 [02:10<00:37,  1.47it/s] 72%|███████▏  | 141/195 [02:11<00:37,  1.45it/s] 73%|███████▎  | 142/195 [02:12<00:36,  1.47it/s] 73%|███████▎  | 143/195 [02:12<00:35,  1.46it/s] 74%|███████▍  | 144/195 [02:13<00:32,  1.56it/s] 74%|███████▍  | 145/195 [02:14<00:33,  1.47it/s] 75%|███████▍  | 146/195 [02:14<00:31,  1.55it/s] 75%|███████▌  | 147/195 [02:15<00:33,  1.45it/s] 76%|███████▌  | 148/195 [02:15<00:28,  1.63it/s] 76%|███████▋  | 149/195 [02:16<00:32,  1.42it/s] 77%|███████▋  | 151/195 [02:18<00:31,  1.40it/s] 78%|███████▊  | 153/195 [02:19<00:30,  1.38it/s] 79%|███████▉  | 155/195 [02:20<00:27,  1.47it/s] 80%|████████  | 156/195 [02:21<00:25,  1.50it/s] 81%|████████  | 157/195 [02:22<00:25,  1.51it/s] 81%|████████  | 158/195 [02:22<00:23,  1.54it/s] 82%|████████▏ | 159/195 [02:23<00:22,  1.59it/s] 82%|████████▏ | 160/195 [02:24<00:23,  1.49it/s] 83%|████████▎ | 161/195 [02:24<00:22,  1.52it/s] 83%|████████▎ | 162/195 [02:25<00:22,  1.48it/s] 84%|████████▎ | 163/195 [02:26<00:20,  1.57it/s] 84%|████████▍ | 164/195 [02:26<00:20,  1.53it/s] 85%|████████▍ | 165/195 [02:27<00:19,  1.53it/s] 85%|████████▌ | 166/195 [02:28<00:20,  1.44it/s] 86%|████████▌ | 167/195 [02:28<00:19,  1.44it/s] 86%|████████▌ | 168/195 [02:29<00:18,  1.45it/s] 87%|████████▋ | 169/195 [02:30<00:17,  1.45it/s] 87%|████████▋ | 170/195 [02:30<00:16,  1.52it/s] 88%|████████▊ | 171/195 [02:31<00:16,  1.49it/s] 88%|████████▊ | 172/195 [02:32<00:15,  1.49it/s] 89%|████████▊ | 173/195 [02:32<00:14,  1.54it/s] 89%|████████▉ | 174/195 [02:33<00:14,  1.48it/s] 90%|████████▉ | 175/195 [02:34<00:12,  1.57it/s] 90%|█████████ | 176/195 [02:34<00:13,  1.42it/s] 91%|█████████ | 177/195 [02:35<00:11,  1.59it/s] 91%|█████████▏| 178/195 [02:36<00:11,  1.47it/s] 92%|█████████▏| 179/195 [02:36<00:09,  1.63it/s] 92%|█████████▏| 180/195 [02:37<00:10,  1.43it/s] 93%|█████████▎| 181/195 [02:38<00:08,  1.60it/s] 93%|█████████▎| 182/195 [02:38<00:09,  1.37it/s] 94%|█████████▍| 183/195 [02:39<00:07,  1.54it/s] 94%|█████████▍| 184/195 [02:40<00:08,  1.33it/s] 95%|█████████▍| 185/195 [02:40<00:06,  1.50it/s] 95%|█████████▌| 186/195 [02:41<00:06,  1.46it/s] 96%|█████████▋| 188/195 [02:42<00:04,  1.47it/s] 97%|█████████▋| 189/195 [02:43<00:04,  1.46it/s] 97%|█████████▋| 190/195 [02:44<00:03,  1.47it/s] 98%|█████████▊| 191/195 [02:45<00:02,  1.37it/s] 98%|█████████▊| 192/195 [02:46<00:02,  1.33it/s] 99%|█████████▉| 193/195 [02:46<00:01,  1.33it/s] 99%|█████████▉| 194/195 [02:47<00:00,  1.34it/s]100%|██████████| 195/195 [02:47<00:00,  1.77it/s]100%|██████████| 195/195 [02:49<00:00,  1.15it/s]
2025-09-24 09:56:25 [info     ] Validating outputs
2025-09-24 09:56:25 [info     ] Predict - end                  time=0:2:49
2025-09-24 09:56:25 [info     ] Evaluate - start               split=test
2025-09-24 09:56:25 [info     ] Evaluate - end                 answer_distr=[0.31, 0.27, 0.18, 0.24] correctness_llm=0.57 llm_group_correctness=[0.33, 0.38, 0.51, 0.77, 0.87] monotonicity=0.94
2025-09-24 09:56:25 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:56:25 [info     ] Augmenting questions for IRT estimation num_questions=6
2025-09-24 09:56:25 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:56:25 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1167.54it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3564.18it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 573.21it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 9446.63it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1017.33it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3606.53it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 547.84it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6620.10it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1113.90it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3593.38it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 628.98it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6384.02it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1037.61it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 4092.21it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 578.19it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6499.92it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1090.00it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3717.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 595.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6319.44it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 984.12it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3661.75it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 613.03it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6540.46it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1054.45it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 4108.24it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 587.42it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6547.75it/s]
2025-09-24 09:56:31 INFO: EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
2025-09-24 09:56:31 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:56:31 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:56:31 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:56:31 [info     ] Evaluate question difficulty - end mae=1.19 rmse=1.44 split=test
2025-09-24 09:56:31 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 2 finished: 0:3:5

 ********** Run: 3/3 **********
2025-09-24 09:56:52 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 09:56:52 [info     ] Reading train split questions  num_questions=92
2025-09-24 09:56:52 [info     ] Reading validation split questions num_questions=23
2025-09-24 09:56:52 [info     ] Reading test split questions   num_questions=39
2025-09-24 09:56:53 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 09:56:53 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 09:56:58 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 09:56:58 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 09:56:58 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 09:56:59 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 09:57:02 [info     ] Setting seed                   value=45
2025-09-24 09:57:02 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 09:57:02 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_kc_exact native_structured_output=True num_examples=3 system_prompt=teacher_dbe_miscons_level_context
2025-09-24 09:57:02 [info     ] Building example selector
2025-09-24 09:57:02 [info     ] Building model                 name=qwen3:14b provider=ollama rate_limit=None temp=1.0
2025-09-24 09:57:02 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:14<46:04, 14.25s/it]  1%|          | 2/195 [00:14<19:05,  5.94s/it]  2%|▏         | 3/195 [00:18<16:27,  5.14s/it]  3%|▎         | 5/195 [00:22<10:13,  3.23s/it]  4%|▎         | 7/195 [00:24<06:59,  2.23s/it]  4%|▍         | 8/195 [00:24<05:55,  1.90s/it]  5%|▍         | 9/195 [00:26<05:33,  1.79s/it]  5%|▌         | 10/195 [00:27<04:45,  1.55s/it]  6%|▌         | 11/195 [00:28<04:23,  1.43s/it]  6%|▌         | 12/195 [00:28<03:34,  1.17s/it]  7%|▋         | 13/195 [00:29<03:10,  1.04s/it]  7%|▋         | 14/195 [00:30<03:01,  1.01s/it]  8%|▊         | 15/195 [00:31<02:40,  1.12it/s]  8%|▊         | 16/195 [00:32<02:40,  1.11it/s]  9%|▊         | 17/195 [00:32<02:30,  1.18it/s]  9%|▉         | 18/195 [00:33<02:25,  1.22it/s] 10%|▉         | 19/195 [00:34<02:25,  1.21it/s] 10%|█         | 20/195 [00:35<02:34,  1.13it/s] 11%|█         | 21/195 [00:36<02:20,  1.23it/s] 11%|█▏        | 22/195 [00:36<02:20,  1.24it/s] 12%|█▏        | 23/195 [00:37<02:12,  1.30it/s] 12%|█▏        | 24/195 [00:38<02:15,  1.26it/s] 13%|█▎        | 25/195 [00:38<02:01,  1.40it/s] 13%|█▎        | 26/195 [00:39<02:03,  1.37it/s] 14%|█▍        | 27/195 [00:40<01:48,  1.54it/s] 14%|█▍        | 28/195 [00:41<01:56,  1.43it/s] 15%|█▍        | 29/195 [00:41<01:44,  1.58it/s] 15%|█▌        | 30/195 [00:42<02:01,  1.36it/s] 16%|█▌        | 31/195 [00:42<01:46,  1.53it/s] 16%|█▋        | 32/195 [00:43<02:01,  1.34it/s] 17%|█▋        | 33/195 [00:44<01:46,  1.51it/s] 17%|█▋        | 34/195 [00:45<01:57,  1.37it/s] 18%|█▊        | 35/195 [00:45<01:50,  1.45it/s] 18%|█▊        | 36/195 [00:46<01:56,  1.36it/s] 19%|█▉        | 37/195 [00:46<01:26,  1.83it/s] 19%|█▉        | 38/195 [00:47<01:56,  1.35it/s] 20%|██        | 39/195 [00:48<01:50,  1.41it/s] 21%|██        | 40/195 [00:49<01:49,  1.42it/s] 21%|██        | 41/195 [00:50<01:48,  1.42it/s] 22%|██▏       | 42/195 [00:50<01:49,  1.40it/s] 22%|██▏       | 43/195 [00:51<01:43,  1.48it/s] 23%|██▎       | 44/195 [00:52<01:41,  1.48it/s] 23%|██▎       | 45/195 [00:52<01:37,  1.54it/s] 24%|██▎       | 46/195 [00:53<01:41,  1.47it/s] 24%|██▍       | 47/195 [00:53<01:35,  1.55it/s] 25%|██▍       | 48/195 [00:54<01:35,  1.54it/s] 25%|██▌       | 49/195 [00:55<01:30,  1.61it/s] 26%|██▌       | 50/195 [00:56<01:51,  1.30it/s] 26%|██▌       | 51/195 [00:57<02:05,  1.15it/s] 27%|██▋       | 52/195 [00:58<02:06,  1.13it/s] 27%|██▋       | 53/195 [00:59<02:20,  1.01it/s] 28%|██▊       | 54/195 [00:59<01:42,  1.38it/s] 28%|██▊       | 55/195 [01:01<02:31,  1.08s/it] 29%|██▊       | 56/195 [01:02<02:07,  1.09it/s] 29%|██▉       | 57/195 [01:03<02:42,  1.18s/it] 30%|██▉       | 58/195 [01:04<02:31,  1.10s/it] 30%|███       | 59/195 [01:05<02:34,  1.13s/it] 31%|███       | 60/195 [01:06<02:24,  1.07s/it] 31%|███▏      | 61/195 [01:08<02:29,  1.11s/it] 32%|███▏      | 62/195 [01:08<02:00,  1.10it/s] 32%|███▏      | 63/195 [01:09<02:12,  1.00s/it] 33%|███▎      | 64/195 [01:10<02:02,  1.07it/s] 33%|███▎      | 65/195 [01:11<02:07,  1.02it/s] 34%|███▍      | 66/195 [01:12<02:06,  1.02it/s] 34%|███▍      | 67/195 [01:13<01:56,  1.10it/s] 35%|███▍      | 68/195 [01:14<01:53,  1.12it/s] 35%|███▌      | 69/195 [01:15<02:00,  1.04it/s] 36%|███▌      | 70/195 [01:15<01:47,  1.16it/s] 36%|███▋      | 71/195 [01:16<01:49,  1.13it/s] 37%|███▋      | 73/195 [01:18<01:32,  1.33it/s] 38%|███▊      | 74/195 [01:18<01:11,  1.69it/s] 38%|███▊      | 75/195 [01:19<01:40,  1.19it/s] 39%|███▉      | 77/195 [01:21<01:35,  1.24it/s] 41%|████      | 79/195 [01:22<01:34,  1.23it/s] 42%|████▏     | 81/195 [01:24<01:28,  1.28it/s] 42%|████▏     | 82/195 [01:24<01:20,  1.40it/s] 43%|████▎     | 83/195 [01:25<01:25,  1.30it/s] 43%|████▎     | 84/195 [01:26<01:21,  1.36it/s] 44%|████▎     | 85/195 [01:27<01:21,  1.35it/s] 44%|████▍     | 86/195 [01:27<01:17,  1.41it/s] 45%|████▍     | 87/195 [01:28<01:21,  1.33it/s] 46%|████▌     | 89/195 [01:30<01:19,  1.34it/s] 46%|████▌     | 90/195 [01:30<01:11,  1.47it/s] 47%|████▋     | 91/195 [01:31<01:17,  1.34it/s] 47%|████▋     | 92/195 [01:32<01:13,  1.40it/s] 48%|████▊     | 93/195 [01:33<01:16,  1.33it/s] 48%|████▊     | 94/195 [01:33<01:13,  1.37it/s] 49%|████▊     | 95/195 [01:34<01:07,  1.47it/s] 49%|████▉     | 96/195 [01:34<01:01,  1.62it/s] 50%|████▉     | 97/195 [01:35<00:58,  1.66it/s] 50%|█████     | 98/195 [01:35<00:55,  1.74it/s] 51%|█████     | 99/195 [01:36<01:00,  1.58it/s] 51%|█████▏    | 100/195 [01:37<01:19,  1.20it/s] 52%|█████▏    | 101/195 [01:39<01:33,  1.01it/s] 52%|█████▏    | 102/195 [01:40<01:46,  1.14s/it] 53%|█████▎    | 103/195 [01:41<01:39,  1.08s/it] 53%|█████▎    | 104/195 [01:43<02:00,  1.33s/it] 54%|█████▍    | 105/195 [01:44<01:50,  1.23s/it] 54%|█████▍    | 106/195 [01:45<01:51,  1.25s/it] 55%|█████▍    | 107/195 [01:46<01:41,  1.16s/it] 55%|█████▌    | 108/195 [01:47<01:36,  1.11s/it] 56%|█████▌    | 109/195 [01:48<01:18,  1.09it/s] 56%|█████▋    | 110/195 [01:49<01:22,  1.03it/s] 57%|█████▋    | 111/195 [01:49<01:08,  1.22it/s] 57%|█████▋    | 112/195 [01:50<01:16,  1.09it/s] 58%|█████▊    | 113/195 [01:51<01:04,  1.27it/s] 58%|█████▊    | 114/195 [01:52<01:18,  1.03it/s] 59%|█████▉    | 116/195 [01:55<01:29,  1.13s/it] 61%|██████    | 118/195 [01:58<01:34,  1.22s/it] 62%|██████▏   | 120/195 [02:00<01:26,  1.16s/it] 62%|██████▏   | 121/195 [02:00<01:15,  1.02s/it] 63%|██████▎   | 122/195 [02:01<01:14,  1.02s/it] 63%|██████▎   | 123/195 [02:02<01:06,  1.09it/s] 64%|██████▎   | 124/195 [02:03<01:02,  1.14it/s] 64%|██████▍   | 125/195 [02:03<00:58,  1.19it/s] 65%|██████▍   | 126/195 [02:04<00:57,  1.21it/s] 65%|██████▌   | 127/195 [02:05<00:52,  1.29it/s] 66%|██████▌   | 128/195 [02:06<00:49,  1.35it/s] 66%|██████▌   | 129/195 [02:06<00:45,  1.47it/s] 67%|██████▋   | 130/195 [02:07<00:46,  1.39it/s] 67%|██████▋   | 131/195 [02:08<00:45,  1.41it/s] 68%|██████▊   | 132/195 [02:08<00:46,  1.36it/s] 69%|██████▊   | 134/195 [02:10<00:43,  1.42it/s] 70%|██████▉   | 136/195 [02:11<00:41,  1.42it/s] 71%|███████   | 138/195 [02:12<00:39,  1.45it/s] 72%|███████▏  | 140/195 [02:14<00:36,  1.50it/s] 73%|███████▎  | 142/195 [02:15<00:34,  1.52it/s] 74%|███████▍  | 144/195 [02:16<00:34,  1.50it/s] 75%|███████▍  | 146/195 [02:18<00:32,  1.53it/s] 75%|███████▌  | 147/195 [02:18<00:26,  1.81it/s] 76%|███████▌  | 148/195 [02:19<00:32,  1.46it/s] 76%|███████▋  | 149/195 [02:19<00:25,  1.82it/s] 77%|███████▋  | 150/195 [02:20<00:33,  1.34it/s] 78%|███████▊  | 152/195 [02:22<00:30,  1.40it/s] 78%|███████▊  | 153/195 [02:22<00:24,  1.73it/s] 79%|███████▉  | 154/195 [02:23<00:30,  1.36it/s] 79%|███████▉  | 155/195 [02:24<00:27,  1.44it/s] 80%|████████  | 156/195 [02:24<00:25,  1.51it/s] 81%|████████  | 157/195 [02:25<00:25,  1.51it/s] 81%|████████  | 158/195 [02:25<00:23,  1.58it/s] 82%|████████▏ | 159/195 [02:26<00:21,  1.70it/s] 82%|████████▏ | 160/195 [02:27<00:22,  1.55it/s] 83%|████████▎ | 161/195 [02:27<00:21,  1.61it/s] 83%|████████▎ | 162/195 [02:28<00:20,  1.58it/s] 84%|████████▎ | 163/195 [02:28<00:19,  1.66it/s] 84%|████████▍ | 164/195 [02:29<00:19,  1.57it/s] 85%|████████▍ | 165/195 [02:30<00:18,  1.61it/s] 85%|████████▌ | 166/195 [02:30<00:19,  1.49it/s] 86%|████████▌ | 167/195 [02:31<00:19,  1.45it/s] 86%|████████▌ | 168/195 [02:32<00:18,  1.47it/s] 87%|████████▋ | 169/195 [02:33<00:17,  1.46it/s] 87%|████████▋ | 170/195 [02:33<00:16,  1.54it/s] 88%|████████▊ | 171/195 [02:34<00:15,  1.53it/s] 88%|████████▊ | 172/195 [02:34<00:14,  1.60it/s] 89%|████████▊ | 173/195 [02:35<00:13,  1.58it/s] 89%|████████▉ | 174/195 [02:36<00:13,  1.60it/s] 90%|████████▉ | 175/195 [02:36<00:12,  1.61it/s] 90%|█████████ | 176/195 [02:37<00:11,  1.63it/s] 91%|█████████ | 177/195 [02:37<00:11,  1.63it/s] 91%|█████████▏| 178/195 [02:38<00:10,  1.63it/s] 92%|█████████▏| 179/195 [02:39<00:09,  1.62it/s] 92%|█████████▏| 180/195 [02:39<00:09,  1.65it/s] 93%|█████████▎| 181/195 [02:40<00:08,  1.57it/s] 93%|█████████▎| 182/195 [02:40<00:07,  1.65it/s] 94%|█████████▍| 183/195 [02:41<00:07,  1.52it/s] 94%|█████████▍| 184/195 [02:42<00:06,  1.68it/s] 95%|█████████▍| 185/195 [02:43<00:06,  1.47it/s] 95%|█████████▌| 186/195 [02:43<00:05,  1.65it/s] 96%|█████████▌| 187/195 [02:44<00:05,  1.39it/s] 96%|█████████▋| 188/195 [02:44<00:04,  1.58it/s] 97%|█████████▋| 189/195 [02:45<00:04,  1.31it/s] 98%|█████████▊| 191/195 [02:47<00:02,  1.36it/s] 99%|█████████▉| 193/195 [02:48<00:01,  1.37it/s]100%|██████████| 195/195 [02:49<00:00,  1.64it/s]100%|██████████| 195/195 [02:51<00:00,  1.14it/s]
2025-09-24 09:59:53 [info     ] Validating outputs
2025-09-24 09:59:53 [info     ] Predict - end                  time=0:2:51
2025-09-24 09:59:53 [info     ] Evaluate - start               split=test
2025-09-24 09:59:53 [info     ] Evaluate - end                 answer_distr=[0.29, 0.27, 0.23, 0.19] correctness_llm=0.6 llm_group_correctness=[0.38, 0.33, 0.49, 0.9, 0.9] monotonicity=0.64
2025-09-24 09:59:53 [info     ] Evaluate question difficulty - start split=test
2025-09-24 09:59:53 [info     ] Augmenting questions for IRT estimation num_questions=6
2025-09-24 09:59:53 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 09:59:53 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 981.35it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3952.68it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 574.55it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7157.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1039.52it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3582.05it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 643.22it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7489.83it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1009.32it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3689.00it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 620.94it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8272.79it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 810.14it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3532.31it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 565.21it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7078.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1159.15it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3562.55it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 586.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7084.97it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1133.42it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3873.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 605.24it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7341.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1153.87it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3722.92it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 745.89it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7423.55it/s]
2025-09-24 09:59:59 INFO: EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
2025-09-24 09:59:59 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 09:59:59 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 09:59:59 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 09:59:59 [info     ] Evaluate question difficulty - end mae=1.57 rmse=1.93 split=test
2025-09-24 09:59:59 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 3 finished: 0:3:6

 ========== Config: qwen3:8b~T_1.0~SO_teacher_bool_nocontext~L_5~SP_teacher_dbe_miscons_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_dbe_studentlevel_kc_exact3 ==========
Config 9/16

 ********** Run: 1/3 **********
2025-09-24 10:00:19 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:00:19 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:00:19 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:00:19 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:00:20 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:00:20 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:00:25 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:00:25 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:00:25 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:00:26 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:00:29 [info     ] Setting seed                   value=43
2025-09-24 10:00:29 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 10:00:29 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_kc_exact native_structured_output=True num_examples=3 system_prompt=teacher_dbe_miscons_level_context
2025-09-24 10:00:29 [info     ] Building example selector
2025-09-24 10:00:29 [info     ] Building model                 name=qwen3:8b provider=ollama rate_limit=None temp=1.0
2025-09-24 10:00:29 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:15<48:50, 15.11s/it]  1%|          | 2/195 [00:15<20:45,  6.45s/it]  2%|▏         | 3/195 [00:17<14:27,  4.52s/it]  2%|▏         | 4/195 [00:18<09:50,  3.09s/it]  3%|▎         | 5/195 [00:19<07:46,  2.45s/it]  3%|▎         | 6/195 [00:20<05:28,  1.74s/it]  4%|▎         | 7/195 [00:21<05:14,  1.68s/it]  4%|▍         | 8/195 [00:22<03:54,  1.26s/it]  5%|▍         | 9/195 [00:23<03:35,  1.16s/it]  6%|▌         | 11/195 [00:24<02:49,  1.08it/s]  6%|▌         | 12/195 [00:24<02:22,  1.28it/s]  7%|▋         | 13/195 [00:25<02:23,  1.27it/s]  8%|▊         | 15/195 [00:26<02:04,  1.44it/s]  8%|▊         | 16/195 [00:27<01:54,  1.56it/s]  9%|▊         | 17/195 [00:27<01:54,  1.55it/s]  9%|▉         | 18/195 [00:28<01:55,  1.53it/s] 10%|▉         | 19/195 [00:29<02:02,  1.44it/s] 10%|█         | 20/195 [00:29<01:54,  1.53it/s] 11%|█         | 21/195 [00:30<01:48,  1.61it/s] 11%|█▏        | 22/195 [00:30<01:34,  1.84it/s] 12%|█▏        | 23/195 [00:31<01:37,  1.77it/s] 12%|█▏        | 24/195 [00:32<01:38,  1.73it/s] 13%|█▎        | 25/195 [00:32<01:32,  1.84it/s] 13%|█▎        | 26/195 [00:33<01:30,  1.88it/s] 14%|█▍        | 27/195 [00:33<01:26,  1.95it/s] 14%|█▍        | 28/195 [00:33<01:24,  1.98it/s] 15%|█▍        | 29/195 [00:34<01:21,  2.05it/s] 15%|█▌        | 30/195 [00:34<01:21,  2.03it/s] 16%|█▌        | 31/195 [00:35<01:17,  2.11it/s] 16%|█▋        | 32/195 [00:35<01:18,  2.08it/s] 17%|█▋        | 33/195 [00:36<01:18,  2.06it/s] 17%|█▋        | 34/195 [00:36<01:20,  2.01it/s] 18%|█▊        | 35/195 [00:37<01:15,  2.13it/s] 18%|█▊        | 36/195 [00:37<01:16,  2.07it/s] 19%|█▉        | 37/195 [00:38<01:15,  2.09it/s] 19%|█▉        | 38/195 [00:38<01:18,  2.01it/s] 21%|██        | 40/195 [00:39<01:12,  2.13it/s] 21%|██        | 41/195 [00:39<01:05,  2.35it/s] 22%|██▏       | 42/195 [00:40<01:11,  2.14it/s] 22%|██▏       | 43/195 [00:40<01:03,  2.38it/s] 23%|██▎       | 44/195 [00:41<01:10,  2.14it/s] 23%|██▎       | 45/195 [00:41<01:02,  2.40it/s] 24%|██▎       | 46/195 [00:42<01:08,  2.17it/s] 24%|██▍       | 47/195 [00:42<01:00,  2.45it/s] 25%|██▍       | 48/195 [00:43<01:09,  2.11it/s] 25%|██▌       | 49/195 [00:43<01:01,  2.38it/s] 26%|██▌       | 50/195 [00:44<01:22,  1.77it/s] 26%|██▌       | 51/195 [00:44<01:19,  1.81it/s] 27%|██▋       | 52/195 [00:45<01:25,  1.68it/s] 27%|██▋       | 53/195 [00:46<01:28,  1.61it/s] 28%|██▊       | 54/195 [00:47<01:31,  1.54it/s] 28%|██▊       | 55/195 [00:47<01:31,  1.53it/s] 29%|██▊       | 56/195 [00:48<01:32,  1.50it/s] 29%|██▉       | 57/195 [00:49<01:36,  1.44it/s] 30%|██▉       | 58/195 [00:49<01:31,  1.50it/s] 30%|███       | 59/195 [00:50<01:40,  1.35it/s] 31%|███       | 60/195 [00:50<01:23,  1.62it/s] 31%|███▏      | 61/195 [00:52<01:39,  1.34it/s] 32%|███▏      | 63/195 [00:53<01:28,  1.49it/s] 33%|███▎      | 65/195 [00:54<01:19,  1.63it/s] 34%|███▍      | 67/195 [00:55<01:19,  1.61it/s] 35%|███▌      | 69/195 [00:56<01:13,  1.72it/s] 36%|███▌      | 70/195 [00:56<01:05,  1.90it/s] 36%|███▋      | 71/195 [00:57<01:14,  1.67it/s] 37%|███▋      | 72/195 [00:57<01:04,  1.90it/s] 37%|███▋      | 73/195 [00:58<01:07,  1.81it/s] 38%|███▊      | 74/195 [00:58<00:58,  2.06it/s] 38%|███▊      | 75/195 [00:59<01:05,  1.83it/s] 39%|███▉      | 76/195 [01:00<01:03,  1.88it/s] 39%|███▉      | 77/195 [01:00<01:03,  1.87it/s] 40%|████      | 78/195 [01:01<01:04,  1.80it/s] 41%|████      | 79/195 [01:01<01:05,  1.77it/s] 41%|████      | 80/195 [01:02<01:02,  1.85it/s] 42%|████▏     | 81/195 [01:02<01:01,  1.85it/s] 42%|████▏     | 82/195 [01:03<00:58,  1.93it/s] 43%|████▎     | 83/195 [01:03<00:58,  1.92it/s] 43%|████▎     | 84/195 [01:04<00:53,  2.06it/s] 44%|████▎     | 85/195 [01:04<00:53,  2.07it/s] 44%|████▍     | 86/195 [01:05<00:52,  2.07it/s] 45%|████▍     | 87/195 [01:05<00:49,  2.17it/s] 45%|████▌     | 88/195 [01:06<00:52,  2.05it/s] 46%|████▌     | 89/195 [01:06<00:51,  2.07it/s] 46%|████▌     | 90/195 [01:07<00:53,  1.95it/s] 47%|████▋     | 92/195 [01:08<00:50,  2.03it/s] 48%|████▊     | 94/195 [01:09<00:49,  2.02it/s] 49%|████▊     | 95/195 [01:09<00:44,  2.24it/s] 49%|████▉     | 96/195 [01:09<00:43,  2.26it/s] 50%|████▉     | 97/195 [01:10<00:41,  2.37it/s] 50%|█████     | 98/195 [01:10<00:38,  2.50it/s] 51%|█████     | 99/195 [01:10<00:38,  2.47it/s] 51%|█████▏    | 100/195 [01:11<00:48,  1.97it/s] 52%|█████▏    | 101/195 [01:12<01:00,  1.56it/s] 52%|█████▏    | 102/195 [01:13<01:05,  1.41it/s] 53%|█████▎    | 103/195 [01:14<01:13,  1.25it/s] 53%|█████▎    | 104/195 [01:15<01:14,  1.23it/s] 54%|█████▍    | 105/195 [01:16<01:10,  1.27it/s] 54%|█████▍    | 106/195 [01:16<00:57,  1.56it/s] 55%|█████▍    | 107/195 [01:17<01:04,  1.36it/s] 56%|█████▌    | 109/195 [01:18<00:58,  1.47it/s] 57%|█████▋    | 111/195 [01:19<00:50,  1.68it/s] 58%|█████▊    | 113/195 [01:20<00:48,  1.69it/s] 58%|█████▊    | 114/195 [01:21<00:43,  1.87it/s] 59%|█████▉    | 115/195 [01:22<00:54,  1.48it/s] 59%|█████▉    | 116/195 [01:23<00:56,  1.39it/s] 60%|██████    | 117/195 [01:24<01:00,  1.28it/s] 61%|██████    | 118/195 [01:24<01:01,  1.26it/s] 61%|██████    | 119/195 [01:25<01:03,  1.20it/s] 62%|██████▏   | 120/195 [01:26<00:55,  1.35it/s] 62%|██████▏   | 121/195 [01:26<00:50,  1.46it/s] 63%|██████▎   | 122/195 [01:27<00:43,  1.67it/s] 63%|██████▎   | 123/195 [01:27<00:39,  1.82it/s] 64%|██████▎   | 124/195 [01:28<00:37,  1.90it/s] 64%|██████▍   | 125/195 [01:28<00:33,  2.09it/s] 65%|██████▍   | 126/195 [01:29<00:34,  1.97it/s] 65%|██████▌   | 127/195 [01:29<00:30,  2.25it/s] 66%|██████▌   | 128/195 [01:30<00:32,  2.03it/s] 66%|██████▌   | 129/195 [01:30<00:28,  2.32it/s] 67%|██████▋   | 130/195 [01:30<00:32,  2.01it/s] 67%|██████▋   | 131/195 [01:31<00:27,  2.30it/s] 68%|██████▊   | 132/195 [01:31<00:32,  1.92it/s] 69%|██████▊   | 134/195 [01:32<00:29,  2.06it/s] 69%|██████▉   | 135/195 [01:33<00:26,  2.30it/s] 70%|██████▉   | 136/195 [01:33<00:29,  2.00it/s] 70%|███████   | 137/195 [01:34<00:26,  2.20it/s] 71%|███████   | 138/195 [01:34<00:27,  2.10it/s] 71%|███████▏  | 139/195 [01:35<00:26,  2.12it/s] 72%|███████▏  | 140/195 [01:35<00:26,  2.09it/s] 72%|███████▏  | 141/195 [01:35<00:23,  2.27it/s] 73%|███████▎  | 142/195 [01:36<00:23,  2.24it/s] 73%|███████▎  | 143/195 [01:36<00:22,  2.29it/s] 74%|███████▍  | 144/195 [01:37<00:23,  2.21it/s] 74%|███████▍  | 145/195 [01:37<00:22,  2.26it/s] 75%|███████▍  | 146/195 [01:38<00:22,  2.18it/s] 75%|███████▌  | 147/195 [01:38<00:22,  2.16it/s] 76%|███████▌  | 148/195 [01:39<00:22,  2.06it/s] 76%|███████▋  | 149/195 [01:39<00:21,  2.18it/s] 77%|███████▋  | 150/195 [01:40<00:20,  2.22it/s] 77%|███████▋  | 151/195 [01:40<00:21,  2.02it/s] 78%|███████▊  | 152/195 [01:41<00:20,  2.09it/s] 78%|███████▊  | 153/195 [01:41<00:20,  2.04it/s] 79%|███████▉  | 154/195 [01:42<00:19,  2.07it/s] 79%|███████▉  | 155/195 [01:42<00:19,  2.06it/s] 81%|████████  | 157/195 [01:43<00:16,  2.33it/s] 81%|████████  | 158/195 [01:43<00:14,  2.52it/s] 82%|████████▏ | 159/195 [01:44<00:16,  2.15it/s] 82%|████████▏ | 160/195 [01:44<00:14,  2.39it/s] 83%|████████▎ | 161/195 [01:45<00:15,  2.19it/s] 83%|████████▎ | 162/195 [01:45<00:13,  2.42it/s] 84%|████████▎ | 163/195 [01:45<00:14,  2.28it/s] 84%|████████▍ | 164/195 [01:46<00:13,  2.32it/s] 85%|████████▍ | 165/195 [01:46<00:13,  2.21it/s] 85%|████████▌ | 166/195 [01:47<00:12,  2.26it/s] 86%|████████▌ | 167/195 [01:47<00:12,  2.22it/s] 86%|████████▌ | 168/195 [01:48<00:11,  2.25it/s] 87%|████████▋ | 169/195 [01:48<00:11,  2.35it/s] 87%|████████▋ | 170/195 [01:49<00:11,  2.20it/s] 88%|████████▊ | 171/195 [01:49<00:09,  2.46it/s] 88%|████████▊ | 172/195 [01:50<00:10,  2.10it/s] 89%|████████▉ | 174/195 [01:50<00:09,  2.25it/s] 90%|████████▉ | 175/195 [01:51<00:08,  2.31it/s] 90%|█████████ | 176/195 [01:51<00:08,  2.24it/s] 91%|█████████ | 177/195 [01:52<00:08,  2.20it/s] 91%|█████████▏| 178/195 [01:52<00:08,  2.11it/s] 92%|█████████▏| 179/195 [01:53<00:07,  2.12it/s] 92%|█████████▏| 180/195 [01:53<00:06,  2.15it/s] 93%|█████████▎| 181/195 [01:54<00:06,  2.15it/s] 93%|█████████▎| 182/195 [01:54<00:05,  2.19it/s] 94%|█████████▍| 183/195 [01:54<00:05,  2.20it/s] 94%|█████████▍| 184/195 [01:55<00:04,  2.23it/s] 95%|█████████▍| 185/195 [01:55<00:04,  2.21it/s] 95%|█████████▌| 186/195 [01:56<00:03,  2.37it/s] 96%|█████████▌| 187/195 [01:56<00:03,  2.34it/s] 96%|█████████▋| 188/195 [01:57<00:02,  2.46it/s] 97%|█████████▋| 189/195 [01:57<00:02,  2.29it/s] 97%|█████████▋| 190/195 [01:57<00:01,  2.53it/s] 98%|█████████▊| 191/195 [01:58<00:01,  2.03it/s] 99%|█████████▉| 193/195 [01:59<00:00,  2.08it/s] 99%|█████████▉| 194/195 [01:59<00:00,  2.32it/s]100%|██████████| 195/195 [02:00<00:00,  2.45it/s]100%|██████████| 195/195 [02:02<00:00,  1.59it/s]
2025-09-24 10:02:31 [info     ] Validating outputs
2025-09-24 10:02:31 [info     ] Predict - end                  time=0:2:2
2025-09-24 10:02:31 [info     ] Evaluate - start               split=test
2025-09-24 10:02:31 [info     ] Evaluate - end                 answer_distr=[0.36, 0.24, 0.13, 0.27] correctness_llm=0.74 llm_group_correctness=[0.59, 0.64, 0.74, 0.82, 0.9] monotonicity=0.98
2025-09-24 10:02:31 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:02:31 [info     ] Augmenting questions for IRT estimation num_questions=17
2025-09-24 10:02:31 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:02:31 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 984.25it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3507.62it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 599.65it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5405.03it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 910.93it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3533.46it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 596.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5550.12it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 928.15it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3601.13it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 613.76it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5613.79it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 941.45it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3726.32it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 598.07it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5613.79it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 934.32it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3695.92it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 708.05it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5084.00it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1022.61it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3633.45it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 711.10it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5612.72it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 919.46it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3979.80it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 618.22it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5104.33it/s]
2025-09-24 10:02:36 INFO: EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
2025-09-24 10:02:36 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:02:36 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:02:36 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:02:36 [info     ] Evaluate question difficulty - end mae=1.29 rmse=1.83 split=test
2025-09-24 10:02:36 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 1 finished: 0:2:17

 ********** Run: 2/3 **********
2025-09-24 10:02:54 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:02:54 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:02:54 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:02:54 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:02:56 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:02:56 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:03:01 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:03:01 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:03:01 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:03:02 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:03:05 [info     ] Setting seed                   value=44
2025-09-24 10:03:05 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 10:03:05 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_kc_exact native_structured_output=True num_examples=3 system_prompt=teacher_dbe_miscons_level_context
2025-09-24 10:03:05 [info     ] Building example selector
2025-09-24 10:03:05 [info     ] Building model                 name=qwen3:8b provider=ollama rate_limit=None temp=1.0
2025-09-24 10:03:05 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:13<43:55, 13.59s/it]  1%|          | 2/195 [00:14<19:52,  6.18s/it]  2%|▏         | 3/195 [00:16<14:05,  4.41s/it]  2%|▏         | 4/195 [00:17<09:23,  2.95s/it]  3%|▎         | 5/195 [00:18<07:16,  2.29s/it]  3%|▎         | 6/195 [00:19<05:39,  1.80s/it]  4%|▎         | 7/195 [00:20<04:26,  1.42s/it]  4%|▍         | 8/195 [00:20<03:37,  1.16s/it]  5%|▍         | 9/195 [00:21<03:09,  1.02s/it]  5%|▌         | 10/195 [00:22<02:54,  1.06it/s]  6%|▌         | 11/195 [00:22<02:29,  1.23it/s]  6%|▌         | 12/195 [00:23<02:09,  1.41it/s]  7%|▋         | 13/195 [00:23<02:06,  1.44it/s]  7%|▋         | 14/195 [00:24<02:10,  1.39it/s]  8%|▊         | 15/195 [00:25<01:52,  1.60it/s]  8%|▊         | 16/195 [00:25<01:44,  1.70it/s]  9%|▊         | 17/195 [00:26<01:47,  1.65it/s]  9%|▉         | 18/195 [00:26<01:45,  1.68it/s] 10%|▉         | 19/195 [00:27<01:44,  1.68it/s] 10%|█         | 20/195 [00:28<01:44,  1.67it/s] 11%|█         | 21/195 [00:28<01:28,  1.97it/s] 11%|█▏        | 22/195 [00:29<01:43,  1.67it/s] 12%|█▏        | 23/195 [00:29<01:36,  1.78it/s] 12%|█▏        | 24/195 [00:30<01:38,  1.74it/s] 13%|█▎        | 25/195 [00:30<01:34,  1.80it/s] 13%|█▎        | 26/195 [00:31<01:27,  1.93it/s] 14%|█▍        | 27/195 [00:31<01:24,  1.98it/s] 14%|█▍        | 28/195 [00:32<01:21,  2.05it/s] 15%|█▍        | 29/195 [00:32<01:18,  2.11it/s] 15%|█▌        | 30/195 [00:33<01:18,  2.11it/s] 16%|█▌        | 31/195 [00:33<01:16,  2.15it/s] 16%|█▋        | 32/195 [00:33<01:15,  2.15it/s] 17%|█▋        | 33/195 [00:34<01:13,  2.19it/s] 17%|█▋        | 34/195 [00:34<01:14,  2.16it/s] 18%|█▊        | 35/195 [00:35<01:10,  2.28it/s] 18%|█▊        | 36/195 [00:35<01:15,  2.10it/s] 19%|█▉        | 37/195 [00:36<01:08,  2.32it/s] 19%|█▉        | 38/195 [00:36<01:17,  2.03it/s] 20%|██        | 39/195 [00:37<01:07,  2.32it/s] 21%|██        | 40/195 [00:37<01:18,  1.96it/s] 21%|██        | 41/195 [00:38<01:08,  2.26it/s] 22%|██▏       | 42/195 [00:38<01:16,  1.99it/s] 22%|██▏       | 43/195 [00:38<01:06,  2.29it/s] 23%|██▎       | 44/195 [00:39<01:14,  2.03it/s] 24%|██▎       | 46/195 [00:40<01:06,  2.23it/s] 24%|██▍       | 47/195 [00:40<00:59,  2.47it/s] 25%|██▍       | 48/195 [00:41<01:06,  2.20it/s] 25%|██▌       | 49/195 [00:41<00:59,  2.44it/s] 26%|██▌       | 50/195 [00:42<01:14,  1.96it/s] 26%|██▌       | 51/195 [00:42<01:15,  1.92it/s] 27%|██▋       | 52/195 [00:43<01:26,  1.65it/s] 27%|██▋       | 53/195 [00:44<01:23,  1.69it/s] 28%|██▊       | 54/195 [00:44<01:26,  1.64it/s] 28%|██▊       | 55/195 [00:45<01:27,  1.59it/s] 29%|██▊       | 56/195 [00:46<01:28,  1.57it/s] 29%|██▉       | 57/195 [00:46<01:29,  1.53it/s] 30%|██▉       | 58/195 [00:47<01:30,  1.51it/s] 30%|███       | 59/195 [00:48<01:32,  1.47it/s] 31%|███       | 60/195 [00:48<01:31,  1.48it/s] 31%|███▏      | 61/195 [00:49<01:26,  1.54it/s] 32%|███▏      | 62/195 [00:50<01:23,  1.58it/s] 32%|███▏      | 63/195 [00:50<01:24,  1.57it/s] 33%|███▎      | 64/195 [00:51<01:10,  1.87it/s] 33%|███▎      | 65/195 [00:51<01:18,  1.66it/s] 34%|███▍      | 67/195 [00:52<01:09,  1.83it/s] 35%|███▍      | 68/195 [00:53<01:00,  2.09it/s] 35%|███▌      | 69/195 [00:53<01:12,  1.73it/s] 36%|███▌      | 70/195 [00:54<01:10,  1.78it/s] 36%|███▋      | 71/195 [00:55<01:11,  1.73it/s] 37%|███▋      | 72/195 [00:55<01:10,  1.75it/s] 37%|███▋      | 73/195 [00:56<01:10,  1.74it/s] 38%|███▊      | 74/195 [00:56<01:10,  1.72it/s] 38%|███▊      | 75/195 [00:57<01:06,  1.82it/s] 39%|███▉      | 76/195 [00:57<01:08,  1.74it/s] 40%|████      | 78/195 [00:59<01:07,  1.73it/s] 41%|████      | 80/195 [01:00<01:05,  1.75it/s] 42%|████▏     | 82/195 [01:01<00:58,  1.92it/s] 43%|████▎     | 84/195 [01:01<00:55,  1.99it/s] 44%|████▎     | 85/195 [01:02<00:50,  2.18it/s] 44%|████▍     | 86/195 [01:02<00:53,  2.04it/s] 45%|████▍     | 87/195 [01:03<00:51,  2.12it/s] 45%|████▌     | 88/195 [01:03<00:51,  2.08it/s] 46%|████▌     | 89/195 [01:04<00:52,  2.03it/s] 46%|████▌     | 90/195 [01:04<00:50,  2.06it/s] 47%|████▋     | 91/195 [01:05<00:49,  2.09it/s] 47%|████▋     | 92/195 [01:05<00:48,  2.10it/s] 48%|████▊     | 93/195 [01:06<00:48,  2.09it/s] 48%|████▊     | 94/195 [01:06<00:45,  2.20it/s] 49%|████▊     | 95/195 [01:07<00:48,  2.08it/s] 49%|████▉     | 96/195 [01:07<00:44,  2.23it/s] 50%|████▉     | 97/195 [01:07<00:39,  2.45it/s] 50%|█████     | 98/195 [01:08<00:40,  2.40it/s] 51%|█████▏    | 100/195 [01:09<00:51,  1.83it/s] 52%|█████▏    | 101/195 [01:09<00:46,  2.04it/s] 52%|█████▏    | 102/195 [01:11<01:11,  1.31it/s] 53%|█████▎    | 103/195 [01:11<00:59,  1.56it/s] 53%|█████▎    | 104/195 [01:13<01:21,  1.12it/s] 54%|█████▍    | 105/195 [01:13<01:05,  1.37it/s] 54%|█████▍    | 106/195 [01:14<01:08,  1.30it/s] 55%|█████▌    | 108/195 [01:15<01:00,  1.45it/s] 56%|█████▋    | 110/195 [01:16<00:53,  1.59it/s] 57%|█████▋    | 112/195 [01:18<00:52,  1.58it/s] 58%|█████▊    | 113/195 [01:18<00:46,  1.77it/s] 58%|█████▊    | 114/195 [01:19<00:55,  1.46it/s] 59%|█████▉    | 115/195 [01:19<00:47,  1.68it/s] 59%|█████▉    | 116/195 [01:21<01:03,  1.24it/s] 60%|██████    | 117/195 [01:21<00:53,  1.47it/s] 61%|██████    | 118/195 [01:23<01:09,  1.12it/s] 61%|██████    | 119/195 [01:23<00:56,  1.35it/s] 62%|██████▏   | 120/195 [01:24<01:04,  1.16it/s] 62%|██████▏   | 121/195 [01:24<00:51,  1.43it/s] 63%|██████▎   | 122/195 [01:25<00:48,  1.50it/s] 63%|██████▎   | 123/195 [01:25<00:40,  1.80it/s] 64%|██████▎   | 124/195 [01:26<00:42,  1.66it/s] 65%|██████▍   | 126/195 [01:27<00:36,  1.91it/s] 65%|██████▌   | 127/195 [01:27<00:32,  2.11it/s] 66%|██████▌   | 128/195 [01:28<00:33,  1.99it/s] 66%|██████▌   | 129/195 [01:28<00:29,  2.24it/s] 67%|██████▋   | 130/195 [01:29<00:32,  2.02it/s] 67%|██████▋   | 131/195 [01:29<00:28,  2.27it/s] 68%|██████▊   | 132/195 [01:30<00:31,  2.03it/s] 68%|██████▊   | 133/195 [01:30<00:26,  2.31it/s] 69%|██████▊   | 134/195 [01:30<00:27,  2.18it/s] 69%|██████▉   | 135/195 [01:31<00:26,  2.23it/s] 70%|██████▉   | 136/195 [01:31<00:26,  2.19it/s] 70%|███████   | 137/195 [01:32<00:25,  2.24it/s] 71%|███████   | 138/195 [01:32<00:26,  2.18it/s] 71%|███████▏  | 139/195 [01:33<00:25,  2.22it/s] 72%|███████▏  | 140/195 [01:33<00:25,  2.18it/s] 72%|███████▏  | 141/195 [01:33<00:23,  2.29it/s] 73%|███████▎  | 142/195 [01:34<00:23,  2.30it/s] 73%|███████▎  | 143/195 [01:34<00:22,  2.35it/s] 74%|███████▍  | 144/195 [01:35<00:22,  2.31it/s] 74%|███████▍  | 145/195 [01:35<00:21,  2.37it/s] 75%|███████▍  | 146/195 [01:36<00:20,  2.36it/s] 75%|███████▌  | 147/195 [01:36<00:20,  2.36it/s] 76%|███████▌  | 148/195 [01:37<00:21,  2.17it/s] 76%|███████▋  | 149/195 [01:37<00:21,  2.14it/s] 77%|███████▋  | 150/195 [01:38<00:21,  2.08it/s] 77%|███████▋  | 151/195 [01:38<00:21,  2.08it/s] 78%|███████▊  | 152/195 [01:38<00:20,  2.11it/s] 78%|███████▊  | 153/195 [01:39<00:18,  2.27it/s] 79%|███████▉  | 154/195 [01:39<00:19,  2.13it/s] 79%|███████▉  | 155/195 [01:40<00:18,  2.19it/s] 80%|████████  | 156/195 [01:40<00:17,  2.22it/s] 81%|████████  | 157/195 [01:41<00:16,  2.30it/s] 81%|████████  | 158/195 [01:41<00:16,  2.28it/s] 82%|████████▏ | 159/195 [01:41<00:14,  2.43it/s] 82%|████████▏ | 160/195 [01:42<00:15,  2.31it/s] 83%|████████▎ | 161/195 [01:42<00:14,  2.40it/s] 83%|████████▎ | 162/195 [01:43<00:14,  2.31it/s] 84%|████████▎ | 163/195 [01:43<00:13,  2.34it/s] 84%|████████▍ | 164/195 [01:44<00:12,  2.42it/s] 85%|████████▍ | 165/195 [01:44<00:12,  2.31it/s] 85%|████████▌ | 166/195 [01:44<00:12,  2.38it/s] 86%|████████▌ | 167/195 [01:45<00:12,  2.32it/s] 87%|████████▋ | 169/195 [01:46<00:11,  2.25it/s] 87%|████████▋ | 170/195 [01:46<00:10,  2.46it/s] 88%|████████▊ | 171/195 [01:47<00:10,  2.22it/s] 88%|████████▊ | 172/195 [01:47<00:09,  2.43it/s] 89%|████████▊ | 173/195 [01:48<00:10,  2.12it/s] 89%|████████▉ | 174/195 [01:48<00:08,  2.39it/s] 90%|████████▉ | 175/195 [01:49<00:09,  2.07it/s] 90%|█████████ | 176/195 [01:49<00:08,  2.33it/s] 91%|█████████ | 177/195 [01:49<00:08,  2.13it/s] 91%|█████████▏| 178/195 [01:50<00:07,  2.19it/s] 92%|█████████▏| 179/195 [01:50<00:07,  2.16it/s] 92%|█████████▏| 180/195 [01:51<00:07,  2.02it/s] 93%|█████████▎| 181/195 [01:51<00:07,  1.99it/s] 93%|█████████▎| 182/195 [01:52<00:06,  1.97it/s] 94%|█████████▍| 183/195 [01:52<00:05,  2.06it/s] 94%|█████████▍| 184/195 [01:53<00:05,  2.05it/s] 95%|█████████▍| 185/195 [01:53<00:04,  2.06it/s] 95%|█████████▌| 186/195 [01:54<00:04,  2.02it/s] 96%|█████████▌| 187/195 [01:54<00:03,  2.10it/s] 96%|█████████▋| 188/195 [01:55<00:03,  2.14it/s] 97%|█████████▋| 189/195 [01:55<00:02,  2.18it/s] 97%|█████████▋| 190/195 [01:56<00:02,  2.17it/s] 98%|█████████▊| 191/195 [01:56<00:01,  2.23it/s] 98%|█████████▊| 192/195 [01:57<00:01,  2.10it/s] 99%|█████████▉| 193/195 [01:57<00:00,  2.02it/s] 99%|█████████▉| 194/195 [01:58<00:00,  1.95it/s]100%|██████████| 195/195 [01:58<00:00,  2.47it/s]100%|██████████| 195/195 [02:00<00:00,  1.62it/s]
2025-09-24 10:05:05 [info     ] Validating outputs
2025-09-24 10:05:05 [info     ] Predict - end                  time=0:2:0
2025-09-24 10:05:05 [info     ] Evaluate - start               split=test
2025-09-24 10:05:05 [info     ] Evaluate - end                 answer_distr=[0.39, 0.22, 0.11, 0.28] correctness_llm=0.75 llm_group_correctness=[0.56, 0.69, 0.85, 0.77, 0.87] monotonicity=0.64
2025-09-24 10:05:05 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:05:05 [info     ] Augmenting questions for IRT estimation num_questions=19
2025-09-24 10:05:05 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:05:05 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1083.88it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3412.49it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 588.69it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6752.56it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 988.92it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3697.43it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 561.20it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7078.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 951.98it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3787.31it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 690.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6501.36it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 958.32it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3897.68it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 663.64it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5921.77it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1011.55it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3641.86it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 570.56it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7162.75it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1080.69it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3687.84it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 630.33it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6744.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1025.72it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3712.36it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 621.30it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6765.01it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 919.95it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3712.87it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 562.51it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6633.56it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1147.01it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3688.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 584.96it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5527.13it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 900.20it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3698.93it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 669.32it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6603.72it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 976.04it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3638.70it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 593.34it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7141.85it/s]
2025-09-24 10:05:13 INFO: EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
2025-09-24 10:05:13 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:05:13 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:05:13 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:05:13 [info     ] Evaluate question difficulty - end mae=1.78 rmse=2.29 split=test
2025-09-24 10:05:13 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 2 finished: 0:2:18

 ********** Run: 3/3 **********
2025-09-24 10:05:30 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:05:30 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:05:30 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:05:30 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:05:32 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:05:32 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:05:37 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:05:37 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:05:37 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:05:37 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:05:40 [info     ] Setting seed                   value=45
2025-09-24 10:05:40 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 10:05:40 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_kc_exact native_structured_output=True num_examples=3 system_prompt=teacher_dbe_miscons_level_context
2025-09-24 10:05:40 [info     ] Building example selector
2025-09-24 10:05:40 [info     ] Building model                 name=qwen3:8b provider=ollama rate_limit=None temp=1.0
2025-09-24 10:05:40 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:13<44:22, 13.73s/it]  1%|          | 2/195 [00:14<18:52,  5.87s/it]  2%|▏         | 3/195 [00:16<13:45,  4.30s/it]  2%|▏         | 4/195 [00:16<08:45,  2.75s/it]  3%|▎         | 5/195 [00:18<07:28,  2.36s/it]  4%|▎         | 7/195 [00:20<04:56,  1.58s/it]  5%|▍         | 9/195 [00:21<03:40,  1.18s/it]  6%|▌         | 11/195 [00:22<03:04,  1.00s/it]  7%|▋         | 13/195 [00:23<02:28,  1.22it/s]  8%|▊         | 15/195 [00:25<02:18,  1.30it/s]  9%|▊         | 17/195 [00:26<02:01,  1.46it/s]  9%|▉         | 18/195 [00:26<01:47,  1.64it/s] 10%|▉         | 19/195 [00:27<01:58,  1.48it/s] 10%|█         | 20/195 [00:27<01:42,  1.71it/s] 11%|█         | 21/195 [00:28<01:47,  1.61it/s] 12%|█▏        | 23/195 [00:29<01:43,  1.67it/s] 13%|█▎        | 25/195 [00:30<01:35,  1.78it/s] 13%|█▎        | 26/195 [00:30<01:24,  1.99it/s] 14%|█▍        | 27/195 [00:31<01:27,  1.91it/s] 14%|█▍        | 28/195 [00:31<01:17,  2.16it/s] 15%|█▍        | 29/195 [00:32<01:21,  2.05it/s] 15%|█▌        | 30/195 [00:32<01:11,  2.31it/s] 16%|█▌        | 31/195 [00:33<01:22,  2.00it/s] 16%|█▋        | 32/195 [00:33<01:12,  2.25it/s] 17%|█▋        | 33/195 [00:34<01:26,  1.88it/s] 18%|█▊        | 35/195 [00:35<01:19,  2.02it/s] 18%|█▊        | 36/195 [00:35<01:10,  2.26it/s] 19%|█▉        | 37/195 [00:36<01:16,  2.05it/s] 19%|█▉        | 38/195 [00:36<01:07,  2.32it/s] 20%|██        | 39/195 [00:36<01:14,  2.09it/s] 21%|██        | 40/195 [00:37<01:05,  2.35it/s] 21%|██        | 41/195 [00:37<01:13,  2.10it/s] 22%|██▏       | 42/195 [00:38<01:04,  2.37it/s] 22%|██▏       | 43/195 [00:38<01:12,  2.09it/s] 23%|██▎       | 45/195 [00:39<01:07,  2.22it/s] 24%|██▍       | 47/195 [00:40<01:05,  2.26it/s] 25%|██▍       | 48/195 [00:40<00:59,  2.46it/s] 25%|██▌       | 49/195 [00:41<01:05,  2.24it/s] 26%|██▌       | 50/195 [00:41<01:05,  2.20it/s] 26%|██▌       | 51/195 [00:42<01:13,  1.96it/s] 27%|██▋       | 52/195 [00:43<01:23,  1.70it/s] 27%|██▋       | 53/195 [00:43<01:27,  1.61it/s] 28%|██▊       | 54/195 [00:44<01:38,  1.44it/s] 28%|██▊       | 55/195 [00:45<01:37,  1.43it/s] 29%|██▊       | 56/195 [00:46<01:34,  1.47it/s] 30%|██▉       | 58/195 [00:47<01:26,  1.58it/s] 31%|███       | 60/195 [00:48<01:30,  1.49it/s] 32%|███▏      | 62/195 [00:49<01:21,  1.64it/s] 32%|███▏      | 63/195 [00:50<01:11,  1.84it/s] 33%|███▎      | 64/195 [00:50<01:20,  1.63it/s] 34%|███▍      | 66/195 [00:52<01:18,  1.64it/s] 34%|███▍      | 67/195 [00:52<01:09,  1.84it/s] 35%|███▍      | 68/195 [00:53<01:18,  1.63it/s] 35%|███▌      | 69/195 [00:53<01:13,  1.71it/s] 36%|███▌      | 70/195 [00:54<01:08,  1.83it/s] 36%|███▋      | 71/195 [00:54<01:06,  1.85it/s] 37%|███▋      | 72/195 [00:55<01:11,  1.71it/s] 37%|███▋      | 73/195 [00:56<01:11,  1.70it/s] 38%|███▊      | 74/195 [00:56<01:09,  1.73it/s] 38%|███▊      | 75/195 [00:57<01:10,  1.70it/s] 39%|███▉      | 77/195 [00:58<01:06,  1.77it/s] 40%|████      | 78/195 [00:58<00:58,  2.01it/s] 41%|████      | 79/195 [00:59<01:14,  1.56it/s] 41%|████      | 80/195 [00:59<01:04,  1.79it/s] 42%|████▏     | 81/195 [01:00<01:07,  1.69it/s] 43%|████▎     | 83/195 [01:01<00:56,  1.98it/s] 43%|████▎     | 84/195 [01:01<00:54,  2.02it/s] 44%|████▎     | 85/195 [01:02<00:54,  2.01it/s] 44%|████▍     | 86/195 [01:02<00:55,  1.97it/s] 45%|████▍     | 87/195 [01:03<00:52,  2.06it/s] 45%|████▌     | 88/195 [01:03<00:52,  2.04it/s] 46%|████▌     | 89/195 [01:04<00:50,  2.11it/s] 46%|████▌     | 90/195 [01:04<00:52,  2.01it/s] 47%|████▋     | 91/195 [01:05<00:50,  2.06it/s] 47%|████▋     | 92/195 [01:05<00:51,  2.01it/s] 48%|████▊     | 93/195 [01:06<00:49,  2.06it/s] 48%|████▊     | 94/195 [01:06<00:49,  2.03it/s] 49%|████▊     | 95/195 [01:07<00:45,  2.22it/s] 49%|████▉     | 96/195 [01:07<00:43,  2.29it/s] 50%|████▉     | 97/195 [01:07<00:40,  2.40it/s] 50%|█████     | 98/195 [01:08<00:39,  2.46it/s] 51%|█████     | 99/195 [01:08<00:40,  2.39it/s] 51%|█████▏    | 100/195 [01:09<00:53,  1.79it/s] 52%|█████▏    | 101/195 [01:10<01:02,  1.49it/s] 52%|█████▏    | 102/195 [01:11<01:10,  1.32it/s] 53%|█████▎    | 103/195 [01:12<01:13,  1.25it/s] 53%|█████▎    | 104/195 [01:13<01:12,  1.25it/s] 54%|█████▍    | 105/195 [01:13<01:05,  1.38it/s] 54%|█████▍    | 106/195 [01:14<01:12,  1.24it/s] 55%|█████▍    | 107/195 [01:15<01:04,  1.37it/s] 55%|█████▌    | 108/195 [01:15<01:00,  1.45it/s] 56%|█████▌    | 109/195 [01:16<00:52,  1.63it/s] 56%|█████▋    | 110/195 [01:17<00:56,  1.51it/s] 57%|█████▋    | 111/195 [01:17<00:51,  1.62it/s] 57%|█████▋    | 112/195 [01:18<00:49,  1.67it/s] 58%|█████▊    | 113/195 [01:18<00:51,  1.60it/s] 58%|█████▊    | 114/195 [01:19<00:53,  1.51it/s] 59%|█████▉    | 115/195 [01:20<00:56,  1.41it/s] 59%|█████▉    | 116/195 [01:21<01:07,  1.18it/s] 60%|██████    | 117/195 [01:22<01:08,  1.14it/s] 61%|██████    | 118/195 [01:23<01:07,  1.15it/s] 61%|██████    | 119/195 [01:24<01:08,  1.11it/s] 62%|██████▏   | 120/195 [01:24<00:57,  1.31it/s] 62%|██████▏   | 121/195 [01:25<00:50,  1.45it/s] 63%|██████▎   | 122/195 [01:25<00:45,  1.60it/s] 63%|██████▎   | 123/195 [01:26<00:42,  1.68it/s] 64%|██████▎   | 124/195 [01:26<00:38,  1.86it/s] 64%|██████▍   | 125/195 [01:27<00:37,  1.86it/s] 65%|██████▍   | 126/195 [01:27<00:34,  1.99it/s] 65%|██████▌   | 127/195 [01:28<00:35,  1.94it/s] 66%|██████▌   | 128/195 [01:28<00:34,  1.93it/s] 66%|██████▌   | 129/195 [01:29<00:34,  1.90it/s] 67%|██████▋   | 130/195 [01:29<00:32,  2.01it/s] 67%|██████▋   | 131/195 [01:30<00:31,  2.03it/s] 68%|██████▊   | 132/195 [01:30<00:30,  2.06it/s] 68%|██████▊   | 133/195 [01:31<00:30,  2.01it/s] 69%|██████▊   | 134/195 [01:31<00:29,  2.07it/s] 69%|██████▉   | 135/195 [01:32<00:29,  2.06it/s] 70%|██████▉   | 136/195 [01:32<00:28,  2.08it/s] 70%|███████   | 137/195 [01:33<00:27,  2.15it/s] 71%|███████   | 138/195 [01:33<00:26,  2.13it/s] 71%|███████▏  | 139/195 [01:33<00:25,  2.20it/s] 72%|███████▏  | 140/195 [01:34<00:25,  2.12it/s] 72%|███████▏  | 141/195 [01:34<00:25,  2.13it/s] 73%|███████▎  | 142/195 [01:35<00:24,  2.16it/s] 73%|███████▎  | 143/195 [01:35<00:23,  2.23it/s] 74%|███████▍  | 144/195 [01:36<00:22,  2.26it/s] 74%|███████▍  | 145/195 [01:36<00:22,  2.27it/s] 75%|███████▍  | 146/195 [01:37<00:20,  2.35it/s] 75%|███████▌  | 147/195 [01:37<00:22,  2.16it/s] 76%|███████▋  | 149/195 [01:38<00:19,  2.39it/s] 77%|███████▋  | 150/195 [01:38<00:19,  2.31it/s] 77%|███████▋  | 151/195 [01:39<00:19,  2.24it/s] 78%|███████▊  | 152/195 [01:39<00:19,  2.17it/s] 78%|███████▊  | 153/195 [01:40<00:19,  2.10it/s] 79%|███████▉  | 154/195 [01:40<00:19,  2.11it/s] 79%|███████▉  | 155/195 [01:41<00:18,  2.13it/s] 80%|████████  | 156/195 [01:41<00:18,  2.13it/s] 81%|████████  | 157/195 [01:42<00:17,  2.14it/s] 81%|████████  | 158/195 [01:42<00:17,  2.11it/s] 82%|████████▏ | 159/195 [01:43<00:16,  2.14it/s] 82%|████████▏ | 160/195 [01:43<00:16,  2.15it/s] 83%|████████▎ | 161/195 [01:44<00:15,  2.18it/s] 83%|████████▎ | 162/195 [01:44<00:15,  2.17it/s] 84%|████████▎ | 163/195 [01:44<00:14,  2.26it/s] 84%|████████▍ | 164/195 [01:45<00:13,  2.26it/s] 85%|████████▍ | 165/195 [01:45<00:13,  2.29it/s] 85%|████████▌ | 166/195 [01:46<00:13,  2.10it/s] 86%|████████▌ | 167/195 [01:46<00:13,  2.14it/s] 86%|████████▌ | 168/195 [01:47<00:13,  2.07it/s] 87%|████████▋ | 169/195 [01:47<00:12,  2.06it/s] 87%|████████▋ | 170/195 [01:48<00:12,  1.96it/s] 88%|████████▊ | 171/195 [01:48<00:11,  2.04it/s] 88%|████████▊ | 172/195 [01:49<00:10,  2.10it/s] 89%|████████▊ | 173/195 [01:49<00:10,  2.10it/s] 89%|████████▉ | 174/195 [01:50<00:10,  2.09it/s] 90%|████████▉ | 175/195 [01:50<00:09,  2.21it/s] 90%|█████████ | 176/195 [01:51<00:08,  2.21it/s] 91%|█████████ | 177/195 [01:51<00:08,  2.22it/s] 91%|█████████▏| 178/195 [01:52<00:08,  2.03it/s] 92%|█████████▏| 179/195 [01:52<00:07,  2.12it/s] 92%|█████████▏| 180/195 [01:52<00:07,  2.14it/s] 93%|█████████▎| 181/195 [01:53<00:06,  2.23it/s] 93%|█████████▎| 182/195 [01:53<00:06,  2.09it/s] 94%|█████████▍| 184/195 [01:54<00:05,  2.17it/s] 95%|█████████▍| 185/195 [01:55<00:04,  2.39it/s] 95%|█████████▌| 186/195 [01:55<00:04,  2.11it/s] 96%|█████████▌| 187/195 [01:56<00:03,  2.35it/s] 96%|█████████▋| 188/195 [01:56<00:03,  2.05it/s] 97%|█████████▋| 189/195 [01:56<00:02,  2.31it/s] 97%|█████████▋| 190/195 [01:57<00:02,  2.08it/s] 98%|█████████▊| 191/195 [01:57<00:01,  2.34it/s] 98%|█████████▊| 192/195 [01:58<00:01,  1.97it/s] 99%|█████████▉| 193/195 [01:58<00:00,  2.23it/s] 99%|█████████▉| 194/195 [01:59<00:00,  1.85it/s]100%|██████████| 195/195 [02:01<00:00,  1.60it/s]
2025-09-24 10:07:42 [info     ] Validating outputs
2025-09-24 10:07:42 [info     ] Predict - end                  time=0:2:1
2025-09-24 10:07:42 [info     ] Evaluate - start               split=test
2025-09-24 10:07:42 [info     ] Evaluate - end                 answer_distr=[0.35, 0.25, 0.12, 0.28] correctness_llm=0.74 llm_group_correctness=[0.54, 0.67, 0.85, 0.74, 0.9] monotonicity=0.59
2025-09-24 10:07:42 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:07:42 [info     ] Augmenting questions for IRT estimation num_questions=16
2025-09-24 10:07:42 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:07:42 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 985.87it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3577.58it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 585.79it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6464.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 938.29it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3620.10it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 593.83it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6337.17it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 996.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3493.16it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 660.47it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6260.16it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1171.87it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3582.68it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 625.37it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6710.89it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1083.00it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3785.39it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 723.99it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6200.66it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1029.28it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3635.14it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 717.72it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5683.34it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 967.54it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3806.88it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 653.35it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6106.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 921.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3960.91it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 625.28it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6205.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 997.25it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3487.21it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 661.59it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6458.45it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1153.68it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3627.24it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 635.72it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5962.66it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 929.38it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3696.67it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 630.38it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6230.93it/s]
2025-09-24 10:07:50 INFO: EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
EM converged at iteration 11.
2025-09-24 10:07:50 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:07:50 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:07:50 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:07:50 [info     ] Evaluate question difficulty - end mae=1.59 rmse=1.93 split=test
2025-09-24 10:07:50 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 3 finished: 0:2:20

 ========== Config: llama3.2:1b~T_0.0~SO_student_bool_nocontext~L_5~SP_student_dbe_miscons_level_context~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_dbe_studentlevel_random1 ==========
Config 10/16

 ********** Run: 1/3 **********
2025-09-24 10:08:06 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:08:06 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:08:06 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:08:06 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:08:08 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:08:08 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:08:12 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:08:12 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:08:12 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:08:13 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:08:16 [info     ] Setting seed                   value=43
2025-09-24 10:08:16 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 10:08:16 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_random native_structured_output=True num_examples=1 system_prompt=student_dbe_miscons_level_context
2025-09-24 10:08:16 [info     ] Building example selector
2025-09-24 10:08:16 [info     ] Building model                 name=llama3.2:1b provider=ollama rate_limit=None temp=0.0
2025-09-24 10:08:16 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:10<32:49, 10.15s/it]  2%|▏         | 3/195 [00:10<09:25,  2.94s/it]  2%|▏         | 4/195 [00:11<06:21,  2.00s/it]  3%|▎         | 5/195 [00:12<05:18,  1.68s/it]  4%|▎         | 7/195 [00:13<03:31,  1.13s/it]  5%|▍         | 9/195 [00:14<02:36,  1.19it/s]  6%|▌         | 11/195 [00:15<02:07,  1.45it/s]  7%|▋         | 13/195 [00:15<01:39,  1.83it/s]  7%|▋         | 14/195 [00:16<01:35,  1.89it/s]  8%|▊         | 15/195 [00:16<01:32,  1.95it/s]  8%|▊         | 16/195 [00:16<01:28,  2.02it/s]  9%|▊         | 17/195 [00:17<01:25,  2.07it/s]  9%|▉         | 18/195 [00:17<01:18,  2.24it/s] 10%|▉         | 19/195 [00:18<01:17,  2.28it/s] 10%|█         | 20/195 [00:18<01:23,  2.10it/s] 11%|█         | 21/195 [00:19<01:17,  2.23it/s] 11%|█▏        | 22/195 [00:19<01:18,  2.20it/s] 12%|█▏        | 23/195 [00:19<01:12,  2.36it/s] 13%|█▎        | 25/195 [00:20<01:12,  2.34it/s] 14%|█▍        | 27/195 [00:21<01:08,  2.46it/s] 15%|█▍        | 29/195 [00:22<01:07,  2.46it/s] 15%|█▌        | 30/195 [00:22<00:58,  2.83it/s] 16%|█▌        | 31/195 [00:23<01:14,  2.19it/s] 16%|█▋        | 32/195 [00:23<01:02,  2.60it/s] 17%|█▋        | 33/195 [00:24<01:16,  2.12it/s] 17%|█▋        | 34/195 [00:24<01:01,  2.62it/s] 18%|█▊        | 35/195 [00:25<01:19,  2.00it/s] 18%|█▊        | 36/195 [00:25<01:04,  2.47it/s] 19%|█▉        | 37/195 [00:26<01:17,  2.04it/s] 19%|█▉        | 38/195 [00:26<01:02,  2.52it/s] 20%|██        | 39/195 [00:26<01:15,  2.05it/s] 21%|██        | 40/195 [00:27<00:59,  2.60it/s] 21%|██        | 41/195 [00:27<01:15,  2.04it/s] 22%|██▏       | 42/195 [00:27<01:00,  2.55it/s] 22%|██▏       | 43/195 [00:28<01:10,  2.17it/s] 23%|██▎       | 44/195 [00:28<00:53,  2.81it/s] 23%|██▎       | 45/195 [00:29<01:03,  2.35it/s] 24%|██▍       | 47/195 [00:30<01:05,  2.27it/s] 25%|██▍       | 48/195 [00:30<00:52,  2.78it/s] 25%|██▌       | 49/195 [00:31<01:07,  2.15it/s] 26%|██▌       | 51/195 [00:31<01:05,  2.21it/s] 27%|██▋       | 53/195 [00:32<01:01,  2.31it/s] 28%|██▊       | 55/195 [00:33<00:59,  2.36it/s] 29%|██▉       | 57/195 [00:34<00:57,  2.42it/s] 30%|███       | 59/195 [00:35<00:58,  2.34it/s] 31%|███▏      | 61/195 [00:35<00:47,  2.81it/s] 32%|███▏      | 63/195 [00:36<00:41,  3.20it/s] 33%|███▎      | 65/195 [00:36<00:37,  3.46it/s] 34%|███▍      | 67/195 [00:36<00:33,  3.85it/s] 35%|███▌      | 69/195 [00:37<00:29,  4.30it/s] 36%|███▌      | 70/195 [00:37<00:38,  3.29it/s] 36%|███▋      | 71/195 [00:38<00:36,  3.40it/s] 37%|███▋      | 72/195 [00:38<00:33,  3.72it/s] 37%|███▋      | 73/195 [00:38<00:30,  4.02it/s] 38%|███▊      | 74/195 [00:38<00:30,  3.93it/s] 38%|███▊      | 75/195 [00:38<00:27,  4.43it/s] 39%|███▉      | 76/195 [00:39<00:33,  3.57it/s] 39%|███▉      | 77/195 [00:39<00:37,  3.16it/s] 40%|████      | 78/195 [00:40<00:36,  3.19it/s] 41%|████      | 79/195 [00:40<00:31,  3.71it/s] 41%|████      | 80/195 [00:40<00:32,  3.52it/s] 42%|████▏     | 81/195 [00:41<00:46,  2.48it/s] 42%|████▏     | 82/195 [00:41<00:39,  2.89it/s] 43%|████▎     | 84/195 [00:42<00:47,  2.35it/s] 44%|████▍     | 86/195 [00:43<00:47,  2.29it/s] 45%|████▌     | 88/195 [00:44<00:47,  2.26it/s] 46%|████▌     | 90/195 [00:44<00:40,  2.58it/s] 47%|████▋     | 91/195 [00:45<00:40,  2.56it/s] 47%|████▋     | 92/195 [00:45<00:41,  2.46it/s] 48%|████▊     | 93/195 [00:46<00:39,  2.55it/s] 48%|████▊     | 94/195 [00:46<00:38,  2.60it/s] 49%|████▊     | 95/195 [00:46<00:32,  3.12it/s] 49%|████▉     | 96/195 [00:46<00:29,  3.34it/s] 50%|████▉     | 97/195 [00:47<00:27,  3.61it/s] 50%|█████     | 98/195 [00:47<00:25,  3.77it/s] 51%|█████     | 99/195 [00:47<00:21,  4.39it/s] 51%|█████▏    | 100/195 [00:47<00:22,  4.18it/s] 52%|█████▏    | 101/195 [00:48<00:33,  2.79it/s] 52%|█████▏    | 102/195 [00:48<00:29,  3.18it/s] 53%|█████▎    | 103/195 [00:49<00:37,  2.44it/s] 53%|█████▎    | 104/195 [00:49<00:32,  2.81it/s] 54%|█████▍    | 105/195 [00:50<00:42,  2.14it/s] 54%|█████▍    | 106/195 [00:50<00:34,  2.60it/s] 55%|█████▍    | 107/195 [00:51<00:44,  1.99it/s] 55%|█████▌    | 108/195 [00:51<00:33,  2.58it/s] 56%|█████▌    | 109/195 [00:51<00:41,  2.09it/s] 57%|█████▋    | 111/195 [00:52<00:38,  2.18it/s] 58%|█████▊    | 113/195 [00:53<00:36,  2.23it/s] 59%|█████▉    | 115/195 [00:54<00:34,  2.34it/s] 59%|█████▉    | 116/195 [00:54<00:29,  2.71it/s] 60%|██████    | 117/195 [00:55<00:34,  2.26it/s] 61%|██████    | 118/195 [00:55<00:27,  2.78it/s] 61%|██████    | 119/195 [00:56<00:36,  2.06it/s] 62%|██████▏   | 121/195 [00:57<00:35,  2.10it/s] 63%|██████▎   | 123/195 [00:57<00:33,  2.17it/s] 64%|██████▍   | 125/195 [00:59<00:33,  2.08it/s] 65%|██████▌   | 127/195 [01:00<00:33,  2.01it/s] 66%|██████▌   | 129/195 [01:00<00:26,  2.52it/s] 67%|██████▋   | 130/195 [01:01<00:28,  2.28it/s] 67%|██████▋   | 131/195 [01:01<00:25,  2.52it/s] 68%|██████▊   | 132/195 [01:01<00:21,  2.95it/s] 68%|██████▊   | 133/195 [01:02<00:26,  2.34it/s] 69%|██████▉   | 135/195 [01:02<00:19,  3.10it/s] 70%|███████   | 137/195 [01:02<00:15,  3.65it/s] 71%|███████   | 138/195 [01:03<00:14,  4.05it/s] 71%|███████▏  | 139/195 [01:03<00:15,  3.67it/s] 72%|███████▏  | 140/195 [01:03<00:16,  3.25it/s] 72%|███████▏  | 141/195 [01:04<00:16,  3.22it/s] 73%|███████▎  | 142/195 [01:04<00:17,  3.05it/s] 73%|███████▎  | 143/195 [01:04<00:14,  3.71it/s] 74%|███████▍  | 144/195 [01:05<00:16,  3.14it/s] 74%|███████▍  | 145/195 [01:05<00:17,  2.94it/s] 75%|███████▍  | 146/195 [01:05<00:18,  2.66it/s] 75%|███████▌  | 147/195 [01:06<00:17,  2.79it/s] 76%|███████▋  | 149/195 [01:06<00:13,  3.47it/s] 77%|███████▋  | 150/195 [01:07<00:13,  3.27it/s] 77%|███████▋  | 151/195 [01:07<00:15,  2.88it/s] 78%|███████▊  | 152/195 [01:07<00:14,  2.89it/s] 78%|███████▊  | 153/195 [01:08<00:17,  2.45it/s] 79%|███████▉  | 154/195 [01:08<00:16,  2.49it/s] 79%|███████▉  | 155/195 [01:09<00:18,  2.17it/s] 80%|████████  | 156/195 [01:09<00:16,  2.30it/s] 81%|████████  | 157/195 [01:10<00:17,  2.17it/s] 81%|████████  | 158/195 [01:10<00:15,  2.38it/s] 82%|████████▏ | 159/195 [01:11<00:15,  2.36it/s] 82%|████████▏ | 160/195 [01:11<00:14,  2.49it/s] 83%|████████▎ | 161/195 [01:11<00:14,  2.38it/s] 83%|████████▎ | 162/195 [01:12<00:14,  2.34it/s] 84%|████████▎ | 163/195 [01:12<00:14,  2.26it/s] 84%|████████▍ | 164/195 [01:13<00:12,  2.41it/s] 85%|████████▌ | 166/195 [01:13<00:09,  3.21it/s] 86%|████████▌ | 168/195 [01:14<00:07,  3.48it/s] 87%|████████▋ | 170/195 [01:14<00:06,  3.71it/s] 88%|████████▊ | 172/195 [01:14<00:05,  3.99it/s] 89%|████████▉ | 174/195 [01:15<00:04,  4.27it/s] 90%|████████▉ | 175/195 [01:15<00:04,  4.54it/s] 90%|█████████ | 176/195 [01:15<00:04,  4.28it/s] 91%|█████████ | 177/195 [01:15<00:03,  4.51it/s] 91%|█████████▏| 178/195 [01:16<00:04,  4.12it/s] 92%|█████████▏| 179/195 [01:16<00:03,  4.66it/s] 92%|█████████▏| 180/195 [01:17<00:05,  2.91it/s] 93%|█████████▎| 182/195 [01:17<00:04,  3.17it/s] 94%|█████████▍| 183/195 [01:18<00:04,  2.92it/s] 94%|█████████▍| 184/195 [01:18<00:04,  2.73it/s] 95%|█████████▍| 185/195 [01:18<00:03,  2.60it/s] 95%|█████████▌| 186/195 [01:19<00:03,  2.43it/s] 96%|█████████▌| 187/195 [01:19<00:03,  2.46it/s] 96%|█████████▋| 188/195 [01:20<00:03,  2.16it/s] 97%|█████████▋| 189/195 [01:20<00:02,  2.51it/s] 97%|█████████▋| 190/195 [01:21<00:02,  2.13it/s] 98%|█████████▊| 191/195 [01:21<00:01,  2.48it/s] 99%|█████████▉| 193/195 [01:22<00:00,  3.00it/s]100%|██████████| 195/195 [01:22<00:00,  3.74it/s]100%|██████████| 195/195 [01:24<00:00,  2.31it/s]
2025-09-24 10:09:40 [info     ] Validating outputs
2025-09-24 10:09:40 [info     ] Predict - end                  time=0:1:24
2025-09-24 10:09:40 [info     ] Evaluate - start               split=test
2025-09-24 10:09:40 [info     ] Evaluate - end                 answer_distr=[0.35, 0.25, 0.17, 0.23] correctness_llm=0.81 llm_group_correctness=[0.62, 0.77, 0.87, 0.85, 0.92] monotonicity=0.8
2025-09-24 10:09:40 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:09:40 [info     ] Augmenting questions for IRT estimation num_questions=6
2025-09-24 10:09:40 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:09:40 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1200.38it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 4125.02it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 507.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8475.79it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1091.86it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3429.52it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 654.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 9750.96it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1132.85it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3491.90it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 586.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8254.18it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1007.69it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3718.44it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 588.34it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8249.54it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1049.48it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3574.85it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 630.57it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 9362.29it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1151.78it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3561.85it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 717.15it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8668.48it/s]
2025-09-24 10:09:45 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 10:09:45 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:09:45 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:09:45 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:09:45 [info     ] Evaluate question difficulty - end mae=1.29 rmse=1.61 split=test
2025-09-24 10:09:45 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 1 finished: 0:1:39

 ********** Run: 2/3 **********
2025-09-24 10:10:02 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:10:02 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:10:02 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:10:02 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:10:04 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:10:04 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:10:09 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:10:09 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:10:09 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:10:09 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:10:12 [info     ] Setting seed                   value=44
2025-09-24 10:10:12 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 10:10:12 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_random native_structured_output=True num_examples=1 system_prompt=student_dbe_miscons_level_context
2025-09-24 10:10:12 [info     ] Building example selector
2025-09-24 10:10:12 [info     ] Building model                 name=llama3.2:1b provider=ollama rate_limit=None temp=0.0
2025-09-24 10:10:12 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:08<26:12,  8.11s/it]  1%|          | 2/195 [00:08<10:59,  3.42s/it]  2%|▏         | 3/195 [00:09<07:08,  2.23s/it]  2%|▏         | 4/195 [00:09<04:35,  1.44s/it]  3%|▎         | 5/195 [00:10<03:55,  1.24s/it]  4%|▎         | 7/195 [00:10<02:19,  1.35it/s]  4%|▍         | 8/195 [00:11<02:06,  1.48it/s]  5%|▍         | 9/195 [00:11<01:56,  1.59it/s]  5%|▌         | 10/195 [00:11<01:38,  1.87it/s]  6%|▌         | 11/195 [00:12<01:42,  1.79it/s]  6%|▌         | 12/195 [00:13<01:40,  1.82it/s]  7%|▋         | 13/195 [00:13<01:24,  2.16it/s]  7%|▋         | 14/195 [00:14<01:32,  1.96it/s]  8%|▊         | 15/195 [00:14<01:16,  2.36it/s]  8%|▊         | 16/195 [00:14<01:33,  1.91it/s]  9%|▊         | 17/195 [00:15<01:18,  2.26it/s]  9%|▉         | 18/195 [00:15<01:29,  1.99it/s] 10%|▉         | 19/195 [00:16<01:10,  2.51it/s] 10%|█         | 20/195 [00:16<01:24,  2.07it/s] 11%|█         | 21/195 [00:17<01:14,  2.33it/s] 11%|█▏        | 22/195 [00:17<01:27,  1.98it/s] 12%|█▏        | 23/195 [00:17<01:10,  2.44it/s] 12%|█▏        | 24/195 [00:18<01:21,  2.11it/s] 13%|█▎        | 25/195 [00:18<01:09,  2.45it/s] 13%|█▎        | 26/195 [00:19<01:09,  2.42it/s] 14%|█▍        | 27/195 [00:19<00:55,  3.02it/s] 14%|█▍        | 28/195 [00:20<01:13,  2.26it/s] 15%|█▍        | 29/195 [00:20<00:58,  2.84it/s] 15%|█▌        | 30/195 [00:20<01:13,  2.26it/s] 16%|█▋        | 32/195 [00:21<01:09,  2.36it/s] 17%|█▋        | 34/195 [00:22<01:03,  2.52it/s] 18%|█▊        | 36/195 [00:23<01:01,  2.57it/s] 19%|█▉        | 38/195 [00:23<01:00,  2.59it/s] 21%|██        | 40/195 [00:24<00:58,  2.65it/s] 22%|██▏       | 42/195 [00:24<00:47,  3.21it/s] 22%|██▏       | 43/195 [00:25<00:53,  2.86it/s] 23%|██▎       | 44/195 [00:25<00:49,  3.06it/s] 23%|██▎       | 45/195 [00:26<00:56,  2.68it/s] 24%|██▎       | 46/195 [00:26<00:48,  3.06it/s] 24%|██▍       | 47/195 [00:26<00:41,  3.53it/s] 25%|██▍       | 48/195 [00:27<00:54,  2.71it/s] 25%|██▌       | 49/195 [00:27<00:43,  3.34it/s] 26%|██▌       | 50/195 [00:27<00:57,  2.53it/s] 26%|██▌       | 51/195 [00:28<00:45,  3.15it/s] 27%|██▋       | 52/195 [00:28<00:58,  2.42it/s] 27%|██▋       | 53/195 [00:28<00:48,  2.95it/s] 28%|██▊       | 54/195 [00:29<00:59,  2.38it/s] 28%|██▊       | 55/195 [00:29<00:48,  2.91it/s] 29%|██▊       | 56/195 [00:30<01:06,  2.08it/s] 29%|██▉       | 57/195 [00:30<00:53,  2.58it/s] 30%|██▉       | 58/195 [00:31<00:57,  2.36it/s] 30%|███       | 59/195 [00:31<00:55,  2.44it/s] 31%|███       | 60/195 [00:31<00:53,  2.53it/s] 31%|███▏      | 61/195 [00:32<00:45,  2.94it/s] 32%|███▏      | 62/195 [00:32<00:37,  3.58it/s] 32%|███▏      | 63/195 [00:32<00:38,  3.40it/s] 33%|███▎      | 64/195 [00:32<00:33,  3.95it/s] 33%|███▎      | 65/195 [00:33<00:36,  3.55it/s] 34%|███▍      | 66/195 [00:33<00:45,  2.85it/s] 34%|███▍      | 67/195 [00:33<00:40,  3.15it/s] 35%|███▌      | 69/195 [00:34<00:33,  3.81it/s] 36%|███▌      | 70/195 [00:34<00:36,  3.44it/s] 36%|███▋      | 71/195 [00:34<00:32,  3.77it/s] 37%|███▋      | 72/195 [00:35<00:36,  3.38it/s] 37%|███▋      | 73/195 [00:35<00:33,  3.65it/s] 38%|███▊      | 75/195 [00:35<00:27,  4.31it/s] 39%|███▉      | 76/195 [00:36<00:31,  3.72it/s] 39%|███▉      | 77/195 [00:36<00:28,  4.11it/s] 40%|████      | 78/195 [00:36<00:27,  4.24it/s] 41%|████      | 79/195 [00:36<00:24,  4.71it/s] 41%|████      | 80/195 [00:36<00:25,  4.53it/s] 42%|████▏     | 81/195 [00:37<00:43,  2.61it/s] 42%|████▏     | 82/195 [00:37<00:37,  3.00it/s] 43%|████▎     | 83/195 [00:38<00:43,  2.60it/s] 43%|████▎     | 84/195 [00:38<00:36,  3.03it/s] 44%|████▎     | 85/195 [00:39<00:52,  2.10it/s] 44%|████▍     | 86/195 [00:39<00:41,  2.65it/s] 45%|████▍     | 87/195 [00:39<00:41,  2.61it/s] 45%|████▌     | 88/195 [00:40<00:38,  2.77it/s] 46%|████▌     | 89/195 [00:40<00:41,  2.57it/s] 46%|████▌     | 90/195 [00:40<00:37,  2.79it/s] 47%|████▋     | 91/195 [00:41<00:41,  2.51it/s] 47%|████▋     | 92/195 [00:41<00:37,  2.73it/s] 48%|████▊     | 93/195 [00:42<00:37,  2.69it/s] 48%|████▊     | 94/195 [00:42<00:40,  2.47it/s] 49%|████▊     | 95/195 [00:42<00:36,  2.75it/s] 50%|████▉     | 97/195 [00:43<00:29,  3.35it/s] 51%|█████     | 99/195 [00:43<00:25,  3.80it/s] 52%|█████▏    | 101/195 [00:44<00:31,  2.96it/s] 52%|█████▏    | 102/195 [00:44<00:27,  3.44it/s] 53%|█████▎    | 103/195 [00:45<00:38,  2.36it/s] 54%|█████▍    | 105/195 [00:46<00:38,  2.31it/s] 55%|█████▍    | 107/195 [00:47<00:39,  2.25it/s] 55%|█████▌    | 108/195 [00:47<00:32,  2.64it/s] 56%|█████▌    | 109/195 [00:48<00:39,  2.19it/s] 56%|█████▋    | 110/195 [00:48<00:31,  2.67it/s] 57%|█████▋    | 111/195 [00:49<00:38,  2.20it/s] 57%|█████▋    | 112/195 [00:49<00:30,  2.76it/s] 58%|█████▊    | 113/195 [00:49<00:36,  2.23it/s] 58%|█████▊    | 114/195 [00:50<00:29,  2.77it/s] 59%|█████▉    | 115/195 [00:50<00:36,  2.20it/s] 59%|█████▉    | 116/195 [00:50<00:28,  2.76it/s] 60%|██████    | 117/195 [00:51<00:35,  2.20it/s] 61%|██████    | 118/195 [00:51<00:27,  2.76it/s] 61%|██████    | 119/195 [00:52<00:33,  2.28it/s] 62%|██████▏   | 120/195 [00:52<00:27,  2.72it/s] 62%|██████▏   | 121/195 [00:52<00:23,  3.20it/s] 63%|██████▎   | 122/195 [00:53<00:28,  2.53it/s] 63%|██████▎   | 123/195 [00:53<00:22,  3.18it/s] 64%|██████▎   | 124/195 [00:54<00:33,  2.14it/s] 64%|██████▍   | 125/195 [00:54<00:25,  2.73it/s] 65%|██████▍   | 126/195 [00:54<00:24,  2.86it/s] 65%|██████▌   | 127/195 [00:55<00:32,  2.08it/s] 66%|██████▌   | 128/195 [00:55<00:26,  2.50it/s] 66%|██████▌   | 129/195 [00:56<00:29,  2.25it/s] 67%|██████▋   | 130/195 [00:56<00:25,  2.54it/s] 67%|██████▋   | 131/195 [00:57<00:28,  2.23it/s] 68%|██████▊   | 132/195 [00:57<00:24,  2.60it/s] 68%|██████▊   | 133/195 [00:57<00:24,  2.48it/s] 69%|██████▊   | 134/195 [00:57<00:20,  2.98it/s] 69%|██████▉   | 135/195 [00:58<00:16,  3.53it/s] 70%|██████▉   | 136/195 [00:58<00:15,  3.75it/s] 70%|███████   | 137/195 [00:58<00:13,  4.26it/s] 71%|███████   | 138/195 [00:58<00:13,  4.35it/s] 71%|███████▏  | 139/195 [00:58<00:11,  4.90it/s] 72%|███████▏  | 140/195 [00:59<00:11,  4.80it/s] 72%|███████▏  | 141/195 [00:59<00:10,  5.30it/s] 73%|███████▎  | 142/195 [00:59<00:10,  5.20it/s] 73%|███████▎  | 143/195 [00:59<00:10,  4.91it/s] 74%|███████▍  | 145/195 [01:00<00:09,  5.01it/s] 75%|███████▍  | 146/195 [01:00<00:14,  3.41it/s] 75%|███████▌  | 147/195 [01:00<00:13,  3.58it/s] 76%|███████▌  | 148/195 [01:01<00:14,  3.19it/s] 76%|███████▋  | 149/195 [01:01<00:15,  3.02it/s] 77%|███████▋  | 150/195 [01:02<00:18,  2.47it/s] 77%|███████▋  | 151/195 [01:02<00:17,  2.56it/s] 78%|███████▊  | 152/195 [01:03<00:19,  2.24it/s] 78%|███████▊  | 153/195 [01:03<00:17,  2.39it/s] 79%|███████▉  | 154/195 [01:04<00:18,  2.17it/s] 79%|███████▉  | 155/195 [01:04<00:18,  2.11it/s] 80%|████████  | 156/195 [01:04<00:16,  2.32it/s] 81%|████████  | 157/195 [01:05<00:18,  2.09it/s] 81%|████████  | 158/195 [01:05<00:16,  2.29it/s] 82%|████████▏ | 159/195 [01:06<00:15,  2.25it/s] 82%|████████▏ | 160/195 [01:06<00:13,  2.59it/s] 83%|████████▎ | 161/195 [01:07<00:13,  2.48it/s] 83%|████████▎ | 162/195 [01:07<00:11,  2.86it/s] 84%|████████▎ | 163/195 [01:07<00:12,  2.47it/s] 84%|████████▍ | 164/195 [01:07<00:10,  2.89it/s] 85%|████████▍ | 165/195 [01:08<00:08,  3.36it/s] 85%|████████▌ | 166/195 [01:08<00:07,  3.73it/s] 86%|████████▌ | 167/195 [01:08<00:07,  3.68it/s] 86%|████████▌ | 168/195 [01:08<00:06,  4.11it/s] 87%|████████▋ | 169/195 [01:09<00:07,  3.70it/s] 87%|████████▋ | 170/195 [01:09<00:05,  4.31it/s] 88%|████████▊ | 171/195 [01:09<00:06,  4.00it/s] 88%|████████▊ | 172/195 [01:09<00:04,  4.75it/s] 89%|████████▊ | 173/195 [01:09<00:05,  4.25it/s] 90%|████████▉ | 175/195 [01:10<00:04,  4.50it/s] 91%|█████████ | 177/195 [01:11<00:05,  3.54it/s] 92%|█████████▏| 179/195 [01:11<00:05,  3.17it/s] 93%|█████████▎| 181/195 [01:12<00:04,  2.96it/s] 94%|█████████▍| 183/195 [01:13<00:04,  2.85it/s] 94%|█████████▍| 184/195 [01:13<00:03,  3.26it/s] 95%|█████████▍| 185/195 [01:14<00:03,  2.65it/s] 96%|█████████▌| 187/195 [01:14<00:03,  2.62it/s] 96%|█████████▋| 188/195 [01:15<00:02,  3.07it/s] 97%|█████████▋| 189/195 [01:15<00:02,  2.36it/s] 98%|█████████▊| 191/195 [01:16<00:01,  2.32it/s] 99%|█████████▉| 193/195 [01:17<00:00,  2.87it/s] 99%|█████████▉| 194/195 [01:17<00:00,  2.81it/s]100%|██████████| 195/195 [01:19<00:00,  2.44it/s]
2025-09-24 10:11:32 [info     ] Validating outputs
2025-09-24 10:11:32 [info     ] Predict - end                  time=0:1:19
2025-09-24 10:11:32 [info     ] Evaluate - start               split=test
2025-09-24 10:11:32 [info     ] Evaluate - end                 answer_distr=[0.35, 0.26, 0.16, 0.23] correctness_llm=0.8 llm_group_correctness=[0.64, 0.79, 0.79, 0.79, 0.97] monotonicity=0.89
2025-09-24 10:11:32 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:11:32 [info     ] Augmenting questions for IRT estimation num_questions=7
2025-09-24 10:11:32 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:11:32 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1282.61it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3643.24it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 521.56it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6417.51it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1013.71it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3723.35it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 561.42it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5566.96it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 985.11it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3508.22it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 670.10it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5940.94it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 985.87it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3744.23it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 558.18it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5801.25it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 964.97it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3629.98it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 624.02it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6738.61it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1070.95it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3566.12it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 661.94it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6740.16it/s]
2025-09-24 10:11:37 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 10:11:37 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:11:37 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:11:37 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:11:37 [info     ] Evaluate question difficulty - end mae=1.42 rmse=1.73 split=test
2025-09-24 10:11:37 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 2 finished: 0:1:34

 ********** Run: 3/3 **********
2025-09-24 10:11:54 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:11:54 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:11:54 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:11:54 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:11:56 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:11:56 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:12:00 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:12:00 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:12:00 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:12:01 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:12:04 [info     ] Setting seed                   value=45
2025-09-24 10:12:04 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 10:12:04 [info     ] Building few-shot prompt       example_selector=both_dbe_studentlevel_random native_structured_output=True num_examples=1 system_prompt=student_dbe_miscons_level_context
2025-09-24 10:12:04 [info     ] Building example selector
2025-09-24 10:12:04 [info     ] Building model                 name=llama3.2:1b provider=ollama rate_limit=None temp=0.0
2025-09-24 10:12:04 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:08<26:54,  8.32s/it]  2%|▏         | 3/195 [00:09<08:01,  2.51s/it]  2%|▏         | 4/195 [00:09<05:48,  1.82s/it]  3%|▎         | 6/195 [00:10<03:32,  1.13s/it]  4%|▎         | 7/195 [00:10<02:41,  1.16it/s]  4%|▍         | 8/195 [00:11<02:37,  1.19it/s]  5%|▌         | 10/195 [00:12<02:04,  1.48it/s]  6%|▌         | 12/195 [00:13<01:45,  1.74it/s]  7%|▋         | 14/195 [00:13<01:20,  2.24it/s]  8%|▊         | 15/195 [00:14<01:18,  2.30it/s]  8%|▊         | 16/195 [00:14<01:09,  2.59it/s]  9%|▊         | 17/195 [00:15<01:21,  2.18it/s]  9%|▉         | 18/195 [00:15<01:11,  2.48it/s] 10%|▉         | 19/195 [00:15<01:19,  2.22it/s] 10%|█         | 20/195 [00:16<01:06,  2.63it/s] 11%|█▏        | 22/195 [00:16<01:07,  2.56it/s] 12%|█▏        | 24/195 [00:17<00:56,  3.04it/s] 13%|█▎        | 25/195 [00:17<01:00,  2.79it/s] 13%|█▎        | 26/195 [00:17<00:55,  3.04it/s] 14%|█▍        | 27/195 [00:18<00:46,  3.64it/s] 14%|█▍        | 28/195 [00:18<01:03,  2.62it/s] 15%|█▌        | 30/195 [00:19<01:08,  2.42it/s] 16%|█▋        | 32/195 [00:20<01:10,  2.30it/s] 17%|█▋        | 34/195 [00:21<01:08,  2.36it/s] 18%|█▊        | 36/195 [00:22<01:08,  2.32it/s] 19%|█▉        | 38/195 [00:23<01:05,  2.41it/s] 21%|██        | 40/195 [00:23<00:55,  2.79it/s] 21%|██        | 41/195 [00:23<00:54,  2.82it/s] 22%|██▏       | 43/195 [00:24<00:55,  2.73it/s] 23%|██▎       | 45/195 [00:25<00:55,  2.69it/s] 24%|██▍       | 47/195 [00:26<01:00,  2.44it/s] 25%|██▌       | 49/195 [00:27<01:00,  2.43it/s] 26%|██▌       | 51/195 [00:28<00:59,  2.41it/s] 27%|██▋       | 53/195 [00:29<01:00,  2.36it/s] 28%|██▊       | 55/195 [00:29<01:00,  2.33it/s] 29%|██▉       | 57/195 [00:30<01:00,  2.28it/s] 30%|██▉       | 58/195 [00:30<00:52,  2.61it/s] 30%|███       | 59/195 [00:31<01:00,  2.24it/s] 31%|███       | 60/195 [00:31<00:49,  2.71it/s] 31%|███▏      | 61/195 [00:31<00:44,  3.00it/s] 32%|███▏      | 62/195 [00:32<00:52,  2.54it/s] 32%|███▏      | 63/195 [00:32<00:43,  3.05it/s] 33%|███▎      | 64/195 [00:32<00:38,  3.45it/s] 33%|███▎      | 65/195 [00:33<00:39,  3.30it/s] 34%|███▍      | 66/195 [00:33<00:36,  3.52it/s] 35%|███▍      | 68/195 [00:33<00:30,  4.18it/s] 36%|███▌      | 70/195 [00:34<00:28,  4.43it/s] 36%|███▋      | 71/195 [00:34<00:34,  3.55it/s] 37%|███▋      | 72/195 [00:35<00:35,  3.45it/s] 37%|███▋      | 73/195 [00:35<00:36,  3.34it/s] 38%|███▊      | 74/195 [00:35<00:31,  3.85it/s] 38%|███▊      | 75/195 [00:35<00:32,  3.69it/s] 39%|███▉      | 76/195 [00:36<00:37,  3.17it/s] 39%|███▉      | 77/195 [00:36<00:34,  3.39it/s] 41%|████      | 79/195 [00:36<00:28,  4.11it/s] 41%|████      | 80/195 [00:37<00:30,  3.79it/s] 42%|████▏     | 81/195 [00:37<00:30,  3.73it/s] 42%|████▏     | 82/195 [00:38<00:44,  2.55it/s] 43%|████▎     | 83/195 [00:38<00:40,  2.80it/s] 43%|████▎     | 84/195 [00:38<00:32,  3.45it/s] 44%|████▎     | 85/195 [00:38<00:34,  3.20it/s] 44%|████▍     | 86/195 [00:39<00:46,  2.34it/s] 45%|████▍     | 87/195 [00:39<00:39,  2.75it/s] 45%|████▌     | 88/195 [00:40<00:40,  2.67it/s] 46%|████▌     | 89/195 [00:40<00:33,  3.20it/s] 46%|████▌     | 90/195 [00:41<00:43,  2.41it/s] 47%|████▋     | 91/195 [00:41<00:33,  3.06it/s] 47%|████▋     | 92/195 [00:41<00:32,  3.13it/s] 48%|████▊     | 93/195 [00:41<00:35,  2.86it/s] 48%|████▊     | 94/195 [00:42<00:33,  3.00it/s] 49%|████▉     | 96/195 [00:42<00:27,  3.58it/s] 50%|████▉     | 97/195 [00:42<00:23,  4.24it/s] 50%|█████     | 98/195 [00:43<00:25,  3.81it/s] 51%|█████     | 99/195 [00:43<00:30,  3.13it/s] 52%|█████▏    | 101/195 [00:44<00:34,  2.70it/s] 53%|█████▎    | 103/195 [00:45<00:34,  2.67it/s] 54%|█████▍    | 105/195 [00:45<00:34,  2.58it/s] 55%|█████▍    | 107/195 [00:46<00:36,  2.38it/s] 56%|█████▌    | 109/195 [00:47<00:37,  2.31it/s] 57%|█████▋    | 111/195 [00:48<00:38,  2.19it/s] 57%|█████▋    | 112/195 [00:49<00:32,  2.52it/s] 58%|█████▊    | 113/195 [00:49<00:39,  2.06it/s] 59%|█████▉    | 115/195 [00:50<00:37,  2.11it/s] 60%|██████    | 117/195 [00:51<00:35,  2.22it/s] 61%|██████    | 119/195 [00:52<00:32,  2.33it/s] 62%|██████▏   | 121/195 [00:53<00:30,  2.42it/s] 63%|██████▎   | 122/195 [00:53<00:26,  2.80it/s] 63%|██████▎   | 123/195 [00:53<00:24,  2.99it/s] 64%|██████▎   | 124/195 [00:54<00:30,  2.33it/s] 64%|██████▍   | 125/195 [00:54<00:25,  2.75it/s] 65%|██████▍   | 126/195 [00:54<00:22,  3.03it/s] 65%|██████▌   | 127/195 [00:55<00:29,  2.29it/s] 66%|██████▌   | 128/195 [00:55<00:24,  2.73it/s] 66%|██████▌   | 129/195 [00:56<00:27,  2.37it/s] 67%|██████▋   | 130/195 [00:56<00:23,  2.82it/s] 67%|██████▋   | 131/195 [00:56<00:23,  2.70it/s] 68%|██████▊   | 132/195 [00:56<00:19,  3.19it/s] 68%|██████▊   | 133/195 [00:57<00:18,  3.38it/s] 69%|██████▊   | 134/195 [00:57<00:16,  3.73it/s] 69%|██████▉   | 135/195 [00:58<00:24,  2.49it/s] 70%|███████   | 137/195 [00:58<00:19,  2.95it/s] 71%|███████   | 138/195 [00:59<00:21,  2.69it/s] 71%|███████▏  | 139/195 [00:59<00:19,  2.91it/s] 72%|███████▏  | 141/195 [00:59<00:14,  3.68it/s] 73%|███████▎  | 142/195 [01:00<00:17,  2.99it/s] 73%|███████▎  | 143/195 [01:00<00:16,  3.19it/s] 74%|███████▍  | 145/195 [01:01<00:18,  2.74it/s] 75%|███████▌  | 147/195 [01:02<00:18,  2.62it/s] 76%|███████▋  | 149/195 [01:02<00:13,  3.29it/s] 77%|███████▋  | 150/195 [01:03<00:16,  2.78it/s] 77%|███████▋  | 151/195 [01:03<00:14,  3.11it/s] 78%|███████▊  | 152/195 [01:03<00:18,  2.34it/s] 78%|███████▊  | 153/195 [01:04<00:14,  2.86it/s] 79%|███████▉  | 154/195 [01:04<00:19,  2.12it/s] 79%|███████▉  | 155/195 [01:05<00:14,  2.69it/s] 80%|████████  | 156/195 [01:05<00:18,  2.06it/s] 81%|████████  | 157/195 [01:05<00:14,  2.57it/s] 81%|████████  | 158/195 [01:06<00:17,  2.10it/s] 82%|████████▏ | 159/195 [01:06<00:13,  2.63it/s] 82%|████████▏ | 160/195 [01:07<00:16,  2.11it/s] 83%|████████▎ | 161/195 [01:07<00:12,  2.70it/s] 83%|████████▎ | 162/195 [01:07<00:11,  2.84it/s] 84%|████████▎ | 163/195 [01:08<00:13,  2.34it/s] 84%|████████▍ | 164/195 [01:08<00:10,  2.83it/s] 85%|████████▍ | 165/195 [01:08<00:08,  3.47it/s] 85%|████████▌ | 166/195 [01:09<00:08,  3.47it/s] 86%|████████▌ | 167/195 [01:09<00:06,  4.05it/s] 86%|████████▌ | 168/195 [01:09<00:06,  3.87it/s] 87%|████████▋ | 170/195 [01:09<00:05,  4.41it/s] 88%|████████▊ | 172/195 [01:10<00:05,  4.28it/s] 89%|████████▉ | 174/195 [01:10<00:04,  4.32it/s] 90%|█████████ | 176/195 [01:11<00:04,  4.46it/s] 91%|█████████ | 177/195 [01:11<00:04,  3.69it/s] 91%|█████████▏| 178/195 [01:11<00:04,  4.00it/s] 92%|█████████▏| 179/195 [01:12<00:05,  3.01it/s] 92%|█████████▏| 180/195 [01:12<00:04,  3.35it/s] 93%|█████████▎| 182/195 [01:13<00:04,  2.89it/s] 94%|█████████▍| 184/195 [01:14<00:04,  2.72it/s] 95%|█████████▌| 186/195 [01:14<00:02,  3.21it/s] 96%|█████████▌| 187/195 [01:15<00:02,  2.99it/s] 96%|█████████▋| 188/195 [01:15<00:02,  3.01it/s] 97%|█████████▋| 189/195 [01:15<00:02,  2.89it/s] 97%|█████████▋| 190/195 [01:16<00:01,  2.77it/s] 98%|█████████▊| 192/195 [01:17<00:01,  2.69it/s] 99%|█████████▉| 194/195 [01:17<00:00,  3.22it/s]100%|██████████| 195/195 [01:19<00:00,  2.44it/s]
2025-09-24 10:13:24 [info     ] Validating outputs
2025-09-24 10:13:24 [info     ] Predict - end                  time=0:1:19
2025-09-24 10:13:24 [info     ] Evaluate - start               split=test
2025-09-24 10:13:24 [info     ] Evaluate - end                 answer_distr=[0.31, 0.27, 0.19, 0.23] correctness_llm=0.77 llm_group_correctness=[0.69, 0.72, 0.79, 0.69, 0.95] monotonicity=0.34
2025-09-24 10:13:24 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:13:24 [info     ] Augmenting questions for IRT estimation num_questions=6
2025-09-24 10:13:24 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:13:24 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1148.81it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3473.14it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 609.72it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7818.94it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 829.08it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3563.63it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 640.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7340.03it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 999.26it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3493.09it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 733.36it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7930.88it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 986.96it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3648.93it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 635.00it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7356.58it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1022.72it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3594.96it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 672.38it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7474.57it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1048.05it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3664.13it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 663.16it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8427.13it/s]
2025-09-24 10:13:28 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 10:13:28 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:13:28 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:13:28 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:13:28 [info     ] Evaluate question difficulty - end mae=1.15 rmse=1.44 split=test
2025-09-24 10:13:28 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 3 finished: 0:1:34

 ========== Config: qwen3:14b~T_1.0~SO_student_bool_nocontext~L_5~SP_student_dbe_miscons_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_cfe_studentlevel_random0 ==========
Config 11/16

 ********** Run: 1/3 **********
2025-09-24 10:13:48 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:13:48 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:13:48 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:13:48 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:13:50 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:13:50 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:13:54 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:13:54 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:13:54 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:13:55 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:13:58 [info     ] Setting seed                   value=43
2025-09-24 10:13:58 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 10:13:58 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_dbe_miscons_level_nocontext
2025-09-24 10:13:58 [info     ] Building model                 name=qwen3:14b provider=ollama rate_limit=None temp=1.0
2025-09-24 10:13:58 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:06<19:52,  6.15s/it]  2%|▏         | 3/195 [00:08<08:22,  2.62s/it]  2%|▏         | 4/195 [00:10<06:56,  2.18s/it]  3%|▎         | 5/195 [00:11<05:26,  1.72s/it]  4%|▎         | 7/195 [00:11<03:29,  1.11s/it]  4%|▍         | 8/195 [00:12<02:58,  1.05it/s]  5%|▍         | 9/195 [00:12<02:34,  1.20it/s]  5%|▌         | 10/195 [00:13<02:07,  1.45it/s]  6%|▌         | 11/195 [00:13<01:46,  1.72it/s]  6%|▌         | 12/195 [00:13<01:33,  1.96it/s]  7%|▋         | 13/195 [00:14<01:20,  2.25it/s]  7%|▋         | 14/195 [00:14<01:18,  2.32it/s]  8%|▊         | 15/195 [00:14<01:06,  2.73it/s]  8%|▊         | 16/195 [00:15<01:14,  2.41it/s]  9%|▉         | 18/195 [00:15<01:04,  2.73it/s] 10%|█         | 20/195 [00:16<01:03,  2.76it/s] 11%|█▏        | 22/195 [00:17<00:56,  3.04it/s] 12%|█▏        | 24/195 [00:17<00:56,  3.04it/s] 13%|█▎        | 26/195 [00:18<00:58,  2.89it/s] 14%|█▍        | 28/195 [00:19<00:58,  2.83it/s] 15%|█▌        | 30/195 [00:20<01:00,  2.73it/s] 16%|█▋        | 32/195 [00:21<01:01,  2.64it/s] 17%|█▋        | 33/195 [00:21<01:01,  2.63it/s] 17%|█▋        | 34/195 [00:21<01:05,  2.46it/s] 18%|█▊        | 36/195 [00:22<01:03,  2.50it/s] 19%|█▉        | 38/195 [00:23<01:02,  2.53it/s] 20%|██        | 39/195 [00:23<00:52,  2.94it/s] 21%|██        | 40/195 [00:24<01:07,  2.30it/s] 22%|██▏       | 42/195 [00:25<01:01,  2.51it/s] 23%|██▎       | 44/195 [00:25<00:58,  2.60it/s] 24%|██▎       | 46/195 [00:26<00:54,  2.72it/s] 25%|██▍       | 48/195 [00:27<00:53,  2.77it/s] 26%|██▌       | 50/195 [00:27<00:54,  2.64it/s] 26%|██▌       | 51/195 [00:28<00:47,  3.01it/s] 27%|██▋       | 52/195 [00:29<01:07,  2.13it/s] 28%|██▊       | 54/195 [00:30<01:10,  2.01it/s] 28%|██▊       | 55/195 [00:30<01:09,  2.01it/s] 29%|██▊       | 56/195 [00:31<01:10,  1.97it/s] 29%|██▉       | 57/195 [00:31<01:09,  1.97it/s] 30%|██▉       | 58/195 [00:32<01:10,  1.94it/s] 30%|███       | 59/195 [00:32<01:14,  1.83it/s] 31%|███       | 60/195 [00:33<01:06,  2.03it/s] 31%|███▏      | 61/195 [00:33<01:02,  2.15it/s] 32%|███▏      | 62/195 [00:33<00:55,  2.38it/s] 32%|███▏      | 63/195 [00:34<00:59,  2.22it/s] 33%|███▎      | 64/195 [00:34<00:54,  2.38it/s] 33%|███▎      | 65/195 [00:35<00:51,  2.51it/s] 34%|███▍      | 66/195 [00:35<00:49,  2.59it/s] 34%|███▍      | 67/195 [00:35<00:48,  2.63it/s] 35%|███▍      | 68/195 [00:36<00:47,  2.67it/s] 35%|███▌      | 69/195 [00:36<00:45,  2.80it/s] 36%|███▌      | 70/195 [00:37<00:49,  2.53it/s] 37%|███▋      | 72/195 [00:37<00:47,  2.60it/s] 38%|███▊      | 74/195 [00:38<00:45,  2.66it/s] 38%|███▊      | 75/195 [00:39<00:52,  2.27it/s] 39%|███▉      | 76/195 [00:39<00:48,  2.47it/s] 39%|███▉      | 77/195 [00:39<00:46,  2.55it/s] 40%|████      | 78/195 [00:40<00:47,  2.48it/s] 41%|████      | 80/195 [00:41<00:45,  2.53it/s] 42%|████▏     | 82/195 [00:41<00:41,  2.70it/s] 43%|████▎     | 84/195 [00:42<00:42,  2.60it/s] 44%|████▍     | 86/195 [00:43<00:40,  2.72it/s] 45%|████▌     | 88/195 [00:43<00:38,  2.77it/s] 46%|████▌     | 90/195 [00:44<00:38,  2.72it/s] 47%|████▋     | 92/195 [00:45<00:36,  2.81it/s] 48%|████▊     | 93/195 [00:45<00:32,  3.17it/s] 48%|████▊     | 94/195 [00:46<00:40,  2.49it/s] 49%|████▉     | 96/195 [00:46<00:36,  2.71it/s] 50%|████▉     | 97/195 [00:46<00:31,  3.14it/s] 50%|█████     | 98/195 [00:47<00:36,  2.64it/s] 51%|█████     | 99/195 [00:47<00:30,  3.20it/s] 51%|█████▏    | 100/195 [00:48<00:42,  2.23it/s] 52%|█████▏    | 101/195 [00:49<00:45,  2.06it/s] 52%|█████▏    | 102/195 [00:49<00:49,  1.88it/s] 53%|█████▎    | 103/195 [00:50<00:48,  1.88it/s] 53%|█████▎    | 104/195 [00:50<00:51,  1.78it/s] 54%|█████▍    | 105/195 [00:51<00:49,  1.82it/s] 54%|█████▍    | 106/195 [00:51<00:50,  1.77it/s] 55%|█████▍    | 107/195 [00:52<00:52,  1.68it/s] 55%|█████▌    | 108/195 [00:53<00:47,  1.82it/s] 56%|█████▌    | 109/195 [00:53<00:53,  1.61it/s] 57%|█████▋    | 111/195 [00:54<00:48,  1.73it/s] 58%|█████▊    | 113/195 [00:55<00:44,  1.83it/s] 59%|█████▉    | 115/195 [00:57<00:45,  1.75it/s] 60%|██████    | 117/195 [00:58<00:44,  1.76it/s] 61%|██████    | 119/195 [00:59<00:44,  1.73it/s] 62%|██████▏   | 120/195 [00:59<00:39,  1.91it/s] 62%|██████▏   | 121/195 [01:00<00:37,  1.96it/s] 63%|██████▎   | 122/195 [01:00<00:36,  2.02it/s] 63%|██████▎   | 123/195 [01:00<00:31,  2.27it/s] 64%|██████▎   | 124/195 [01:01<00:32,  2.17it/s] 65%|██████▍   | 126/195 [01:02<00:30,  2.28it/s] 66%|██████▌   | 128/195 [01:03<00:28,  2.36it/s] 66%|██████▌   | 129/195 [01:03<00:27,  2.43it/s] 67%|██████▋   | 130/195 [01:03<00:28,  2.31it/s] 68%|██████▊   | 132/195 [01:04<00:25,  2.43it/s] 69%|██████▊   | 134/195 [01:05<00:24,  2.47it/s] 70%|██████▉   | 136/195 [01:06<00:23,  2.53it/s] 71%|███████   | 138/195 [01:06<00:21,  2.60it/s] 71%|███████▏  | 139/195 [01:07<00:18,  3.01it/s] 72%|███████▏  | 140/195 [01:07<00:21,  2.50it/s] 73%|███████▎  | 142/195 [01:08<00:20,  2.60it/s] 74%|███████▍  | 144/195 [01:09<00:18,  2.72it/s] 74%|███████▍  | 145/195 [01:09<00:18,  2.76it/s] 75%|███████▍  | 146/195 [01:09<00:17,  2.82it/s] 75%|███████▌  | 147/195 [01:10<00:18,  2.62it/s] 76%|███████▋  | 149/195 [01:10<00:17,  2.67it/s] 77%|███████▋  | 151/195 [01:11<00:17,  2.47it/s] 78%|███████▊  | 152/195 [01:12<00:16,  2.54it/s] 78%|███████▊  | 153/195 [01:12<00:17,  2.39it/s] 79%|███████▉  | 154/195 [01:13<00:16,  2.44it/s] 79%|███████▉  | 155/195 [01:13<00:16,  2.49it/s] 80%|████████  | 156/195 [01:13<00:14,  2.65it/s] 81%|████████  | 157/195 [01:14<00:13,  2.73it/s] 81%|████████  | 158/195 [01:14<00:13,  2.77it/s] 82%|████████▏ | 159/195 [01:14<00:13,  2.75it/s] 82%|████████▏ | 160/195 [01:15<00:12,  2.81it/s] 83%|████████▎ | 161/195 [01:15<00:12,  2.77it/s] 83%|████████▎ | 162/195 [01:15<00:11,  2.91it/s] 84%|████████▎ | 163/195 [01:16<00:12,  2.53it/s] 85%|████████▍ | 165/195 [01:17<00:12,  2.42it/s] 86%|████████▌ | 167/195 [01:18<00:11,  2.42it/s] 87%|████████▋ | 169/195 [01:18<00:10,  2.44it/s] 88%|████████▊ | 171/195 [01:19<00:09,  2.64it/s] 89%|████████▊ | 173/195 [01:20<00:08,  2.73it/s] 89%|████████▉ | 174/195 [01:20<00:07,  2.77it/s] 90%|████████▉ | 175/195 [01:20<00:07,  2.78it/s] 90%|█████████ | 176/195 [01:21<00:07,  2.58it/s] 91%|█████████▏| 178/195 [01:22<00:06,  2.69it/s] 92%|█████████▏| 179/195 [01:22<00:05,  2.75it/s] 92%|█████████▏| 180/195 [01:22<00:05,  2.75it/s] 93%|█████████▎| 181/195 [01:23<00:05,  2.78it/s] 93%|█████████▎| 182/195 [01:23<00:04,  2.79it/s] 94%|█████████▍| 183/195 [01:23<00:04,  2.79it/s] 94%|█████████▍| 184/195 [01:24<00:03,  2.79it/s] 95%|█████████▍| 185/195 [01:24<00:03,  2.50it/s] 95%|█████████▌| 186/195 [01:24<00:02,  3.17it/s] 96%|█████████▌| 187/195 [01:25<00:03,  2.46it/s] 97%|█████████▋| 189/195 [01:26<00:02,  2.62it/s] 98%|█████████▊| 191/195 [01:26<00:01,  2.60it/s] 99%|█████████▉| 193/195 [01:27<00:00,  2.55it/s] 99%|█████████▉| 194/195 [01:28<00:00,  2.62it/s]100%|██████████| 195/195 [01:28<00:00,  2.82it/s]100%|██████████| 195/195 [01:30<00:00,  2.16it/s]
2025-09-24 10:15:28 [info     ] Validating outputs
2025-09-24 10:15:29 [info     ] Predict - end                  time=0:1:30
2025-09-24 10:15:29 [info     ] Evaluate - start               split=test
2025-09-24 10:15:29 [info     ] Evaluate - end                 answer_distr=[0.25, 0.35, 0.23, 0.11] correctness_llm=0.57 llm_group_correctness=[0.51, 0.36, 0.54, 0.69, 0.77] monotonicity=0.37
2025-09-24 10:15:29 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:15:29 [info     ] Augmenting questions for IRT estimation num_questions=10
2025-09-24 10:15:29 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:15:29 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1057.53it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3540.42it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 506.81it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6130.74it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1008.49it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3554.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 621.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5495.06it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1010.78it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3558.52it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 584.44it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6144.86it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 986.73it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3690.75it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 611.33it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6257.49it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 978.48it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 4030.00it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 651.33it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6085.00it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1002.63it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3897.87it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 607.23it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6205.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 952.63it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3581.50it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 589.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7062.82it/s]
2025-09-24 10:15:34 INFO: EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
2025-09-24 10:15:34 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:15:34 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:15:34 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:15:34 [info     ] Evaluate question difficulty - end mae=1.8 rmse=2.06 split=test
2025-09-24 10:15:34 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 1 finished: 0:1:45

 ********** Run: 2/3 **********
2025-09-24 10:15:51 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:15:51 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:15:51 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:15:51 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:15:53 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:15:53 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:15:58 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:15:58 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:15:58 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:15:58 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:16:01 [info     ] Setting seed                   value=44
2025-09-24 10:16:01 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 10:16:01 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_dbe_miscons_level_nocontext
2025-09-24 10:16:01 [info     ] Building model                 name=qwen3:14b provider=ollama rate_limit=None temp=1.0
2025-09-24 10:16:01 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:02<09:12,  2.85s/it]  1%|          | 2/195 [00:04<06:19,  1.96s/it]  2%|▏         | 3/195 [00:05<05:46,  1.81s/it]  2%|▏         | 4/195 [00:07<05:16,  1.66s/it]  3%|▎         | 5/195 [00:08<04:14,  1.34s/it]  4%|▎         | 7/195 [00:08<02:50,  1.11it/s]  4%|▍         | 8/195 [00:09<02:27,  1.27it/s]  5%|▍         | 9/195 [00:09<02:13,  1.39it/s]  5%|▌         | 10/195 [00:10<01:52,  1.65it/s]  6%|▌         | 11/195 [00:10<01:45,  1.74it/s]  6%|▌         | 12/195 [00:11<01:27,  2.10it/s]  7%|▋         | 13/195 [00:11<01:22,  2.21it/s]  7%|▋         | 14/195 [00:11<01:13,  2.48it/s]  8%|▊         | 15/195 [00:12<01:10,  2.55it/s]  8%|▊         | 16/195 [00:12<01:05,  2.75it/s]  9%|▊         | 17/195 [00:12<01:08,  2.62it/s] 10%|▉         | 19/195 [00:13<01:00,  2.90it/s] 11%|█         | 21/195 [00:13<00:56,  3.10it/s] 12%|█▏        | 23/195 [00:14<00:55,  3.10it/s] 13%|█▎        | 25/195 [00:15<00:56,  2.99it/s] 14%|█▍        | 27/195 [00:16<00:57,  2.91it/s] 15%|█▍        | 29/195 [00:16<00:57,  2.86it/s] 16%|█▌        | 31/195 [00:17<01:00,  2.70it/s] 17%|█▋        | 33/195 [00:18<01:01,  2.63it/s] 18%|█▊        | 35/195 [00:19<01:00,  2.66it/s] 18%|█▊        | 36/195 [00:19<00:58,  2.72it/s] 19%|█▉        | 37/195 [00:19<00:59,  2.67it/s] 19%|█▉        | 38/195 [00:20<00:57,  2.72it/s] 20%|██        | 39/195 [00:20<00:58,  2.67it/s] 21%|██        | 40/195 [00:21<01:01,  2.52it/s] 22%|██▏       | 42/195 [00:21<00:57,  2.64it/s] 23%|██▎       | 44/195 [00:22<00:57,  2.65it/s] 24%|██▎       | 46/195 [00:23<00:55,  2.71it/s] 24%|██▍       | 47/195 [00:23<00:54,  2.72it/s] 25%|██▍       | 48/195 [00:23<00:53,  2.75it/s] 25%|██▌       | 49/195 [00:24<00:52,  2.80it/s] 26%|██▌       | 50/195 [00:24<00:57,  2.52it/s] 26%|██▌       | 51/195 [00:25<01:01,  2.36it/s] 27%|██▋       | 52/195 [00:25<01:08,  2.08it/s] 28%|██▊       | 54/195 [00:27<01:10,  2.00it/s] 29%|██▊       | 56/195 [00:28<01:11,  1.94it/s] 29%|██▉       | 57/195 [00:28<01:08,  2.01it/s] 30%|██▉       | 58/195 [00:29<01:11,  1.92it/s] 30%|███       | 59/195 [00:29<01:13,  1.86it/s] 31%|███       | 60/195 [00:29<01:02,  2.18it/s] 31%|███▏      | 61/195 [00:30<01:01,  2.19it/s] 32%|███▏      | 63/195 [00:31<01:04,  2.04it/s] 33%|███▎      | 64/195 [00:32<01:06,  1.96it/s] 33%|███▎      | 65/195 [00:32<00:57,  2.27it/s] 34%|███▍      | 66/195 [00:32<01:02,  2.08it/s] 35%|███▍      | 68/195 [00:33<00:50,  2.49it/s] 35%|███▌      | 69/195 [00:33<00:48,  2.59it/s] 36%|███▌      | 70/195 [00:34<00:47,  2.64it/s] 36%|███▋      | 71/195 [00:34<00:45,  2.71it/s] 37%|███▋      | 72/195 [00:34<00:44,  2.74it/s] 37%|███▋      | 73/195 [00:35<00:46,  2.63it/s] 38%|███▊      | 74/195 [00:35<00:45,  2.68it/s] 38%|███▊      | 75/195 [00:36<00:48,  2.47it/s] 39%|███▉      | 77/195 [00:36<00:45,  2.62it/s] 41%|████      | 79/195 [00:37<00:45,  2.53it/s] 42%|████▏     | 81/195 [00:38<00:43,  2.63it/s] 43%|████▎     | 83/195 [00:39<00:41,  2.72it/s] 43%|████▎     | 84/195 [00:39<00:41,  2.66it/s] 44%|████▎     | 85/195 [00:39<00:41,  2.68it/s] 44%|████▍     | 86/195 [00:40<00:40,  2.71it/s] 45%|████▍     | 87/195 [00:40<00:39,  2.73it/s] 45%|████▌     | 88/195 [00:40<00:39,  2.74it/s] 46%|████▌     | 89/195 [00:41<00:38,  2.77it/s] 46%|████▌     | 90/195 [00:41<00:37,  2.78it/s] 47%|████▋     | 91/195 [00:41<00:37,  2.78it/s] 47%|████▋     | 92/195 [00:42<00:37,  2.78it/s] 48%|████▊     | 93/195 [00:42<00:36,  2.78it/s] 48%|████▊     | 94/195 [00:43<00:36,  2.78it/s] 49%|████▊     | 95/195 [00:43<00:35,  2.83it/s] 49%|████▉     | 96/195 [00:43<00:34,  2.91it/s] 50%|████▉     | 97/195 [00:44<00:32,  2.98it/s] 50%|█████     | 98/195 [00:44<00:32,  2.95it/s] 51%|█████     | 99/195 [00:44<00:32,  2.99it/s] 51%|█████▏    | 100/195 [00:45<00:39,  2.42it/s] 52%|█████▏    | 101/195 [00:45<00:45,  2.07it/s] 52%|█████▏    | 102/195 [00:46<00:48,  1.92it/s] 53%|█████▎    | 103/195 [00:47<00:50,  1.84it/s] 53%|█████▎    | 104/195 [00:47<00:51,  1.78it/s] 54%|█████▍    | 105/195 [00:48<00:51,  1.74it/s] 54%|█████▍    | 106/195 [00:48<00:51,  1.73it/s] 55%|█████▍    | 107/195 [00:49<00:50,  1.74it/s] 55%|█████▌    | 108/195 [00:50<00:49,  1.77it/s] 56%|█████▌    | 109/195 [00:50<00:48,  1.77it/s] 56%|█████▋    | 110/195 [00:51<00:47,  1.80it/s] 57%|█████▋    | 111/195 [00:51<00:49,  1.71it/s] 58%|█████▊    | 113/195 [00:52<00:48,  1.69it/s] 59%|█████▉    | 115/195 [00:54<00:45,  1.75it/s] 59%|█████▉    | 116/195 [00:54<00:44,  1.76it/s] 60%|██████    | 117/195 [00:55<00:46,  1.69it/s] 61%|██████    | 118/195 [00:55<00:44,  1.74it/s] 61%|██████    | 119/195 [00:56<00:47,  1.62it/s] 62%|██████▏   | 121/195 [00:57<00:38,  1.93it/s] 63%|██████▎   | 122/195 [00:57<00:35,  2.06it/s] 63%|██████▎   | 123/195 [00:58<00:33,  2.17it/s] 64%|██████▎   | 124/195 [00:58<00:31,  2.27it/s] 64%|██████▍   | 125/195 [00:58<00:29,  2.35it/s] 65%|██████▍   | 126/195 [00:59<00:29,  2.37it/s] 65%|██████▌   | 127/195 [00:59<00:27,  2.50it/s] 66%|██████▌   | 128/195 [01:00<00:27,  2.40it/s] 66%|██████▌   | 129/195 [01:00<00:25,  2.63it/s] 67%|██████▋   | 130/195 [01:00<00:27,  2.36it/s] 68%|██████▊   | 132/195 [01:01<00:26,  2.41it/s] 69%|██████▊   | 134/195 [01:02<00:25,  2.42it/s] 70%|██████▉   | 136/195 [01:03<00:23,  2.54it/s] 71%|███████   | 138/195 [01:04<00:22,  2.49it/s] 72%|███████▏  | 140/195 [01:04<00:21,  2.59it/s] 72%|███████▏  | 141/195 [01:04<00:18,  2.98it/s] 73%|███████▎  | 142/195 [01:05<00:20,  2.53it/s] 73%|███████▎  | 143/195 [01:05<00:19,  2.70it/s] 74%|███████▍  | 144/195 [01:06<00:19,  2.62it/s] 74%|███████▍  | 145/195 [01:06<00:17,  2.79it/s] 75%|███████▍  | 146/195 [01:06<00:17,  2.78it/s] 75%|███████▌  | 147/195 [01:07<00:16,  2.88it/s] 76%|███████▌  | 148/195 [01:07<00:16,  2.80it/s] 76%|███████▋  | 149/195 [01:07<00:15,  2.89it/s] 77%|███████▋  | 150/195 [01:08<00:17,  2.59it/s] 77%|███████▋  | 151/195 [01:08<00:17,  2.52it/s] 78%|███████▊  | 152/195 [01:09<00:17,  2.41it/s] 78%|███████▊  | 153/195 [01:09<00:17,  2.41it/s] 79%|███████▉  | 154/195 [01:10<00:17,  2.30it/s] 79%|███████▉  | 155/195 [01:10<00:16,  2.40it/s] 80%|████████  | 156/195 [01:10<00:14,  2.62it/s] 81%|████████  | 157/195 [01:11<00:14,  2.54it/s] 81%|████████  | 158/195 [01:11<00:12,  2.89it/s] 82%|████████▏ | 159/195 [01:11<00:13,  2.64it/s] 83%|████████▎ | 161/195 [01:12<00:12,  2.64it/s] 84%|████████▎ | 163/195 [01:13<00:11,  2.78it/s] 85%|████████▍ | 165/195 [01:14<00:10,  2.85it/s] 85%|████████▌ | 166/195 [01:14<00:09,  2.97it/s] 86%|████████▌ | 167/195 [01:14<00:10,  2.73it/s] 86%|████████▌ | 168/195 [01:15<00:09,  2.77it/s] 87%|████████▋ | 169/195 [01:15<00:10,  2.49it/s] 87%|████████▋ | 170/195 [01:16<00:09,  2.52it/s] 88%|████████▊ | 171/195 [01:16<00:08,  2.67it/s] 88%|████████▊ | 172/195 [01:16<00:09,  2.40it/s] 89%|████████▉ | 174/195 [01:17<00:07,  2.68it/s] 90%|█████████ | 176/195 [01:18<00:07,  2.66it/s] 91%|█████████▏| 178/195 [01:19<00:06,  2.66it/s] 92%|█████████▏| 180/195 [01:19<00:05,  2.66it/s] 93%|█████████▎| 182/195 [01:20<00:04,  2.66it/s] 94%|█████████▍| 184/195 [01:21<00:04,  2.61it/s] 95%|█████████▍| 185/195 [01:21<00:03,  2.74it/s] 95%|█████████▌| 186/195 [01:22<00:03,  2.61it/s] 96%|█████████▌| 187/195 [01:22<00:02,  2.67it/s] 96%|█████████▋| 188/195 [01:22<00:02,  2.63it/s] 97%|█████████▋| 189/195 [01:23<00:02,  2.51it/s] 97%|█████████▋| 190/195 [01:23<00:01,  2.54it/s] 98%|█████████▊| 191/195 [01:24<00:01,  2.55it/s] 98%|█████████▊| 192/195 [01:24<00:01,  2.56it/s] 99%|█████████▉| 193/195 [01:24<00:00,  2.56it/s] 99%|█████████▉| 194/195 [01:25<00:00,  2.55it/s]100%|██████████| 195/195 [01:25<00:00,  3.06it/s]100%|██████████| 195/195 [01:27<00:00,  2.23it/s]
2025-09-24 10:17:29 [info     ] Validating outputs
2025-09-24 10:17:29 [info     ] Predict - end                  time=0:1:27
2025-09-24 10:17:29 [info     ] Evaluate - start               split=test
2025-09-24 10:17:29 [info     ] Evaluate - end                 answer_distr=[0.22, 0.29, 0.25, 0.18] correctness_llm=0.55 llm_group_correctness=[0.46, 0.44, 0.54, 0.72, 0.62] monotonicity=0.32
2025-09-24 10:17:29 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:17:29 [info     ] Augmenting questions for IRT estimation num_questions=10
2025-09-24 10:17:29 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:17:29 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1088.66it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3504.46it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 572.43it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7651.84it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1015.82it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3524.02it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 629.39it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8989.63it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1328.69it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3715.06it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 693.34it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8052.70it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 990.79it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3557.90it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 674.91it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8124.00it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1079.30it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3560.30it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 771.74it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7928.74it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1145.36it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3622.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 675.20it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8388.61it/s]
2025-09-24 10:17:33 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 10:17:33 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:17:33 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:17:33 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:17:33 [info     ] Evaluate question difficulty - end mae=1.42 rmse=1.93 split=test
2025-09-24 10:17:33 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 2 finished: 0:1:42

 ********** Run: 3/3 **********
2025-09-24 10:17:52 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:17:52 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:17:52 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:17:52 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:17:54 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:17:54 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:17:58 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:17:58 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:17:58 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:17:59 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:18:02 [info     ] Setting seed                   value=45
2025-09-24 10:18:02 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 10:18:02 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_dbe_miscons_level_nocontext
2025-09-24 10:18:02 [info     ] Building model                 name=qwen3:14b provider=ollama rate_limit=None temp=1.0
2025-09-24 10:18:02 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:02<09:30,  2.94s/it]  2%|▏         | 3/195 [00:05<05:42,  1.78s/it]  2%|▏         | 4/195 [00:06<04:44,  1.49s/it]  3%|▎         | 5/195 [00:07<04:22,  1.38s/it]  4%|▎         | 7/195 [00:08<02:59,  1.05it/s]  4%|▍         | 8/195 [00:09<02:36,  1.19it/s]  5%|▍         | 9/195 [00:09<02:10,  1.43it/s]  5%|▌         | 10/195 [00:10<02:01,  1.52it/s]  6%|▌         | 11/195 [00:10<01:42,  1.79it/s]  6%|▌         | 12/195 [00:10<01:35,  1.91it/s]  7%|▋         | 13/195 [00:11<01:19,  2.30it/s]  7%|▋         | 14/195 [00:11<01:19,  2.28it/s]  8%|▊         | 16/195 [00:12<01:08,  2.60it/s]  9%|▉         | 18/195 [00:12<01:05,  2.71it/s] 10%|█         | 20/195 [00:13<01:02,  2.81it/s] 11%|█         | 21/195 [00:13<00:53,  3.22it/s] 11%|█▏        | 22/195 [00:14<01:03,  2.70it/s] 12%|█▏        | 24/195 [00:14<01:00,  2.83it/s] 13%|█▎        | 26/195 [00:15<01:00,  2.79it/s] 14%|█▍        | 28/195 [00:16<01:00,  2.74it/s] 15%|█▌        | 30/195 [00:17<01:01,  2.67it/s] 16%|█▋        | 32/195 [00:18<01:03,  2.57it/s] 17%|█▋        | 34/195 [00:18<01:04,  2.50it/s] 18%|█▊        | 35/195 [00:19<00:56,  2.84it/s] 18%|█▊        | 36/195 [00:19<01:08,  2.31it/s] 19%|█▉        | 38/195 [00:20<01:07,  2.32it/s] 20%|██        | 39/195 [00:21<01:06,  2.34it/s] 21%|██        | 40/195 [00:21<01:05,  2.35it/s] 21%|██        | 41/195 [00:21<01:03,  2.44it/s] 22%|██▏       | 42/195 [00:22<01:02,  2.45it/s] 22%|██▏       | 43/195 [00:22<00:59,  2.55it/s] 23%|██▎       | 44/195 [00:22<00:58,  2.58it/s] 23%|██▎       | 45/195 [00:23<00:54,  2.73it/s] 24%|██▎       | 46/195 [00:23<00:54,  2.74it/s] 24%|██▍       | 47/195 [00:23<00:51,  2.85it/s] 25%|██▍       | 48/195 [00:24<00:52,  2.82it/s] 25%|██▌       | 49/195 [00:24<00:50,  2.88it/s] 26%|██▌       | 50/195 [00:25<00:58,  2.46it/s] 26%|██▌       | 51/195 [00:25<01:02,  2.29it/s] 27%|██▋       | 52/195 [00:26<01:08,  2.10it/s] 27%|██▋       | 53/195 [00:26<01:10,  2.01it/s] 28%|██▊       | 54/195 [00:27<01:11,  1.97it/s] 28%|██▊       | 55/195 [00:27<01:15,  1.86it/s] 29%|██▉       | 57/195 [00:28<01:12,  1.90it/s] 30%|███       | 59/195 [00:30<01:11,  1.89it/s] 31%|███       | 60/195 [00:30<01:07,  2.01it/s] 31%|███▏      | 61/195 [00:30<01:00,  2.20it/s] 32%|███▏      | 62/195 [00:31<01:01,  2.18it/s] 32%|███▏      | 63/195 [00:31<00:54,  2.42it/s] 33%|███▎      | 64/195 [00:31<00:55,  2.37it/s] 33%|███▎      | 65/195 [00:32<00:52,  2.48it/s] 34%|███▍      | 66/195 [00:32<00:50,  2.54it/s] 34%|███▍      | 67/195 [00:32<00:47,  2.71it/s] 35%|███▍      | 68/195 [00:33<00:48,  2.59it/s] 35%|███▌      | 69/195 [00:33<00:42,  2.94it/s] 36%|███▌      | 70/195 [00:34<00:52,  2.38it/s] 37%|███▋      | 72/195 [00:34<00:46,  2.64it/s] 38%|███▊      | 74/195 [00:35<00:47,  2.54it/s] 39%|███▉      | 76/195 [00:36<00:43,  2.75it/s] 39%|███▉      | 77/195 [00:36<00:40,  2.95it/s] 40%|████      | 78/195 [00:37<00:45,  2.59it/s] 41%|████      | 79/195 [00:37<00:52,  2.23it/s] 42%|████▏     | 81/195 [00:38<00:44,  2.57it/s] 43%|████▎     | 83/195 [00:39<00:42,  2.66it/s] 43%|████▎     | 84/195 [00:39<00:41,  2.64it/s] 44%|████▎     | 85/195 [00:39<00:41,  2.66it/s] 44%|████▍     | 86/195 [00:40<00:39,  2.73it/s] 45%|████▍     | 87/195 [00:40<00:42,  2.53it/s] 46%|████▌     | 89/195 [00:41<00:40,  2.65it/s] 47%|████▋     | 91/195 [00:42<00:38,  2.72it/s] 48%|████▊     | 93/195 [00:42<00:36,  2.77it/s] 49%|████▊     | 95/195 [00:43<00:35,  2.80it/s] 50%|████▉     | 97/195 [00:44<00:34,  2.86it/s] 51%|█████     | 99/195 [00:44<00:32,  2.94it/s] 51%|█████▏    | 100/195 [00:45<00:36,  2.63it/s] 52%|█████▏    | 101/195 [00:45<00:40,  2.35it/s] 52%|█████▏    | 102/195 [00:46<00:42,  2.18it/s] 53%|█████▎    | 103/195 [00:47<00:47,  1.92it/s] 53%|█████▎    | 104/195 [00:47<00:48,  1.86it/s] 54%|█████▍    | 105/195 [00:48<00:49,  1.81it/s] 54%|█████▍    | 106/195 [00:48<00:49,  1.79it/s] 55%|█████▍    | 107/195 [00:49<00:49,  1.77it/s] 55%|█████▌    | 108/195 [00:50<00:48,  1.78it/s] 56%|█████▌    | 109/195 [00:50<00:48,  1.76it/s] 56%|█████▋    | 110/195 [00:51<00:47,  1.78it/s] 57%|█████▋    | 111/195 [00:51<00:46,  1.81it/s] 57%|█████▋    | 112/195 [00:52<00:44,  1.86it/s] 58%|█████▊    | 113/195 [00:53<00:48,  1.70it/s] 58%|█████▊    | 114/195 [00:53<00:47,  1.72it/s] 59%|█████▉    | 115/195 [00:54<00:46,  1.72it/s] 59%|█████▉    | 116/195 [00:54<00:47,  1.65it/s] 60%|██████    | 117/195 [00:55<00:44,  1.73it/s] 61%|██████    | 118/195 [00:55<00:46,  1.65it/s] 61%|██████    | 119/195 [00:56<00:45,  1.68it/s] 62%|██████▏   | 120/195 [00:57<00:42,  1.75it/s] 63%|██████▎   | 122/195 [00:57<00:36,  2.00it/s] 64%|██████▎   | 124/195 [00:58<00:33,  2.14it/s] 64%|██████▍   | 125/195 [00:58<00:27,  2.54it/s] 65%|██████▍   | 126/195 [00:59<00:32,  2.11it/s] 66%|██████▌   | 128/195 [01:00<00:29,  2.25it/s] 67%|██████▋   | 130/195 [01:01<00:27,  2.32it/s] 68%|██████▊   | 132/195 [01:02<00:27,  2.31it/s] 69%|██████▊   | 134/195 [01:02<00:25,  2.35it/s] 69%|██████▉   | 135/195 [01:03<00:21,  2.75it/s] 70%|██████▉   | 136/195 [01:03<00:25,  2.29it/s] 71%|███████   | 138/195 [01:04<00:23,  2.42it/s] 72%|███████▏  | 140/195 [01:05<00:22,  2.43it/s] 73%|███████▎  | 142/195 [01:05<00:20,  2.62it/s] 73%|███████▎  | 143/195 [01:06<00:20,  2.59it/s] 74%|███████▍  | 144/195 [01:06<00:19,  2.61it/s] 74%|███████▍  | 145/195 [01:07<00:19,  2.63it/s] 75%|███████▍  | 146/195 [01:07<00:18,  2.68it/s] 75%|███████▌  | 147/195 [01:07<00:17,  2.69it/s] 76%|███████▌  | 148/195 [01:08<00:17,  2.74it/s] 76%|███████▋  | 149/195 [01:08<00:18,  2.52it/s] 77%|███████▋  | 151/195 [01:09<00:18,  2.40it/s] 78%|███████▊  | 152/195 [01:09<00:17,  2.52it/s] 78%|███████▊  | 153/195 [01:10<00:18,  2.33it/s] 79%|███████▉  | 154/195 [01:10<00:17,  2.28it/s] 79%|███████▉  | 155/195 [01:11<00:15,  2.51it/s] 80%|████████  | 156/195 [01:11<00:15,  2.47it/s] 81%|████████  | 157/195 [01:11<00:13,  2.84it/s] 81%|████████  | 158/195 [01:12<00:13,  2.66it/s] 82%|████████▏ | 160/195 [01:13<00:13,  2.56it/s] 83%|████████▎ | 162/195 [01:13<00:12,  2.71it/s] 84%|████████▎ | 163/195 [01:14<00:11,  2.73it/s] 84%|████████▍ | 164/195 [01:14<00:11,  2.74it/s] 85%|████████▍ | 165/195 [01:14<00:11,  2.72it/s] 85%|████████▌ | 166/195 [01:15<00:10,  2.81it/s] 86%|████████▌ | 167/195 [01:15<00:10,  2.64it/s] 86%|████████▌ | 168/195 [01:15<00:09,  2.93it/s] 87%|████████▋ | 169/195 [01:16<00:09,  2.64it/s] 87%|████████▋ | 170/195 [01:16<00:08,  2.88it/s] 88%|████████▊ | 171/195 [01:16<00:09,  2.65it/s] 88%|████████▊ | 172/195 [01:17<00:07,  2.91it/s] 89%|████████▊ | 173/195 [01:17<00:08,  2.45it/s] 89%|████████▉ | 174/195 [01:18<00:07,  2.80it/s] 90%|████████▉ | 175/195 [01:18<00:07,  2.65it/s] 90%|█████████ | 176/195 [01:18<00:06,  2.78it/s] 91%|█████████ | 177/195 [01:19<00:06,  2.69it/s] 91%|█████████▏| 178/195 [01:19<00:06,  2.79it/s] 92%|█████████▏| 179/195 [01:20<00:06,  2.31it/s] 93%|█████████▎| 181/195 [01:20<00:05,  2.49it/s] 93%|█████████▎| 182/195 [01:20<00:04,  3.02it/s] 94%|█████████▍| 183/195 [01:21<00:05,  2.38it/s] 95%|█████████▍| 185/195 [01:22<00:04,  2.48it/s] 95%|█████████▌| 186/195 [01:22<00:03,  2.51it/s] 96%|█████████▌| 187/195 [01:23<00:03,  2.52it/s] 96%|█████████▋| 188/195 [01:23<00:02,  2.56it/s] 97%|█████████▋| 189/195 [01:23<00:02,  2.61it/s] 97%|█████████▋| 190/195 [01:24<00:02,  2.35it/s] 98%|█████████▊| 192/195 [01:25<00:01,  2.41it/s] 99%|█████████▉| 194/195 [01:26<00:00,  2.44it/s]100%|██████████| 195/195 [01:28<00:00,  2.21it/s]
2025-09-24 10:19:31 [info     ] Validating outputs
2025-09-24 10:19:31 [info     ] Predict - end                  time=0:1:28
2025-09-24 10:19:31 [info     ] Evaluate - start               split=test
2025-09-24 10:19:31 [info     ] Evaluate - end                 answer_distr=[0.28, 0.31, 0.22, 0.15] correctness_llm=0.55 llm_group_correctness=[0.38, 0.44, 0.56, 0.67, 0.72] monotonicity=0.98
2025-09-24 10:19:31 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:19:31 [info     ] Augmenting questions for IRT estimation num_questions=10
2025-09-24 10:19:31 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:19:31 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1025.54it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3947.91it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 570.91it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6103.98it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 947.07it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3461.01it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 607.38it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7143.58it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1135.96it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3590.07it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 638.22it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7708.09it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1035.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3398.60it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 610.54it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8037.26it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 963.04it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3914.47it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 640.83it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7093.53it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1050.11it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3742.94it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 723.21it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6997.17it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 964.87it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3509.20it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 774.93it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6924.56it/s]
2025-09-24 10:19:36 INFO: EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
2025-09-24 10:19:36 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:19:36 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:19:36 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:19:36 [info     ] Evaluate question difficulty - end mae=1.6 rmse=1.91 split=test
2025-09-24 10:19:36 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 3 finished: 0:1:44

 ========== Config: qwen3:1.7b~T_0.0~SO_teacher_bool_nocontext~L_5~SP_teacher_dbe_miscons_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_cfe_studentlevel_random0 ==========
Config 12/16

 ********** Run: 1/3 **********
2025-09-24 10:19:54 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:19:54 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:19:54 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:19:54 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:19:56 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:19:56 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:20:01 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:20:01 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:20:01 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:20:02 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:20:05 [info     ] Setting seed                   value=43
2025-09-24 10:20:05 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 10:20:05 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_dbe_miscons_level_nocontext
2025-09-24 10:20:05 [info     ] Building model                 name=qwen3:1.7b provider=ollama rate_limit=None temp=0.0
2025-09-24 10:20:05 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:03<09:57,  3.08s/it]  2%|▏         | 3/195 [00:03<02:59,  1.07it/s]  3%|▎         | 5/195 [00:03<01:45,  1.80it/s]  4%|▎         | 7/195 [00:04<01:17,  2.41it/s]  5%|▍         | 9/195 [00:04<01:03,  2.94it/s]  6%|▌         | 11/195 [00:05<00:54,  3.38it/s]  6%|▌         | 12/195 [00:05<00:47,  3.87it/s]  7%|▋         | 13/195 [00:05<00:47,  3.80it/s]  8%|▊         | 15/195 [00:05<00:40,  4.47it/s]  9%|▊         | 17/195 [00:06<00:36,  4.90it/s] 10%|▉         | 19/195 [00:06<00:36,  4.84it/s] 11%|█         | 21/195 [00:06<00:34,  5.02it/s] 12%|█▏        | 23/195 [00:07<00:34,  4.99it/s] 13%|█▎        | 25/195 [00:07<00:33,  5.10it/s] 14%|█▍        | 27/195 [00:08<00:33,  5.03it/s] 15%|█▍        | 29/195 [00:08<00:32,  5.15it/s] 16%|█▌        | 31/195 [00:08<00:31,  5.26it/s] 17%|█▋        | 33/195 [00:09<00:29,  5.45it/s] 18%|█▊        | 35/195 [00:09<00:29,  5.51it/s] 19%|█▉        | 37/195 [00:09<00:29,  5.41it/s] 20%|██        | 39/195 [00:10<00:27,  5.57it/s] 21%|██        | 41/195 [00:10<00:29,  5.14it/s] 22%|██▏       | 43/195 [00:11<00:29,  5.19it/s] 23%|██▎       | 45/195 [00:11<00:29,  5.06it/s] 24%|██▍       | 47/195 [00:11<00:28,  5.20it/s] 25%|██▌       | 49/195 [00:12<00:26,  5.44it/s] 26%|██▌       | 51/195 [00:12<00:28,  5.14it/s] 27%|██▋       | 53/195 [00:13<00:26,  5.35it/s] 28%|██▊       | 55/195 [00:13<00:26,  5.20it/s] 29%|██▉       | 57/195 [00:13<00:26,  5.12it/s] 30%|███       | 59/195 [00:14<00:26,  5.21it/s] 31%|███▏      | 61/195 [00:14<00:25,  5.36it/s] 32%|███▏      | 63/195 [00:14<00:23,  5.55it/s] 33%|███▎      | 65/195 [00:15<00:23,  5.47it/s] 34%|███▍      | 67/195 [00:15<00:23,  5.45it/s] 35%|███▌      | 69/195 [00:15<00:22,  5.58it/s] 36%|███▋      | 71/195 [00:16<00:24,  5.13it/s] 37%|███▋      | 73/195 [00:16<00:24,  5.06it/s] 38%|███▊      | 74/195 [00:16<00:21,  5.52it/s] 38%|███▊      | 75/195 [00:17<00:25,  4.75it/s] 39%|███▉      | 77/195 [00:17<00:23,  5.07it/s] 41%|████      | 79/195 [00:17<00:21,  5.28it/s] 42%|████▏     | 81/195 [00:18<00:22,  5.10it/s] 43%|████▎     | 83/195 [00:18<00:21,  5.21it/s] 44%|████▎     | 85/195 [00:19<00:21,  5.15it/s] 45%|████▍     | 87/195 [00:19<00:20,  5.26it/s] 46%|████▌     | 89/195 [00:19<00:19,  5.47it/s] 47%|████▋     | 91/195 [00:20<00:19,  5.25it/s] 48%|████▊     | 93/195 [00:20<00:20,  5.07it/s] 49%|████▊     | 95/195 [00:21<00:19,  5.13it/s] 50%|████▉     | 97/195 [00:21<00:18,  5.22it/s] 51%|█████     | 99/195 [00:21<00:18,  5.11it/s] 52%|█████▏    | 101/195 [00:22<00:18,  5.03it/s] 52%|█████▏    | 102/195 [00:22<00:18,  5.03it/s] 53%|█████▎    | 103/195 [00:22<00:17,  5.28it/s] 53%|█████▎    | 104/195 [00:22<00:17,  5.06it/s] 54%|█████▍    | 106/195 [00:23<00:17,  4.99it/s] 55%|█████▌    | 108/195 [00:23<00:16,  5.25it/s] 56%|█████▋    | 110/195 [00:24<00:16,  5.18it/s] 57%|█████▋    | 112/195 [00:24<00:16,  5.11it/s] 58%|█████▊    | 114/195 [00:24<00:15,  5.20it/s] 59%|█████▉    | 115/195 [00:24<00:14,  5.67it/s] 59%|█████▉    | 116/195 [00:25<00:16,  4.74it/s] 61%|██████    | 118/195 [00:25<00:15,  5.10it/s] 62%|██████▏   | 120/195 [00:25<00:14,  5.15it/s] 63%|██████▎   | 122/195 [00:26<00:13,  5.31it/s] 64%|██████▎   | 124/195 [00:26<00:12,  5.52it/s] 65%|██████▍   | 126/195 [00:27<00:12,  5.45it/s] 66%|██████▌   | 128/195 [00:27<00:11,  5.64it/s] 67%|██████▋   | 130/195 [00:27<00:11,  5.52it/s] 68%|██████▊   | 132/195 [00:28<00:11,  5.58it/s] 69%|██████▊   | 134/195 [00:28<00:10,  5.74it/s] 70%|██████▉   | 136/195 [00:28<00:10,  5.59it/s] 71%|███████   | 138/195 [00:29<00:10,  5.68it/s] 72%|███████▏  | 140/195 [00:29<00:09,  5.54it/s] 73%|███████▎  | 142/195 [00:29<00:09,  5.62it/s] 74%|███████▍  | 144/195 [00:30<00:09,  5.43it/s] 75%|███████▍  | 146/195 [00:30<00:08,  5.50it/s] 76%|███████▌  | 148/195 [00:30<00:08,  5.61it/s] 77%|███████▋  | 150/195 [00:31<00:08,  5.44it/s] 78%|███████▊  | 152/195 [00:31<00:07,  5.38it/s] 79%|███████▉  | 154/195 [00:32<00:07,  5.55it/s] 80%|████████  | 156/195 [00:32<00:07,  5.45it/s] 81%|████████  | 158/195 [00:32<00:06,  5.30it/s] 82%|████████▏ | 160/195 [00:33<00:06,  5.41it/s] 83%|████████▎ | 162/195 [00:33<00:05,  5.51it/s] 84%|████████▍ | 164/195 [00:33<00:05,  5.68it/s] 85%|████████▌ | 166/195 [00:34<00:05,  5.38it/s] 86%|████████▌ | 168/195 [00:34<00:04,  5.56it/s] 87%|████████▋ | 170/195 [00:34<00:04,  5.63it/s] 88%|████████▊ | 172/195 [00:35<00:04,  5.63it/s] 89%|████████▉ | 174/195 [00:35<00:03,  5.57it/s] 90%|█████████ | 176/195 [00:36<00:03,  5.56it/s] 91%|█████████▏| 178/195 [00:36<00:03,  5.45it/s] 92%|█████████▏| 180/195 [00:36<00:02,  5.38it/s] 93%|█████████▎| 182/195 [00:37<00:02,  5.39it/s] 94%|█████████▍| 184/195 [00:37<00:02,  5.25it/s] 95%|█████████▌| 186/195 [00:37<00:01,  5.17it/s] 96%|█████████▋| 188/195 [00:38<00:01,  5.32it/s] 97%|█████████▋| 190/195 [00:38<00:00,  5.37it/s] 98%|█████████▊| 192/195 [00:39<00:00,  5.29it/s] 99%|█████████▉| 194/195 [00:39<00:00,  5.47it/s]100%|██████████| 195/195 [00:41<00:00,  4.69it/s]
2025-09-24 10:20:46 [info     ] Validating outputs
2025-09-24 10:20:46 [info     ] Predict - end                  time=0:0:41
2025-09-24 10:20:46 [info     ] Evaluate - start               split=test
2025-09-24 10:20:46 [info     ] Evaluate - end                 answer_distr=[0.35, 0.26, 0.16, 0.23] correctness_llm=0.88 llm_group_correctness=[0.9, 0.85, 0.87, 0.85, 0.92] monotonicity=-0.26
2025-09-24 10:20:46 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:20:46 [info     ] Augmenting questions for IRT estimation num_questions=34
2025-09-24 10:20:46 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:20:46 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 996.00it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3460.87it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 525.49it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6147.43it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 896.88it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3085.85it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 612.81it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6724.72it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 905.45it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3813.80it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 596.84it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6468.41it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 885.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3635.95it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 708.68it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5896.79it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 950.97it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3526.45it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 569.82it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5833.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 944.33it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3615.30it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 617.93it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6160.33it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 906.93it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3716.41it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 639.32it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7023.95it/s]
2025-09-24 10:20:51 INFO: EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
2025-09-24 10:20:51 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:20:51 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:20:51 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:20:51 [info     ] Evaluate question difficulty - end mae=1.42 rmse=1.87 split=test
2025-09-24 10:20:51 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 1 finished: 0:0:57

 ********** Run: 2/3 **********
2025-09-24 10:21:14 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:21:14 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:21:14 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:21:14 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:21:16 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:21:16 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:21:21 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:21:21 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:21:21 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:21:21 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:21:24 [info     ] Setting seed                   value=44
2025-09-24 10:21:24 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 10:21:24 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_dbe_miscons_level_nocontext
2025-09-24 10:21:24 [info     ] Building model                 name=qwen3:1.7b provider=ollama rate_limit=None temp=0.0
2025-09-24 10:21:24 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<03:41,  1.14s/it]  2%|▏         | 3/195 [00:01<01:24,  2.26it/s]  3%|▎         | 5/195 [00:01<01:03,  3.00it/s]  4%|▎         | 7/195 [00:02<00:53,  3.53it/s]  5%|▍         | 9/195 [00:02<00:48,  3.85it/s]  6%|▌         | 11/195 [00:03<00:44,  4.12it/s]  7%|▋         | 13/195 [00:03<00:39,  4.60it/s]  8%|▊         | 15/195 [00:03<00:37,  4.83it/s]  9%|▊         | 17/195 [00:04<00:36,  4.88it/s] 10%|▉         | 19/195 [00:04<00:35,  5.02it/s] 11%|█         | 21/195 [00:05<00:34,  5.03it/s] 12%|█▏        | 23/195 [00:05<00:32,  5.28it/s] 13%|█▎        | 25/195 [00:05<00:31,  5.34it/s] 14%|█▍        | 27/195 [00:06<00:30,  5.44it/s] 15%|█▍        | 29/195 [00:06<00:31,  5.33it/s] 16%|█▌        | 31/195 [00:06<00:30,  5.37it/s] 17%|█▋        | 33/195 [00:07<00:30,  5.29it/s] 18%|█▊        | 35/195 [00:07<00:29,  5.41it/s] 19%|█▉        | 37/195 [00:08<00:29,  5.29it/s] 20%|██        | 39/195 [00:08<00:31,  4.92it/s] 21%|██        | 41/195 [00:09<00:31,  4.89it/s] 22%|██▏       | 43/195 [00:09<00:30,  4.99it/s] 23%|██▎       | 45/195 [00:09<00:30,  4.96it/s] 24%|██▎       | 46/195 [00:09<00:27,  5.43it/s] 24%|██▍       | 47/195 [00:10<00:28,  5.24it/s] 25%|██▍       | 48/195 [00:10<00:26,  5.50it/s] 25%|██▌       | 49/195 [00:10<00:26,  5.54it/s] 26%|██▌       | 50/195 [00:10<00:26,  5.40it/s] 26%|██▌       | 51/195 [00:10<00:27,  5.24it/s] 27%|██▋       | 52/195 [00:11<00:27,  5.17it/s] 27%|██▋       | 53/195 [00:11<00:25,  5.47it/s] 28%|██▊       | 54/195 [00:11<00:27,  5.18it/s] 29%|██▊       | 56/195 [00:11<00:28,  4.93it/s] 30%|██▉       | 58/195 [00:12<00:27,  4.90it/s] 31%|███       | 60/195 [00:12<00:26,  5.13it/s] 32%|███▏      | 62/195 [00:12<00:24,  5.39it/s] 33%|███▎      | 64/195 [00:13<00:23,  5.57it/s] 34%|███▍      | 66/195 [00:13<00:24,  5.37it/s] 35%|███▍      | 68/195 [00:14<00:22,  5.53it/s] 36%|███▌      | 70/195 [00:14<00:22,  5.62it/s] 36%|███▋      | 71/195 [00:14<00:20,  6.04it/s] 37%|███▋      | 72/195 [00:14<00:25,  4.92it/s] 38%|███▊      | 74/195 [00:15<00:23,  5.12it/s] 39%|███▉      | 76/195 [00:15<00:22,  5.27it/s] 40%|████      | 78/195 [00:15<00:22,  5.28it/s] 41%|████      | 80/195 [00:16<00:21,  5.32it/s] 42%|████▏     | 82/195 [00:16<00:21,  5.16it/s] 43%|████▎     | 84/195 [00:17<00:21,  5.20it/s] 44%|████▍     | 86/195 [00:17<00:20,  5.32it/s] 45%|████▌     | 88/195 [00:17<00:19,  5.53it/s] 46%|████▌     | 89/195 [00:17<00:17,  6.01it/s] 46%|████▌     | 90/195 [00:18<00:19,  5.51it/s] 47%|████▋     | 91/195 [00:18<00:18,  5.65it/s] 47%|████▋     | 92/195 [00:18<00:19,  5.30it/s] 48%|████▊     | 93/195 [00:18<00:18,  5.53it/s] 48%|████▊     | 94/195 [00:18<00:19,  5.18it/s] 49%|████▊     | 95/195 [00:19<00:18,  5.32it/s] 49%|████▉     | 96/195 [00:19<00:19,  5.01it/s] 50%|████▉     | 97/195 [00:19<00:18,  5.30it/s] 50%|█████     | 98/195 [00:19<00:18,  5.12it/s] 51%|█████     | 99/195 [00:19<00:17,  5.35it/s] 51%|█████▏    | 100/195 [00:20<00:17,  5.41it/s] 52%|█████▏    | 101/195 [00:20<00:21,  4.28it/s] 53%|█████▎    | 103/195 [00:20<00:20,  4.55it/s] 54%|█████▍    | 105/195 [00:21<00:18,  4.76it/s] 55%|█████▍    | 107/195 [00:21<00:17,  5.04it/s] 56%|█████▌    | 109/195 [00:21<00:16,  5.29it/s] 57%|█████▋    | 111/195 [00:22<00:15,  5.43it/s] 58%|█████▊    | 113/195 [00:22<00:14,  5.56it/s] 59%|█████▉    | 115/195 [00:22<00:15,  5.22it/s] 60%|██████    | 117/195 [00:23<00:15,  4.91it/s] 61%|██████    | 119/195 [00:23<00:14,  5.23it/s] 62%|██████▏   | 121/195 [00:24<00:14,  5.21it/s] 63%|██████▎   | 123/195 [00:24<00:13,  5.35it/s] 64%|██████▍   | 125/195 [00:24<00:13,  5.36it/s] 65%|██████▌   | 127/195 [00:25<00:12,  5.43it/s] 66%|██████▌   | 129/195 [00:25<00:11,  5.56it/s] 67%|██████▋   | 131/195 [00:25<00:11,  5.40it/s] 68%|██████▊   | 133/195 [00:26<00:11,  5.61it/s] 69%|██████▉   | 135/195 [00:26<00:10,  5.59it/s] 70%|██████▉   | 136/195 [00:26<00:09,  6.04it/s] 70%|███████   | 137/195 [00:26<00:10,  5.76it/s] 71%|███████   | 138/195 [00:27<00:09,  5.93it/s] 71%|███████▏  | 139/195 [00:27<00:09,  5.95it/s] 72%|███████▏  | 140/195 [00:27<00:09,  5.95it/s] 72%|███████▏  | 141/195 [00:27<00:09,  5.86it/s] 73%|███████▎  | 142/195 [00:27<00:09,  5.83it/s] 73%|███████▎  | 143/195 [00:27<00:09,  5.77it/s] 74%|███████▍  | 144/195 [00:28<00:08,  5.82it/s] 74%|███████▍  | 145/195 [00:28<00:08,  5.78it/s] 75%|███████▍  | 146/195 [00:28<00:08,  5.76it/s] 75%|███████▌  | 147/195 [00:28<00:08,  5.78it/s] 76%|███████▌  | 148/195 [00:28<00:07,  6.04it/s] 76%|███████▋  | 149/195 [00:28<00:07,  6.14it/s] 77%|███████▋  | 150/195 [00:29<00:08,  5.39it/s] 77%|███████▋  | 151/195 [00:29<00:08,  5.15it/s] 78%|███████▊  | 152/195 [00:29<00:07,  5.54it/s] 78%|███████▊  | 153/195 [00:29<00:07,  5.99it/s] 79%|███████▉  | 154/195 [00:29<00:07,  5.77it/s] 80%|████████  | 156/195 [00:30<00:06,  6.21it/s] 81%|████████  | 158/195 [00:30<00:05,  6.57it/s] 82%|████████▏ | 160/195 [00:30<00:05,  5.97it/s] 83%|████████▎ | 162/195 [00:31<00:05,  6.00it/s] 84%|████████▍ | 164/195 [00:31<00:05,  5.68it/s] 85%|████████▌ | 166/195 [00:32<00:05,  5.25it/s] 86%|████████▌ | 168/195 [00:32<00:05,  5.32it/s] 87%|████████▋ | 170/195 [00:32<00:04,  5.37it/s] 88%|████████▊ | 172/195 [00:33<00:04,  5.39it/s] 89%|████████▉ | 174/195 [00:33<00:03,  5.46it/s] 90%|█████████ | 176/195 [00:33<00:03,  5.58it/s] 91%|█████████▏| 178/195 [00:34<00:03,  5.59it/s] 92%|█████████▏| 180/195 [00:34<00:02,  5.48it/s] 93%|█████████▎| 182/195 [00:34<00:02,  5.55it/s] 94%|█████████▍| 184/195 [00:35<00:01,  5.60it/s] 95%|█████████▌| 186/195 [00:35<00:01,  5.59it/s] 96%|█████████▋| 188/195 [00:36<00:01,  5.40it/s] 97%|█████████▋| 190/195 [00:36<00:00,  5.47it/s] 98%|█████████▊| 192/195 [00:36<00:00,  5.49it/s] 99%|█████████▉| 194/195 [00:37<00:00,  5.46it/s]100%|██████████| 195/195 [00:39<00:00,  4.96it/s]
2025-09-24 10:22:04 [info     ] Validating outputs
2025-09-24 10:22:04 [info     ] Predict - end                  time=0:0:39
2025-09-24 10:22:04 [info     ] Evaluate - start               split=test
2025-09-24 10:22:04 [info     ] Evaluate - end                 answer_distr=[0.35, 0.27, 0.16, 0.22] correctness_llm=0.87 llm_group_correctness=[0.9, 0.82, 0.85, 0.85, 0.92] monotonicity=-0.12
2025-09-24 10:22:04 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:22:04 [info     ] Augmenting questions for IRT estimation num_questions=33
2025-09-24 10:22:04 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:22:04 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1111.70it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3746.37it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 552.56it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7657.83it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1067.76it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3787.31it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 616.69it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8701.88it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 951.15it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3077.84it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 648.69it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8915.92it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 992.23it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3686.84it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 605.53it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 9017.24it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1275.70it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3997.60it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 644.33it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7852.40it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1063.46it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3777.08it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 612.64it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7616.12it/s]
2025-09-24 10:22:08 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 10:22:08 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:22:08 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:22:08 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:22:08 [info     ] Evaluate question difficulty - end mae=1.5 rmse=1.97 split=test
2025-09-24 10:22:08 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 2 finished: 0:0:54

 ********** Run: 3/3 **********
2025-09-24 10:22:25 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:22:25 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:22:25 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:22:25 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:22:27 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:22:27 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:22:32 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:22:32 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:22:32 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:22:32 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:22:35 [info     ] Setting seed                   value=45
2025-09-24 10:22:35 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 10:22:35 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_dbe_miscons_level_nocontext
2025-09-24 10:22:35 [info     ] Building model                 name=qwen3:1.7b provider=ollama rate_limit=None temp=0.0
2025-09-24 10:22:35 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<03:24,  1.05s/it]  2%|▏         | 3/195 [00:01<01:17,  2.48it/s]  3%|▎         | 5/195 [00:01<00:58,  3.27it/s]  4%|▎         | 7/195 [00:02<00:51,  3.67it/s]  5%|▍         | 9/195 [00:02<00:46,  3.98it/s]  5%|▌         | 10/195 [00:02<00:40,  4.56it/s]  6%|▌         | 11/195 [00:03<00:40,  4.54it/s]  6%|▌         | 12/195 [00:03<00:37,  4.88it/s]  7%|▋         | 13/195 [00:03<00:38,  4.71it/s]  7%|▋         | 14/195 [00:03<00:38,  4.66it/s]  8%|▊         | 15/195 [00:03<00:36,  4.96it/s]  8%|▊         | 16/195 [00:03<00:34,  5.16it/s]  9%|▊         | 17/195 [00:04<00:32,  5.56it/s]  9%|▉         | 18/195 [00:04<00:34,  5.13it/s] 10%|█         | 20/195 [00:04<00:33,  5.20it/s] 11%|█▏        | 22/195 [00:05<00:31,  5.49it/s] 12%|█▏        | 24/195 [00:05<00:31,  5.48it/s] 13%|█▎        | 26/195 [00:05<00:31,  5.41it/s] 14%|█▍        | 28/195 [00:06<00:32,  5.14it/s] 15%|█▌        | 30/195 [00:06<00:30,  5.38it/s] 16%|█▋        | 32/195 [00:06<00:29,  5.50it/s] 17%|█▋        | 34/195 [00:07<00:28,  5.65it/s] 18%|█▊        | 35/195 [00:07<00:26,  6.11it/s] 18%|█▊        | 36/195 [00:07<00:31,  5.05it/s] 19%|█▉        | 38/195 [00:08<00:30,  5.09it/s] 21%|██        | 40/195 [00:08<00:29,  5.21it/s] 22%|██▏       | 42/195 [00:08<00:30,  5.04it/s] 23%|██▎       | 44/195 [00:09<00:30,  4.92it/s] 24%|██▎       | 46/195 [00:09<00:30,  4.95it/s] 25%|██▍       | 48/195 [00:10<00:29,  4.98it/s] 26%|██▌       | 50/195 [00:10<00:29,  4.96it/s] 27%|██▋       | 52/195 [00:10<00:28,  4.94it/s] 28%|██▊       | 54/195 [00:11<00:27,  5.10it/s] 29%|██▊       | 56/195 [00:11<00:27,  5.07it/s] 30%|██▉       | 58/195 [00:12<00:26,  5.17it/s] 31%|███       | 60/195 [00:12<00:25,  5.39it/s] 32%|███▏      | 62/195 [00:12<00:23,  5.56it/s] 33%|███▎      | 64/195 [00:13<00:24,  5.40it/s] 34%|███▍      | 66/195 [00:13<00:22,  5.77it/s] 34%|███▍      | 67/195 [00:13<00:22,  5.61it/s] 35%|███▍      | 68/195 [00:13<00:22,  5.68it/s] 35%|███▌      | 69/195 [00:13<00:21,  5.80it/s] 36%|███▌      | 70/195 [00:14<00:21,  5.73it/s] 36%|███▋      | 71/195 [00:14<00:21,  5.78it/s] 37%|███▋      | 72/195 [00:14<00:21,  5.62it/s] 37%|███▋      | 73/195 [00:14<00:21,  5.77it/s] 38%|███▊      | 74/195 [00:14<00:21,  5.70it/s] 38%|███▊      | 75/195 [00:14<00:20,  5.76it/s] 39%|███▉      | 76/195 [00:15<00:20,  5.72it/s] 39%|███▉      | 77/195 [00:15<00:21,  5.53it/s] 40%|████      | 78/195 [00:15<00:19,  5.98it/s] 41%|████      | 79/195 [00:15<00:20,  5.61it/s] 42%|████▏     | 81/195 [00:16<00:19,  5.73it/s] 43%|████▎     | 83/195 [00:16<00:19,  5.76it/s] 44%|████▎     | 85/195 [00:16<00:18,  5.95it/s] 45%|████▍     | 87/195 [00:17<00:18,  5.78it/s] 46%|████▌     | 89/195 [00:17<00:18,  5.88it/s] 47%|████▋     | 91/195 [00:17<00:18,  5.59it/s] 48%|████▊     | 93/195 [00:18<00:17,  5.80it/s] 49%|████▊     | 95/195 [00:18<00:20,  4.91it/s] 50%|████▉     | 97/195 [00:19<00:19,  5.11it/s] 51%|█████     | 99/195 [00:19<00:18,  5.29it/s] 52%|█████▏    | 101/195 [00:19<00:18,  5.01it/s] 53%|█████▎    | 103/195 [00:20<00:17,  5.37it/s] 54%|█████▍    | 105/195 [00:20<00:16,  5.57it/s] 55%|█████▍    | 107/195 [00:20<00:15,  5.54it/s] 56%|█████▌    | 109/195 [00:21<00:15,  5.64it/s] 57%|█████▋    | 111/195 [00:21<00:14,  5.96it/s] 58%|█████▊    | 113/195 [00:21<00:14,  5.52it/s] 59%|█████▉    | 115/195 [00:22<00:14,  5.65it/s] 60%|██████    | 117/195 [00:22<00:13,  5.64it/s] 61%|██████    | 119/195 [00:22<00:13,  5.66it/s] 62%|██████▏   | 121/195 [00:23<00:13,  5.68it/s] 63%|██████▎   | 123/195 [00:23<00:12,  5.57it/s] 64%|██████▍   | 125/195 [00:23<00:12,  5.61it/s] 65%|██████▌   | 127/195 [00:24<00:12,  5.59it/s] 66%|██████▌   | 128/195 [00:24<00:11,  6.01it/s] 66%|██████▌   | 129/195 [00:24<00:12,  5.12it/s] 67%|██████▋   | 131/195 [00:25<00:12,  5.24it/s] 68%|██████▊   | 133/195 [00:25<00:11,  5.46it/s] 69%|██████▉   | 135/195 [00:25<00:10,  5.51it/s] 70%|███████   | 137/195 [00:26<00:10,  5.73it/s] 71%|███████▏  | 139/195 [00:26<00:09,  6.03it/s] 72%|███████▏  | 141/195 [00:26<00:09,  5.87it/s] 73%|███████▎  | 143/195 [00:27<00:08,  6.13it/s] 74%|███████▍  | 145/195 [00:27<00:08,  5.75it/s] 75%|███████▌  | 147/195 [00:27<00:08,  5.77it/s] 76%|███████▋  | 149/195 [00:28<00:07,  5.87it/s] 77%|███████▋  | 151/195 [00:28<00:07,  5.69it/s] 78%|███████▊  | 152/195 [00:28<00:07,  6.07it/s] 78%|███████▊  | 153/195 [00:28<00:07,  5.29it/s] 79%|███████▉  | 155/195 [00:29<00:07,  5.42it/s] 81%|████████  | 157/195 [00:29<00:06,  5.62it/s] 81%|████████  | 158/195 [00:29<00:06,  6.14it/s] 82%|████████▏ | 159/195 [00:29<00:06,  5.45it/s] 83%|████████▎ | 161/195 [00:30<00:06,  5.58it/s] 84%|████████▎ | 163/195 [00:30<00:06,  5.32it/s] 85%|████████▍ | 165/195 [00:31<00:05,  5.49it/s] 86%|████████▌ | 167/195 [00:31<00:05,  5.49it/s] 87%|████████▋ | 169/195 [00:31<00:04,  5.36it/s] 88%|████████▊ | 171/195 [00:32<00:04,  5.12it/s] 89%|████████▊ | 173/195 [00:32<00:04,  5.25it/s] 90%|████████▉ | 175/195 [00:32<00:03,  5.30it/s] 91%|█████████ | 177/195 [00:33<00:03,  5.28it/s] 92%|█████████▏| 179/195 [00:33<00:03,  5.31it/s] 93%|█████████▎| 181/195 [00:34<00:02,  5.33it/s] 94%|█████████▍| 183/195 [00:34<00:02,  5.14it/s] 95%|█████████▍| 185/195 [00:34<00:01,  5.27it/s] 96%|█████████▌| 187/195 [00:35<00:01,  5.37it/s] 97%|█████████▋| 189/195 [00:35<00:01,  5.08it/s] 98%|█████████▊| 191/195 [00:36<00:00,  5.28it/s] 99%|█████████▉| 193/195 [00:36<00:00,  5.34it/s]100%|██████████| 195/195 [00:36<00:00,  5.86it/s]100%|██████████| 195/195 [00:38<00:00,  5.02it/s]
2025-09-24 10:23:14 [info     ] Validating outputs
2025-09-24 10:23:14 [info     ] Predict - end                  time=0:0:38
2025-09-24 10:23:14 [info     ] Evaluate - start               split=test
2025-09-24 10:23:14 [info     ] Evaluate - end                 answer_distr=[0.34, 0.28, 0.15, 0.23] correctness_llm=0.86 llm_group_correctness=[0.9, 0.82, 0.82, 0.85, 0.9] monotonicity=-0.32
2025-09-24 10:23:14 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:23:14 [info     ] Augmenting questions for IRT estimation num_questions=34
2025-09-24 10:23:14 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:23:14 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1096.39it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3963.03it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 561.62it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7543.71it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 948.88it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3519.01it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 605.71it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8006.58it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 956.92it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3513.27it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 695.43it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8730.34it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 967.48it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3697.68it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 588.80it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7624.03it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1096.71it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3869.56it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 607.73it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7898.88it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1003.15it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3713.21it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 579.35it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8079.29it/s]
2025-09-24 10:23:19 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 10:23:19 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:23:19 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:23:19 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:23:19 [info     ] Evaluate question difficulty - end mae=1.53 rmse=2.01 split=test
2025-09-24 10:23:19 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 3 finished: 0:0:53

 ========== Config: llama3.2:1b~T_1.0~SO_teacher_bool_nocontext~L_5~SP_teacher_dbe_miscons_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_cfe_studentlevel_random0 ==========
Config 13/16

 ********** Run: 1/3 **********
2025-09-24 10:23:36 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:23:36 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:23:36 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:23:36 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:23:38 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:23:38 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:23:43 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:23:43 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:23:43 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:23:43 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:23:46 [info     ] Setting seed                   value=43
2025-09-24 10:23:46 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 10:23:46 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_dbe_miscons_level_nocontext
2025-09-24 10:23:46 [info     ] Building model                 name=llama3.2:1b provider=ollama rate_limit=None temp=1.0
2025-09-24 10:23:46 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:02<09:26,  2.92s/it]  1%|          | 2/195 [00:03<04:13,  1.31s/it]  2%|▏         | 3/195 [00:03<02:53,  1.11it/s]  3%|▎         | 5/195 [00:04<01:59,  1.59it/s]  3%|▎         | 6/195 [00:04<01:31,  2.06it/s]  4%|▎         | 7/195 [00:04<01:25,  2.21it/s]  5%|▍         | 9/195 [00:05<01:10,  2.65it/s]  5%|▌         | 10/195 [00:05<01:09,  2.66it/s]  6%|▌         | 12/195 [00:06<00:55,  3.29it/s]  7%|▋         | 14/195 [00:06<00:46,  3.88it/s]  8%|▊         | 16/195 [00:06<00:42,  4.23it/s]  9%|▊         | 17/195 [00:07<00:38,  4.65it/s]  9%|▉         | 18/195 [00:07<00:47,  3.72it/s] 10%|▉         | 19/195 [00:07<00:54,  3.22it/s] 10%|█         | 20/195 [00:08<01:05,  2.67it/s] 11%|█         | 21/195 [00:08<00:56,  3.07it/s] 11%|█▏        | 22/195 [00:09<01:10,  2.46it/s] 12%|█▏        | 23/195 [00:10<01:43,  1.67it/s] 12%|█▏        | 24/195 [00:10<01:19,  2.14it/s] 13%|█▎        | 25/195 [00:10<01:05,  2.59it/s] 13%|█▎        | 26/195 [00:11<00:59,  2.82it/s] 14%|█▍        | 27/195 [00:11<00:47,  3.51it/s] 14%|█▍        | 28/195 [00:11<00:46,  3.61it/s] 15%|█▌        | 30/195 [00:11<00:45,  3.67it/s] 16%|█▌        | 31/195 [00:12<00:40,  4.05it/s] 16%|█▋        | 32/195 [00:12<00:41,  3.95it/s] 17%|█▋        | 33/195 [00:12<00:36,  4.38it/s] 17%|█▋        | 34/195 [00:13<00:46,  3.46it/s] 18%|█▊        | 35/195 [00:13<00:38,  4.17it/s] 18%|█▊        | 36/195 [00:13<00:43,  3.69it/s] 19%|█▉        | 37/195 [00:13<00:37,  4.24it/s] 19%|█▉        | 38/195 [00:13<00:37,  4.14it/s] 20%|██        | 39/195 [00:14<00:48,  3.22it/s] 21%|██        | 41/195 [00:14<00:38,  4.02it/s] 22%|██▏       | 42/195 [00:14<00:32,  4.64it/s] 22%|██▏       | 43/195 [00:15<00:42,  3.61it/s] 23%|██▎       | 44/195 [00:15<00:46,  3.23it/s] 23%|██▎       | 45/195 [00:16<00:48,  3.08it/s] 24%|██▍       | 47/195 [00:16<00:38,  3.83it/s] 25%|██▍       | 48/195 [00:16<00:34,  4.26it/s] 25%|██▌       | 49/195 [00:17<01:00,  2.41it/s] 26%|██▌       | 50/195 [00:17<00:55,  2.62it/s] 26%|██▌       | 51/195 [00:18<00:50,  2.86it/s] 27%|██▋       | 52/195 [00:18<00:56,  2.54it/s] 28%|██▊       | 54/195 [00:18<00:44,  3.18it/s] 29%|██▊       | 56/195 [00:19<00:50,  2.77it/s] 30%|██▉       | 58/195 [00:20<00:46,  2.92it/s] 30%|███       | 59/195 [00:20<00:42,  3.23it/s] 31%|███▏      | 61/195 [00:21<00:40,  3.34it/s] 32%|███▏      | 62/195 [00:21<00:37,  3.54it/s] 32%|███▏      | 63/195 [00:21<00:33,  3.97it/s] 33%|███▎      | 64/195 [00:21<00:30,  4.35it/s] 33%|███▎      | 65/195 [00:21<00:29,  4.43it/s] 34%|███▍      | 66/195 [00:22<00:26,  4.92it/s] 34%|███▍      | 67/195 [00:22<00:28,  4.46it/s] 35%|███▍      | 68/195 [00:22<00:24,  5.19it/s] 35%|███▌      | 69/195 [00:22<00:28,  4.38it/s] 36%|███▋      | 71/195 [00:23<00:24,  5.00it/s] 37%|███▋      | 73/195 [00:23<00:23,  5.14it/s] 38%|███▊      | 75/195 [00:23<00:22,  5.38it/s] 39%|███▉      | 77/195 [00:24<00:21,  5.46it/s] 41%|████      | 79/195 [00:24<00:23,  4.84it/s] 41%|████      | 80/195 [00:25<00:29,  3.92it/s] 42%|████▏     | 82/195 [00:25<00:28,  4.03it/s] 43%|████▎     | 83/195 [00:25<00:29,  3.76it/s] 44%|████▎     | 85/195 [00:26<00:28,  3.90it/s] 44%|████▍     | 86/195 [00:26<00:33,  3.26it/s] 45%|████▍     | 87/195 [00:27<00:29,  3.68it/s] 45%|████▌     | 88/195 [00:27<00:27,  3.86it/s] 46%|████▌     | 89/195 [00:27<00:31,  3.33it/s] 47%|████▋     | 91/195 [00:28<00:27,  3.72it/s] 47%|████▋     | 92/195 [00:28<00:34,  3.02it/s] 48%|████▊     | 94/195 [00:29<00:28,  3.51it/s] 49%|████▉     | 96/195 [00:29<00:26,  3.73it/s] 50%|████▉     | 97/195 [00:29<00:27,  3.61it/s] 50%|█████     | 98/195 [00:30<00:26,  3.67it/s] 51%|█████     | 99/195 [00:30<00:23,  4.17it/s] 51%|█████▏    | 100/195 [00:30<00:26,  3.54it/s] 52%|█████▏    | 102/195 [00:31<00:23,  3.88it/s] 53%|█████▎    | 103/195 [00:31<00:25,  3.56it/s] 53%|█████▎    | 104/195 [00:31<00:28,  3.21it/s] 54%|█████▍    | 105/195 [00:32<00:28,  3.21it/s] 54%|█████▍    | 106/195 [00:32<00:24,  3.68it/s] 55%|█████▍    | 107/195 [00:32<00:22,  3.97it/s] 55%|█████▌    | 108/195 [00:33<00:24,  3.50it/s] 56%|█████▌    | 109/195 [00:33<00:25,  3.42it/s] 57%|█████▋    | 111/195 [00:33<00:20,  4.13it/s] 57%|█████▋    | 112/195 [00:34<00:21,  3.89it/s] 58%|█████▊    | 113/195 [00:34<00:18,  4.36it/s] 58%|█████▊    | 114/195 [00:34<00:19,  4.19it/s] 59%|█████▉    | 115/195 [00:34<00:18,  4.35it/s] 59%|█████▉    | 116/195 [00:35<00:21,  3.69it/s] 61%|██████    | 118/195 [00:35<00:17,  4.29it/s] 61%|██████    | 119/195 [00:35<00:16,  4.60it/s] 62%|██████▏   | 120/195 [00:35<00:19,  3.85it/s] 63%|██████▎   | 122/195 [00:36<00:21,  3.39it/s] 63%|██████▎   | 123/195 [00:36<00:20,  3.54it/s] 64%|██████▎   | 124/195 [00:36<00:17,  4.16it/s] 64%|██████▍   | 125/195 [00:37<00:17,  3.90it/s] 65%|██████▍   | 126/195 [00:37<00:16,  4.25it/s] 65%|██████▌   | 127/195 [00:37<00:16,  4.11it/s] 66%|██████▌   | 128/195 [00:38<00:18,  3.71it/s] 67%|██████▋   | 130/195 [00:38<00:16,  4.01it/s] 68%|██████▊   | 132/195 [00:38<00:14,  4.50it/s] 68%|██████▊   | 133/195 [00:39<00:17,  3.52it/s] 69%|██████▊   | 134/195 [00:39<00:16,  3.65it/s] 69%|██████▉   | 135/195 [00:39<00:17,  3.34it/s] 70%|██████▉   | 136/195 [00:40<00:14,  3.95it/s] 70%|███████   | 137/195 [00:40<00:18,  3.18it/s] 71%|███████▏  | 139/195 [00:41<00:17,  3.21it/s] 72%|███████▏  | 140/195 [00:41<00:20,  2.68it/s] 72%|███████▏  | 141/195 [00:42<00:20,  2.58it/s] 73%|███████▎  | 142/195 [00:42<00:18,  2.89it/s] 73%|███████▎  | 143/195 [00:42<00:16,  3.22it/s] 74%|███████▍  | 144/195 [00:43<00:18,  2.71it/s] 74%|███████▍  | 145/195 [00:43<00:19,  2.63it/s] 75%|███████▍  | 146/195 [00:43<00:18,  2.69it/s] 75%|███████▌  | 147/195 [00:44<00:15,  3.13it/s] 76%|███████▌  | 148/195 [00:44<00:12,  3.91it/s] 76%|███████▋  | 149/195 [00:44<00:11,  3.94it/s] 77%|███████▋  | 151/195 [00:44<00:09,  4.67it/s] 78%|███████▊  | 152/195 [00:44<00:08,  5.02it/s] 78%|███████▊  | 153/195 [00:45<00:08,  4.80it/s] 79%|███████▉  | 154/195 [00:45<00:07,  5.17it/s] 79%|███████▉  | 155/195 [00:45<00:07,  5.43it/s] 80%|████████  | 156/195 [00:45<00:07,  5.17it/s] 81%|████████  | 157/195 [00:46<00:08,  4.56it/s] 81%|████████  | 158/195 [00:46<00:10,  3.68it/s] 82%|████████▏ | 159/195 [00:46<00:09,  3.99it/s] 82%|████████▏ | 160/195 [00:46<00:07,  4.74it/s] 83%|████████▎ | 161/195 [00:47<00:09,  3.54it/s] 83%|████████▎ | 162/195 [00:47<00:11,  2.84it/s] 84%|████████▍ | 164/195 [00:48<00:09,  3.25it/s] 85%|████████▍ | 165/195 [00:48<00:08,  3.73it/s] 85%|████████▌ | 166/195 [00:48<00:07,  3.66it/s] 86%|████████▌ | 167/195 [00:49<00:09,  3.01it/s] 86%|████████▌ | 168/195 [00:49<00:10,  2.54it/s] 87%|████████▋ | 169/195 [00:50<00:10,  2.40it/s] 87%|████████▋ | 170/195 [00:50<00:09,  2.71it/s] 88%|████████▊ | 172/195 [00:50<00:06,  3.48it/s] 89%|████████▉ | 174/195 [00:51<00:04,  4.20it/s] 90%|████████▉ | 175/195 [00:51<00:04,  4.08it/s] 90%|█████████ | 176/195 [00:51<00:04,  4.44it/s] 91%|█████████ | 177/195 [00:51<00:04,  3.84it/s] 92%|█████████▏| 179/195 [00:52<00:04,  3.65it/s] 93%|█████████▎| 181/195 [00:52<00:03,  4.44it/s] 93%|█████████▎| 182/195 [00:52<00:02,  4.58it/s] 94%|█████████▍| 183/195 [00:53<00:02,  4.02it/s] 94%|█████████▍| 184/195 [00:53<00:02,  4.42it/s] 95%|█████████▍| 185/195 [00:53<00:02,  4.11it/s] 95%|█████████▌| 186/195 [00:54<00:03,  2.99it/s] 96%|█████████▌| 187/195 [00:54<00:02,  3.69it/s] 96%|█████████▋| 188/195 [00:54<00:02,  3.47it/s] 97%|█████████▋| 189/195 [00:55<00:02,  2.86it/s] 97%|█████████▋| 190/195 [00:56<00:02,  1.82it/s] 98%|█████████▊| 191/195 [00:56<00:01,  2.31it/s] 98%|█████████▊| 192/195 [00:56<00:01,  2.68it/s] 99%|█████████▉| 193/195 [00:56<00:00,  3.10it/s] 99%|█████████▉| 194/195 [00:57<00:00,  3.68it/s]100%|██████████| 195/195 [00:57<00:00,  3.20it/s]100%|██████████| 195/195 [00:59<00:00,  3.27it/s]
2025-09-24 10:24:46 [info     ] Validating outputs
2025-09-24 10:24:46 [info     ] Predict - end                  time=0:0:59
2025-09-24 10:24:46 [info     ] Evaluate - start               split=test
2025-09-24 10:24:46 [info     ] Evaluate - end                 answer_distr=[0.29, 0.22, 0.15, 0.29] correctness_llm=0.63 llm_group_correctness=[0.44, 0.59, 0.67, 0.64, 0.82] monotonicity=0.78
2025-09-24 10:24:46 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:24:46 [info     ] Augmenting questions for IRT estimation num_questions=7
2025-09-24 10:24:46 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:24:46 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1127.28it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3501.61it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 539.57it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8208.03it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1050.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3716.58it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 603.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8547.34it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1046.52it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3519.47it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 617.16it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 9865.63it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1113.43it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3771.16it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 643.59it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6794.75it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1220.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3613.46it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 616.65it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 9126.56it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1133.25it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3705.30it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 640.48it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8187.43it/s]
2025-09-24 10:24:50 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 10:24:50 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:24:50 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:24:50 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:24:50 [info     ] Evaluate question difficulty - end mae=1.45 rmse=1.65 split=test
2025-09-24 10:24:50 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 1 finished: 0:1:14

 ********** Run: 2/3 **********
2025-09-24 10:25:08 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:25:08 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:25:08 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:25:08 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:25:09 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:25:09 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:25:14 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:25:14 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:25:14 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:25:15 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:25:18 [info     ] Setting seed                   value=44
2025-09-24 10:25:18 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 10:25:18 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_dbe_miscons_level_nocontext
2025-09-24 10:25:18 [info     ] Building model                 name=llama3.2:1b provider=ollama rate_limit=None temp=1.0
2025-09-24 10:25:18 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<03:40,  1.14s/it]  1%|          | 2/195 [00:01<02:01,  1.58it/s]  2%|▏         | 3/195 [00:01<01:25,  2.25it/s]  2%|▏         | 4/195 [00:01<01:14,  2.55it/s]  3%|▎         | 5/195 [00:02<01:41,  1.87it/s]  3%|▎         | 6/195 [00:02<01:20,  2.34it/s]  4%|▍         | 8/195 [00:03<01:00,  3.07it/s]  5%|▍         | 9/195 [00:03<01:03,  2.92it/s]  6%|▌         | 11/195 [00:04<00:54,  3.38it/s]  7%|▋         | 13/195 [00:04<00:48,  3.77it/s]  8%|▊         | 15/195 [00:05<00:45,  3.96it/s]  9%|▊         | 17/195 [00:05<00:41,  4.31it/s]  9%|▉         | 18/195 [00:05<00:42,  4.19it/s] 10%|▉         | 19/195 [00:05<00:40,  4.36it/s] 10%|█         | 20/195 [00:06<00:44,  3.93it/s] 11%|█         | 21/195 [00:06<00:55,  3.12it/s] 11%|█▏        | 22/195 [00:07<00:51,  3.36it/s] 12%|█▏        | 23/195 [00:07<00:43,  3.91it/s] 12%|█▏        | 24/195 [00:07<00:50,  3.38it/s] 13%|█▎        | 25/195 [00:07<00:52,  3.22it/s] 13%|█▎        | 26/195 [00:08<00:47,  3.56it/s] 14%|█▍        | 27/195 [00:08<00:53,  3.12it/s] 14%|█▍        | 28/195 [00:08<00:48,  3.43it/s] 15%|█▌        | 30/195 [00:09<00:40,  4.03it/s] 16%|█▌        | 31/195 [00:09<00:42,  3.83it/s] 16%|█▋        | 32/195 [00:09<00:46,  3.53it/s] 17%|█▋        | 34/195 [00:10<00:38,  4.15it/s] 18%|█▊        | 36/195 [00:10<00:32,  4.82it/s] 19%|█▉        | 37/195 [00:10<00:30,  5.10it/s] 19%|█▉        | 38/195 [00:11<00:37,  4.19it/s] 20%|██        | 39/195 [00:11<00:40,  3.90it/s] 21%|██        | 41/195 [00:11<00:33,  4.55it/s] 22%|██▏       | 42/195 [00:11<00:32,  4.78it/s] 22%|██▏       | 43/195 [00:12<00:30,  4.96it/s] 23%|██▎       | 44/195 [00:12<00:40,  3.77it/s] 24%|██▎       | 46/195 [00:12<00:38,  3.89it/s] 24%|██▍       | 47/195 [00:13<00:32,  4.52it/s] 25%|██▍       | 48/195 [00:13<00:37,  3.94it/s] 25%|██▌       | 49/195 [00:13<00:42,  3.46it/s] 26%|██▌       | 51/195 [00:14<00:42,  3.35it/s] 27%|██▋       | 53/195 [00:15<00:45,  3.15it/s] 28%|██▊       | 54/195 [00:15<00:52,  2.69it/s] 28%|██▊       | 55/195 [00:15<00:44,  3.17it/s] 29%|██▊       | 56/195 [00:16<00:43,  3.18it/s] 29%|██▉       | 57/195 [00:16<00:40,  3.42it/s] 30%|██▉       | 58/195 [00:16<00:38,  3.59it/s] 30%|███       | 59/195 [00:16<00:39,  3.49it/s] 31%|███       | 60/195 [00:17<00:31,  4.23it/s] 31%|███▏      | 61/195 [00:17<00:40,  3.35it/s] 32%|███▏      | 62/195 [00:17<00:43,  3.09it/s] 32%|███▏      | 63/195 [00:18<00:44,  2.94it/s] 33%|███▎      | 64/195 [00:18<00:41,  3.15it/s] 33%|███▎      | 65/195 [00:18<00:39,  3.32it/s] 34%|███▍      | 67/195 [00:19<00:36,  3.55it/s] 35%|███▌      | 69/195 [00:19<00:32,  3.86it/s] 36%|███▌      | 70/195 [00:19<00:29,  4.28it/s] 36%|███▋      | 71/195 [00:20<00:30,  4.01it/s] 37%|███▋      | 73/195 [00:20<00:27,  4.37it/s] 38%|███▊      | 75/195 [00:20<00:24,  4.95it/s] 39%|███▉      | 76/195 [00:21<00:27,  4.28it/s] 39%|███▉      | 77/195 [00:22<00:43,  2.69it/s] 40%|████      | 78/195 [00:22<00:39,  2.94it/s] 41%|████      | 79/195 [00:22<00:35,  3.23it/s] 41%|████      | 80/195 [00:22<00:32,  3.59it/s] 42%|████▏     | 81/195 [00:23<00:34,  3.28it/s] 42%|████▏     | 82/195 [00:23<00:39,  2.84it/s] 43%|████▎     | 83/195 [00:23<00:38,  2.87it/s] 44%|████▎     | 85/195 [00:24<00:40,  2.71it/s] 44%|████▍     | 86/195 [00:24<00:35,  3.04it/s] 45%|████▍     | 87/195 [00:25<00:31,  3.43it/s] 45%|████▌     | 88/195 [00:25<00:33,  3.17it/s] 46%|████▌     | 89/195 [00:25<00:36,  2.88it/s] 47%|████▋     | 91/195 [00:26<00:31,  3.33it/s] 48%|████▊     | 93/195 [00:26<00:24,  4.08it/s] 48%|████▊     | 94/195 [00:26<00:22,  4.58it/s] 49%|████▊     | 95/195 [00:27<00:23,  4.27it/s] 49%|████▉     | 96/195 [00:27<00:21,  4.60it/s] 50%|████▉     | 97/195 [00:27<00:21,  4.52it/s] 50%|█████     | 98/195 [00:27<00:22,  4.39it/s] 51%|█████▏    | 100/195 [00:28<00:24,  3.91it/s] 52%|█████▏    | 102/195 [00:28<00:21,  4.27it/s] 53%|█████▎    | 103/195 [00:29<00:25,  3.57it/s] 53%|█████▎    | 104/195 [00:29<00:23,  3.86it/s] 54%|█████▍    | 105/195 [00:29<00:20,  4.34it/s] 54%|█████▍    | 106/195 [00:29<00:24,  3.67it/s] 55%|█████▌    | 108/195 [00:30<00:20,  4.30it/s] 56%|█████▌    | 109/195 [00:30<00:17,  4.88it/s] 56%|█████▋    | 110/195 [00:30<00:19,  4.26it/s] 57%|█████▋    | 111/195 [00:31<00:24,  3.46it/s] 57%|█████▋    | 112/195 [00:31<00:20,  4.06it/s] 58%|█████▊    | 113/195 [00:31<00:21,  3.74it/s] 58%|█████▊    | 114/195 [00:31<00:19,  4.14it/s] 59%|█████▉    | 115/195 [00:31<00:17,  4.50it/s] 59%|█████▉    | 116/195 [00:32<00:21,  3.64it/s] 61%|██████    | 118/195 [00:32<00:18,  4.16it/s] 62%|██████▏   | 120/195 [00:33<00:18,  4.11it/s] 62%|██████▏   | 121/195 [00:33<00:23,  3.20it/s] 63%|██████▎   | 122/195 [00:34<00:20,  3.48it/s] 63%|██████▎   | 123/195 [00:34<00:23,  3.03it/s] 64%|██████▎   | 124/195 [00:34<00:23,  3.01it/s] 65%|██████▍   | 126/195 [00:35<00:19,  3.49it/s] 66%|██████▌   | 128/195 [00:35<00:18,  3.57it/s] 66%|██████▌   | 129/195 [00:36<00:19,  3.35it/s] 67%|██████▋   | 130/195 [00:36<00:21,  2.96it/s] 68%|██████▊   | 132/195 [00:37<00:25,  2.52it/s] 68%|██████▊   | 133/195 [00:37<00:23,  2.66it/s] 69%|██████▉   | 135/195 [00:38<00:17,  3.36it/s] 70%|██████▉   | 136/195 [00:38<00:20,  2.93it/s] 71%|███████   | 138/195 [00:39<00:18,  3.11it/s] 71%|███████▏  | 139/195 [00:39<00:17,  3.14it/s] 72%|███████▏  | 141/195 [00:40<00:15,  3.52it/s] 73%|███████▎  | 142/195 [00:40<00:16,  3.28it/s] 73%|███████▎  | 143/195 [00:40<00:17,  2.96it/s] 74%|███████▍  | 145/195 [00:41<00:14,  3.41it/s] 75%|███████▍  | 146/195 [00:41<00:13,  3.75it/s] 75%|███████▌  | 147/195 [00:41<00:14,  3.37it/s] 76%|███████▋  | 149/195 [00:42<00:11,  3.98it/s] 77%|███████▋  | 150/195 [00:42<00:14,  3.17it/s] 77%|███████▋  | 151/195 [00:43<00:14,  2.99it/s] 78%|███████▊  | 152/195 [00:43<00:15,  2.84it/s] 79%|███████▉  | 154/195 [00:44<00:12,  3.31it/s] 80%|████████  | 156/195 [00:44<00:12,  3.06it/s] 81%|████████  | 157/195 [00:45<00:11,  3.45it/s] 81%|████████  | 158/195 [00:45<00:11,  3.09it/s] 82%|████████▏ | 159/195 [00:45<00:10,  3.51it/s] 82%|████████▏ | 160/195 [00:46<00:11,  3.03it/s] 83%|████████▎ | 161/195 [00:46<00:11,  2.91it/s] 84%|████████▎ | 163/195 [00:46<00:09,  3.54it/s] 85%|████████▍ | 165/195 [00:47<00:07,  4.27it/s] 86%|████████▌ | 167/195 [00:47<00:06,  4.40it/s] 86%|████████▌ | 168/195 [00:47<00:05,  4.88it/s] 87%|████████▋ | 169/195 [00:48<00:06,  4.31it/s] 87%|████████▋ | 170/195 [00:48<00:07,  3.17it/s] 88%|████████▊ | 171/195 [00:49<00:10,  2.39it/s] 88%|████████▊ | 172/195 [00:49<00:10,  2.25it/s] 89%|████████▊ | 173/195 [00:50<00:08,  2.66it/s] 89%|████████▉ | 174/195 [00:50<00:06,  3.17it/s] 90%|████████▉ | 175/195 [00:50<00:05,  3.48it/s] 90%|█████████ | 176/195 [00:50<00:05,  3.44it/s] 91%|█████████ | 177/195 [00:51<00:05,  3.19it/s] 91%|█████████▏| 178/195 [00:51<00:06,  2.53it/s] 92%|█████████▏| 180/195 [00:52<00:05,  2.89it/s] 93%|█████████▎| 182/195 [00:52<00:03,  3.49it/s] 94%|█████████▍| 183/195 [00:52<00:03,  3.44it/s] 94%|█████████▍| 184/195 [00:53<00:02,  3.77it/s] 95%|█████████▍| 185/195 [00:53<00:03,  2.64it/s] 95%|█████████▌| 186/195 [00:54<00:03,  2.36it/s] 96%|█████████▌| 187/195 [00:55<00:04,  1.99it/s] 96%|█████████▋| 188/195 [00:55<00:02,  2.54it/s] 97%|█████████▋| 189/195 [00:55<00:02,  2.45it/s] 97%|█████████▋| 190/195 [00:56<00:01,  2.50it/s] 98%|█████████▊| 192/195 [00:56<00:00,  3.34it/s] 99%|█████████▉| 194/195 [00:56<00:00,  3.76it/s]100%|██████████| 195/195 [00:58<00:00,  3.31it/s]
2025-09-24 10:26:17 [info     ] Validating outputs
2025-09-24 10:26:17 [info     ] Predict - end                  time=0:0:59
2025-09-24 10:26:17 [info     ] Evaluate - start               split=test
2025-09-24 10:26:17 [info     ] Evaluate - end                 answer_distr=[0.33, 0.19, 0.13, 0.26] correctness_llm=0.62 llm_group_correctness=[0.56, 0.64, 0.64, 0.56, 0.69] monotonicity=0.24
2025-09-24 10:26:17 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:26:17 [info     ] Augmenting questions for IRT estimation num_questions=6
2025-09-24 10:26:17 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:26:17 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1380.61it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3654.31it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 518.34it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7943.76it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1161.81it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3702.11it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 603.33it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 9056.18it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 957.01it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3669.64it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 717.70it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8635.33it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1089.75it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3661.84it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 636.17it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7913.78it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1112.84it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3614.42it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 556.70it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7871.35it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1091.21it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3899.91it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 666.15it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7787.83it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1063.46it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3735.93it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 590.02it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8835.43it/s]
2025-09-24 10:26:23 INFO: EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
2025-09-24 10:26:23 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:26:23 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:26:23 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:26:23 [info     ] Evaluate question difficulty - end mae=1.45 rmse=1.77 split=test
2025-09-24 10:26:23 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 2 finished: 0:1:14

 ********** Run: 3/3 **********
2025-09-24 10:26:40 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:26:40 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:26:40 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:26:40 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:26:42 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:26:42 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:26:46 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:26:46 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:26:46 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:26:47 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:26:50 [info     ] Setting seed                   value=45
2025-09-24 10:26:50 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 10:26:50 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_dbe_miscons_level_nocontext
2025-09-24 10:26:50 [info     ] Building model                 name=llama3.2:1b provider=ollama rate_limit=None temp=1.0
2025-09-24 10:26:50 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<03:14,  1.00s/it]  1%|          | 2/195 [00:01<01:42,  1.88it/s]  2%|▏         | 3/195 [00:01<01:23,  2.30it/s]  3%|▎         | 5/195 [00:01<00:54,  3.52it/s]  3%|▎         | 6/195 [00:02<00:49,  3.85it/s]  4%|▎         | 7/195 [00:02<01:02,  3.02it/s]  5%|▍         | 9/195 [00:03<00:58,  3.19it/s]  5%|▌         | 10/195 [00:03<01:03,  2.89it/s]  6%|▌         | 12/195 [00:04<00:55,  3.31it/s]  7%|▋         | 13/195 [00:04<00:58,  3.11it/s]  7%|▋         | 14/195 [00:04<00:58,  3.09it/s]  8%|▊         | 15/195 [00:05<00:54,  3.30it/s]  8%|▊         | 16/195 [00:05<01:02,  2.86it/s]  9%|▊         | 17/195 [00:05<01:02,  2.84it/s]  9%|▉         | 18/195 [00:06<00:57,  3.06it/s] 10%|▉         | 19/195 [00:06<00:54,  3.23it/s] 10%|█         | 20/195 [00:06<00:43,  4.00it/s] 11%|█         | 21/195 [00:06<00:46,  3.77it/s] 12%|█▏        | 23/195 [00:07<00:38,  4.44it/s] 12%|█▏        | 24/195 [00:07<00:33,  5.06it/s] 13%|█▎        | 25/195 [00:07<00:39,  4.29it/s] 14%|█▍        | 27/195 [00:08<00:37,  4.48it/s] 14%|█▍        | 28/195 [00:08<00:33,  5.05it/s] 15%|█▍        | 29/195 [00:08<00:33,  4.96it/s] 15%|█▌        | 30/195 [00:08<00:33,  4.92it/s] 16%|█▌        | 31/195 [00:09<00:45,  3.58it/s] 16%|█▋        | 32/195 [00:09<00:49,  3.30it/s] 17%|█▋        | 34/195 [00:09<00:39,  4.08it/s] 18%|█▊        | 35/195 [00:09<00:34,  4.69it/s] 18%|█▊        | 36/195 [00:10<00:40,  3.88it/s] 19%|█▉        | 37/195 [00:10<00:39,  4.02it/s] 19%|█▉        | 38/195 [00:10<00:42,  3.73it/s] 20%|██        | 39/195 [00:10<00:34,  4.51it/s] 21%|██        | 40/195 [00:11<00:35,  4.31it/s] 21%|██        | 41/195 [00:11<00:32,  4.71it/s] 22%|██▏       | 42/195 [00:11<00:31,  4.87it/s] 22%|██▏       | 43/195 [00:11<00:40,  3.78it/s] 23%|██▎       | 44/195 [00:12<00:46,  3.23it/s] 23%|██▎       | 45/195 [00:12<00:50,  2.99it/s] 24%|██▎       | 46/195 [00:13<00:54,  2.71it/s] 24%|██▍       | 47/195 [00:13<00:45,  3.25it/s] 25%|██▍       | 48/195 [00:13<00:37,  3.89it/s] 25%|██▌       | 49/195 [00:13<00:40,  3.61it/s] 26%|██▌       | 50/195 [00:14<00:41,  3.50it/s] 26%|██▌       | 51/195 [00:14<00:34,  4.23it/s] 27%|██▋       | 52/195 [00:14<00:32,  4.34it/s] 27%|██▋       | 53/195 [00:14<00:34,  4.11it/s] 28%|██▊       | 54/195 [00:14<00:33,  4.22it/s] 28%|██▊       | 55/195 [00:15<00:35,  3.93it/s] 29%|██▊       | 56/195 [00:15<00:34,  4.08it/s] 29%|██▉       | 57/195 [00:15<00:35,  3.84it/s] 30%|███       | 59/195 [00:16<00:32,  4.17it/s] 31%|███       | 60/195 [00:16<00:36,  3.66it/s] 31%|███▏      | 61/195 [00:16<00:33,  4.05it/s] 32%|███▏      | 62/195 [00:17<00:36,  3.66it/s] 32%|███▏      | 63/195 [00:17<00:31,  4.24it/s] 33%|███▎      | 64/195 [00:17<00:36,  3.58it/s] 34%|███▍      | 66/195 [00:18<00:37,  3.42it/s] 34%|███▍      | 67/195 [00:18<00:39,  3.26it/s] 35%|███▌      | 69/195 [00:18<00:31,  4.00it/s] 36%|███▌      | 70/195 [00:19<00:29,  4.27it/s] 36%|███▋      | 71/195 [00:19<00:28,  4.38it/s] 37%|███▋      | 72/195 [00:19<00:27,  4.43it/s] 37%|███▋      | 73/195 [00:19<00:25,  4.79it/s] 38%|███▊      | 74/195 [00:20<00:30,  3.99it/s] 38%|███▊      | 75/195 [00:20<00:27,  4.32it/s] 39%|███▉      | 76/195 [00:20<00:29,  4.05it/s] 39%|███▉      | 77/195 [00:20<00:27,  4.31it/s] 40%|████      | 78/195 [00:21<00:34,  3.40it/s] 41%|████      | 79/195 [00:21<00:47,  2.43it/s] 41%|████      | 80/195 [00:22<00:38,  2.97it/s] 42%|████▏     | 81/195 [00:22<00:33,  3.39it/s] 42%|████▏     | 82/195 [00:22<00:32,  3.49it/s] 43%|████▎     | 83/195 [00:22<00:25,  4.32it/s] 43%|████▎     | 84/195 [00:22<00:30,  3.67it/s] 44%|████▍     | 86/195 [00:23<00:24,  4.49it/s] 45%|████▍     | 87/195 [00:23<00:24,  4.48it/s] 46%|████▌     | 89/195 [00:23<00:20,  5.11it/s] 47%|████▋     | 91/195 [00:24<00:22,  4.62it/s] 48%|████▊     | 93/195 [00:26<00:52,  1.95it/s] 49%|████▊     | 95/195 [00:26<00:42,  2.36it/s] 50%|████▉     | 97/195 [00:27<00:34,  2.80it/s] 50%|█████     | 98/195 [00:27<00:32,  2.99it/s] 51%|█████     | 99/195 [00:27<00:28,  3.36it/s] 51%|█████▏    | 100/195 [00:28<00:28,  3.38it/s] 52%|█████▏    | 101/195 [00:28<00:25,  3.68it/s] 52%|█████▏    | 102/195 [00:28<00:26,  3.54it/s] 53%|█████▎    | 104/195 [00:28<00:22,  4.08it/s] 54%|█████▍    | 105/195 [00:29<00:26,  3.35it/s] 55%|█████▍    | 107/195 [00:29<00:23,  3.75it/s] 55%|█████▌    | 108/195 [00:30<00:22,  3.83it/s] 56%|█████▌    | 109/195 [00:30<00:22,  3.84it/s] 56%|█████▋    | 110/195 [00:30<00:19,  4.44it/s] 57%|█████▋    | 111/195 [00:30<00:22,  3.80it/s] 58%|█████▊    | 113/195 [00:31<00:18,  4.35it/s] 58%|█████▊    | 114/195 [00:31<00:21,  3.85it/s] 59%|█████▉    | 115/195 [00:31<00:20,  3.99it/s] 59%|█████▉    | 116/195 [00:31<00:18,  4.38it/s] 60%|██████    | 117/195 [00:32<00:18,  4.25it/s] 61%|██████    | 118/195 [00:32<00:20,  3.70it/s] 61%|██████    | 119/195 [00:32<00:21,  3.50it/s] 62%|██████▏   | 120/195 [00:33<00:18,  3.95it/s] 62%|██████▏   | 121/195 [00:33<00:21,  3.49it/s] 63%|██████▎   | 123/195 [00:33<00:18,  3.86it/s] 64%|██████▍   | 125/195 [00:34<00:17,  4.06it/s] 65%|██████▌   | 127/195 [00:34<00:16,  4.24it/s] 66%|██████▌   | 128/195 [00:35<00:19,  3.35it/s] 66%|██████▌   | 129/195 [00:35<00:17,  3.68it/s] 67%|██████▋   | 130/195 [00:36<00:22,  2.92it/s] 67%|██████▋   | 131/195 [00:36<00:21,  3.02it/s] 68%|██████▊   | 132/195 [00:36<00:25,  2.52it/s] 68%|██████▊   | 133/195 [00:37<00:20,  3.06it/s] 69%|██████▉   | 135/195 [00:37<00:22,  2.71it/s] 70%|██████▉   | 136/195 [00:38<00:18,  3.14it/s] 70%|███████   | 137/195 [00:38<00:16,  3.53it/s] 71%|███████   | 138/195 [00:38<00:17,  3.25it/s] 72%|███████▏  | 140/195 [00:38<00:13,  4.04it/s] 72%|███████▏  | 141/195 [00:39<00:12,  4.34it/s] 73%|███████▎  | 142/195 [00:39<00:11,  4.55it/s] 73%|███████▎  | 143/195 [00:39<00:11,  4.40it/s] 74%|███████▍  | 144/195 [00:40<00:15,  3.31it/s] 74%|███████▍  | 145/195 [00:40<00:16,  3.06it/s] 75%|███████▍  | 146/195 [00:40<00:16,  2.97it/s] 75%|███████▌  | 147/195 [00:41<00:13,  3.44it/s] 76%|███████▌  | 148/195 [00:41<00:15,  3.07it/s] 77%|███████▋  | 150/195 [00:41<00:12,  3.55it/s] 77%|███████▋  | 151/195 [00:42<00:12,  3.67it/s] 78%|███████▊  | 152/195 [00:42<00:11,  3.91it/s] 78%|███████▊  | 153/195 [00:42<00:09,  4.28it/s] 79%|███████▉  | 154/195 [00:42<00:09,  4.52it/s] 79%|███████▉  | 155/195 [00:42<00:09,  4.24it/s] 80%|████████  | 156/195 [00:43<00:08,  4.63it/s] 81%|████████  | 157/195 [00:43<00:08,  4.60it/s] 81%|████████  | 158/195 [00:43<00:06,  5.32it/s] 82%|████████▏ | 159/195 [00:43<00:08,  4.10it/s] 83%|████████▎ | 161/195 [00:44<00:07,  4.76it/s] 83%|████████▎ | 162/195 [00:44<00:06,  5.36it/s] 84%|████████▎ | 163/195 [00:44<00:06,  4.96it/s] 84%|████████▍ | 164/195 [00:44<00:05,  5.54it/s] 85%|████████▍ | 165/195 [00:44<00:06,  4.84it/s] 85%|████████▌ | 166/195 [00:45<00:07,  3.76it/s] 86%|████████▌ | 167/195 [00:45<00:06,  4.11it/s] 86%|████████▌ | 168/195 [00:45<00:06,  4.12it/s] 87%|████████▋ | 169/195 [00:46<00:06,  3.78it/s] 87%|████████▋ | 170/195 [00:46<00:07,  3.20it/s] 88%|████████▊ | 171/195 [00:46<00:06,  3.77it/s] 88%|████████▊ | 172/195 [00:47<00:06,  3.50it/s] 89%|████████▊ | 173/195 [00:47<00:05,  3.72it/s] 89%|████████▉ | 174/195 [00:47<00:07,  2.82it/s] 90%|█████████ | 176/195 [00:48<00:07,  2.58it/s] 91%|█████████ | 177/195 [00:48<00:06,  2.81it/s] 91%|█████████▏| 178/195 [00:49<00:05,  3.33it/s] 92%|█████████▏| 179/195 [00:49<00:05,  3.13it/s] 93%|█████████▎| 181/195 [00:49<00:03,  3.72it/s] 93%|█████████▎| 182/195 [00:49<00:03,  4.23it/s] 94%|█████████▍| 183/195 [00:50<00:03,  3.92it/s] 94%|█████████▍| 184/195 [00:50<00:02,  4.22it/s] 95%|█████████▍| 185/195 [00:50<00:03,  3.23it/s] 95%|█████████▌| 186/195 [00:51<00:03,  2.92it/s] 96%|█████████▌| 187/195 [00:51<00:02,  3.21it/s] 96%|█████████▋| 188/195 [00:51<00:01,  3.68it/s] 97%|█████████▋| 189/195 [00:52<00:01,  3.99it/s] 97%|█████████▋| 190/195 [00:52<00:01,  3.54it/s] 98%|█████████▊| 191/195 [00:52<00:00,  4.27it/s] 98%|█████████▊| 192/195 [00:52<00:00,  3.66it/s] 99%|█████████▉| 193/195 [00:53<00:00,  3.67it/s]100%|██████████| 195/195 [00:53<00:00,  5.10it/s]100%|██████████| 195/195 [00:55<00:00,  3.52it/s]
2025-09-24 10:27:45 [info     ] Validating outputs
2025-09-24 10:27:45 [info     ] Predict - end                  time=0:0:55
2025-09-24 10:27:45 [info     ] Evaluate - start               split=test
2025-09-24 10:27:45 [info     ] Evaluate - end                 answer_distr=[0.35, 0.16, 0.11, 0.3] correctness_llm=0.63 llm_group_correctness=[0.49, 0.59, 0.69, 0.59, 0.77] monotonicity=0.52
2025-09-24 10:27:45 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:27:46 [info     ] Augmenting questions for IRT estimation num_questions=5
2025-09-24 10:27:46 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:27:46 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1181.35it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3498.24it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 613.21it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5808.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1063.23it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3365.94it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 543.04it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6481.26it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1093.69it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3490.48it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 595.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5832.37it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 981.71it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3626.60it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 699.54it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5957.82it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 921.42it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3447.37it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 730.08it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5994.31it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 960.42it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3819.24it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 661.40it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6645.57it/s]
2025-09-24 10:27:50 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 10:27:50 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:27:50 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:27:50 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:27:50 [info     ] Evaluate question difficulty - end mae=1.41 rmse=1.8 split=test
2025-09-24 10:27:50 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 3 finished: 0:1:10

 ========== Config: llama3.1:8b~T_1.0~SO_teacher_bool_nocontext~L_5~SP_teacher_dbe_miscons_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_cfe_studentlevel_random0 ==========
Config 14/16

 ********** Run: 1/3 **********
2025-09-24 10:28:08 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:28:08 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:28:08 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:28:08 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:28:10 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:28:10 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:28:14 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:28:14 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:28:14 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:28:15 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:28:18 [info     ] Setting seed                   value=43
2025-09-24 10:28:18 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 10:28:18 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_dbe_miscons_level_nocontext
2025-09-24 10:28:18 [info     ] Building model                 name=llama3.1:8b provider=ollama rate_limit=None temp=1.0
2025-09-24 10:28:18 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:04<14:48,  4.58s/it]  1%|          | 2/195 [00:04<06:21,  1.98s/it]  2%|▏         | 3/195 [00:05<04:04,  1.28s/it]  2%|▏         | 4/195 [00:05<02:50,  1.12it/s]  3%|▎         | 5/195 [00:05<02:15,  1.40it/s]  3%|▎         | 6/195 [00:06<01:47,  1.76it/s]  4%|▎         | 7/195 [00:06<01:38,  1.91it/s]  5%|▍         | 9/195 [00:07<01:26,  2.15it/s]  5%|▌         | 10/195 [00:07<01:10,  2.62it/s]  6%|▌         | 11/195 [00:08<01:24,  2.17it/s]  6%|▌         | 12/195 [00:08<01:10,  2.60it/s]  7%|▋         | 13/195 [00:08<01:08,  2.66it/s]  7%|▋         | 14/195 [00:08<00:59,  3.02it/s]  8%|▊         | 15/195 [00:09<01:04,  2.80it/s]  8%|▊         | 16/195 [00:09<01:02,  2.85it/s]  9%|▊         | 17/195 [00:10<01:00,  2.93it/s] 10%|▉         | 19/195 [00:10<00:56,  3.12it/s] 11%|█         | 21/195 [00:11<01:02,  2.79it/s] 11%|█▏        | 22/195 [00:11<00:53,  3.23it/s] 12%|█▏        | 23/195 [00:12<01:03,  2.69it/s] 13%|█▎        | 25/195 [00:12<00:57,  2.94it/s] 13%|█▎        | 26/195 [00:12<00:51,  3.28it/s] 14%|█▍        | 27/195 [00:13<01:02,  2.70it/s] 14%|█▍        | 28/195 [00:13<00:57,  2.90it/s] 15%|█▍        | 29/195 [00:14<01:09,  2.40it/s] 15%|█▌        | 30/195 [00:14<01:08,  2.40it/s] 16%|█▌        | 31/195 [00:15<01:02,  2.62it/s] 16%|█▋        | 32/195 [00:15<01:05,  2.48it/s] 17%|█▋        | 33/195 [00:15<01:01,  2.64it/s] 17%|█▋        | 34/195 [00:16<00:58,  2.76it/s] 18%|█▊        | 35/195 [00:16<00:52,  3.03it/s] 18%|█▊        | 36/195 [00:16<00:57,  2.78it/s] 19%|█▉        | 38/195 [00:17<00:56,  2.75it/s] 20%|██        | 39/195 [00:17<00:56,  2.76it/s] 21%|██        | 40/195 [00:18<00:51,  3.02it/s] 21%|██        | 41/195 [00:18<00:58,  2.63it/s] 22%|██▏       | 42/195 [00:18<00:47,  3.23it/s] 22%|██▏       | 43/195 [00:19<00:54,  2.78it/s] 23%|██▎       | 44/195 [00:19<00:53,  2.81it/s] 23%|██▎       | 45/195 [00:20<00:57,  2.61it/s] 24%|██▎       | 46/195 [00:20<00:59,  2.49it/s] 24%|██▍       | 47/195 [00:20<00:53,  2.79it/s] 25%|██▍       | 48/195 [00:21<00:51,  2.86it/s] 25%|██▌       | 49/195 [00:21<00:52,  2.76it/s] 26%|██▌       | 50/195 [00:21<00:48,  2.97it/s] 26%|██▌       | 51/195 [00:22<00:52,  2.73it/s] 27%|██▋       | 52/195 [00:22<00:49,  2.87it/s] 27%|██▋       | 53/195 [00:22<00:43,  3.25it/s] 28%|██▊       | 54/195 [00:23<00:46,  3.04it/s] 29%|██▊       | 56/195 [00:23<00:49,  2.83it/s] 29%|██▉       | 57/195 [00:24<00:49,  2.76it/s] 30%|██▉       | 58/195 [00:24<00:42,  3.20it/s] 30%|███       | 59/195 [00:25<00:48,  2.78it/s] 31%|███▏      | 61/195 [00:25<00:43,  3.10it/s] 32%|███▏      | 62/195 [00:25<00:42,  3.13it/s] 32%|███▏      | 63/195 [00:26<00:49,  2.67it/s] 33%|███▎      | 65/195 [00:27<00:49,  2.65it/s] 34%|███▍      | 67/195 [00:27<00:45,  2.84it/s] 35%|███▍      | 68/195 [00:27<00:38,  3.29it/s] 35%|███▌      | 69/195 [00:28<00:40,  3.11it/s] 36%|███▌      | 70/195 [00:28<00:36,  3.41it/s] 36%|███▋      | 71/195 [00:28<00:43,  2.87it/s] 37%|███▋      | 72/195 [00:29<00:35,  3.44it/s] 37%|███▋      | 73/195 [00:29<00:47,  2.56it/s] 38%|███▊      | 75/195 [00:30<00:38,  3.08it/s] 39%|███▉      | 76/195 [00:30<00:37,  3.15it/s] 39%|███▉      | 77/195 [00:31<00:46,  2.55it/s] 40%|████      | 78/195 [00:31<00:40,  2.90it/s] 41%|████      | 79/195 [00:31<00:40,  2.86it/s] 41%|████      | 80/195 [00:31<00:34,  3.32it/s] 42%|████▏     | 81/195 [00:32<00:41,  2.73it/s] 42%|████▏     | 82/195 [00:32<00:37,  3.04it/s] 43%|████▎     | 83/195 [00:33<00:47,  2.35it/s] 43%|████▎     | 84/195 [00:33<00:38,  2.85it/s] 44%|████▎     | 85/195 [00:33<00:39,  2.80it/s] 45%|████▍     | 87/195 [00:34<00:37,  2.89it/s] 46%|████▌     | 89/195 [00:35<00:33,  3.15it/s] 46%|████▌     | 90/195 [00:35<00:32,  3.21it/s] 47%|████▋     | 91/195 [00:35<00:34,  3.05it/s] 47%|████▋     | 92/195 [00:35<00:29,  3.48it/s] 48%|████▊     | 93/195 [00:36<00:31,  3.27it/s] 48%|████▊     | 94/195 [00:37<00:45,  2.22it/s] 49%|████▊     | 95/195 [00:37<00:38,  2.61it/s] 49%|████▉     | 96/195 [00:37<00:43,  2.28it/s] 50%|█████     | 98/195 [00:38<00:35,  2.76it/s] 51%|█████     | 99/195 [00:38<00:32,  3.00it/s] 51%|█████▏    | 100/195 [00:39<00:34,  2.78it/s] 52%|█████▏    | 101/195 [00:39<00:39,  2.40it/s] 53%|█████▎    | 103/195 [00:40<00:36,  2.52it/s] 53%|█████▎    | 104/195 [00:40<00:38,  2.35it/s] 54%|█████▍    | 105/195 [00:41<00:33,  2.66it/s] 54%|█████▍    | 106/195 [00:41<00:32,  2.71it/s] 55%|█████▍    | 107/195 [00:42<00:36,  2.40it/s] 56%|█████▌    | 109/195 [00:42<00:31,  2.72it/s] 56%|█████▋    | 110/195 [00:42<00:26,  3.20it/s] 57%|█████▋    | 111/195 [00:43<00:28,  2.97it/s] 57%|█████▋    | 112/195 [00:43<00:23,  3.57it/s] 58%|█████▊    | 113/195 [00:44<00:31,  2.57it/s] 59%|█████▉    | 115/195 [00:44<00:29,  2.73it/s] 59%|█████▉    | 116/195 [00:45<00:32,  2.43it/s] 61%|██████    | 118/195 [00:45<00:29,  2.57it/s] 62%|██████▏   | 120/195 [00:46<00:27,  2.71it/s] 63%|██████▎   | 122/195 [00:47<00:26,  2.81it/s] 63%|██████▎   | 123/195 [00:47<00:23,  3.08it/s] 64%|██████▎   | 124/195 [00:47<00:25,  2.81it/s] 64%|██████▍   | 125/195 [00:48<00:24,  2.83it/s] 65%|██████▍   | 126/195 [00:48<00:27,  2.49it/s] 65%|██████▌   | 127/195 [00:49<00:23,  2.85it/s] 66%|██████▌   | 128/195 [00:49<00:26,  2.57it/s] 66%|██████▌   | 129/195 [00:49<00:22,  2.91it/s] 67%|██████▋   | 130/195 [00:50<00:23,  2.74it/s] 67%|██████▋   | 131/195 [00:50<00:23,  2.78it/s] 68%|██████▊   | 132/195 [00:50<00:20,  3.04it/s] 68%|██████▊   | 133/195 [00:51<00:22,  2.72it/s] 69%|██████▉   | 135/195 [00:51<00:19,  3.12it/s] 70%|██████▉   | 136/195 [00:52<00:19,  2.98it/s] 70%|███████   | 137/195 [00:52<00:16,  3.51it/s] 71%|███████   | 138/195 [00:52<00:20,  2.73it/s] 71%|███████▏  | 139/195 [00:53<00:20,  2.68it/s] 72%|███████▏  | 140/195 [00:53<00:19,  2.75it/s] 72%|███████▏  | 141/195 [00:53<00:17,  3.16it/s] 73%|███████▎  | 142/195 [00:54<00:19,  2.75it/s] 74%|███████▍  | 144/195 [00:54<00:16,  3.18it/s] 75%|███████▍  | 146/195 [00:55<00:15,  3.21it/s] 76%|███████▌  | 148/195 [00:55<00:13,  3.38it/s] 76%|███████▋  | 149/195 [00:56<00:14,  3.27it/s] 77%|███████▋  | 150/195 [00:56<00:14,  3.05it/s] 77%|███████▋  | 151/195 [00:57<00:13,  3.18it/s] 78%|███████▊  | 152/195 [00:57<00:12,  3.47it/s] 78%|███████▊  | 153/195 [00:57<00:12,  3.24it/s] 79%|███████▉  | 154/195 [00:57<00:11,  3.45it/s] 79%|███████▉  | 155/195 [00:58<00:16,  2.42it/s] 80%|████████  | 156/195 [00:58<00:14,  2.61it/s] 81%|████████  | 157/195 [00:59<00:13,  2.88it/s] 81%|████████  | 158/195 [00:59<00:12,  2.96it/s] 82%|████████▏ | 160/195 [01:00<00:11,  2.98it/s] 83%|████████▎ | 162/195 [01:00<00:11,  2.87it/s] 84%|████████▎ | 163/195 [01:01<00:10,  3.07it/s] 84%|████████▍ | 164/195 [01:01<00:11,  2.71it/s] 85%|████████▌ | 166/195 [01:02<00:10,  2.87it/s] 86%|████████▌ | 167/195 [01:02<00:08,  3.18it/s] 86%|████████▌ | 168/195 [01:02<00:09,  2.96it/s] 87%|████████▋ | 169/195 [01:03<00:09,  2.85it/s] 87%|████████▋ | 170/195 [01:03<00:09,  2.68it/s] 88%|████████▊ | 171/195 [01:04<00:09,  2.61it/s] 88%|████████▊ | 172/195 [01:04<00:08,  2.67it/s] 89%|████████▊ | 173/195 [01:04<00:08,  2.54it/s] 89%|████████▉ | 174/195 [01:05<00:07,  2.69it/s] 90%|████████▉ | 175/195 [01:05<00:08,  2.30it/s] 90%|█████████ | 176/195 [01:06<00:08,  2.34it/s] 91%|█████████ | 177/195 [01:06<00:06,  2.88it/s] 91%|█████████▏| 178/195 [01:06<00:05,  2.90it/s] 92%|█████████▏| 179/195 [01:06<00:04,  3.57it/s] 92%|█████████▏| 180/195 [01:07<00:04,  3.11it/s] 93%|█████████▎| 181/195 [01:07<00:05,  2.49it/s] 94%|█████████▍| 183/195 [01:08<00:04,  2.88it/s] 94%|█████████▍| 184/195 [01:08<00:03,  3.43it/s] 95%|█████████▍| 185/195 [01:08<00:03,  3.28it/s] 95%|█████████▌| 186/195 [01:09<00:02,  3.21it/s] 96%|█████████▌| 187/195 [01:09<00:02,  3.42it/s] 96%|█████████▋| 188/195 [01:09<00:01,  3.60it/s] 97%|█████████▋| 189/195 [01:09<00:01,  3.65it/s] 97%|█████████▋| 190/195 [01:10<00:01,  3.63it/s] 98%|█████████▊| 191/195 [01:10<00:01,  3.15it/s] 98%|█████████▊| 192/195 [01:10<00:00,  3.19it/s] 99%|█████████▉| 193/195 [01:11<00:00,  3.22it/s] 99%|█████████▉| 194/195 [01:11<00:00,  3.60it/s]100%|██████████| 195/195 [01:11<00:00,  4.14it/s]100%|██████████| 195/195 [01:13<00:00,  2.65it/s]
2025-09-24 10:29:32 [info     ] Validating outputs
2025-09-24 10:29:32 [info     ] Predict - end                  time=0:1:13
2025-09-24 10:29:32 [info     ] Evaluate - start               split=test
2025-09-24 10:29:32 [info     ] Evaluate - end                 answer_distr=[0.16, 0.29, 0.24, 0.3] correctness_llm=0.38 llm_group_correctness=[0.18, 0.21, 0.51, 0.44, 0.56] monotonicity=0.62
2025-09-24 10:29:32 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:29:32 [info     ] Augmenting questions for IRT estimation num_questions=6
2025-09-24 10:29:32 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:29:32 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1039.19it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3550.79it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 593.60it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6300.46it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1057.68it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3478.16it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 657.39it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6707.82it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1039.26it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3581.58it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 651.70it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6359.14it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1021.72it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 4057.19it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 581.81it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6106.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 960.77it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3498.47it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 621.86it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6447.11it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1008.42it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3781.45it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 553.85it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6973.90it/s]
2025-09-24 10:29:37 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 10:29:37 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:29:37 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:29:37 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:29:37 [info     ] Evaluate question difficulty - end mae=1.34 rmse=1.63 split=test
2025-09-24 10:29:37 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 1 finished: 0:1:28

 ********** Run: 2/3 **********
2025-09-24 10:29:55 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:29:55 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:29:55 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:29:55 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:29:57 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:29:57 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:30:01 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:30:01 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:30:01 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:30:02 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:30:05 [info     ] Setting seed                   value=44
2025-09-24 10:30:05 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 10:30:05 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_dbe_miscons_level_nocontext
2025-09-24 10:30:05 [info     ] Building model                 name=llama3.1:8b provider=ollama rate_limit=None temp=1.0
2025-09-24 10:30:05 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<05:18,  1.64s/it]  2%|▏         | 3/195 [00:02<02:07,  1.50it/s]  3%|▎         | 5/195 [00:03<01:51,  1.70it/s]  3%|▎         | 6/195 [00:03<01:36,  1.96it/s]  4%|▎         | 7/195 [00:04<01:32,  2.04it/s]  4%|▍         | 8/195 [00:04<01:21,  2.29it/s]  5%|▍         | 9/195 [00:04<01:19,  2.34it/s]  5%|▌         | 10/195 [00:05<01:36,  1.91it/s]  6%|▌         | 11/195 [00:05<01:29,  2.07it/s]  6%|▌         | 12/195 [00:06<01:15,  2.43it/s]  7%|▋         | 13/195 [00:06<01:16,  2.39it/s]  7%|▋         | 14/195 [00:06<01:15,  2.41it/s]  8%|▊         | 15/195 [00:07<00:58,  3.09it/s]  8%|▊         | 16/195 [00:08<01:29,  2.01it/s]  9%|▊         | 17/195 [00:08<01:12,  2.46it/s]  9%|▉         | 18/195 [00:08<01:15,  2.34it/s] 10%|█         | 20/195 [00:09<01:05,  2.65it/s] 11%|█▏        | 22/195 [00:10<01:20,  2.16it/s] 12%|█▏        | 23/195 [00:10<01:13,  2.35it/s] 12%|█▏        | 24/195 [00:11<01:18,  2.18it/s] 13%|█▎        | 26/195 [00:12<01:13,  2.30it/s] 14%|█▍        | 28/195 [00:13<01:12,  2.29it/s] 15%|█▍        | 29/195 [00:13<01:02,  2.65it/s] 15%|█▌        | 30/195 [00:13<01:04,  2.58it/s] 16%|█▌        | 31/195 [00:13<00:59,  2.74it/s] 16%|█▋        | 32/195 [00:14<00:54,  3.01it/s] 17%|█▋        | 33/195 [00:14<00:48,  3.34it/s] 17%|█▋        | 34/195 [00:14<00:49,  3.24it/s] 18%|█▊        | 36/195 [00:15<00:46,  3.41it/s] 19%|█▉        | 37/195 [00:15<00:43,  3.65it/s] 19%|█▉        | 38/195 [00:15<00:48,  3.27it/s] 20%|██        | 39/195 [00:16<00:44,  3.54it/s] 21%|██        | 40/195 [00:16<00:49,  3.12it/s] 21%|██        | 41/195 [00:16<00:42,  3.62it/s] 22%|██▏       | 42/195 [00:17<00:50,  3.04it/s] 23%|██▎       | 44/195 [00:17<00:45,  3.29it/s] 23%|██▎       | 45/195 [00:17<00:46,  3.25it/s] 24%|██▎       | 46/195 [00:18<00:42,  3.54it/s] 24%|██▍       | 47/195 [00:18<00:45,  3.27it/s] 25%|██▍       | 48/195 [00:18<00:45,  3.24it/s] 25%|██▌       | 49/195 [00:19<00:43,  3.38it/s] 26%|██▌       | 50/195 [00:19<00:55,  2.59it/s] 27%|██▋       | 52/195 [00:20<00:51,  2.79it/s] 28%|██▊       | 54/195 [00:20<00:46,  3.03it/s] 29%|██▊       | 56/195 [00:21<00:43,  3.23it/s] 29%|██▉       | 57/195 [00:22<00:48,  2.84it/s] 30%|██▉       | 58/195 [00:22<00:41,  3.31it/s] 30%|███       | 59/195 [00:22<00:45,  2.99it/s] 31%|███▏      | 61/195 [00:23<00:44,  3.02it/s] 32%|███▏      | 62/195 [00:23<00:39,  3.39it/s] 32%|███▏      | 63/195 [00:23<00:41,  3.20it/s] 33%|███▎      | 64/195 [00:24<00:37,  3.47it/s] 33%|███▎      | 65/195 [00:24<00:39,  3.26it/s] 34%|███▍      | 66/195 [00:24<00:42,  3.01it/s] 34%|███▍      | 67/195 [00:24<00:37,  3.39it/s] 35%|███▍      | 68/195 [00:25<00:40,  3.14it/s] 36%|███▌      | 70/195 [00:25<00:36,  3.39it/s] 36%|███▋      | 71/195 [00:26<00:35,  3.53it/s] 37%|███▋      | 72/195 [00:26<00:33,  3.66it/s] 37%|███▋      | 73/195 [00:26<00:31,  3.87it/s] 38%|███▊      | 74/195 [00:26<00:31,  3.87it/s] 38%|███▊      | 75/195 [00:27<00:36,  3.31it/s] 39%|███▉      | 77/195 [00:27<00:39,  3.02it/s] 41%|████      | 79/195 [00:28<00:36,  3.17it/s] 41%|████      | 80/195 [00:28<00:35,  3.27it/s] 42%|████▏     | 81/195 [00:29<00:35,  3.22it/s] 42%|████▏     | 82/195 [00:29<00:36,  3.07it/s] 43%|████▎     | 83/195 [00:29<00:37,  3.02it/s] 43%|████▎     | 84/195 [00:30<00:30,  3.58it/s] 44%|████▎     | 85/195 [00:30<00:31,  3.48it/s] 44%|████▍     | 86/195 [00:30<00:37,  2.89it/s] 45%|████▌     | 88/195 [00:31<00:32,  3.30it/s] 46%|████▌     | 89/195 [00:31<00:32,  3.29it/s] 46%|████▌     | 90/195 [00:32<00:34,  3.07it/s] 47%|████▋     | 91/195 [00:32<00:33,  3.06it/s] 47%|████▋     | 92/195 [00:32<00:30,  3.34it/s] 48%|████▊     | 93/195 [00:32<00:27,  3.67it/s] 48%|████▊     | 94/195 [00:33<00:27,  3.66it/s] 49%|████▊     | 95/195 [00:33<00:26,  3.74it/s] 49%|████▉     | 96/195 [00:33<00:28,  3.51it/s] 50%|████▉     | 97/195 [00:33<00:26,  3.65it/s] 50%|█████     | 98/195 [00:34<00:30,  3.20it/s] 51%|█████     | 99/195 [00:34<00:24,  3.92it/s] 51%|█████▏    | 100/195 [00:35<00:35,  2.68it/s] 52%|█████▏    | 102/195 [00:35<00:34,  2.72it/s] 53%|█████▎    | 103/195 [00:36<00:34,  2.65it/s] 53%|█████▎    | 104/195 [00:36<00:32,  2.81it/s] 54%|█████▍    | 105/195 [00:36<00:34,  2.60it/s] 54%|█████▍    | 106/195 [00:37<00:44,  2.02it/s] 55%|█████▍    | 107/195 [00:37<00:34,  2.53it/s] 55%|█████▌    | 108/195 [00:38<00:39,  2.22it/s] 56%|█████▌    | 109/195 [00:38<00:30,  2.84it/s] 56%|█████▋    | 110/195 [00:39<00:35,  2.40it/s] 57%|█████▋    | 111/195 [00:39<00:28,  2.92it/s] 57%|█████▋    | 112/195 [00:39<00:32,  2.55it/s] 58%|█████▊    | 113/195 [00:39<00:27,  3.03it/s] 58%|█████▊    | 114/195 [00:40<00:29,  2.74it/s] 59%|█████▉    | 115/195 [00:40<00:28,  2.79it/s] 59%|█████▉    | 116/195 [00:41<00:28,  2.77it/s] 60%|██████    | 117/195 [00:41<00:33,  2.30it/s] 61%|██████    | 119/195 [00:42<00:27,  2.80it/s] 62%|██████▏   | 121/195 [00:42<00:24,  2.98it/s] 63%|██████▎   | 122/195 [00:43<00:26,  2.75it/s] 63%|██████▎   | 123/195 [00:43<00:22,  3.17it/s] 64%|██████▎   | 124/195 [00:43<00:23,  3.03it/s] 65%|██████▍   | 126/195 [00:44<00:25,  2.74it/s] 65%|██████▌   | 127/195 [00:44<00:21,  3.23it/s] 66%|██████▌   | 128/195 [00:45<00:25,  2.67it/s] 66%|██████▌   | 129/195 [00:45<00:20,  3.15it/s] 67%|██████▋   | 130/195 [00:45<00:20,  3.15it/s] 67%|██████▋   | 131/195 [00:46<00:21,  3.01it/s] 68%|██████▊   | 133/195 [00:46<00:19,  3.15it/s] 69%|██████▊   | 134/195 [00:47<00:19,  3.07it/s] 69%|██████▉   | 135/195 [00:47<00:17,  3.45it/s] 70%|██████▉   | 136/195 [00:47<00:18,  3.11it/s] 70%|███████   | 137/195 [00:48<00:20,  2.89it/s] 71%|███████   | 138/195 [00:48<00:17,  3.34it/s] 71%|███████▏  | 139/195 [00:48<00:17,  3.20it/s] 72%|███████▏  | 140/195 [00:48<00:15,  3.52it/s] 72%|███████▏  | 141/195 [00:49<00:20,  2.62it/s] 73%|███████▎  | 142/195 [00:49<00:18,  2.90it/s] 73%|███████▎  | 143/195 [00:50<00:18,  2.78it/s] 74%|███████▍  | 144/195 [00:50<00:17,  2.94it/s] 74%|███████▍  | 145/195 [00:50<00:19,  2.63it/s] 75%|███████▌  | 147/195 [00:51<00:17,  2.79it/s] 76%|███████▋  | 149/195 [00:52<00:15,  2.90it/s] 77%|███████▋  | 150/195 [00:52<00:14,  3.08it/s] 77%|███████▋  | 151/195 [00:53<00:16,  2.66it/s] 78%|███████▊  | 152/195 [00:53<00:13,  3.17it/s] 78%|███████▊  | 153/195 [00:53<00:14,  2.90it/s] 79%|███████▉  | 154/195 [00:54<00:15,  2.64it/s] 79%|███████▉  | 155/195 [00:54<00:13,  2.95it/s] 80%|████████  | 156/195 [00:54<00:12,  3.13it/s] 81%|████████  | 157/195 [00:55<00:13,  2.91it/s] 81%|████████  | 158/195 [00:55<00:12,  2.88it/s] 82%|████████▏ | 159/195 [00:55<00:10,  3.41it/s] 82%|████████▏ | 160/195 [00:55<00:10,  3.21it/s] 83%|████████▎ | 161/195 [00:56<00:08,  3.89it/s] 83%|████████▎ | 162/195 [00:56<00:11,  2.96it/s] 84%|████████▎ | 163/195 [00:56<00:09,  3.53it/s] 84%|████████▍ | 164/195 [00:57<00:09,  3.22it/s] 85%|████████▍ | 165/195 [00:57<00:09,  3.27it/s] 85%|████████▌ | 166/195 [00:57<00:10,  2.65it/s] 86%|████████▌ | 168/195 [00:58<00:08,  3.06it/s] 87%|████████▋ | 170/195 [00:59<00:07,  3.25it/s] 88%|████████▊ | 172/195 [00:59<00:07,  3.27it/s] 89%|████████▊ | 173/195 [01:00<00:07,  3.01it/s] 90%|████████▉ | 175/195 [01:00<00:06,  3.22it/s] 90%|█████████ | 176/195 [01:00<00:05,  3.54it/s] 91%|█████████ | 177/195 [01:01<00:05,  3.20it/s] 92%|█████████▏| 179/195 [01:01<00:05,  3.08it/s] 93%|█████████▎| 181/195 [01:02<00:05,  2.75it/s] 93%|█████████▎| 182/195 [01:03<00:05,  2.60it/s] 94%|█████████▍| 184/195 [01:03<00:04,  2.63it/s] 95%|█████████▌| 186/195 [01:04<00:03,  2.96it/s] 96%|█████████▌| 187/195 [01:04<00:02,  3.05it/s] 96%|█████████▋| 188/195 [01:05<00:02,  3.28it/s] 97%|█████████▋| 189/195 [01:05<00:01,  3.04it/s] 97%|█████████▋| 190/195 [01:05<00:01,  3.33it/s] 98%|█████████▊| 191/195 [01:06<00:01,  3.04it/s] 98%|█████████▊| 192/195 [01:06<00:00,  3.46it/s] 99%|█████████▉| 193/195 [01:06<00:00,  3.38it/s] 99%|█████████▉| 194/195 [01:06<00:00,  3.31it/s]100%|██████████| 195/195 [01:07<00:00,  3.57it/s]100%|██████████| 195/195 [01:09<00:00,  2.82it/s]
2025-09-24 10:31:14 [info     ] Validating outputs
2025-09-24 10:31:14 [info     ] Predict - end                  time=0:1:9
2025-09-24 10:31:14 [info     ] Evaluate - start               split=test
2025-09-24 10:31:14 [info     ] Evaluate - end                 answer_distr=[0.17, 0.29, 0.3, 0.24] correctness_llm=0.36 llm_group_correctness=[0.23, 0.21, 0.36, 0.44, 0.56] monotonicity=0.75
2025-09-24 10:31:14 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:31:14 [info     ] Augmenting questions for IRT estimation num_questions=7
2025-09-24 10:31:14 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:31:14 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1001.30it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3743.20it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 539.43it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6457.03it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1082.08it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3411.14it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 704.67it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6666.70it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1112.21it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3787.84it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 659.52it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6842.26it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1102.11it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 4221.58it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 657.09it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6491.30it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 964.62it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3652.43it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 586.17it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6544.83it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 988.06it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3674.67it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 649.57it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6457.03it/s]
2025-09-24 10:31:19 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 10:31:19 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:31:19 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:31:19 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:31:19 [info     ] Evaluate question difficulty - end mae=1.53 rmse=1.88 split=test
2025-09-24 10:31:19 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 2 finished: 0:1:23

 ********** Run: 3/3 **********
2025-09-24 10:31:38 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:31:38 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:31:38 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:31:38 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:31:39 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:31:39 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:31:44 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:31:44 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:31:44 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:31:45 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:31:48 [info     ] Setting seed                   value=45
2025-09-24 10:31:48 [info     ] Building structured outputter  name=teacher_bool_nocontext
2025-09-24 10:31:48 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=teacher_dbe_miscons_level_nocontext
2025-09-24 10:31:48 [info     ] Building model                 name=llama3.1:8b provider=ollama rate_limit=None temp=1.0
2025-09-24 10:31:48 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<06:18,  1.95s/it]  2%|▏         | 3/195 [00:02<02:21,  1.36it/s]  2%|▏         | 4/195 [00:02<01:52,  1.70it/s]  3%|▎         | 5/195 [00:03<01:41,  1.87it/s]  3%|▎         | 6/195 [00:04<01:54,  1.65it/s]  4%|▍         | 8/195 [00:04<01:40,  1.85it/s]  5%|▍         | 9/195 [00:05<01:32,  2.00it/s]  5%|▌         | 10/195 [00:05<01:18,  2.35it/s]  6%|▌         | 11/195 [00:06<01:17,  2.37it/s]  6%|▌         | 12/195 [00:06<01:08,  2.69it/s]  7%|▋         | 13/195 [00:06<01:10,  2.59it/s]  8%|▊         | 15/195 [00:07<00:59,  3.02it/s]  8%|▊         | 16/195 [00:07<01:02,  2.84it/s]  9%|▊         | 17/195 [00:07<00:59,  2.97it/s]  9%|▉         | 18/195 [00:08<00:59,  2.99it/s] 10%|▉         | 19/195 [00:08<01:03,  2.77it/s] 10%|█         | 20/195 [00:08<00:52,  3.33it/s] 11%|█         | 21/195 [00:09<01:03,  2.74it/s] 12%|█▏        | 23/195 [00:09<00:55,  3.12it/s] 12%|█▏        | 24/195 [00:10<00:53,  3.20it/s] 13%|█▎        | 25/195 [00:10<01:01,  2.78it/s] 13%|█▎        | 26/195 [00:11<01:01,  2.76it/s] 14%|█▍        | 27/195 [00:11<00:52,  3.19it/s] 14%|█▍        | 28/195 [00:11<01:05,  2.54it/s] 15%|█▍        | 29/195 [00:11<00:53,  3.11it/s] 15%|█▌        | 30/195 [00:12<01:13,  2.24it/s] 16%|█▋        | 32/195 [00:13<01:01,  2.65it/s] 17%|█▋        | 33/195 [00:13<00:59,  2.72it/s] 17%|█▋        | 34/195 [00:14<01:00,  2.65it/s] 18%|█▊        | 35/195 [00:14<00:58,  2.75it/s] 18%|█▊        | 36/195 [00:14<01:04,  2.47it/s] 19%|█▉        | 38/195 [00:15<00:59,  2.62it/s] 21%|██        | 40/195 [00:16<00:56,  2.74it/s] 22%|██▏       | 42/195 [00:16<00:55,  2.78it/s] 22%|██▏       | 43/195 [00:17<00:49,  3.07it/s] 23%|██▎       | 44/195 [00:17<00:55,  2.71it/s] 24%|██▎       | 46/195 [00:18<00:49,  2.98it/s] 24%|██▍       | 47/195 [00:18<00:48,  3.04it/s] 25%|██▍       | 48/195 [00:18<00:52,  2.81it/s] 26%|██▌       | 50/195 [00:19<00:44,  3.25it/s] 26%|██▌       | 51/195 [00:19<00:42,  3.40it/s] 27%|██▋       | 52/195 [00:20<00:52,  2.72it/s] 28%|██▊       | 54/195 [00:21<00:54,  2.58it/s] 29%|██▊       | 56/195 [00:21<00:49,  2.80it/s] 29%|██▉       | 57/195 [00:21<00:42,  3.23it/s] 30%|██▉       | 58/195 [00:22<00:42,  3.20it/s] 30%|███       | 59/195 [00:22<00:52,  2.59it/s] 31%|███       | 60/195 [00:22<00:44,  3.04it/s] 31%|███▏      | 61/195 [00:23<00:49,  2.72it/s] 32%|███▏      | 62/195 [00:23<00:39,  3.37it/s] 32%|███▏      | 63/195 [00:24<00:54,  2.44it/s] 33%|███▎      | 64/195 [00:24<00:42,  3.10it/s] 33%|███▎      | 65/195 [00:24<00:46,  2.80it/s] 34%|███▍      | 66/195 [00:24<00:39,  3.26it/s] 34%|███▍      | 67/195 [00:25<00:45,  2.83it/s] 35%|███▌      | 69/195 [00:25<00:36,  3.49it/s] 36%|███▋      | 71/195 [00:26<00:41,  2.98it/s] 37%|███▋      | 72/195 [00:26<00:39,  3.15it/s] 37%|███▋      | 73/195 [00:27<00:36,  3.35it/s] 38%|███▊      | 74/195 [00:27<00:43,  2.80it/s] 39%|███▉      | 76/195 [00:28<00:41,  2.85it/s] 40%|████      | 78/195 [00:28<00:37,  3.12it/s] 41%|████      | 80/195 [00:29<00:31,  3.60it/s] 42%|████▏     | 81/195 [00:29<00:31,  3.64it/s] 42%|████▏     | 82/195 [00:29<00:30,  3.71it/s] 43%|████▎     | 83/195 [00:30<00:34,  3.25it/s] 43%|████▎     | 84/195 [00:30<00:28,  3.85it/s] 44%|████▎     | 85/195 [00:30<00:37,  2.96it/s] 45%|████▍     | 87/195 [00:31<00:35,  3.03it/s] 46%|████▌     | 89/195 [00:32<00:34,  3.09it/s] 47%|████▋     | 91/195 [00:32<00:33,  3.09it/s] 47%|████▋     | 92/195 [00:33<00:30,  3.37it/s] 48%|████▊     | 93/195 [00:33<00:34,  2.95it/s] 49%|████▊     | 95/195 [00:34<00:38,  2.62it/s] 50%|████▉     | 97/195 [00:34<00:32,  2.99it/s] 50%|█████     | 98/195 [00:35<00:36,  2.69it/s] 51%|█████▏    | 100/195 [00:36<00:34,  2.75it/s] 52%|█████▏    | 101/195 [00:36<00:31,  3.00it/s] 52%|█████▏    | 102/195 [00:37<00:37,  2.47it/s] 53%|█████▎    | 103/195 [00:37<00:30,  2.97it/s] 53%|█████▎    | 104/195 [00:37<00:35,  2.58it/s] 54%|█████▍    | 105/195 [00:37<00:32,  2.76it/s] 54%|█████▍    | 106/195 [00:38<00:33,  2.70it/s] 55%|█████▍    | 107/195 [00:38<00:26,  3.35it/s] 55%|█████▌    | 108/195 [00:38<00:30,  2.87it/s] 56%|█████▌    | 109/195 [00:39<00:28,  3.01it/s] 56%|█████▋    | 110/195 [00:39<00:30,  2.77it/s] 57%|█████▋    | 111/195 [00:39<00:25,  3.28it/s] 57%|█████▋    | 112/195 [00:40<00:42,  1.97it/s] 58%|█████▊    | 114/195 [00:41<00:33,  2.42it/s] 59%|█████▉    | 115/195 [00:41<00:27,  2.89it/s] 59%|█████▉    | 116/195 [00:42<00:33,  2.38it/s] 61%|██████    | 118/195 [00:43<00:33,  2.32it/s] 61%|██████    | 119/195 [00:43<00:31,  2.44it/s] 62%|██████▏   | 120/195 [00:43<00:28,  2.59it/s] 62%|██████▏   | 121/195 [00:44<00:27,  2.72it/s] 63%|██████▎   | 122/195 [00:44<00:25,  2.83it/s] 63%|██████▎   | 123/195 [00:44<00:22,  3.19it/s] 64%|██████▎   | 124/195 [00:45<00:26,  2.65it/s] 65%|██████▍   | 126/195 [00:45<00:26,  2.59it/s] 65%|██████▌   | 127/195 [00:46<00:24,  2.81it/s] 66%|██████▌   | 128/195 [00:46<00:26,  2.57it/s] 66%|██████▌   | 129/195 [00:46<00:22,  2.94it/s] 67%|██████▋   | 130/195 [00:47<00:31,  2.09it/s] 68%|██████▊   | 132/195 [00:48<00:25,  2.49it/s] 68%|██████▊   | 133/195 [00:48<00:24,  2.52it/s] 69%|██████▊   | 134/195 [00:49<00:27,  2.22it/s] 69%|██████▉   | 135/195 [00:49<00:24,  2.46it/s] 70%|██████▉   | 136/195 [00:50<00:28,  2.08it/s] 70%|███████   | 137/195 [00:50<00:23,  2.49it/s] 71%|███████   | 138/195 [00:50<00:22,  2.58it/s] 71%|███████▏  | 139/195 [00:51<00:18,  3.07it/s] 72%|███████▏  | 140/195 [00:51<00:19,  2.84it/s] 72%|███████▏  | 141/195 [00:51<00:20,  2.67it/s] 73%|███████▎  | 142/195 [00:52<00:17,  2.99it/s] 73%|███████▎  | 143/195 [00:52<00:17,  3.06it/s] 74%|███████▍  | 144/195 [00:52<00:13,  3.82it/s] 74%|███████▍  | 145/195 [00:52<00:14,  3.42it/s] 75%|███████▍  | 146/195 [00:52<00:11,  4.14it/s] 75%|███████▌  | 147/195 [00:53<00:15,  3.12it/s] 76%|███████▌  | 148/195 [00:53<00:12,  3.62it/s] 76%|███████▋  | 149/195 [00:54<00:15,  3.06it/s] 77%|███████▋  | 150/195 [00:54<00:15,  2.91it/s] 77%|███████▋  | 151/195 [00:54<00:15,  2.88it/s] 78%|███████▊  | 152/195 [00:55<00:15,  2.76it/s] 79%|███████▉  | 154/195 [00:55<00:12,  3.16it/s] 80%|████████  | 156/195 [00:56<00:13,  2.94it/s] 81%|████████  | 158/195 [00:57<00:12,  3.06it/s] 82%|████████▏ | 159/195 [00:57<00:11,  3.18it/s] 82%|████████▏ | 160/195 [00:57<00:10,  3.47it/s] 83%|████████▎ | 161/195 [00:58<00:10,  3.15it/s] 83%|████████▎ | 162/195 [00:58<00:09,  3.31it/s] 84%|████████▎ | 163/195 [00:58<00:11,  2.83it/s] 85%|████████▍ | 165/195 [00:59<00:09,  3.03it/s] 86%|████████▌ | 167/195 [00:59<00:08,  3.30it/s] 86%|████████▌ | 168/195 [01:00<00:08,  3.13it/s] 87%|████████▋ | 169/195 [01:00<00:09,  2.85it/s] 87%|████████▋ | 170/195 [01:01<00:08,  2.90it/s] 88%|████████▊ | 171/195 [01:01<00:09,  2.62it/s] 88%|████████▊ | 172/195 [01:01<00:08,  2.59it/s] 89%|████████▉ | 174/195 [01:02<00:08,  2.50it/s] 90%|█████████ | 176/195 [01:03<00:07,  2.55it/s] 91%|█████████ | 177/195 [01:03<00:06,  2.90it/s] 91%|█████████▏| 178/195 [01:04<00:05,  2.91it/s] 92%|█████████▏| 179/195 [01:04<00:05,  2.74it/s] 92%|█████████▏| 180/195 [01:04<00:05,  2.99it/s] 93%|█████████▎| 181/195 [01:05<00:05,  2.79it/s] 93%|█████████▎| 182/195 [01:05<00:04,  3.08it/s] 94%|█████████▍| 183/195 [01:05<00:03,  3.03it/s] 94%|█████████▍| 184/195 [01:05<00:03,  3.44it/s] 95%|█████████▍| 185/195 [01:06<00:03,  2.68it/s] 95%|█████████▌| 186/195 [01:06<00:03,  2.59it/s] 96%|█████████▌| 187/195 [01:07<00:02,  3.24it/s] 96%|█████████▋| 188/195 [01:07<00:02,  3.10it/s] 97%|█████████▋| 189/195 [01:07<00:01,  3.78it/s] 97%|█████████▋| 190/195 [01:08<00:01,  2.93it/s] 98%|█████████▊| 192/195 [01:08<00:00,  3.43it/s] 99%|█████████▉| 193/195 [01:08<00:00,  3.81it/s] 99%|█████████▉| 194/195 [01:09<00:00,  2.65it/s]100%|██████████| 195/195 [01:09<00:00,  2.93it/s]100%|██████████| 195/195 [01:11<00:00,  2.72it/s]
2025-09-24 10:32:59 [info     ] Validating outputs
2025-09-24 10:32:59 [info     ] Predict - end                  time=0:1:11
2025-09-24 10:32:59 [info     ] Evaluate - start               split=test
2025-09-24 10:32:59 [info     ] Evaluate - end                 answer_distr=[0.16, 0.22, 0.29, 0.33] correctness_llm=0.36 llm_group_correctness=[0.15, 0.23, 0.46, 0.51, 0.46] monotonicity=0.69
2025-09-24 10:32:59 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:32:59 [info     ] Augmenting questions for IRT estimation num_questions=3
2025-09-24 10:32:59 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:32:59 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1088.82it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3008.22it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 608.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8532.44it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1023.61it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3505.52it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 666.17it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8655.70it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1143.84it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3568.61it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 658.10it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8515.12it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1033.73it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3738.41it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 613.95it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 9585.42it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1176.24it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3555.04it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 627.72it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8816.86it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 981.68it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3761.02it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 724.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 9368.26it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1133.25it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3671.37it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 681.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8846.08it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1145.14it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3639.35it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 654.88it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8934.91it/s]
2025-09-24 10:33:05 INFO: EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
2025-09-24 10:33:05 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:33:05 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:33:05 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:33:06 [info     ] Evaluate question difficulty - end mae=1.47 rmse=1.79 split=test
2025-09-24 10:33:06 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 3 finished: 0:1:27

 ========== Config: qwen3:0.6b~T_1.0~SO_student_bool_nocontext~L_5~SP_student_dbe_miscons_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_cfe_studentlevel_random0 ==========
Config 15/16

 ********** Run: 1/3 **********
2025-09-24 10:33:24 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:33:24 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:33:24 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:33:24 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:33:25 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:33:25 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:33:30 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:33:30 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:33:30 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:33:31 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:33:34 [info     ] Setting seed                   value=43
2025-09-24 10:33:34 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 10:33:34 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_dbe_miscons_level_nocontext
2025-09-24 10:33:34 [info     ] Building model                 name=qwen3:0.6b provider=ollama rate_limit=None temp=1.0
2025-09-24 10:33:34 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:02<07:28,  2.31s/it]  1%|          | 2/195 [00:02<03:16,  1.02s/it]  2%|▏         | 3/195 [00:03<02:37,  1.22it/s]  2%|▏         | 4/195 [00:03<01:45,  1.81it/s]  3%|▎         | 5/195 [00:03<01:39,  1.91it/s]  3%|▎         | 6/195 [00:03<01:27,  2.15it/s]  4%|▎         | 7/195 [00:04<01:05,  2.86it/s]  4%|▍         | 8/195 [00:04<01:00,  3.08it/s]  5%|▌         | 10/195 [00:04<00:46,  4.00it/s]  6%|▌         | 11/195 [00:04<00:47,  3.91it/s]  6%|▌         | 12/195 [00:05<00:43,  4.23it/s]  7%|▋         | 13/195 [00:05<00:41,  4.40it/s]  7%|▋         | 14/195 [00:05<00:37,  4.86it/s]  8%|▊         | 15/195 [00:05<00:38,  4.64it/s]  8%|▊         | 16/195 [00:05<00:37,  4.83it/s]  9%|▊         | 17/195 [00:06<00:36,  4.89it/s]  9%|▉         | 18/195 [00:06<00:45,  3.86it/s] 10%|█         | 20/195 [00:06<00:37,  4.71it/s] 11%|█         | 21/195 [00:06<00:34,  5.06it/s] 11%|█▏        | 22/195 [00:07<00:35,  4.89it/s] 12%|█▏        | 23/195 [00:07<00:34,  4.97it/s] 12%|█▏        | 24/195 [00:07<00:35,  4.88it/s] 13%|█▎        | 25/195 [00:07<00:32,  5.20it/s] 13%|█▎        | 26/195 [00:07<00:29,  5.66it/s] 14%|█▍        | 27/195 [00:08<00:31,  5.33it/s] 14%|█▍        | 28/195 [00:08<00:31,  5.33it/s] 15%|█▍        | 29/195 [00:08<00:35,  4.67it/s] 15%|█▌        | 30/195 [00:08<00:33,  4.92it/s] 16%|█▌        | 31/195 [00:08<00:33,  4.89it/s] 16%|█▋        | 32/195 [00:09<00:30,  5.28it/s] 17%|█▋        | 33/195 [00:09<00:31,  5.13it/s] 17%|█▋        | 34/195 [00:09<00:29,  5.49it/s] 18%|█▊        | 35/195 [00:09<00:32,  4.92it/s] 19%|█▉        | 37/195 [00:10<00:29,  5.41it/s] 19%|█▉        | 38/195 [00:10<00:27,  5.66it/s] 20%|██        | 39/195 [00:10<00:28,  5.38it/s] 21%|██        | 40/195 [00:10<00:27,  5.67it/s] 21%|██        | 41/195 [00:11<00:37,  4.10it/s] 22%|██▏       | 42/195 [00:11<00:38,  3.94it/s] 22%|██▏       | 43/195 [00:11<00:34,  4.38it/s] 23%|██▎       | 44/195 [00:11<00:32,  4.59it/s] 23%|██▎       | 45/195 [00:11<00:30,  4.95it/s] 24%|██▎       | 46/195 [00:12<00:30,  4.91it/s] 24%|██▍       | 47/195 [00:12<00:27,  5.35it/s] 25%|██▍       | 48/195 [00:12<00:28,  5.17it/s] 25%|██▌       | 49/195 [00:12<00:26,  5.57it/s] 26%|██▌       | 50/195 [00:12<00:28,  5.17it/s] 26%|██▌       | 51/195 [00:12<00:26,  5.43it/s] 27%|██▋       | 52/195 [00:13<00:28,  5.09it/s] 27%|██▋       | 53/195 [00:13<00:28,  4.95it/s] 28%|██▊       | 54/195 [00:13<00:26,  5.34it/s] 28%|██▊       | 55/195 [00:13<00:28,  4.85it/s] 29%|██▊       | 56/195 [00:13<00:27,  5.12it/s] 29%|██▉       | 57/195 [00:14<00:25,  5.48it/s] 30%|██▉       | 58/195 [00:14<00:26,  5.11it/s] 30%|███       | 59/195 [00:14<00:26,  5.21it/s] 31%|███       | 60/195 [00:14<00:25,  5.30it/s] 31%|███▏      | 61/195 [00:14<00:25,  5.22it/s] 32%|███▏      | 62/195 [00:15<00:24,  5.53it/s] 32%|███▏      | 63/195 [00:15<00:21,  6.01it/s] 33%|███▎      | 64/195 [00:15<00:23,  5.56it/s] 33%|███▎      | 65/195 [00:15<00:21,  5.95it/s] 34%|███▍      | 66/195 [00:15<00:23,  5.50it/s] 34%|███▍      | 67/195 [00:16<00:32,  3.89it/s] 35%|███▍      | 68/195 [00:16<00:28,  4.47it/s] 35%|███▌      | 69/195 [00:16<00:24,  5.11it/s] 36%|███▌      | 70/195 [00:16<00:23,  5.31it/s] 36%|███▋      | 71/195 [00:16<00:21,  5.88it/s] 37%|███▋      | 72/195 [00:16<00:21,  5.59it/s] 37%|███▋      | 73/195 [00:17<00:19,  6.20it/s] 38%|███▊      | 74/195 [00:17<00:23,  5.06it/s] 38%|███▊      | 75/195 [00:17<00:21,  5.65it/s] 39%|███▉      | 76/195 [00:17<00:22,  5.34it/s] 39%|███▉      | 77/195 [00:17<00:20,  5.77it/s] 40%|████      | 78/195 [00:18<00:21,  5.46it/s] 41%|████      | 79/195 [00:18<00:19,  5.86it/s] 41%|████      | 80/195 [00:18<00:21,  5.42it/s] 42%|████▏     | 81/195 [00:18<00:19,  5.78it/s] 42%|████▏     | 82/195 [00:18<00:22,  5.04it/s] 43%|████▎     | 83/195 [00:18<00:20,  5.52it/s] 43%|████▎     | 84/195 [00:19<00:20,  5.40it/s] 44%|████▎     | 85/195 [00:19<00:20,  5.38it/s] 44%|████▍     | 86/195 [00:19<00:24,  4.53it/s] 45%|████▌     | 88/195 [00:19<00:21,  5.09it/s] 46%|████▌     | 90/195 [00:20<00:21,  4.91it/s] 47%|████▋     | 92/195 [00:20<00:20,  4.98it/s] 48%|████▊     | 94/195 [00:21<00:19,  5.15it/s] 49%|████▊     | 95/195 [00:21<00:17,  5.65it/s] 49%|████▉     | 96/195 [00:21<00:18,  5.27it/s] 50%|████▉     | 97/195 [00:21<00:17,  5.59it/s] 50%|█████     | 98/195 [00:21<00:19,  5.03it/s] 51%|█████     | 99/195 [00:22<00:17,  5.43it/s] 51%|█████▏    | 100/195 [00:22<00:19,  5.00it/s] 52%|█████▏    | 101/195 [00:22<00:18,  5.15it/s] 52%|█████▏    | 102/195 [00:22<00:18,  5.02it/s] 53%|█████▎    | 103/195 [00:22<00:18,  4.95it/s] 53%|█████▎    | 104/195 [00:23<00:19,  4.75it/s] 54%|█████▍    | 105/195 [00:23<00:18,  4.95it/s] 54%|█████▍    | 106/195 [00:23<00:18,  4.76it/s] 55%|█████▍    | 107/195 [00:23<00:16,  5.18it/s] 55%|█████▌    | 108/195 [00:23<00:18,  4.81it/s] 56%|█████▌    | 109/195 [00:24<00:17,  5.01it/s] 56%|█████▋    | 110/195 [00:24<00:18,  4.63it/s] 57%|█████▋    | 111/195 [00:24<00:18,  4.64it/s] 57%|█████▋    | 112/195 [00:24<00:16,  5.01it/s] 58%|█████▊    | 113/195 [00:24<00:16,  4.87it/s] 58%|█████▊    | 114/195 [00:25<00:15,  5.32it/s] 59%|█████▉    | 115/195 [00:25<00:17,  4.50it/s] 59%|█████▉    | 116/195 [00:25<00:16,  4.90it/s] 60%|██████    | 117/195 [00:25<00:16,  4.85it/s] 61%|██████    | 118/195 [00:25<00:14,  5.24it/s] 61%|██████    | 119/195 [00:26<00:15,  4.75it/s] 62%|██████▏   | 121/195 [00:26<00:13,  5.34it/s] 63%|██████▎   | 122/195 [00:26<00:12,  5.94it/s] 63%|██████▎   | 123/195 [00:26<00:13,  5.42it/s] 64%|██████▎   | 124/195 [00:27<00:13,  5.26it/s] 64%|██████▍   | 125/195 [00:27<00:12,  5.82it/s] 65%|██████▍   | 126/195 [00:27<00:11,  5.81it/s] 66%|██████▌   | 128/195 [00:27<00:11,  5.95it/s] 66%|██████▌   | 129/195 [00:27<00:11,  5.57it/s] 67%|██████▋   | 130/195 [00:28<00:11,  5.74it/s] 67%|██████▋   | 131/195 [00:28<00:10,  6.19it/s] 68%|██████▊   | 132/195 [00:28<00:10,  5.87it/s] 68%|██████▊   | 133/195 [00:28<00:09,  6.25it/s] 69%|██████▊   | 134/195 [00:28<00:10,  5.74it/s] 70%|██████▉   | 136/195 [00:28<00:09,  6.06it/s] 70%|███████   | 137/195 [00:29<00:08,  6.48it/s] 71%|███████   | 138/195 [00:29<00:09,  5.96it/s] 71%|███████▏  | 139/195 [00:29<00:08,  6.25it/s] 72%|███████▏  | 140/195 [00:29<00:09,  5.55it/s] 72%|███████▏  | 141/195 [00:29<00:09,  5.73it/s] 73%|███████▎  | 142/195 [00:29<00:08,  6.07it/s] 73%|███████▎  | 143/195 [00:30<00:09,  5.20it/s] 74%|███████▍  | 145/195 [00:30<00:09,  5.04it/s] 75%|███████▌  | 147/195 [00:31<00:09,  5.13it/s] 76%|███████▋  | 149/195 [00:31<00:08,  5.59it/s] 77%|███████▋  | 150/195 [00:31<00:07,  5.74it/s] 77%|███████▋  | 151/195 [00:31<00:08,  5.13it/s] 78%|███████▊  | 153/195 [00:32<00:07,  5.53it/s] 79%|███████▉  | 154/195 [00:32<00:07,  5.68it/s] 79%|███████▉  | 155/195 [00:32<00:07,  5.31it/s] 80%|████████  | 156/195 [00:32<00:06,  5.70it/s] 81%|████████  | 157/195 [00:32<00:06,  5.44it/s] 81%|████████  | 158/195 [00:32<00:06,  5.87it/s] 82%|████████▏ | 159/195 [00:33<00:07,  5.09it/s] 82%|████████▏ | 160/195 [00:33<00:09,  3.84it/s] 83%|████████▎ | 161/195 [00:33<00:07,  4.44it/s] 83%|████████▎ | 162/195 [00:34<00:08,  3.74it/s] 84%|████████▍ | 164/195 [00:34<00:06,  4.55it/s] 85%|████████▍ | 165/195 [00:34<00:05,  5.02it/s] 85%|████████▌ | 166/195 [00:34<00:05,  5.02it/s] 86%|████████▌ | 167/195 [00:34<00:05,  5.19it/s] 86%|████████▌ | 168/195 [00:35<00:05,  4.72it/s] 87%|████████▋ | 169/195 [00:35<00:05,  5.19it/s] 87%|████████▋ | 170/195 [00:35<00:05,  4.67it/s] 88%|████████▊ | 171/195 [00:35<00:05,  4.54it/s] 88%|████████▊ | 172/195 [00:36<00:04,  5.07it/s] 89%|████████▊ | 173/195 [00:36<00:05,  4.31it/s] 89%|████████▉ | 174/195 [00:36<00:04,  4.54it/s] 90%|█████████ | 176/195 [00:36<00:03,  4.79it/s] 91%|█████████▏| 178/195 [00:37<00:03,  5.07it/s] 92%|█████████▏| 180/195 [00:37<00:02,  5.47it/s] 93%|█████████▎| 182/195 [00:37<00:02,  5.67it/s] 94%|█████████▍| 183/195 [00:38<00:02,  5.82it/s] 94%|█████████▍| 184/195 [00:38<00:01,  5.77it/s] 95%|█████████▍| 185/195 [00:38<00:01,  6.09it/s] 95%|█████████▌| 186/195 [00:38<00:01,  5.92it/s] 96%|█████████▌| 187/195 [00:38<00:01,  6.28it/s] 96%|█████████▋| 188/195 [00:38<00:01,  6.09it/s] 97%|█████████▋| 189/195 [00:39<00:00,  6.49it/s] 97%|█████████▋| 190/195 [00:39<00:00,  6.16it/s] 98%|█████████▊| 191/195 [00:39<00:00,  6.52it/s] 98%|█████████▊| 192/195 [00:39<00:00,  6.14it/s] 99%|█████████▉| 193/195 [00:39<00:00,  6.78it/s] 99%|█████████▉| 194/195 [00:39<00:00,  5.98it/s]100%|██████████| 195/195 [00:42<00:00,  4.61it/s]
2025-09-24 10:34:16 [info     ] Validating outputs
2025-09-24 10:34:16 [info     ] Predict - end                  time=0:0:42
2025-09-24 10:34:16 [info     ] Evaluate - start               split=test
2025-09-24 10:34:16 [info     ] Evaluate - end                 answer_distr=[0.46, 0.22, 0.12, 0.17] correctness_llm=0.84 llm_group_correctness=[0.69, 0.79, 0.82, 0.9, 0.97] monotonicity=0.98
2025-09-24 10:34:16 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:34:16 [info     ] Augmenting questions for IRT estimation num_questions=23
2025-09-24 10:34:16 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:34:16 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 919.54it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3544.94it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 567.96it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6054.88it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1159.79it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3665.12it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 521.61it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5920.57it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 918.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3586.76it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 687.37it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 2575.90it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 763.25it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3038.73it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 614.04it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6073.67it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1002.46it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3758.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 625.23it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6156.45it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 959.11it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3499.22it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 596.16it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6618.60it/s]
2025-09-24 10:34:21 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 10:34:21 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:34:21 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:34:21 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:34:21 [info     ] Evaluate question difficulty - end mae=1.59 rmse=1.97 split=test
2025-09-24 10:34:21 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 1 finished: 0:0:57

 ********** Run: 2/3 **********
2025-09-24 10:34:41 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:34:41 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:34:41 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:34:41 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:34:43 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:34:43 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:34:47 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:34:47 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:34:47 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:34:48 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:34:51 [info     ] Setting seed                   value=44
2025-09-24 10:34:51 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 10:34:51 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_dbe_miscons_level_nocontext
2025-09-24 10:34:51 [info     ] Building model                 name=qwen3:0.6b provider=ollama rate_limit=None temp=1.0
2025-09-24 10:34:51 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:00<02:55,  1.11it/s]  1%|          | 2/195 [00:01<01:26,  2.24it/s]  2%|▏         | 3/195 [00:01<01:33,  2.05it/s]  2%|▏         | 4/195 [00:01<01:11,  2.67it/s]  3%|▎         | 5/195 [00:02<01:05,  2.89it/s]  3%|▎         | 6/195 [00:02<01:02,  3.02it/s]  4%|▎         | 7/195 [00:02<01:13,  2.57it/s]  5%|▍         | 9/195 [00:03<00:52,  3.54it/s]  6%|▌         | 11/195 [00:03<00:45,  4.04it/s]  7%|▋         | 13/195 [00:03<00:38,  4.78it/s]  8%|▊         | 15/195 [00:04<00:31,  5.66it/s]  8%|▊         | 16/195 [00:04<00:29,  6.02it/s]  9%|▊         | 17/195 [00:04<00:28,  6.35it/s]  9%|▉         | 18/195 [00:04<00:29,  5.98it/s] 10%|▉         | 19/195 [00:04<00:39,  4.44it/s] 10%|█         | 20/195 [00:05<00:36,  4.86it/s] 11%|█         | 21/195 [00:05<00:33,  5.20it/s] 12%|█▏        | 23/195 [00:05<00:31,  5.44it/s] 13%|█▎        | 25/195 [00:05<00:29,  5.71it/s] 13%|█▎        | 26/195 [00:06<00:30,  5.45it/s] 14%|█▍        | 27/195 [00:06<00:30,  5.53it/s] 14%|█▍        | 28/195 [00:06<00:28,  5.90it/s] 15%|█▍        | 29/195 [00:06<00:30,  5.53it/s] 15%|█▌        | 30/195 [00:06<00:29,  5.54it/s] 16%|█▌        | 31/195 [00:07<00:28,  5.81it/s] 16%|█▋        | 32/195 [00:07<00:33,  4.91it/s] 17%|█▋        | 33/195 [00:07<00:46,  3.49it/s] 17%|█▋        | 34/195 [00:07<00:38,  4.16it/s] 18%|█▊        | 35/195 [00:08<00:33,  4.81it/s] 18%|█▊        | 36/195 [00:08<00:33,  4.76it/s] 19%|█▉        | 38/195 [00:08<00:37,  4.16it/s] 21%|██        | 40/195 [00:09<00:30,  5.12it/s] 21%|██        | 41/195 [00:09<00:28,  5.49it/s] 22%|██▏       | 42/195 [00:09<00:28,  5.37it/s] 22%|██▏       | 43/195 [00:09<00:25,  5.87it/s] 23%|██▎       | 44/195 [00:09<00:28,  5.21it/s] 23%|██▎       | 45/195 [00:09<00:27,  5.55it/s] 24%|██▎       | 46/195 [00:10<00:29,  4.97it/s] 24%|██▍       | 47/195 [00:10<00:27,  5.47it/s] 25%|██▍       | 48/195 [00:10<00:36,  4.00it/s] 25%|██▌       | 49/195 [00:11<00:42,  3.41it/s] 26%|██▌       | 51/195 [00:11<00:34,  4.18it/s] 27%|██▋       | 52/195 [00:11<00:29,  4.78it/s] 27%|██▋       | 53/195 [00:11<00:30,  4.64it/s] 28%|██▊       | 54/195 [00:11<00:28,  4.95it/s] 28%|██▊       | 55/195 [00:12<00:37,  3.76it/s] 29%|██▊       | 56/195 [00:12<00:36,  3.76it/s] 29%|██▉       | 57/195 [00:12<00:33,  4.18it/s] 30%|██▉       | 58/195 [00:13<00:31,  4.32it/s] 30%|███       | 59/195 [00:13<00:30,  4.40it/s] 31%|███       | 60/195 [00:13<00:28,  4.74it/s] 31%|███▏      | 61/195 [00:13<00:28,  4.73it/s] 32%|███▏      | 62/195 [00:13<00:25,  5.26it/s] 32%|███▏      | 63/195 [00:14<00:26,  4.98it/s] 33%|███▎      | 65/195 [00:14<00:26,  4.97it/s] 34%|███▍      | 66/195 [00:14<00:22,  5.67it/s] 34%|███▍      | 67/195 [00:14<00:24,  5.33it/s] 35%|███▍      | 68/195 [00:14<00:22,  5.68it/s] 35%|███▌      | 69/195 [00:15<00:23,  5.44it/s] 36%|███▌      | 70/195 [00:15<00:21,  5.83it/s] 36%|███▋      | 71/195 [00:15<00:22,  5.63it/s] 37%|███▋      | 72/195 [00:15<00:20,  6.07it/s] 37%|███▋      | 73/195 [00:15<00:20,  6.06it/s] 38%|███▊      | 74/195 [00:15<00:21,  5.75it/s] 38%|███▊      | 75/195 [00:16<00:21,  5.51it/s] 39%|███▉      | 76/195 [00:16<00:20,  5.84it/s] 39%|███▉      | 77/195 [00:16<00:21,  5.50it/s] 40%|████      | 78/195 [00:16<00:20,  5.61it/s] 41%|████      | 79/195 [00:16<00:22,  5.22it/s] 41%|████      | 80/195 [00:17<00:22,  5.12it/s] 42%|████▏     | 81/195 [00:17<00:22,  4.98it/s] 42%|████▏     | 82/195 [00:17<00:21,  5.23it/s] 43%|████▎     | 83/195 [00:17<00:18,  5.92it/s] 43%|████▎     | 84/195 [00:17<00:23,  4.80it/s] 44%|████▍     | 86/195 [00:18<00:20,  5.35it/s] 45%|████▌     | 88/195 [00:18<00:22,  4.83it/s] 46%|████▌     | 89/195 [00:18<00:23,  4.54it/s] 46%|████▌     | 90/195 [00:19<00:27,  3.86it/s] 47%|████▋     | 91/195 [00:19<00:24,  4.28it/s] 47%|████▋     | 92/195 [00:19<00:21,  4.73it/s] 48%|████▊     | 93/195 [00:20<00:26,  3.87it/s] 48%|████▊     | 94/195 [00:20<00:27,  3.65it/s] 49%|████▉     | 96/195 [00:20<00:24,  4.08it/s] 50%|████▉     | 97/195 [00:21<00:26,  3.73it/s] 50%|█████     | 98/195 [00:21<00:23,  4.19it/s] 51%|█████     | 99/195 [00:21<00:22,  4.21it/s] 51%|█████▏    | 100/195 [00:21<00:20,  4.52it/s] 52%|█████▏    | 101/195 [00:21<00:21,  4.42it/s] 52%|█████▏    | 102/195 [00:22<00:19,  4.76it/s] 53%|█████▎    | 103/195 [00:22<00:19,  4.75it/s] 53%|█████▎    | 104/195 [00:22<00:17,  5.14it/s] 54%|█████▍    | 105/195 [00:22<00:21,  4.13it/s] 54%|█████▍    | 106/195 [00:22<00:18,  4.92it/s] 55%|█████▍    | 107/195 [00:23<00:21,  4.04it/s] 55%|█████▌    | 108/195 [00:23<00:17,  4.84it/s] 56%|█████▌    | 109/195 [00:23<00:22,  3.79it/s] 57%|█████▋    | 111/195 [00:24<00:18,  4.43it/s] 57%|█████▋    | 112/195 [00:24<00:16,  5.04it/s] 58%|█████▊    | 113/195 [00:24<00:16,  4.84it/s] 58%|█████▊    | 114/195 [00:24<00:15,  5.10it/s] 59%|█████▉    | 115/195 [00:24<00:16,  4.80it/s] 59%|█████▉    | 116/195 [00:25<00:15,  4.96it/s] 60%|██████    | 117/195 [00:25<00:15,  4.90it/s] 61%|██████    | 118/195 [00:25<00:14,  5.32it/s] 61%|██████    | 119/195 [00:25<00:14,  5.25it/s] 62%|██████▏   | 120/195 [00:25<00:14,  5.16it/s] 62%|██████▏   | 121/195 [00:25<00:12,  5.73it/s] 63%|██████▎   | 122/195 [00:26<00:12,  5.73it/s] 63%|██████▎   | 123/195 [00:26<00:11,  6.07it/s] 64%|██████▎   | 124/195 [00:26<00:10,  6.50it/s] 64%|██████▍   | 125/195 [00:26<00:10,  6.61it/s] 65%|██████▍   | 126/195 [00:26<00:10,  6.60it/s] 65%|██████▌   | 127/195 [00:26<00:09,  6.83it/s] 66%|██████▌   | 128/195 [00:27<00:10,  6.36it/s] 66%|██████▌   | 129/195 [00:27<00:12,  5.31it/s] 67%|██████▋   | 130/195 [00:27<00:10,  5.95it/s] 67%|██████▋   | 131/195 [00:27<00:10,  5.83it/s] 68%|██████▊   | 133/195 [00:27<00:10,  5.97it/s] 69%|██████▊   | 134/195 [00:28<00:09,  6.30it/s] 69%|██████▉   | 135/195 [00:28<00:09,  6.58it/s] 70%|██████▉   | 136/195 [00:28<00:09,  6.18it/s] 70%|███████   | 137/195 [00:28<00:08,  6.52it/s] 71%|███████   | 138/195 [00:28<00:10,  5.63it/s] 71%|███████▏  | 139/195 [00:28<00:09,  6.10it/s] 72%|███████▏  | 140/195 [00:29<00:10,  5.29it/s] 73%|███████▎  | 142/195 [00:29<00:09,  5.56it/s] 74%|███████▍  | 144/195 [00:29<00:08,  6.09it/s] 75%|███████▍  | 146/195 [00:29<00:07,  6.57it/s] 75%|███████▌  | 147/195 [00:30<00:06,  6.97it/s] 76%|███████▌  | 148/195 [00:30<00:07,  6.27it/s] 76%|███████▋  | 149/195 [00:30<00:07,  6.28it/s] 77%|███████▋  | 150/195 [00:30<00:07,  6.10it/s] 77%|███████▋  | 151/195 [00:30<00:07,  6.22it/s] 78%|███████▊  | 152/195 [00:31<00:07,  5.65it/s] 78%|███████▊  | 153/195 [00:31<00:10,  3.92it/s] 79%|███████▉  | 154/195 [00:31<00:08,  4.74it/s] 79%|███████▉  | 155/195 [00:31<00:08,  4.55it/s] 80%|████████  | 156/195 [00:31<00:07,  5.10it/s] 81%|████████  | 157/195 [00:32<00:07,  4.95it/s] 81%|████████  | 158/195 [00:32<00:06,  5.43it/s] 82%|████████▏ | 159/195 [00:32<00:07,  4.93it/s] 82%|████████▏ | 160/195 [00:32<00:06,  5.39it/s] 83%|████████▎ | 161/195 [00:32<00:06,  5.18it/s] 83%|████████▎ | 162/195 [00:33<00:05,  5.53it/s] 84%|████████▎ | 163/195 [00:33<00:06,  5.06it/s] 85%|████████▍ | 165/195 [00:33<00:05,  5.41it/s] 86%|████████▌ | 167/195 [00:33<00:04,  5.80it/s] 86%|████████▌ | 168/195 [00:34<00:04,  6.02it/s] 87%|████████▋ | 169/195 [00:34<00:04,  5.66it/s] 87%|████████▋ | 170/195 [00:34<00:04,  5.99it/s] 88%|████████▊ | 171/195 [00:34<00:04,  5.21it/s] 89%|████████▊ | 173/195 [00:35<00:04,  5.45it/s] 89%|████████▉ | 174/195 [00:35<00:03,  6.08it/s] 90%|████████▉ | 175/195 [00:35<00:03,  5.09it/s] 90%|█████████ | 176/195 [00:35<00:03,  5.77it/s] 91%|█████████ | 177/195 [00:35<00:03,  5.08it/s] 92%|█████████▏| 179/195 [00:36<00:02,  5.37it/s] 93%|█████████▎| 181/195 [00:36<00:02,  4.89it/s] 93%|█████████▎| 182/195 [00:36<00:02,  4.36it/s] 94%|█████████▍| 184/195 [00:37<00:02,  5.06it/s] 95%|█████████▍| 185/195 [00:37<00:01,  5.47it/s] 95%|█████████▌| 186/195 [00:37<00:01,  5.43it/s] 96%|█████████▌| 187/195 [00:37<00:01,  5.84it/s] 96%|█████████▋| 188/195 [00:37<00:01,  5.71it/s] 97%|█████████▋| 189/195 [00:37<00:00,  6.14it/s] 97%|█████████▋| 190/195 [00:38<00:00,  6.03it/s] 98%|█████████▊| 191/195 [00:38<00:00,  6.46it/s] 98%|█████████▊| 192/195 [00:38<00:00,  5.94it/s] 99%|█████████▉| 194/195 [00:38<00:00,  5.92it/s]100%|██████████| 195/195 [00:41<00:00,  4.73it/s]
2025-09-24 10:35:32 [info     ] Validating outputs
2025-09-24 10:35:32 [info     ] Predict - end                  time=0:0:41
2025-09-24 10:35:32 [info     ] Evaluate - start               split=test
2025-09-24 10:35:32 [info     ] Evaluate - end                 answer_distr=[0.39, 0.21, 0.15, 0.2] correctness_llm=0.85 llm_group_correctness=[0.82, 0.85, 0.77, 0.9, 0.9] monotonicity=0.25
2025-09-24 10:35:32 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:35:32 [info     ] Augmenting questions for IRT estimation num_questions=22
2025-09-24 10:35:32 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:35:32 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1103.43it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3479.12it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 592.09it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7903.13it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1080.57it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3397.47it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 557.10it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7645.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 954.71it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3574.77it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 656.27it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8043.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1151.96it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3803.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 648.91it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8637.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1087.90it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3555.42it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 621.81it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8427.13it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 977.76it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 4303.55it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 623.09it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8827.46it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1012.94it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3659.54it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 556.31it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7909.52it/s]
2025-09-24 10:35:38 INFO: EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
2025-09-24 10:35:38 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:35:38 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:35:38 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:35:38 [info     ] Evaluate question difficulty - end mae=1.67 rmse=2.05 split=test
2025-09-24 10:35:38 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 2 finished: 0:0:56

 ********** Run: 3/3 **********
2025-09-24 10:35:56 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:35:56 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:35:56 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:35:56 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:35:58 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:35:58 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:36:03 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:36:03 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:36:03 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:36:03 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:36:06 [info     ] Setting seed                   value=45
2025-09-24 10:36:06 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 10:36:06 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_dbe_miscons_level_nocontext
2025-09-24 10:36:06 [info     ] Building model                 name=qwen3:0.6b provider=ollama rate_limit=None temp=1.0
2025-09-24 10:36:06 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:00<02:08,  1.51it/s]  1%|          | 2/195 [00:00<01:05,  2.96it/s]  2%|▏         | 3/195 [00:01<01:00,  3.16it/s]  2%|▏         | 4/195 [00:01<00:50,  3.76it/s]  3%|▎         | 5/195 [00:01<01:11,  2.65it/s]  3%|▎         | 6/195 [00:02<00:58,  3.21it/s]  4%|▍         | 8/195 [00:02<00:42,  4.43it/s]  5%|▍         | 9/195 [00:02<00:42,  4.37it/s]  5%|▌         | 10/195 [00:02<00:39,  4.74it/s]  6%|▌         | 11/195 [00:02<00:38,  4.77it/s]  6%|▌         | 12/195 [00:03<00:40,  4.49it/s]  7%|▋         | 13/195 [00:03<00:43,  4.18it/s]  8%|▊         | 15/195 [00:03<00:35,  5.10it/s]  8%|▊         | 16/195 [00:03<00:34,  5.21it/s]  9%|▊         | 17/195 [00:04<00:40,  4.42it/s] 10%|▉         | 19/195 [00:04<00:39,  4.45it/s] 10%|█         | 20/195 [00:04<00:39,  4.41it/s] 11%|█         | 21/195 [00:05<00:39,  4.37it/s] 11%|█▏        | 22/195 [00:05<00:42,  4.08it/s] 12%|█▏        | 24/195 [00:05<00:36,  4.66it/s] 13%|█▎        | 25/195 [00:05<00:31,  5.31it/s] 13%|█▎        | 26/195 [00:06<00:35,  4.75it/s] 14%|█▍        | 27/195 [00:06<00:32,  5.16it/s] 14%|█▍        | 28/195 [00:06<00:34,  4.89it/s] 15%|█▍        | 29/195 [00:06<00:34,  4.86it/s] 15%|█▌        | 30/195 [00:06<00:31,  5.24it/s] 16%|█▌        | 31/195 [00:07<00:33,  4.86it/s] 16%|█▋        | 32/195 [00:07<00:32,  5.08it/s] 17%|█▋        | 33/195 [00:07<00:29,  5.44it/s] 17%|█▋        | 34/195 [00:07<00:33,  4.88it/s] 18%|█▊        | 36/195 [00:08<00:30,  5.13it/s] 19%|█▉        | 37/195 [00:08<00:43,  3.62it/s] 19%|█▉        | 38/195 [00:08<00:41,  3.76it/s] 21%|██        | 40/195 [00:09<00:37,  4.12it/s] 21%|██        | 41/195 [00:09<00:38,  3.99it/s] 22%|██▏       | 43/195 [00:09<00:30,  4.98it/s] 23%|██▎       | 44/195 [00:09<00:27,  5.52it/s] 23%|██▎       | 45/195 [00:10<00:27,  5.49it/s] 24%|██▎       | 46/195 [00:10<00:26,  5.63it/s] 24%|██▍       | 47/195 [00:10<00:26,  5.63it/s] 25%|██▍       | 48/195 [00:10<00:27,  5.39it/s] 25%|██▌       | 49/195 [00:10<00:24,  5.97it/s] 26%|██▌       | 50/195 [00:10<00:25,  5.73it/s] 26%|██▌       | 51/195 [00:11<00:24,  5.92it/s] 27%|██▋       | 52/195 [00:11<00:26,  5.45it/s] 27%|██▋       | 53/195 [00:11<00:25,  5.65it/s] 28%|██▊       | 54/195 [00:11<00:27,  5.06it/s] 29%|██▊       | 56/195 [00:12<00:29,  4.72it/s] 29%|██▉       | 57/195 [00:12<00:25,  5.35it/s] 30%|██▉       | 58/195 [00:12<00:27,  5.06it/s] 30%|███       | 59/195 [00:12<00:25,  5.33it/s] 31%|███       | 60/195 [00:12<00:26,  5.17it/s] 31%|███▏      | 61/195 [00:13<00:24,  5.53it/s] 32%|███▏      | 62/195 [00:13<00:25,  5.29it/s] 32%|███▏      | 63/195 [00:13<00:27,  4.83it/s] 33%|███▎      | 64/195 [00:13<00:25,  5.22it/s] 33%|███▎      | 65/195 [00:13<00:28,  4.58it/s] 34%|███▍      | 67/195 [00:14<00:24,  5.16it/s] 35%|███▌      | 69/195 [00:14<00:21,  5.86it/s] 36%|███▋      | 71/195 [00:14<00:19,  6.28it/s] 37%|███▋      | 72/195 [00:14<00:18,  6.56it/s] 37%|███▋      | 73/195 [00:15<00:19,  6.31it/s] 38%|███▊      | 74/195 [00:15<00:25,  4.73it/s] 39%|███▉      | 76/195 [00:15<00:21,  5.43it/s] 39%|███▉      | 77/195 [00:15<00:20,  5.83it/s] 40%|████      | 78/195 [00:16<00:20,  5.72it/s] 41%|████      | 79/195 [00:16<00:19,  6.10it/s] 41%|████      | 80/195 [00:16<00:20,  5.69it/s] 42%|████▏     | 81/195 [00:16<00:18,  6.08it/s] 42%|████▏     | 82/195 [00:16<00:20,  5.41it/s] 43%|████▎     | 83/195 [00:16<00:18,  5.93it/s] 43%|████▎     | 84/195 [00:17<00:18,  5.89it/s] 44%|████▎     | 85/195 [00:17<00:18,  5.79it/s] 44%|████▍     | 86/195 [00:17<00:20,  5.29it/s] 45%|████▍     | 87/195 [00:17<00:18,  5.72it/s] 45%|████▌     | 88/195 [00:17<00:19,  5.54it/s] 46%|████▌     | 89/195 [00:18<00:19,  5.47it/s] 46%|████▌     | 90/195 [00:18<00:17,  5.97it/s] 47%|████▋     | 91/195 [00:18<00:21,  4.91it/s] 48%|████▊     | 93/195 [00:18<00:18,  5.60it/s] 48%|████▊     | 94/195 [00:19<00:21,  4.62it/s] 49%|████▊     | 95/195 [00:19<00:18,  5.31it/s] 49%|████▉     | 96/195 [00:19<00:21,  4.51it/s] 50%|████▉     | 97/195 [00:20<00:29,  3.36it/s] 50%|█████     | 98/195 [00:20<00:32,  2.99it/s] 51%|█████▏    | 100/195 [00:20<00:25,  3.75it/s] 52%|█████▏    | 102/195 [00:21<00:23,  3.96it/s] 53%|█████▎    | 104/195 [00:21<00:21,  4.23it/s] 54%|█████▍    | 105/195 [00:21<00:18,  4.76it/s] 54%|█████▍    | 106/195 [00:22<00:21,  4.19it/s] 55%|█████▍    | 107/195 [00:22<00:18,  4.80it/s] 55%|█████▌    | 108/195 [00:22<00:19,  4.43it/s] 56%|█████▌    | 109/195 [00:22<00:17,  4.90it/s] 56%|█████▋    | 110/195 [00:22<00:19,  4.45it/s] 57%|█████▋    | 112/195 [00:23<00:18,  4.49it/s] 58%|█████▊    | 113/195 [00:23<00:16,  5.06it/s] 58%|█████▊    | 114/195 [00:23<00:17,  4.63it/s] 59%|█████▉    | 116/195 [00:24<00:15,  5.03it/s] 60%|██████    | 117/195 [00:24<00:13,  5.65it/s] 61%|██████    | 118/195 [00:24<00:15,  5.03it/s] 61%|██████    | 119/195 [00:24<00:13,  5.74it/s] 62%|██████▏   | 120/195 [00:24<00:14,  5.26it/s] 63%|██████▎   | 122/195 [00:25<00:12,  5.87it/s] 63%|██████▎   | 123/195 [00:25<00:11,  6.27it/s] 64%|██████▎   | 124/195 [00:25<00:12,  5.66it/s] 65%|██████▍   | 126/195 [00:25<00:10,  6.56it/s] 65%|██████▌   | 127/195 [00:25<00:10,  6.78it/s] 66%|██████▌   | 128/195 [00:26<00:10,  6.19it/s] 67%|██████▋   | 130/195 [00:26<00:11,  5.62it/s] 67%|██████▋   | 131/195 [00:26<00:10,  6.19it/s] 68%|██████▊   | 132/195 [00:26<00:11,  5.62it/s] 68%|██████▊   | 133/195 [00:26<00:10,  5.95it/s] 69%|██████▊   | 134/195 [00:27<00:12,  5.00it/s] 70%|██████▉   | 136/195 [00:27<00:11,  5.14it/s] 71%|███████   | 138/195 [00:27<00:10,  5.42it/s] 72%|███████▏  | 140/195 [00:28<00:10,  5.41it/s] 72%|███████▏  | 141/195 [00:28<00:09,  5.60it/s] 73%|███████▎  | 142/195 [00:28<00:10,  5.03it/s] 73%|███████▎  | 143/195 [00:28<00:09,  5.39it/s] 74%|███████▍  | 144/195 [00:29<00:09,  5.21it/s] 74%|███████▍  | 145/195 [00:29<00:09,  5.55it/s] 75%|███████▍  | 146/195 [00:29<00:09,  4.94it/s] 76%|███████▌  | 148/195 [00:29<00:08,  5.31it/s] 77%|███████▋  | 150/195 [00:30<00:07,  5.91it/s] 77%|███████▋  | 151/195 [00:30<00:07,  6.22it/s] 78%|███████▊  | 152/195 [00:30<00:07,  6.01it/s] 78%|███████▊  | 153/195 [00:30<00:06,  6.30it/s] 79%|███████▉  | 154/195 [00:30<00:06,  5.92it/s] 79%|███████▉  | 155/195 [00:30<00:06,  6.27it/s] 80%|████████  | 156/195 [00:31<00:07,  5.37it/s] 81%|████████  | 157/195 [00:31<00:06,  5.70it/s] 81%|████████  | 158/195 [00:31<00:06,  5.50it/s] 82%|████████▏ | 159/195 [00:31<00:06,  5.91it/s] 82%|████████▏ | 160/195 [00:31<00:06,  5.61it/s] 83%|████████▎ | 161/195 [00:32<00:06,  5.46it/s] 83%|████████▎ | 162/195 [00:32<00:07,  4.19it/s] 84%|████████▍ | 164/195 [00:32<00:06,  4.45it/s] 85%|████████▍ | 165/195 [00:33<00:07,  3.96it/s] 85%|████████▌ | 166/195 [00:33<00:06,  4.28it/s] 86%|████████▌ | 167/195 [00:33<00:06,  4.44it/s] 86%|████████▌ | 168/195 [00:33<00:05,  4.56it/s] 87%|████████▋ | 169/195 [00:33<00:05,  4.61it/s] 87%|████████▋ | 170/195 [00:34<00:04,  5.03it/s] 88%|████████▊ | 171/195 [00:34<00:05,  4.14it/s] 88%|████████▊ | 172/195 [00:34<00:05,  3.90it/s] 89%|████████▉ | 174/195 [00:35<00:04,  4.58it/s] 90%|████████▉ | 175/195 [00:35<00:03,  5.11it/s] 90%|█████████ | 176/195 [00:35<00:03,  5.03it/s] 91%|█████████ | 177/195 [00:35<00:03,  5.52it/s] 91%|█████████▏| 178/195 [00:35<00:03,  5.36it/s] 92%|█████████▏| 179/195 [00:35<00:02,  5.70it/s] 92%|█████████▏| 180/195 [00:36<00:02,  5.08it/s] 93%|█████████▎| 182/195 [00:36<00:02,  5.40it/s] 94%|█████████▍| 183/195 [00:36<00:01,  6.06it/s] 94%|█████████▍| 184/195 [00:36<00:02,  5.39it/s] 95%|█████████▍| 185/195 [00:36<00:01,  6.06it/s] 95%|█████████▌| 186/195 [00:37<00:01,  4.80it/s] 96%|█████████▌| 187/195 [00:37<00:01,  5.36it/s] 96%|█████████▋| 188/195 [00:37<00:01,  4.71it/s] 97%|█████████▋| 189/195 [00:37<00:01,  5.56it/s] 97%|█████████▋| 190/195 [00:37<00:00,  5.25it/s] 98%|█████████▊| 191/195 [00:38<00:00,  5.64it/s] 98%|█████████▊| 192/195 [00:38<00:00,  5.13it/s] 99%|█████████▉| 193/195 [00:38<00:00,  5.31it/s] 99%|█████████▉| 194/195 [00:38<00:00,  5.69it/s]100%|██████████| 195/195 [00:38<00:00,  6.19it/s]100%|██████████| 195/195 [00:41<00:00,  4.76it/s]
2025-09-24 10:36:47 [info     ] Validating outputs
2025-09-24 10:36:47 [info     ] Predict - end                  time=0:0:41
2025-09-24 10:36:47 [info     ] Evaluate - start               split=test
2025-09-24 10:36:47 [info     ] Evaluate - end                 answer_distr=[0.43, 0.2, 0.14, 0.18] correctness_llm=0.87 llm_group_correctness=[0.9, 0.92, 0.85, 0.87, 0.79] monotonicity=-1.33
2025-09-24 10:36:47 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:36:47 [info     ] Augmenting questions for IRT estimation num_questions=28
2025-09-24 10:36:47 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:36:47 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1301.65it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3303.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 470.64it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8712.20it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1066.87it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3537.12it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 611.65it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8502.79it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 721.73it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3685.26it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 630.65it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7543.71it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1008.84it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3768.47it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 663.03it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7486.01it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1041.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3559.60it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 619.88it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7329.04it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1041.25it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3713.71it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 607.99it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7312.61it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 928.32it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3439.62it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 625.03it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7292.63it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 920.18it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3486.83it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 644.23it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7296.25it/s]
2025-09-24 10:36:54 INFO: EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
EM converged at iteration 8.
2025-09-24 10:36:54 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:36:54 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:36:54 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:36:54 [info     ] Evaluate question difficulty - end mae=1.63 rmse=2.04 split=test
2025-09-24 10:36:54 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 3 finished: 0:0:57

 ========== Config: qwen3:4b~T_1.0~SO_student_bool_nocontext~L_5~SP_student_dbe_miscons_level_nocontext~SS_proficiency_5_str~EFQ_quotes~EFI_quotes~ES_both_cfe_studentlevel_random0 ==========
Config 16/16

 ********** Run: 1/3 **********
2025-09-24 10:37:11 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:37:11 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:37:11 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:37:11 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:37:13 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:37:13 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:37:17 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:37:17 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:37:17 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:37:18 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:37:21 [info     ] Setting seed                   value=43
2025-09-24 10:37:21 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 10:37:21 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_dbe_miscons_level_nocontext
2025-09-24 10:37:21 [info     ] Building model                 name=qwen3:4b provider=ollama rate_limit=None temp=1.0
2025-09-24 10:37:21 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:02<09:17,  2.87s/it]  1%|          | 2/195 [00:03<04:42,  1.47s/it]  2%|▏         | 3/195 [00:03<03:25,  1.07s/it]  2%|▏         | 4/195 [00:04<02:36,  1.22it/s]  3%|▎         | 5/195 [00:04<02:09,  1.46it/s]  4%|▎         | 7/195 [00:05<01:48,  1.73it/s]  5%|▍         | 9/195 [00:06<01:25,  2.19it/s]  5%|▌         | 10/195 [00:06<01:14,  2.50it/s]  6%|▌         | 11/195 [00:06<01:11,  2.57it/s]  6%|▌         | 12/195 [00:07<01:30,  2.02it/s]  7%|▋         | 13/195 [00:08<01:35,  1.91it/s]  7%|▋         | 14/195 [00:08<01:27,  2.07it/s]  8%|▊         | 15/195 [00:09<01:23,  2.14it/s]  9%|▊         | 17/195 [00:09<01:06,  2.67it/s] 10%|▉         | 19/195 [00:10<00:54,  3.21it/s] 11%|█         | 21/195 [00:10<01:02,  2.79it/s] 11%|█▏        | 22/195 [00:11<01:04,  2.68it/s] 12%|█▏        | 23/195 [00:11<00:56,  3.02it/s] 12%|█▏        | 24/195 [00:11<00:56,  3.05it/s] 13%|█▎        | 25/195 [00:12<00:50,  3.37it/s] 13%|█▎        | 26/195 [00:12<00:47,  3.59it/s] 14%|█▍        | 27/195 [00:12<00:42,  3.93it/s] 14%|█▍        | 28/195 [00:12<00:43,  3.87it/s] 15%|█▍        | 29/195 [00:12<00:39,  4.16it/s] 15%|█▌        | 30/195 [00:13<00:41,  3.93it/s] 16%|█▌        | 31/195 [00:13<00:39,  4.16it/s] 16%|█▋        | 32/195 [00:13<00:43,  3.71it/s] 17%|█▋        | 33/195 [00:14<00:41,  3.91it/s] 17%|█▋        | 34/195 [00:14<00:42,  3.81it/s] 18%|█▊        | 35/195 [00:14<00:39,  4.03it/s] 18%|█▊        | 36/195 [00:14<00:40,  3.92it/s] 19%|█▉        | 37/195 [00:15<00:37,  4.22it/s] 19%|█▉        | 38/195 [00:15<00:48,  3.27it/s] 20%|██        | 39/195 [00:15<00:56,  2.76it/s] 21%|██        | 40/195 [00:16<00:47,  3.26it/s] 21%|██        | 41/195 [00:16<00:52,  2.95it/s] 22%|██▏       | 42/195 [00:16<00:43,  3.52it/s] 22%|██▏       | 43/195 [00:17<00:47,  3.22it/s] 23%|██▎       | 44/195 [00:17<00:39,  3.80it/s] 23%|██▎       | 45/195 [00:17<00:43,  3.46it/s] 24%|██▎       | 46/195 [00:17<00:35,  4.14it/s] 24%|██▍       | 47/195 [00:18<00:39,  3.76it/s] 25%|██▌       | 49/195 [00:18<00:36,  3.98it/s] 26%|██▌       | 51/195 [00:19<00:42,  3.41it/s] 27%|██▋       | 52/195 [00:19<00:50,  2.83it/s] 28%|██▊       | 54/195 [00:20<00:49,  2.88it/s] 28%|██▊       | 55/195 [00:20<00:44,  3.15it/s] 29%|██▊       | 56/195 [00:21<00:45,  3.02it/s] 29%|██▉       | 57/195 [00:21<00:58,  2.35it/s] 30%|██▉       | 58/195 [00:22<00:54,  2.50it/s] 30%|███       | 59/195 [00:22<01:00,  2.26it/s] 31%|███       | 60/195 [00:22<00:56,  2.38it/s] 31%|███▏      | 61/195 [00:23<00:58,  2.28it/s] 32%|███▏      | 62/195 [00:23<00:47,  2.77it/s] 32%|███▏      | 63/195 [00:24<00:48,  2.70it/s] 33%|███▎      | 64/195 [00:24<00:40,  3.24it/s] 33%|███▎      | 65/195 [00:24<00:42,  3.05it/s] 34%|███▍      | 66/195 [00:24<00:36,  3.51it/s] 34%|███▍      | 67/195 [00:25<00:39,  3.24it/s] 35%|███▍      | 68/195 [00:25<00:32,  3.86it/s] 35%|███▌      | 69/195 [00:25<00:36,  3.42it/s] 36%|███▌      | 70/195 [00:25<00:30,  4.07it/s] 36%|███▋      | 71/195 [00:26<00:34,  3.55it/s] 37%|███▋      | 72/195 [00:26<00:28,  4.30it/s] 37%|███▋      | 73/195 [00:26<00:31,  3.87it/s] 38%|███▊      | 74/195 [00:27<00:37,  3.23it/s] 38%|███▊      | 75/195 [00:27<00:35,  3.36it/s] 39%|███▉      | 76/195 [00:27<00:34,  3.48it/s] 39%|███▉      | 77/195 [00:28<00:53,  2.22it/s] 40%|████      | 78/195 [00:28<00:44,  2.60it/s] 41%|████      | 79/195 [00:28<00:38,  2.98it/s] 41%|████      | 80/195 [00:29<00:34,  3.32it/s] 42%|████▏     | 81/195 [00:29<00:33,  3.37it/s] 42%|████▏     | 82/195 [00:29<00:30,  3.76it/s] 43%|████▎     | 83/195 [00:29<00:30,  3.69it/s] 43%|████▎     | 84/195 [00:29<00:27,  4.09it/s] 44%|████▎     | 85/195 [00:30<00:27,  3.94it/s] 44%|████▍     | 86/195 [00:30<00:25,  4.23it/s] 45%|████▍     | 87/195 [00:30<00:26,  4.04it/s] 45%|████▌     | 88/195 [00:30<00:24,  4.44it/s] 46%|████▌     | 89/195 [00:31<00:25,  4.10it/s] 46%|████▌     | 90/195 [00:31<00:30,  3.46it/s] 47%|████▋     | 91/195 [00:31<00:32,  3.19it/s] 47%|████▋     | 92/195 [00:32<00:26,  3.91it/s] 48%|████▊     | 93/195 [00:32<00:28,  3.55it/s] 49%|████▊     | 95/195 [00:32<00:25,  3.91it/s] 49%|████▉     | 96/195 [00:33<00:23,  4.14it/s] 50%|████▉     | 97/195 [00:33<00:25,  3.90it/s] 50%|█████     | 98/195 [00:33<00:22,  4.27it/s] 51%|█████     | 99/195 [00:33<00:23,  4.05it/s] 51%|█████▏    | 100/195 [00:34<00:25,  3.76it/s] 52%|█████▏    | 101/195 [00:34<00:28,  3.26it/s] 52%|█████▏    | 102/195 [00:34<00:31,  2.96it/s] 53%|█████▎    | 103/195 [00:35<00:32,  2.87it/s] 53%|█████▎    | 104/195 [00:35<00:30,  2.96it/s] 54%|█████▍    | 105/195 [00:36<00:38,  2.31it/s] 54%|█████▍    | 106/195 [00:36<00:35,  2.50it/s] 55%|█████▍    | 107/195 [00:37<00:36,  2.38it/s] 55%|█████▌    | 108/195 [00:37<00:33,  2.62it/s] 56%|█████▌    | 109/195 [00:37<00:34,  2.49it/s] 57%|█████▋    | 111/195 [00:38<00:29,  2.82it/s] 57%|█████▋    | 112/195 [00:38<00:27,  2.98it/s] 58%|█████▊    | 113/195 [00:39<00:28,  2.87it/s] 58%|█████▊    | 114/195 [00:39<00:27,  2.95it/s] 59%|█████▉    | 115/195 [00:39<00:30,  2.59it/s] 59%|█████▉    | 116/195 [00:40<00:36,  2.16it/s] 60%|██████    | 117/195 [00:40<00:34,  2.24it/s] 61%|██████    | 118/195 [00:41<00:31,  2.46it/s] 61%|██████    | 119/195 [00:41<00:32,  2.37it/s] 62%|██████▏   | 120/195 [00:41<00:27,  2.73it/s] 62%|██████▏   | 121/195 [00:42<00:29,  2.52it/s] 63%|██████▎   | 122/195 [00:42<00:31,  2.31it/s] 63%|██████▎   | 123/195 [00:43<00:30,  2.35it/s] 64%|██████▎   | 124/195 [00:43<00:30,  2.31it/s] 64%|██████▍   | 125/195 [00:44<00:30,  2.30it/s] 65%|██████▍   | 126/195 [00:44<00:28,  2.40it/s] 65%|██████▌   | 127/195 [00:44<00:23,  2.89it/s] 66%|██████▌   | 128/195 [00:45<00:23,  2.85it/s] 66%|██████▌   | 129/195 [00:45<00:25,  2.63it/s] 67%|██████▋   | 130/195 [00:46<00:24,  2.65it/s] 67%|██████▋   | 131/195 [00:46<00:27,  2.36it/s] 68%|██████▊   | 132/195 [00:46<00:22,  2.85it/s] 68%|██████▊   | 133/195 [00:47<00:22,  2.74it/s] 69%|██████▊   | 134/195 [00:47<00:23,  2.62it/s] 70%|██████▉   | 136/195 [00:48<00:19,  3.07it/s] 70%|███████   | 137/195 [00:48<00:20,  2.83it/s] 71%|███████▏  | 139/195 [00:48<00:16,  3.43it/s] 72%|███████▏  | 140/195 [00:49<00:15,  3.55it/s] 72%|███████▏  | 141/195 [00:49<00:15,  3.53it/s] 73%|███████▎  | 142/195 [00:49<00:13,  4.02it/s] 73%|███████▎  | 143/195 [00:49<00:14,  3.64it/s] 74%|███████▍  | 145/195 [00:50<00:13,  3.58it/s] 75%|███████▍  | 146/195 [00:50<00:14,  3.29it/s] 75%|███████▌  | 147/195 [00:51<00:12,  3.80it/s] 76%|███████▌  | 148/195 [00:51<00:19,  2.47it/s] 76%|███████▋  | 149/195 [00:51<00:15,  3.03it/s] 77%|███████▋  | 150/195 [00:52<00:16,  2.73it/s] 77%|███████▋  | 151/195 [00:52<00:16,  2.62it/s] 78%|███████▊  | 152/195 [00:53<00:13,  3.10it/s] 78%|███████▊  | 153/195 [00:53<00:14,  2.91it/s] 79%|███████▉  | 154/195 [00:53<00:11,  3.47it/s] 79%|███████▉  | 155/195 [00:54<00:14,  2.84it/s] 80%|████████  | 156/195 [00:54<00:14,  2.66it/s] 81%|████████  | 158/195 [00:54<00:10,  3.39it/s] 82%|████████▏ | 159/195 [00:55<00:09,  3.62it/s] 82%|████████▏ | 160/195 [00:55<00:09,  3.53it/s] 83%|████████▎ | 161/195 [00:55<00:08,  3.80it/s] 83%|████████▎ | 162/195 [00:55<00:09,  3.65it/s] 84%|████████▎ | 163/195 [00:56<00:08,  3.60it/s] 84%|████████▍ | 164/195 [00:56<00:07,  4.07it/s] 85%|████████▍ | 165/195 [00:56<00:08,  3.57it/s] 85%|████████▌ | 166/195 [00:56<00:07,  3.82it/s] 86%|████████▌ | 167/195 [00:57<00:07,  3.63it/s] 86%|████████▌ | 168/195 [00:57<00:07,  3.70it/s] 87%|████████▋ | 169/195 [00:57<00:08,  3.17it/s] 87%|████████▋ | 170/195 [00:58<00:08,  2.81it/s] 88%|████████▊ | 172/195 [00:59<00:09,  2.51it/s] 89%|████████▊ | 173/195 [00:59<00:07,  2.98it/s] 89%|████████▉ | 174/195 [00:59<00:06,  3.08it/s] 90%|████████▉ | 175/195 [00:59<00:05,  3.47it/s] 90%|█████████ | 176/195 [01:00<00:06,  2.89it/s] 91%|█████████ | 177/195 [01:00<00:06,  2.90it/s] 92%|█████████▏| 179/195 [01:01<00:05,  3.16it/s] 92%|█████████▏| 180/195 [01:01<00:04,  3.03it/s] 93%|█████████▎| 182/195 [01:02<00:03,  3.35it/s] 94%|█████████▍| 183/195 [01:02<00:03,  3.12it/s] 95%|█████████▍| 185/195 [01:03<00:02,  3.46it/s] 95%|█████████▌| 186/195 [01:03<00:02,  3.26it/s] 96%|█████████▌| 187/195 [01:03<00:02,  3.69it/s] 96%|█████████▋| 188/195 [01:03<00:01,  3.67it/s] 97%|█████████▋| 189/195 [01:04<00:01,  3.36it/s] 97%|█████████▋| 190/195 [01:04<00:01,  3.13it/s] 98%|█████████▊| 191/195 [01:04<00:01,  3.70it/s] 98%|█████████▊| 192/195 [01:05<00:00,  3.45it/s] 99%|█████████▉| 193/195 [01:05<00:00,  4.05it/s] 99%|█████████▉| 194/195 [01:05<00:00,  3.65it/s]100%|██████████| 195/195 [01:05<00:00,  4.38it/s]100%|██████████| 195/195 [01:07<00:00,  2.87it/s]
2025-09-24 10:38:29 [info     ] Validating outputs
2025-09-24 10:38:29 [info     ] Predict - end                  time=0:1:7
2025-09-24 10:38:29 [info     ] Evaluate - start               split=test
2025-09-24 10:38:29 [info     ] Evaluate - end                 answer_distr=[0.24, 0.14, 0.14, 0.23] correctness_llm=0.66 llm_group_correctness=[0.51, 0.77, 0.67, 0.59, 0.74] monotonicity=-0.13
2025-09-24 10:38:29 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:38:29 [info     ] Augmenting questions for IRT estimation num_questions=13
2025-09-24 10:38:29 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:38:29 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1053.32it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3552.64it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 551.28it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7781.64it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1084.32it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3508.07it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 541.35it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7915.91it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1011.27it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3651.29it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 531.96it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7557.30it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1078.07it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3634.82it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 651.69it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8048.28it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1163.84it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3698.01it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 624.42it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8785.20it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1066.09it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3505.29it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 737.51it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7875.57it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1020.51it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3383.34it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 558.78it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 7545.65it/s]
2025-09-24 10:38:35 INFO: EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
EM converged at iteration 7.
2025-09-24 10:38:35 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:38:35 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:38:35 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:38:35 [info     ] Evaluate question difficulty - end mae=1.91 rmse=2.39 split=test
2025-09-24 10:38:35 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 1 finished: 0:1:23

 ********** Run: 2/3 **********
2025-09-24 10:38:52 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:38:52 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:38:52 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:38:52 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:38:54 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:38:54 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:38:59 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:38:59 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:38:59 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:38:59 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:39:03 [info     ] Setting seed                   value=44
2025-09-24 10:39:03 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 10:39:03 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_dbe_miscons_level_nocontext
2025-09-24 10:39:03 [info     ] Building model                 name=qwen3:4b provider=ollama rate_limit=None temp=1.0
2025-09-24 10:39:03 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<04:14,  1.31s/it]  1%|          | 2/195 [00:02<03:29,  1.08s/it]  2%|▏         | 3/195 [00:03<03:21,  1.05s/it]  3%|▎         | 5/195 [00:03<02:02,  1.55it/s]  4%|▎         | 7/195 [00:04<01:44,  1.80it/s]  5%|▍         | 9/195 [00:05<01:18,  2.38it/s]  5%|▌         | 10/195 [00:05<01:06,  2.78it/s]  6%|▌         | 11/195 [00:06<01:18,  2.34it/s]  6%|▌         | 12/195 [00:06<01:11,  2.57it/s]  7%|▋         | 13/195 [00:06<01:03,  2.86it/s]  7%|▋         | 14/195 [00:06<00:56,  3.19it/s]  8%|▊         | 15/195 [00:07<00:55,  3.23it/s]  9%|▊         | 17/195 [00:07<00:47,  3.75it/s] 10%|▉         | 19/195 [00:07<00:42,  4.14it/s] 11%|█         | 21/195 [00:08<00:40,  4.30it/s] 11%|█▏        | 22/195 [00:08<00:37,  4.58it/s] 12%|█▏        | 23/195 [00:08<00:41,  4.16it/s] 12%|█▏        | 24/195 [00:08<00:38,  4.44it/s] 13%|█▎        | 25/195 [00:09<00:49,  3.43it/s] 13%|█▎        | 26/195 [00:09<00:55,  3.06it/s] 14%|█▍        | 28/195 [00:10<00:48,  3.42it/s] 15%|█▌        | 30/195 [00:10<00:44,  3.75it/s] 16%|█▌        | 31/195 [00:11<00:41,  3.92it/s] 16%|█▋        | 32/195 [00:11<00:44,  3.69it/s] 17%|█▋        | 33/195 [00:11<00:41,  3.93it/s] 17%|█▋        | 34/195 [00:11<00:45,  3.53it/s] 18%|█▊        | 36/195 [00:12<00:42,  3.78it/s] 19%|█▉        | 37/195 [00:12<00:37,  4.25it/s] 19%|█▉        | 38/195 [00:12<00:39,  3.93it/s] 20%|██        | 39/195 [00:13<00:46,  3.34it/s] 21%|██        | 40/195 [00:13<00:50,  3.10it/s] 21%|██        | 41/195 [00:13<00:42,  3.66it/s] 22%|██▏       | 42/195 [00:14<00:41,  3.66it/s] 22%|██▏       | 43/195 [00:14<00:36,  4.14it/s] 23%|██▎       | 44/195 [00:14<00:38,  3.95it/s] 23%|██▎       | 45/195 [00:14<00:35,  4.18it/s] 24%|██▎       | 46/195 [00:14<00:36,  4.03it/s] 24%|██▍       | 47/195 [00:15<00:34,  4.33it/s] 25%|██▍       | 48/195 [00:15<00:38,  3.77it/s] 25%|██▌       | 49/195 [00:15<00:35,  4.10it/s] 26%|██▌       | 50/195 [00:16<01:02,  2.30it/s] 26%|██▌       | 51/195 [00:16<00:54,  2.66it/s] 27%|██▋       | 52/195 [00:17<00:57,  2.49it/s] 27%|██▋       | 53/195 [00:18<01:12,  1.96it/s] 28%|██▊       | 54/195 [00:18<01:09,  2.03it/s] 28%|██▊       | 55/195 [00:19<01:13,  1.91it/s] 29%|██▊       | 56/195 [00:19<01:05,  2.14it/s] 29%|██▉       | 57/195 [00:19<00:57,  2.38it/s] 30%|██▉       | 58/195 [00:20<00:50,  2.69it/s] 30%|███       | 59/195 [00:20<00:54,  2.50it/s] 31%|███▏      | 61/195 [00:20<00:44,  3.02it/s] 32%|███▏      | 63/195 [00:21<00:39,  3.38it/s] 33%|███▎      | 64/195 [00:21<00:33,  3.88it/s] 33%|███▎      | 65/195 [00:22<00:38,  3.41it/s] 34%|███▍      | 66/195 [00:22<00:32,  4.00it/s] 34%|███▍      | 67/195 [00:22<00:32,  3.94it/s] 35%|███▍      | 68/195 [00:22<00:36,  3.50it/s] 35%|███▌      | 69/195 [00:23<00:35,  3.60it/s] 36%|███▌      | 70/195 [00:23<00:35,  3.51it/s] 36%|███▋      | 71/195 [00:23<00:35,  3.53it/s] 37%|███▋      | 72/195 [00:23<00:35,  3.50it/s] 37%|███▋      | 73/195 [00:24<00:39,  3.08it/s] 38%|███▊      | 74/195 [00:24<00:35,  3.36it/s] 38%|███▊      | 75/195 [00:24<00:32,  3.71it/s] 39%|███▉      | 76/195 [00:24<00:30,  3.88it/s] 39%|███▉      | 77/195 [00:25<00:31,  3.70it/s] 40%|████      | 78/195 [00:25<00:37,  3.12it/s] 41%|████      | 79/195 [00:26<00:42,  2.73it/s] 42%|████▏     | 81/195 [00:26<00:35,  3.18it/s] 43%|████▎     | 83/195 [00:27<00:32,  3.44it/s] 43%|████▎     | 84/195 [00:27<00:28,  3.90it/s] 44%|████▎     | 85/195 [00:27<00:31,  3.52it/s] 44%|████▍     | 86/195 [00:27<00:28,  3.87it/s] 45%|████▍     | 87/195 [00:28<00:32,  3.35it/s] 46%|████▌     | 89/195 [00:28<00:30,  3.52it/s] 46%|████▌     | 90/195 [00:28<00:26,  3.96it/s] 47%|████▋     | 91/195 [00:29<00:28,  3.69it/s] 47%|████▋     | 92/195 [00:29<00:26,  3.86it/s] 48%|████▊     | 93/195 [00:29<00:26,  3.85it/s] 48%|████▊     | 94/195 [00:30<00:28,  3.55it/s] 49%|████▊     | 95/195 [00:30<00:25,  3.88it/s] 49%|████▉     | 96/195 [00:30<00:26,  3.77it/s] 50%|████▉     | 97/195 [00:30<00:24,  4.04it/s] 50%|█████     | 98/195 [00:31<00:25,  3.80it/s] 51%|█████     | 99/195 [00:31<00:23,  4.08it/s] 51%|█████▏    | 100/195 [00:31<00:29,  3.17it/s] 52%|█████▏    | 101/195 [00:32<00:30,  3.06it/s] 52%|█████▏    | 102/195 [00:32<00:27,  3.38it/s] 53%|█████▎    | 103/195 [00:32<00:34,  2.69it/s] 53%|█████▎    | 104/195 [00:33<00:36,  2.49it/s] 54%|█████▍    | 105/195 [00:33<00:30,  2.93it/s] 54%|█████▍    | 106/195 [00:34<00:32,  2.77it/s] 55%|█████▍    | 107/195 [00:34<00:29,  2.94it/s] 55%|█████▌    | 108/195 [00:34<00:29,  2.91it/s] 56%|█████▌    | 109/195 [00:35<00:30,  2.84it/s] 56%|█████▋    | 110/195 [00:35<00:28,  2.98it/s] 57%|█████▋    | 111/195 [00:35<00:29,  2.89it/s] 57%|█████▋    | 112/195 [00:35<00:27,  3.03it/s] 58%|█████▊    | 113/195 [00:36<00:27,  3.02it/s] 58%|█████▊    | 114/195 [00:36<00:26,  3.06it/s] 59%|█████▉    | 115/195 [00:37<00:32,  2.44it/s] 59%|█████▉    | 116/195 [00:37<00:33,  2.37it/s] 61%|██████    | 118/195 [00:38<00:30,  2.56it/s] 61%|██████    | 119/195 [00:38<00:27,  2.73it/s] 62%|██████▏   | 120/195 [00:39<00:37,  2.02it/s] 62%|██████▏   | 121/195 [00:39<00:29,  2.50it/s] 63%|██████▎   | 122/195 [00:40<00:28,  2.55it/s] 63%|██████▎   | 123/195 [00:40<00:23,  3.09it/s] 64%|██████▎   | 124/195 [00:40<00:23,  3.06it/s] 64%|██████▍   | 125/195 [00:41<00:29,  2.34it/s] 65%|██████▍   | 126/195 [00:41<00:26,  2.62it/s] 65%|██████▌   | 127/195 [00:41<00:22,  3.02it/s] 66%|██████▌   | 128/195 [00:42<00:31,  2.14it/s] 66%|██████▌   | 129/195 [00:42<00:25,  2.55it/s] 67%|██████▋   | 130/195 [00:43<00:23,  2.78it/s] 67%|██████▋   | 131/195 [00:43<00:21,  2.96it/s] 68%|██████▊   | 132/195 [00:43<00:26,  2.35it/s] 68%|██████▊   | 133/195 [00:44<00:24,  2.54it/s] 69%|██████▊   | 134/195 [00:44<00:20,  2.91it/s] 69%|██████▉   | 135/195 [00:44<00:20,  2.95it/s] 70%|██████▉   | 136/195 [00:44<00:17,  3.42it/s] 70%|███████   | 137/195 [00:45<00:20,  2.89it/s] 71%|███████   | 138/195 [00:45<00:21,  2.63it/s] 71%|███████▏  | 139/195 [00:46<00:22,  2.54it/s] 72%|███████▏  | 140/195 [00:46<00:16,  3.26it/s] 72%|███████▏  | 141/195 [00:46<00:18,  2.93it/s] 73%|███████▎  | 143/195 [00:47<00:15,  3.35it/s] 74%|███████▍  | 144/195 [00:47<00:13,  3.88it/s] 74%|███████▍  | 145/195 [00:48<00:21,  2.30it/s] 75%|███████▍  | 146/195 [00:48<00:18,  2.69it/s] 75%|███████▌  | 147/195 [00:48<00:17,  2.79it/s] 76%|███████▌  | 148/195 [00:49<00:14,  3.19it/s] 76%|███████▋  | 149/195 [00:49<00:16,  2.80it/s] 77%|███████▋  | 150/195 [00:50<00:16,  2.69it/s] 77%|███████▋  | 151/195 [00:50<00:13,  3.17it/s] 78%|███████▊  | 152/195 [00:50<00:14,  2.97it/s] 78%|███████▊  | 153/195 [00:50<00:12,  3.48it/s] 79%|███████▉  | 154/195 [00:51<00:13,  3.10it/s] 79%|███████▉  | 155/195 [00:51<00:14,  2.78it/s] 80%|████████  | 156/195 [00:51<00:12,  3.12it/s] 81%|████████  | 157/195 [00:52<00:11,  3.43it/s] 81%|████████  | 158/195 [00:52<00:10,  3.50it/s] 82%|████████▏ | 159/195 [00:52<00:09,  3.81it/s] 82%|████████▏ | 160/195 [00:52<00:09,  3.82it/s] 83%|████████▎ | 161/195 [00:53<00:08,  3.99it/s] 83%|████████▎ | 162/195 [00:53<00:08,  3.95it/s] 84%|████████▎ | 163/195 [00:53<00:07,  4.19it/s] 84%|████████▍ | 164/195 [00:53<00:08,  3.64it/s] 85%|████████▍ | 165/195 [00:54<00:07,  3.83it/s] 85%|████████▌ | 166/195 [00:54<00:10,  2.76it/s] 86%|████████▌ | 167/195 [00:55<00:09,  2.84it/s] 86%|████████▌ | 168/195 [00:55<00:08,  3.12it/s] 87%|████████▋ | 169/195 [00:55<00:08,  3.01it/s] 87%|████████▋ | 170/195 [00:55<00:06,  3.60it/s] 88%|████████▊ | 171/195 [00:56<00:08,  2.99it/s] 89%|████████▊ | 173/195 [00:56<00:05,  3.68it/s] 89%|████████▉ | 174/195 [00:56<00:05,  4.19it/s] 90%|████████▉ | 175/195 [00:57<00:05,  3.79it/s] 90%|█████████ | 176/195 [00:57<00:04,  4.30it/s] 91%|█████████ | 177/195 [00:57<00:04,  3.96it/s] 91%|█████████▏| 178/195 [00:58<00:05,  3.10it/s] 92%|█████████▏| 179/195 [00:58<00:04,  3.45it/s] 92%|█████████▏| 180/195 [00:58<00:04,  3.49it/s] 93%|█████████▎| 181/195 [00:58<00:04,  3.50it/s] 93%|█████████▎| 182/195 [00:59<00:03,  3.76it/s] 94%|█████████▍| 183/195 [00:59<00:03,  3.09it/s] 94%|█████████▍| 184/195 [00:59<00:04,  2.75it/s] 95%|█████████▌| 186/195 [01:00<00:02,  3.33it/s] 96%|█████████▋| 188/195 [01:00<00:01,  3.82it/s] 97%|█████████▋| 189/195 [01:01<00:02,  2.87it/s] 97%|█████████▋| 190/195 [01:01<00:01,  3.07it/s] 98%|█████████▊| 191/195 [01:01<00:01,  3.35it/s] 98%|█████████▊| 192/195 [01:02<00:00,  3.40it/s] 99%|█████████▉| 193/195 [01:02<00:00,  3.61it/s] 99%|█████████▉| 194/195 [01:02<00:00,  3.67it/s]100%|██████████| 195/195 [01:02<00:00,  4.19it/s]100%|██████████| 195/195 [01:05<00:00,  2.98it/s]
2025-09-24 10:40:08 [info     ] Validating outputs
2025-09-24 10:40:08 [info     ] Predict - end                  time=0:1:5
2025-09-24 10:40:08 [info     ] Evaluate - start               split=test
2025-09-24 10:40:08 [info     ] Evaluate - end                 answer_distr=[0.25, 0.14, 0.16, 0.22] correctness_llm=0.65 llm_group_correctness=[0.62, 0.67, 0.67, 0.69, 0.62] monotonicity=-0.04
2025-09-24 10:40:08 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:40:08 [info     ] Augmenting questions for IRT estimation num_questions=13
2025-09-24 10:40:08 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:40:08 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1239.45it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3673.27it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 542.21it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5709.87it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1060.05it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3657.74it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 564.64it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5872.03it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 938.89it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3650.31it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 612.76it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5544.88it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1057.15it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3719.62it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 664.03it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5613.79it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 938.26it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3642.59it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 689.75it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 5921.77it/s]
2025-09-24 10:40:12 INFO: EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
EM converged at iteration 5.
2025-09-24 10:40:12 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:40:12 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:40:12 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:40:12 [info     ] Evaluate question difficulty - end mae=1.84 rmse=2.25 split=test
2025-09-24 10:40:12 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 2 finished: 0:1:19

 ********** Run: 3/3 **********
2025-09-24 10:40:30 [info     ] Building roleplay dataset      name=dbe_kt22
2025-09-24 10:40:31 [info     ] Reading train split questions  num_questions=92
2025-09-24 10:40:31 [info     ] Reading validation split questions num_questions=23
2025-09-24 10:40:31 [info     ] Reading test split questions   num_questions=39
2025-09-24 10:40:32 [info     ] Reading train split interactions num_distinct_questions=92 num_distinct_students=988 num_interactions=65494
2025-09-24 10:40:32 [info     ] Misconceptions as context: bringing correct option forward
2025-09-24 10:40:37 [info     ] Building student scale         num_levels=5 student_scale=proficiency_5_str
2025-09-24 10:40:37 [info     ] Student scale built            map={'1': '1 (Fundamental Awareness)', '2': '2 (Novice)', '3': '3 (Intermediate)', '4': '4 (Advanced)', '5': '5 (Expert)'} string='(of levels 1 (Fundamental Awareness), 2 (Novice), 3 (Intermediate), 4 (Advanced), 5 (Expert))'
2025-09-24 10:40:37 [info     ] Building example formatter     name=quotes splits=['train']
2025-09-24 10:40:37 [info     ] Building example formatter     name=quotes splits=['train', 'validation', 'test']
2025-09-24 10:40:40 [info     ] Setting seed                   value=45
2025-09-24 10:40:40 [info     ] Building structured outputter  name=student_bool_nocontext
2025-09-24 10:40:40 [info     ] Building zero-shot prompt      native_structured_output=True system_prompt=student_dbe_miscons_level_nocontext
2025-09-24 10:40:40 [info     ] Building model                 name=qwen3:4b provider=ollama rate_limit=None temp=1.0
2025-09-24 10:40:40 [info     ] Predict - start                split=test
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:01<04:16,  1.32s/it]  2%|▏         | 3/195 [00:02<02:10,  1.47it/s]  2%|▏         | 4/195 [00:02<01:44,  1.83it/s]  3%|▎         | 5/195 [00:02<01:28,  2.13it/s]  3%|▎         | 6/195 [00:03<01:17,  2.45it/s]  4%|▎         | 7/195 [00:03<01:24,  2.21it/s]  4%|▍         | 8/195 [00:04<01:24,  2.20it/s]  5%|▌         | 10/195 [00:04<01:04,  2.88it/s]  6%|▌         | 11/195 [00:04<00:55,  3.32it/s]  6%|▌         | 12/195 [00:05<00:59,  3.08it/s]  7%|▋         | 13/195 [00:05<01:11,  2.54it/s]  7%|▋         | 14/195 [00:06<01:17,  2.35it/s]  8%|▊         | 15/195 [00:06<01:14,  2.42it/s]  9%|▊         | 17/195 [00:07<01:00,  2.93it/s]  9%|▉         | 18/195 [00:07<00:51,  3.47it/s] 10%|▉         | 19/195 [00:07<00:54,  3.22it/s] 10%|█         | 20/195 [00:07<00:49,  3.52it/s] 11%|█         | 21/195 [00:08<01:09,  2.52it/s] 11%|█▏        | 22/195 [00:09<01:17,  2.24it/s] 12%|█▏        | 24/195 [00:09<00:59,  2.88it/s] 13%|█▎        | 25/195 [00:09<00:50,  3.37it/s] 13%|█▎        | 26/195 [00:09<00:49,  3.40it/s] 14%|█▍        | 27/195 [00:10<00:44,  3.77it/s] 14%|█▍        | 28/195 [00:10<00:47,  3.54it/s] 15%|█▍        | 29/195 [00:10<00:43,  3.84it/s] 15%|█▌        | 30/195 [00:11<00:47,  3.46it/s] 16%|█▌        | 31/195 [00:11<00:42,  3.82it/s] 16%|█▋        | 32/195 [00:11<00:46,  3.54it/s] 17%|█▋        | 33/195 [00:11<00:42,  3.80it/s] 17%|█▋        | 34/195 [00:12<00:45,  3.56it/s] 18%|█▊        | 35/195 [00:12<00:41,  3.90it/s] 18%|█▊        | 36/195 [00:12<00:45,  3.48it/s] 19%|█▉        | 37/195 [00:12<00:41,  3.82it/s] 19%|█▉        | 38/195 [00:13<00:47,  3.34it/s] 21%|██        | 40/195 [00:13<00:42,  3.63it/s] 21%|██        | 41/195 [00:13<00:37,  4.13it/s] 22%|██▏       | 42/195 [00:14<00:41,  3.70it/s] 22%|██▏       | 43/195 [00:14<00:38,  3.97it/s] 23%|██▎       | 44/195 [00:14<00:47,  3.15it/s] 23%|██▎       | 45/195 [00:15<00:51,  2.89it/s] 24%|██▍       | 47/195 [00:15<00:42,  3.47it/s] 25%|██▍       | 48/195 [00:15<00:38,  3.80it/s] 25%|██▌       | 49/195 [00:16<00:40,  3.64it/s] 26%|██▌       | 50/195 [00:16<00:39,  3.69it/s] 26%|██▌       | 51/195 [00:17<01:01,  2.34it/s] 27%|██▋       | 52/195 [00:17<00:54,  2.61it/s] 27%|██▋       | 53/195 [00:17<00:51,  2.77it/s] 28%|██▊       | 54/195 [00:18<00:48,  2.90it/s] 28%|██▊       | 55/195 [00:18<00:44,  3.15it/s] 29%|██▊       | 56/195 [00:18<00:45,  3.06it/s] 29%|██▉       | 57/195 [00:19<00:52,  2.64it/s] 30%|██▉       | 58/195 [00:19<00:49,  2.78it/s] 30%|███       | 59/195 [00:19<00:44,  3.08it/s] 31%|███       | 60/195 [00:20<00:50,  2.69it/s] 31%|███▏      | 61/195 [00:20<00:45,  2.92it/s] 32%|███▏      | 62/195 [00:21<00:47,  2.83it/s] 32%|███▏      | 63/195 [00:21<00:40,  3.23it/s] 33%|███▎      | 64/195 [00:21<00:35,  3.64it/s] 33%|███▎      | 65/195 [00:21<00:34,  3.73it/s] 34%|███▍      | 66/195 [00:21<00:33,  3.91it/s] 34%|███▍      | 67/195 [00:22<00:37,  3.46it/s] 35%|███▍      | 68/195 [00:22<00:41,  3.07it/s] 35%|███▌      | 69/195 [00:22<00:33,  3.74it/s] 36%|███▌      | 70/195 [00:23<00:42,  2.92it/s] 36%|███▋      | 71/195 [00:23<00:49,  2.50it/s] 37%|███▋      | 72/195 [00:24<00:51,  2.38it/s] 38%|███▊      | 74/195 [00:24<00:42,  2.81it/s] 39%|███▉      | 76/195 [00:25<00:36,  3.29it/s] 39%|███▉      | 77/195 [00:25<00:33,  3.54it/s] 40%|████      | 78/195 [00:25<00:34,  3.43it/s] 41%|████      | 79/195 [00:26<00:30,  3.74it/s] 41%|████      | 80/195 [00:26<00:30,  3.71it/s] 42%|████▏     | 81/195 [00:26<00:31,  3.61it/s] 42%|████▏     | 82/195 [00:26<00:28,  3.96it/s] 43%|████▎     | 83/195 [00:27<00:32,  3.49it/s] 44%|████▎     | 85/195 [00:27<00:31,  3.48it/s] 44%|████▍     | 86/195 [00:28<00:30,  3.54it/s] 45%|████▍     | 87/195 [00:28<00:26,  4.09it/s] 45%|████▌     | 88/195 [00:28<00:28,  3.81it/s] 46%|████▌     | 89/195 [00:28<00:24,  4.39it/s] 46%|████▌     | 90/195 [00:28<00:27,  3.79it/s] 47%|████▋     | 91/195 [00:29<00:23,  4.37it/s] 47%|████▋     | 92/195 [00:29<00:26,  3.85it/s] 48%|████▊     | 93/195 [00:29<00:21,  4.69it/s] 48%|████▊     | 94/195 [00:30<00:28,  3.50it/s] 49%|████▉     | 96/195 [00:30<00:25,  3.92it/s] 50%|████▉     | 97/195 [00:30<00:24,  3.93it/s] 50%|█████     | 98/195 [00:30<00:23,  4.18it/s] 51%|█████     | 99/195 [00:31<00:22,  4.20it/s] 51%|█████▏    | 100/195 [00:31<00:22,  4.17it/s] 52%|█████▏    | 101/195 [00:31<00:30,  3.05it/s] 53%|█████▎    | 103/195 [00:32<00:30,  3.02it/s] 53%|█████▎    | 104/195 [00:33<00:35,  2.58it/s] 54%|█████▍    | 105/195 [00:33<00:31,  2.83it/s] 54%|█████▍    | 106/195 [00:33<00:33,  2.62it/s] 55%|█████▌    | 108/195 [00:34<00:32,  2.65it/s] 56%|█████▌    | 109/195 [00:35<00:33,  2.59it/s] 56%|█████▋    | 110/195 [00:35<00:29,  2.89it/s] 57%|█████▋    | 111/195 [00:35<00:30,  2.72it/s] 57%|█████▋    | 112/195 [00:35<00:28,  2.91it/s] 58%|█████▊    | 113/195 [00:36<00:29,  2.76it/s] 58%|█████▊    | 114/195 [00:36<00:27,  2.90it/s] 59%|█████▉    | 115/195 [00:37<00:28,  2.78it/s] 59%|█████▉    | 116/195 [00:37<00:26,  2.96it/s] 60%|██████    | 117/195 [00:37<00:27,  2.80it/s] 61%|██████    | 118/195 [00:38<00:26,  2.96it/s] 61%|██████    | 119/195 [00:38<00:26,  2.88it/s] 62%|██████▏   | 120/195 [00:38<00:24,  3.08it/s] 62%|██████▏   | 121/195 [00:38<00:21,  3.46it/s] 63%|██████▎   | 122/195 [00:39<00:24,  3.02it/s] 63%|██████▎   | 123/195 [00:39<00:24,  2.93it/s] 64%|██████▍   | 125/195 [00:40<00:20,  3.39it/s] 65%|██████▍   | 126/195 [00:40<00:19,  3.56it/s] 65%|██████▌   | 127/195 [00:41<00:30,  2.21it/s] 66%|██████▌   | 128/195 [00:41<00:27,  2.47it/s] 66%|██████▌   | 129/195 [00:41<00:24,  2.75it/s] 67%|██████▋   | 130/195 [00:42<00:25,  2.57it/s] 67%|██████▋   | 131/195 [00:42<00:25,  2.47it/s] 68%|██████▊   | 133/195 [00:43<00:21,  2.91it/s] 69%|██████▉   | 135/195 [00:43<00:18,  3.33it/s] 70%|██████▉   | 136/195 [00:44<00:16,  3.60it/s] 70%|███████   | 137/195 [00:44<00:17,  3.24it/s] 71%|███████▏  | 139/195 [00:44<00:16,  3.43it/s] 72%|███████▏  | 140/195 [00:45<00:14,  3.80it/s] 72%|███████▏  | 141/195 [00:45<00:15,  3.47it/s] 73%|███████▎  | 143/195 [00:46<00:15,  3.33it/s] 74%|███████▍  | 144/195 [00:46<00:18,  2.82it/s] 75%|███████▍  | 146/195 [00:47<00:15,  3.21it/s] 75%|███████▌  | 147/195 [00:47<00:16,  2.92it/s] 76%|███████▌  | 148/195 [00:47<00:13,  3.46it/s] 76%|███████▋  | 149/195 [00:48<00:14,  3.19it/s] 77%|███████▋  | 150/195 [00:48<00:12,  3.61it/s] 77%|███████▋  | 151/195 [00:48<00:13,  3.28it/s] 78%|███████▊  | 152/195 [00:48<00:11,  3.71it/s] 78%|███████▊  | 153/195 [00:49<00:12,  3.27it/s] 79%|███████▉  | 155/195 [00:49<00:11,  3.38it/s] 81%|████████  | 157/195 [00:50<00:09,  3.93it/s] 82%|████████▏ | 159/195 [00:50<00:08,  4.23it/s] 82%|████████▏ | 160/195 [00:50<00:07,  4.70it/s] 83%|████████▎ | 161/195 [00:50<00:07,  4.39it/s] 83%|████████▎ | 162/195 [00:51<00:06,  4.73it/s] 84%|████████▎ | 163/195 [00:51<00:07,  4.22it/s] 84%|████████▍ | 164/195 [00:51<00:06,  4.54it/s] 85%|████████▍ | 165/195 [00:51<00:07,  3.98it/s] 85%|████████▌ | 166/195 [00:52<00:07,  3.93it/s] 86%|████████▌ | 167/195 [00:53<00:11,  2.42it/s] 86%|████████▌ | 168/195 [00:53<00:10,  2.59it/s] 87%|████████▋ | 169/195 [00:53<00:08,  2.96it/s] 87%|████████▋ | 170/195 [00:53<00:08,  2.82it/s] 88%|████████▊ | 171/195 [00:54<00:07,  3.26it/s] 88%|████████▊ | 172/195 [00:54<00:07,  3.20it/s] 89%|████████▊ | 173/195 [00:54<00:08,  2.72it/s] 89%|████████▉ | 174/195 [00:55<00:07,  2.88it/s] 90%|████████▉ | 175/195 [00:55<00:07,  2.68it/s] 90%|█████████ | 176/195 [00:55<00:06,  2.98it/s] 91%|█████████ | 177/195 [00:56<00:07,  2.51it/s] 91%|█████████▏| 178/195 [00:56<00:06,  2.66it/s] 92%|█████████▏| 179/195 [00:57<00:06,  2.53it/s] 92%|█████████▏| 180/195 [00:57<00:05,  2.73it/s] 93%|█████████▎| 181/195 [00:57<00:04,  3.14it/s] 93%|█████████▎| 182/195 [00:58<00:04,  3.02it/s] 94%|█████████▍| 183/195 [00:58<00:03,  3.44it/s] 94%|█████████▍| 184/195 [00:58<00:03,  3.20it/s] 95%|█████████▍| 185/195 [00:58<00:02,  3.59it/s] 95%|█████████▌| 186/195 [00:59<00:02,  3.44it/s] 96%|█████████▌| 187/195 [00:59<00:02,  3.54it/s] 96%|█████████▋| 188/195 [00:59<00:01,  3.63it/s] 97%|█████████▋| 189/195 [00:59<00:01,  3.84it/s] 97%|█████████▋| 190/195 [01:00<00:01,  3.68it/s] 98%|█████████▊| 191/195 [01:00<00:00,  4.07it/s] 98%|█████████▊| 192/195 [01:00<00:00,  3.88it/s] 99%|█████████▉| 193/195 [01:00<00:00,  4.06it/s] 99%|█████████▉| 194/195 [01:01<00:00,  3.64it/s]100%|██████████| 195/195 [01:01<00:00,  4.39it/s]100%|██████████| 195/195 [01:03<00:00,  3.06it/s]
2025-09-24 10:41:44 [info     ] Validating outputs
2025-09-24 10:41:44 [info     ] Predict - end                  time=0:1:3
2025-09-24 10:41:44 [info     ] Evaluate - start               split=test
2025-09-24 10:41:44 [info     ] Evaluate - end                 answer_distr=[0.31, 0.13, 0.14, 0.26] correctness_llm=0.69 llm_group_correctness=[0.62, 0.64, 0.69, 0.74, 0.77] monotonicity=0.98
2025-09-24 10:41:44 [info     ] Evaluate question difficulty - start split=test
2025-09-24 10:41:44 [info     ] Augmenting questions for IRT estimation num_questions=19
2025-09-24 10:41:44 INFO: start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
start loading data
2025-09-24 10:41:44 INFO: data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
data loaded
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 997.96it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 4623.98it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 560.12it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6755.67it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 972.77it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3138.12it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 454.05it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6921.29it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1007.52it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3749.81it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 646.86it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 8899.71it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 986.33it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3816.74it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 592.05it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6772.81it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1145.67it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 4025.54it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 638.00it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6968.94it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 1063.16it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 3515.69it/s]
  0%|          | 0/39 [00:00<?, ?it/s]100%|██████████| 39/39 [00:00<00:00, 592.69it/s]
  0%|          | 0/7 [00:00<?, ?it/s]100%|██████████| 7/7 [00:00<00:00, 6805.78it/s]
2025-09-24 10:41:49 INFO: EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
EM converged at iteration 6.
2025-09-24 10:41:49 INFO: parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
parameter estimated
2025-09-24 10:41:49 INFO: parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
parameter retrieved
2025-09-24 10:41:49 [info     ] Rescaling difficulty range     new_range=(-5, 5) old_range=(-5, 5)
2025-09-24 10:41:49 [info     ] Evaluate question difficulty - end mae=1.74 rmse=2.16 split=test
2025-09-24 10:41:49 [info     ] Saving data                    path=./output/roleplay_dbekt22_test_20250924-090854
Run 3 finished: 0:1:18
2025-09-24 10:42:09 [info     ] All experiments completed successfully.
